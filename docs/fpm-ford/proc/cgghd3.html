<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="spag_lapack module">
    <meta name="author" content="John S. Urban" >
    <link rel="icon" href="../favicon.png">

    <title>CGGHD3 &ndash; spag_lapack</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">spag_lapack </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>CGGHD3
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 0.1% of total for procedures.">379 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/cgghd3.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/cgghd3.f90.html'>cgghd3.f90</a></li>
            <li class="breadcrumb-item active" aria-current="page">CGGHD3</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#vars-0"
         aria-expanded="false" aria-controls="vars-0">
         <h4 class="card-header bg-primary text-white">Variables</h4>
      </a>
      <div id="vars-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../proc/cgghd3.html#variable-cone~133">CONE</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-czero~101">CZERO</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-blk22~4">blk22</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-c~52">c</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-c1~16">c1</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-c2~16">c2</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-cola~4">cola</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-compq2~4">compq2</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-compz2~4">compz2</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-ctemp~13">ctemp</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-i~1053">i</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-ierr~83">ierr</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-initq~12">initq</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-initz~8">initz</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-j~814">j</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-j0~4">j0</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-jcol~14">jcol</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-jj~58">jj</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-jrow~14">jrow</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-k~362">k</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-kacc22~10">kacc22</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-len~6">len</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-lquery~364">lquery</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-lwkopt~202">lwkopt</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-n2nb~4">n2nb</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-nb~220">nb</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-nblst~4">nblst</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-nbmin~73">nbmin</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-nh~18">nh</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-nnb~12">nnb</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-nx~48">nx</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-ppw~4">ppw</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-ppwo~4">ppwo</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-pw~4">pw</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-s~115">s</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-s1~18">s1</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-s2~18">s2</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-temp~195">temp</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-temp1~45">temp1</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-temp2~44">temp2</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-temp3~4">temp3</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-top~4">top</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-topq~4">topq</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-wantq~33">wantq</a>
            <a class="list-group-item" href="../proc/cgghd3.html#variable-wantz~93">wantz</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/cgghd3.html#src">CGGHD3</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2> subroutine CGGHD3(Compq, Compz, N, Ilo, Ihi, A, Lda, B, Ldb, Q, Ldq, Z, Ldz, Work, Lwork, Info)  
</h2>
    

    <p>\brief \b CGGHD3
 \htmlonly
 Download CGGHD3 + dependencies
 <a href="http://www.netlib.org/cgi-bin/netlibfiles.tgz?format=tgz&filename=/lapack/lapack_routine/cgghd3.f">
 [TGZ]</a>
 <a href="http://www.netlib.org/cgi-bin/netlibfiles.zip?format=zip&filename=/lapack/lapack_routine/cgghd3.f">
 [ZIP]</a>
 <a href="http://www.netlib.org/cgi-bin/netlibfiles.txt?format=txt&filename=/lapack/lapack_routine/cgghd3.f">
 [TXT]</a>
 \endhtmlonly
 \par Purpose:</p>
<p>\verbatim</p>
<p>CGGHD3 reduces a pair of complex matrices (A,B) to generalized upper
 Hessenberg form using unitary transformations, where A is a
 general matrix and B is upper triangular.  The form of the
 generalized eigenvalue problem is
    A<em>x = lambda</em>B*x,
 and B is typically made upper triangular by computing its QR
 factorization and moving the unitary matrix Q to the left side
 of the equation.</p>
<p>This subroutine simultaneously reduces A to a Hessenberg matrix H:
    Q<strong>H<em>A</em>Z = H
 and transforms B to another upper triangular matrix T:
    Q</strong>H<em>B</em>Z = T
 in order to reduce the problem to its standard form
    H<em>y = lambda</em>T<em>y
 where y = Z</em><em>H</em>x.</p>
<p>The unitary matrices Q and Z are determined as products of Givens
 rotations.  They may either be formed explicitly, or they may be
 postmultiplied into input matrices Q1 and Z1, so that</p>
<div class="codehilite"><pre><span></span><code>  Q1 * A * Z1**H = (Q1*Q) * H * (Z1*Z)**H

  Q1 * B * Z1**H = (Q1*Q) * T * (Z1*Z)**H
</code></pre></div>

<p>If Q1 is the unitary matrix from the QR factorization of B in the
 original equation A<em>x = lambda</em>B*x, then CGGHD3 reduces the original
 problem to generalized Hessenberg form.</p>
<p>This is a blocked variant of CGGHRD, using matrix-matrix
 multiplications for parts of the computation to enhance performance.
 \endverbatim
 \param[in] COMPQ
 \verbatim
          COMPQ is CHARACTER<em>1
          = &lsquo;N&rsquo;: do not compute Q;
          = &lsquo;I&rsquo;: Q is initialized to the unit matrix, and the
                 unitary matrix Q is returned;
          = &lsquo;V&rsquo;: Q must contain a unitary matrix Q1 on entry,
                 and the product Q1</em>Q is returned.
 \endverbatim</p>
<p>\param[in] COMPZ
 \verbatim
          COMPZ is CHARACTER<em>1
          = &lsquo;N&rsquo;: do not compute Z;
          = &lsquo;I&rsquo;: Z is initialized to the unit matrix, and the
                 unitary matrix Z is returned;
          = &lsquo;V&rsquo;: Z must contain a unitary matrix Z1 on entry,
                 and the product Z1</em>Z is returned.
 \endverbatim</p>
<p>\param[in] N
 \verbatim
          N is INTEGER
          The order of the matrices A and B.  N &gt;= 0.
 \endverbatim</p>
<p>\param[in] ILO
 \verbatim
          ILO is INTEGER
 \endverbatim</p>
<p>\param[in] IHI
 \verbatim
          IHI is INTEGER</p>
<div class="codehilite"><pre><span></span><code><span class="w">      </span><span class="nt">ILO</span><span class="w"> </span><span class="nt">and</span><span class="w"> </span><span class="nt">IHI</span><span class="w"> </span><span class="nt">mark</span><span class="w"> </span><span class="nt">the</span><span class="w"> </span><span class="nt">rows</span><span class="w"> </span><span class="nt">and</span><span class="w"> </span><span class="nt">columns</span><span class="w"> </span><span class="nt">of</span><span class="w"> </span><span class="nt">A</span><span class="w"> </span><span class="nt">which</span><span class="w"> </span><span class="nt">are</span><span class="w"> </span><span class="nt">to</span><span class="w"> </span><span class="nt">be</span><span class="w"></span>
<span class="w">      </span><span class="nt">reduced</span><span class="o">.</span><span class="w">  </span><span class="nt">It</span><span class="w"> </span><span class="nt">is</span><span class="w"> </span><span class="nt">assumed</span><span class="w"> </span><span class="nt">that</span><span class="w"> </span><span class="nt">A</span><span class="w"> </span><span class="nt">is</span><span class="w"> </span><span class="nt">already</span><span class="w"> </span><span class="nt">upper</span><span class="w"> </span><span class="nt">triangular</span><span class="w"></span>
<span class="w">      </span><span class="nt">in</span><span class="w"> </span><span class="nt">rows</span><span class="w"> </span><span class="nt">and</span><span class="w"> </span><span class="nt">columns</span><span class="w"> </span><span class="nt">1</span><span class="p">:</span><span class="nd">ILO-1</span><span class="w"> </span><span class="nt">and</span><span class="w"> </span><span class="nt">IHI</span><span class="o">+</span><span class="nt">1</span><span class="p">:</span><span class="nd">N</span><span class="o">.</span><span class="w">  </span><span class="nt">ILO</span><span class="w"> </span><span class="nt">and</span><span class="w"> </span><span class="nt">IHI</span><span class="w"> </span><span class="nt">are</span><span class="w"></span>
<span class="w">      </span><span class="nt">normally</span><span class="w"> </span><span class="nt">set</span><span class="w"> </span><span class="nt">by</span><span class="w"> </span><span class="nt">a</span><span class="w"> </span><span class="nt">previous</span><span class="w"> </span><span class="nt">call</span><span class="w"> </span><span class="nt">to</span><span class="w"> </span><span class="nt">CGGBAL</span><span class="o">;</span><span class="w"> </span><span class="nt">otherwise</span><span class="w"> </span><span class="nt">they</span><span class="w"></span>
<span class="w">      </span><span class="nt">should</span><span class="w"> </span><span class="nt">be</span><span class="w"> </span><span class="nt">set</span><span class="w"> </span><span class="nt">to</span><span class="w"> </span><span class="nt">1</span><span class="w"> </span><span class="nt">and</span><span class="w"> </span><span class="nt">N</span><span class="w"> </span><span class="nt">respectively</span><span class="o">.</span><span class="w"></span>
<span class="w">      </span><span class="nt">1</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nt">ILO</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nt">IHI</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nt">N</span><span class="o">,</span><span class="w"> </span><span class="nt">if</span><span class="w"> </span><span class="nt">N</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nt">0</span><span class="o">;</span><span class="w"> </span><span class="nt">ILO</span><span class="o">=</span><span class="nt">1</span><span class="w"> </span><span class="nt">and</span><span class="w"> </span><span class="nt">IHI</span><span class="o">=</span><span class="nt">0</span><span class="o">,</span><span class="w"> </span><span class="nt">if</span><span class="w"> </span><span class="nt">N</span><span class="o">=</span><span class="nt">0</span><span class="o">.</span><span class="w"></span>
</code></pre></div>

<p>\endverbatim</p>
<p>\param[in,out] A
 \verbatim
          A is COMPLEX array, dimension (LDA, N)
          On entry, the N-by-N general matrix to be reduced.
          On exit, the upper triangle and the first subdiagonal of A
          are overwritten with the upper Hessenberg matrix H, and the
          rest is set to zero.
 \endverbatim</p>
<p>\param[in] LDA
 \verbatim
          LDA is INTEGER
          The leading dimension of the array A.  LDA &gt;= max(1,N).
 \endverbatim</p>
<p>\param[in,out] B
 \verbatim
          B is COMPLEX array, dimension (LDB, N)
          On entry, the N-by-N upper triangular matrix B.
          On exit, the upper triangular matrix T = Q**H B Z.  The
          elements below the diagonal are set to zero.
 \endverbatim</p>
<p>\param[in] LDB
 \verbatim
          LDB is INTEGER
          The leading dimension of the array B.  LDB &gt;= max(1,N).
 \endverbatim</p>
<p>\param[in,out] Q
 \verbatim
          Q is COMPLEX array, dimension (LDQ, N)
          On entry, if COMPQ = &lsquo;V&rsquo;, the unitary matrix Q1, typically
          from the QR factorization of B.
          On exit, if COMPQ=&rsquo;I&rsquo;, the unitary matrix Q, and if
          COMPQ = &lsquo;V&rsquo;, the product Q1*Q.
          Not referenced if COMPQ=&rsquo;N&rsquo;.
 \endverbatim</p>
<p>\param[in] LDQ
 \verbatim
          LDQ is INTEGER
          The leading dimension of the array Q.
          LDQ &gt;= N if COMPQ=&rsquo;V&rsquo; or &lsquo;I&rsquo;; LDQ &gt;= 1 otherwise.
 \endverbatim</p>
<p>\param[in,out] Z
 \verbatim
          Z is COMPLEX array, dimension (LDZ, N)
          On entry, if COMPZ = &lsquo;V&rsquo;, the unitary matrix Z1.
          On exit, if COMPZ=&rsquo;I&rsquo;, the unitary matrix Z, and if
          COMPZ = &lsquo;V&rsquo;, the product Z1*Z.
          Not referenced if COMPZ=&rsquo;N&rsquo;.
 \endverbatim</p>
<p>\param[in] LDZ
 \verbatim
          LDZ is INTEGER
          The leading dimension of the array Z.
          LDZ &gt;= N if COMPZ=&rsquo;V&rsquo; or &lsquo;I&rsquo;; LDZ &gt;= 1 otherwise.
 \endverbatim</p>
<p>\param[out] WORK
 \verbatim
          WORK is COMPLEX array, dimension (LWORK)
          On exit, if INFO = 0, WORK(1) returns the optimal LWORK.
 \endverbatim</p>
<p>\param[in]  LWORK
 \verbatim
          LWORK is INTEGER
          The length of the array WORK.  LWORK &gt;= 1.
          For optimum performance LWORK &gt;= 6<em>N</em>NB, where NB is the
          optimal blocksize.</p>
<div class="codehilite"><pre><span></span><code>      <span class="k">If</span> <span class="nv">LWORK</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>, <span class="k">then</span> <span class="nv">a</span> <span class="nv">workspace</span> <span class="nv">query</span> <span class="nv">is</span> <span class="nv">assumed</span><span class="c1">; the routine</span>
      <span class="nv">only</span> <span class="nv">calculates</span> <span class="nv">the</span> <span class="nv">optimal</span> <span class="nv">size</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">WORK</span> <span class="nv">array</span>, <span class="nv">returns</span>
      <span class="nv">this</span> <span class="nv">value</span> <span class="nv">as</span> <span class="nv">the</span> <span class="nv">first</span> <span class="nv">entry</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">WORK</span> <span class="nv">array</span>, <span class="nv">and</span> <span class="nv">no</span> <span class="nv">error</span>
      <span class="nv">message</span> <span class="nv">related</span> <span class="nv">to</span> <span class="nv">LWORK</span> <span class="nv">is</span> <span class="nv">issued</span> <span class="nv">by</span> <span class="nv">XERBLA</span>.
</code></pre></div>

<p>\endverbatim</p>
<p>\param[out] INFO
 \verbatim
          INFO is INTEGER
          = 0:  successful exit.
          &lt; 0:  if INFO = -i, the i-th argument had an illegal value.
 \endverbatim
 \author Univ. of Tennessee
 \author Univ. of California Berkeley
 \author Univ. of Colorado Denver
 \author NAG Ltd.
 \date January 2015
 \ingroup complexOTHERcomputational
 \par Further Details:</p>
<p>\verbatim</p>
<p>This routine reduces A to Hessenberg form and maintains B in triangular form
  using a blocked variant of Moler and Stewart&rsquo;s original algorithm,
  as described by Kagstrom, Kressner, Quintana-Orti, and Quintana-Orti
  (BIT 2008).
 \endverbatim</p>
<p>&ndash;CGGHD3242</p>
<div class="codehilite"><pre><span></span><code> .. Scalar Arguments ..
</code></pre></div>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-compq~15"></span>
              character(len=1)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Compq</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-compz~21"></span>
              character(len=1)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Compz</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-n~1433"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>N</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ilo~47"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ilo</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ihi~47"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ihi</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-a~885"></span>
              complex
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>A</strong>(Lda,*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lda~851"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Lda</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-b~421"></span>
              complex
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>B</strong>(Ldb,*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldb~406"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ldb</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-q~87"></span>
              complex
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Q</strong>(Ldq,*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldq~61"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ldq</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-z~154"></span>
              complex
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Z</strong>(Ldz,*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldz~123"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ldz</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-work~851"></span>
              complex
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Work</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork~400"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Lwork</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-info~1119"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Info</strong></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    <br>


    <section>    
      <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-cone~133"></span>
              complex,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>CONE</strong></td>
<td> =</td>
                <td>(1.0E+0,0.0E+0)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-czero~101"></span>
              complex,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>CZERO</strong></td>
<td> =</td>
                <td>(0.0E+0,0.0E+0)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-blk22~4"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>blk22</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-c~52"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>c</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-c1~16"></span>
              complex,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>c1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-c2~16"></span>
              complex,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>c2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-cola~4"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>cola</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-compq2~4"></span>
              character(len=1),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>compq2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-compz2~4"></span>
              character(len=1),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>compz2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ctemp~13"></span>
              complex,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ctemp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-i~1053"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>i</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ierr~83"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ierr</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-initq~12"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>initq</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-initz~8"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>initz</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-j~814"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>j</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-j0~4"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>j0</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jcol~14"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jcol</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jj~58"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jj</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jrow~14"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jrow</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-k~362"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>k</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-kacc22~10"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>kacc22</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-len~6"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>len</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lquery~364"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lquery</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwkopt~202"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwkopt</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-n2nb~4"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>n2nb</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nb~220"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nb</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nblst~4"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nblst</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nbmin~73"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nbmin</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nh~18"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nh</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nnb~12"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nnb</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nx~48"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nx</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ppw~4"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ppw</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ppwo~4"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ppwo</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-pw~4"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>pw</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s~115"></span>
              complex,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>s</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s1~18"></span>
              complex,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>s1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s2~18"></span>
              complex,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>s2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-temp~195"></span>
              complex,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>temp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-temp1~45"></span>
              complex,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>temp1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-temp2~44"></span>
              complex,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>temp2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-temp3~4"></span>
              complex,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>temp3</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-top~4"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>top</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-topq~4"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>topq</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wantq~33"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wantq</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wantz~93"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wantz</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">      </span><span class="k">SUBROUTINE </span><span class="n">CGGHD3</span><span class="p">(</span><span class="n">Compq</span><span class="p">,</span><span class="n">Compz</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Ilo</span><span class="p">,</span><span class="n">Ihi</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">Ldb</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="n">Ldq</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">Ldz</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">,</span><span class="n">Lwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!  -- LAPACK computational routine (version 3.8.0) --</span>
<span class="c">!  -- LAPACK is a software package provided by Univ. of Tennessee,    --</span>
<span class="c">!  -- Univ. of California Berkeley, Univ. of Colorado Denver and NAG Ltd..--</span>
<span class="c">!     January 2015</span>
<span class="c">!</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IMPLICIT NONE</span><span class="w"></span>
<span class="c">!*--CGGHD3242</span>
<span class="c">!</span>
<span class="c">!     .. Scalar Arguments ..</span>
<span class="w">      </span><span class="kt">CHARACTER </span><span class="n">Compq</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Compz</span><span class="w"></span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">Ihi</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Ilo</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Info</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Lda</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Ldb</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Ldq</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Ldz</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Lwork</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Array Arguments ..</span>
<span class="w">      </span><span class="kt">COMPLEX </span><span class="n">A</span><span class="p">(</span><span class="n">Lda</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="n">Ldb</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Q</span><span class="p">(</span><span class="n">Ldq</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Z</span><span class="p">(</span><span class="n">Ldz</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!</span>
<span class="c">!  =====================================================================</span>
<span class="c">!</span>
<span class="c">!     .. Parameters ..</span>
<span class="w">      </span><span class="kt">COMPLEX </span><span class="n">CONE</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">CZERO</span><span class="w"></span>
<span class="w">      </span><span class="k">PARAMETER</span><span class="w"> </span><span class="p">(</span><span class="n">CONE</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0E+0</span><span class="p">,</span><span class="mf">0.0E+0</span><span class="p">),</span><span class="n">CZERO</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0E+0</span><span class="p">,</span><span class="mf">0.0E+0</span><span class="p">))</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Local Scalars ..</span>
<span class="w">      </span><span class="kt">LOGICAL </span><span class="n">blk22</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">initq</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">initz</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lquery</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">wantq</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">wantz</span><span class="w"></span>
<span class="w">      </span><span class="kt">CHARACTER</span><span class="o">*</span><span class="mi">1</span><span class="w"> </span><span class="n">compq2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">compz2</span><span class="w"></span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">cola</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">j0</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">jcol</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">jj</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">jrow</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">kacc22</span><span class="w"> </span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="nb">len</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lwkopt</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">n2nb</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">nblst</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">nbmin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">nh</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">nnb</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">nx</span><span class="w"> </span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">ppw</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ppwo</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">pw</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">top</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">topq</span><span class="w"></span>
<span class="w">      </span><span class="kt">REAL </span><span class="n">c</span><span class="w"></span>
<span class="w">      </span><span class="kt">COMPLEX </span><span class="n">c1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">c2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ctemp</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">s1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">s2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">temp1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">temp2</span><span class="w"> </span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">temp3</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. External Functions ..</span>
<span class="w">      </span><span class="kt">LOGICAL </span><span class="n">LSAME</span><span class="w"></span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">ILAENV</span><span class="w"></span>
<span class="w">      </span><span class="k">EXTERNAL </span><span class="n">ILAENV</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">LSAME</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. External Subroutines ..</span>
<span class="w">      </span><span class="k">EXTERNAL </span><span class="n">CGGHRD</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">CLARTG</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">CLASET</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">CUNM22</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">CROT</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">CGEMM</span><span class="w"> </span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">         </span><span class="n">CGEMV</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">CTRMV</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">CLACPY</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">XERBLA</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Intrinsic Functions ..</span>
<span class="w">      </span><span class="k">INTRINSIC </span><span class="kt">REAL</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nb">CMPLX</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nb">CONJG</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nb">MAX</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Executable Statements ..</span>
<span class="c">!</span>
<span class="c">!     Decode and test the input parameters.</span>
<span class="c">!</span>
<span class="w">      </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">nb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ILAENV</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;CGGHD3&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Ilo</span><span class="p">,</span><span class="n">Ihi</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">lwkopt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">N</span><span class="o">*</span><span class="n">nb</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">Work</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">CMPLX</span><span class="p">(</span><span class="n">lwkopt</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">initq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LSAME</span><span class="p">(</span><span class="n">Compq</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">wantq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">initq</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">LSAME</span><span class="p">(</span><span class="n">Compq</span><span class="p">,</span><span class="s1">&#39;V&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">initz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LSAME</span><span class="p">(</span><span class="n">Compz</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">wantz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">initz</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">LSAME</span><span class="p">(</span><span class="n">Compz</span><span class="p">,</span><span class="s1">&#39;V&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">lquery</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Lwork</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">LSAME</span><span class="p">(</span><span class="n">Compq</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">wantq</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">LSAME</span><span class="p">(</span><span class="n">Compz</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">wantz</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">N</span><span class="o">&lt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Ilo</span><span class="o">&lt;</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Ihi</span><span class="o">&gt;</span><span class="n">N</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">Ihi</span><span class="o">&lt;</span><span class="n">Ilo</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">5</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Lda</span><span class="o">&lt;</span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">7</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Ldb</span><span class="o">&lt;</span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">9</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">wantq</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">Ldq</span><span class="o">&lt;</span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">Ldq</span><span class="o">&lt;</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">11</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">wantz</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">Ldz</span><span class="o">&lt;</span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">Ldz</span><span class="o">&lt;</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">13</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Lwork</span><span class="o">&lt;</span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">lquery</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">15</span><span class="w"></span>
<span class="w">      </span><span class="k">ENDIF</span>
<span class="k">      IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Info</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         CALL </span><span class="n">XERBLA</span><span class="p">(</span><span class="s1">&#39;CGGHD3&#39;</span><span class="p">,</span><span class="o">-</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">RETURN</span>
<span class="k">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">lquery</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         RETURN</span>
<span class="k">      ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Initialize Q and Z if desired.</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">initq</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">CALL </span><span class="n">CLASET</span><span class="p">(</span><span class="s1">&#39;All&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">CONE</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="n">Ldq</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">initz</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">CALL </span><span class="n">CLASET</span><span class="p">(</span><span class="s1">&#39;All&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">CONE</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">Ldz</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Zero out lower triangle of B.</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">N</span><span class="o">&gt;</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">CALL </span><span class="n">CLASET</span><span class="p">(</span><span class="s1">&#39;Lower&#39;</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">B</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">Ldb</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Quick return if possible</span>
<span class="c">!</span>
<span class="w">      </span><span class="n">nh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ihi</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Ilo</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nh</span><span class="o">&lt;=</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Work</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CONE</span><span class="w"></span>
<span class="w">         </span><span class="k">RETURN</span>
<span class="k">      ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Determine the blocksize.</span>
<span class="c">!</span>
<span class="w">      </span><span class="n">nbmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ILAENV</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;CGGHD3&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Ilo</span><span class="p">,</span><span class="n">Ihi</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nb</span><span class="o">&gt;</span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">nb</span><span class="o">&lt;</span><span class="n">nh</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!        Determine when to use unblocked instead of blocked code.</span>
<span class="c">!</span>
<span class="w">         </span><span class="n">nx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">nb</span><span class="p">,</span><span class="n">ILAENV</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;CGGHD3&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Ilo</span><span class="p">,</span><span class="n">Ihi</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nx</span><span class="o">&lt;</span><span class="n">nh</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Determine if workspace is large enough for blocked code.</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Lwork</span><span class="o">&lt;</span><span class="n">lwkopt</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Not enough workspace to use optimal NB:  determine the</span>
<span class="c">!              minimum value of NB, and reduce NB or force use of</span>
<span class="c">!              unblocked code.</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">nbmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">ILAENV</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;CGGHD3&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Ilo</span><span class="p">,</span><span class="n">Ihi</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Lwork</span><span class="o">&gt;=</span><span class="mi">6</span><span class="o">*</span><span class="n">N</span><span class="o">*</span><span class="n">nbmin</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                  </span><span class="n">nb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Lwork</span><span class="o">/</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">N</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">ELSE</span>
<span class="k">                  </span><span class="n">nb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span>
<span class="k">            ENDIF</span>
<span class="k">         ENDIF</span>
<span class="k">      ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nb</span><span class="o">&lt;</span><span class="n">nbmin</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">nb</span><span class="o">&gt;=</span><span class="n">nh</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!        Use unblocked code below</span>
<span class="c">!</span>
<span class="w">         </span><span class="n">jcol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ilo</span><span class="w"></span>
<span class="c">!</span>
<span class="w">      </span><span class="k">ELSE</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!        Use blocked code</span>
<span class="c">!</span>
<span class="w">         </span><span class="n">kacc22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ILAENV</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="s1">&#39;CGGHD3&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Ilo</span><span class="p">,</span><span class="n">Ihi</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">blk22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kacc22</span><span class="o">==</span><span class="mi">2</span><span class="w"></span>
<span class="w">         </span><span class="k">DO </span><span class="n">jcol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ilo</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Ihi</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="w"></span>
<span class="w">            </span><span class="n">nnb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">nb</span><span class="p">,</span><span class="n">Ihi</span><span class="o">-</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Initialize small unitary factors that will hold the</span>
<span class="c">!           accumulated Givens rotations in workspace.</span>
<span class="c">!           N2NB   denotes the number of 2*NNB-by-2*NNB factors</span>
<span class="c">!           NBLST  denotes the (possibly smaller) order of the last</span>
<span class="c">!                  factor.</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">n2nb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Ihi</span><span class="o">-</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">nnb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">nblst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ihi</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">jcol</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">n2nb</span><span class="o">*</span><span class="n">nnb</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLASET</span><span class="p">(</span><span class="s1">&#39;All&#39;</span><span class="p">,</span><span class="n">nblst</span><span class="p">,</span><span class="n">nblst</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">CONE</span><span class="p">,</span><span class="n">Work</span><span class="p">,</span><span class="n">nblst</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">pw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nblst</span><span class="o">*</span><span class="n">nblst</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">n2nb</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLASET</span><span class="p">(</span><span class="s1">&#39;All&#39;</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">CONE</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">pw</span><span class="p">),</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">pw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pw</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4</span><span class="o">*</span><span class="n">nnb</span><span class="o">*</span><span class="n">nnb</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDDO</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Reduce columns JCOL:JCOL+NNB-1 of A to Hessenberg form.</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">DO </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jcol</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">jcol</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nnb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Reduce Jth column of A. Store cosines and sines in Jth</span>
<span class="c">!              column of A and B, respectively.</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ihi</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="w">                  </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">CALL </span><span class="n">CLARTG</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="n">c</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">))</span><span class="w"></span>
<span class="w">                  </span><span class="n">A</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">CMPLX</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">B</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDDO</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Accumulate Givens rotations into workspace array.</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">ppw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">nblst</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">nblst</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">jcol</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="nb">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">jcol</span><span class="w"></span>
<span class="w">               </span><span class="n">jrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n2nb</span><span class="o">*</span><span class="n">nnb</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="w">               </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ihi</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">jrow</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="w">                  </span><span class="n">ctemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">DO </span><span class="n">jj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ppw</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ppw</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                     </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">jj</span><span class="o">+</span><span class="n">nblst</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="n">Work</span><span class="p">(</span><span class="n">jj</span><span class="o">+</span><span class="n">nblst</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctemp</span><span class="o">*</span><span class="n">temp</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">Work</span><span class="p">(</span><span class="n">jj</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="n">Work</span><span class="p">(</span><span class="n">jj</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">CONJG</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">*</span><span class="n">temp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ctemp</span><span class="o">*</span><span class="n">Work</span><span class="p">(</span><span class="n">jj</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">ENDDO</span>
<span class="k">                  </span><span class="nb">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">len</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                  </span><span class="n">ppw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ppw</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">nblst</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDDO</span><span class="w"></span>
<span class="c">!</span>
<span class="w">               </span><span class="n">ppwo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nblst</span><span class="o">*</span><span class="n">nblst</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">nnb</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nnb</span><span class="w"></span>
<span class="w">               </span><span class="n">j0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jrow</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">nnb</span><span class="w"></span>
<span class="w">               </span><span class="k">DO </span><span class="n">jrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j0</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">nnb</span><span class="w"></span>
<span class="w">                  </span><span class="n">ppw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ppwo</span><span class="w"></span>
<span class="w">                  </span><span class="nb">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">jcol</span><span class="w"></span>
<span class="w">                  </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jrow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nnb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">jrow</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="w">                     </span><span class="n">ctemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="k">DO </span><span class="n">jj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ppw</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ppw</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                        </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">jj</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="n">Work</span><span class="p">(</span><span class="n">jj</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctemp</span><span class="o">*</span><span class="n">temp</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">Work</span><span class="p">(</span><span class="n">jj</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="n">Work</span><span class="p">(</span><span class="n">jj</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">CONJG</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">*</span><span class="n">temp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ctemp</span><span class="o">*</span><span class="n">Work</span><span class="p">(</span><span class="n">jj</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="k">ENDDO</span>
<span class="k">                     </span><span class="nb">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">len</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                     </span><span class="n">ppw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ppw</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                  </span><span class="k">ENDDO</span>
<span class="k">                  </span><span class="n">ppwo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ppwo</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4</span><span class="o">*</span><span class="n">nnb</span><span class="o">*</span><span class="n">nnb</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDDO</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              TOP denotes the number of top rows in A and B that will</span>
<span class="c">!              not be updated during the next steps.</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">jcol</span><span class="o">&lt;=</span><span class="mi">2</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                  </span><span class="n">top</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">               </span><span class="k">ELSE</span>
<span class="k">                  </span><span class="n">top</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jcol</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Propagate transformations through B and replace stored</span>
<span class="c">!              left sines/cosines by right sines/cosines.</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">DO </span><span class="n">jj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Update JJth column of B.</span>
<span class="c">!</span>
<span class="w">                  </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">jj</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">Ihi</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="w">                     </span><span class="n">ctemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">jj</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="n">B</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">jj</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctemp</span><span class="o">*</span><span class="n">temp</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">CONJG</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">*</span><span class="n">B</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">jj</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="n">B</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">jj</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">temp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ctemp</span><span class="o">*</span><span class="n">B</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">jj</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">ENDDO</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Annihilate B( JJ+1, JJ ).</span>
<span class="c">!</span>
<span class="w">                  </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">jj</span><span class="o">&lt;</span><span class="n">Ihi</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                     </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="n">jj</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jj</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="k">CALL </span><span class="n">CLARTG</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span><span class="n">B</span><span class="p">(</span><span class="n">jj</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jj</span><span class="p">),</span><span class="n">c</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">B</span><span class="p">(</span><span class="n">jj</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jj</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="w">                     </span><span class="n">B</span><span class="p">(</span><span class="n">jj</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jj</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CZERO</span><span class="w"></span>
<span class="w">                     </span><span class="k">CALL </span><span class="n">CROT</span><span class="p">(</span><span class="n">jj</span><span class="o">-</span><span class="n">top</span><span class="p">,</span><span class="n">B</span><span class="p">(</span><span class="n">top</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jj</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">B</span><span class="p">(</span><span class="n">top</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jj</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">s</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="n">A</span><span class="p">(</span><span class="n">jj</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">CMPLX</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="n">B</span><span class="p">(</span><span class="n">jj</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="nb">CONJG</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">ENDIF</span>
<span class="k">               ENDDO</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Update A by transformations from right.</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">jj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MOD</span><span class="p">(</span><span class="n">Ihi</span><span class="o">-</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ihi</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">jj</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span><span class="w"></span>
<span class="w">                  </span><span class="n">ctemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">B</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">c1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">s1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">B</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">c2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">3</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">s2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">B</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">3</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="w">                  </span><span class="k">DO </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">top</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Ihi</span><span class="w"></span>
<span class="w">                     </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="n">temp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="n">temp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="n">temp3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="n">A</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c2</span><span class="o">*</span><span class="n">temp3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">CONJG</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span><span class="o">*</span><span class="n">temp2</span><span class="w"></span>
<span class="w">                     </span><span class="n">temp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">s2</span><span class="o">*</span><span class="n">temp3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c2</span><span class="o">*</span><span class="n">temp2</span><span class="w"></span>
<span class="w">                     </span><span class="n">A</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c1</span><span class="o">*</span><span class="n">temp2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">CONJG</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span><span class="o">*</span><span class="n">temp1</span><span class="w"></span>
<span class="w">                     </span><span class="n">temp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">s1</span><span class="o">*</span><span class="n">temp2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c1</span><span class="o">*</span><span class="n">temp1</span><span class="w"></span>
<span class="w">                     </span><span class="n">A</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctemp</span><span class="o">*</span><span class="n">temp1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">CONJG</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">*</span><span class="n">temp</span><span class="w"></span>
<span class="w">                     </span><span class="n">A</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="o">*</span><span class="n">temp1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ctemp</span><span class="o">*</span><span class="n">temp</span><span class="w"></span>
<span class="w">                  </span><span class="k">ENDDO</span>
<span class="k">               ENDDO</span><span class="w"></span>
<span class="c">!</span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">jj</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                  DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jj</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="w">                     </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">DBLE</span><span class="p">(</span><span class="n">A</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">))</span><span class="w"></span>
<span class="w">                     </span><span class="k">CALL </span><span class="n">CROT</span><span class="p">(</span><span class="n">Ihi</span><span class="o">-</span><span class="n">top</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="n">top</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="n">top</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="n">i</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                         </span><span class="n">c</span><span class="p">,</span><span class="o">-</span><span class="nb">CONJG</span><span class="p">(</span><span class="n">B</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)))</span><span class="w"></span>
<span class="w">                  </span><span class="k">ENDDO</span>
<span class="k">               ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Update (J+1)th column of A by transformations from left.</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">&lt;</span><span class="n">jcol</span><span class="o">+</span><span class="n">nnb</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                  </span><span class="nb">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">jcol</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Multiply with the trailing accumulated unitary</span>
<span class="c">!                 matrix, which takes the form</span>
<span class="c">!</span>
<span class="c">!                        [  U11  U12  ]</span>
<span class="c">!                    U = [            ],</span>
<span class="c">!                        [  U21  U22  ]</span>
<span class="c">!</span>
<span class="c">!                 where U21 is a LEN-by-LEN matrix and U12 is lower</span>
<span class="c">!                 triangular.</span>
<span class="c">!</span>
<span class="w">                  </span><span class="n">jrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ihi</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">nblst</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                  </span><span class="k">CALL </span><span class="n">CGEMV</span><span class="p">(</span><span class="s1">&#39;Conjugate&#39;</span><span class="p">,</span><span class="n">nblst</span><span class="p">,</span><span class="nb">len</span><span class="p">,</span><span class="n">CONE</span><span class="p">,</span><span class="n">Work</span><span class="p">,</span><span class="n">nblst</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                       </span><span class="n">A</span><span class="p">(</span><span class="n">jrow</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">pw</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">ppw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pw</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">len</span>
<span class="nb">                  </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jrow</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">jrow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nblst</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                     </span><span class="n">Work</span><span class="p">(</span><span class="n">ppw</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="n">ppw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ppw</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                  </span><span class="k">ENDDO</span>
<span class="k">                  CALL </span><span class="n">CTRMV</span><span class="p">(</span><span class="s1">&#39;Lower&#39;</span><span class="p">,</span><span class="s1">&#39;Conjugate&#39;</span><span class="p">,</span><span class="s1">&#39;Non-unit&#39;</span><span class="p">,</span><span class="n">nblst</span><span class="o">-</span><span class="nb">len</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                       </span><span class="n">Work</span><span class="p">(</span><span class="nb">len</span><span class="o">*</span><span class="n">nblst</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">nblst</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">pw</span><span class="o">+</span><span class="nb">len</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">CALL </span><span class="n">CGEMV</span><span class="p">(</span><span class="s1">&#39;Conjugate&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">,</span><span class="n">nblst</span><span class="o">-</span><span class="nb">len</span><span class="p">,</span><span class="n">CONE</span><span class="p">,</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                       </span><span class="n">Work</span><span class="p">((</span><span class="nb">len</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nblst</span><span class="o">-</span><span class="nb">len</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">nblst</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                       </span><span class="n">A</span><span class="p">(</span><span class="n">jrow</span><span class="o">+</span><span class="n">nblst</span><span class="o">-</span><span class="nb">len</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">CONE</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">pw</span><span class="o">+</span><span class="nb">len</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                       </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">ppw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pw</span><span class="w"></span>
<span class="w">                  </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jrow</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">jrow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nblst</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                     </span><span class="n">A</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">ppw</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="n">ppw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ppw</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                  </span><span class="k">ENDDO</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Multiply with the other accumulated unitary</span>
<span class="c">!                 matrices, which take the form</span>
<span class="c">!</span>
<span class="c">!                        [  U11  U12   0  ]</span>
<span class="c">!                        [                ]</span>
<span class="c">!                    U = [  U21  U22   0  ],</span>
<span class="c">!                        [                ]</span>
<span class="c">!                        [   0    0    I  ]</span>
<span class="c">!</span>
<span class="c">!                 where I denotes the (NNB-LEN)-by-(NNB-LEN) identity</span>
<span class="c">!                 matrix, U21 is a LEN-by-LEN upper triangular matrix</span>
<span class="c">!                 and U12 is an NNB-by-NNB lower triangular matrix.</span>
<span class="c">!</span>
<span class="w">                  </span><span class="n">ppwo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nblst</span><span class="o">*</span><span class="n">nblst</span><span class="w"></span>
<span class="w">                  </span><span class="n">j0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jrow</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">nnb</span><span class="w"></span>
<span class="w">                  </span><span class="k">DO </span><span class="n">jrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j0</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">jcol</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">nnb</span><span class="w"></span>
<span class="w">                     </span><span class="n">ppw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pw</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">len</span>
<span class="nb">                     </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jrow</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">jrow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nnb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                        </span><span class="n">Work</span><span class="p">(</span><span class="n">ppw</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="n">ppw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ppw</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                     </span><span class="k">ENDDO</span>
<span class="k">                     </span><span class="n">ppw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pw</span><span class="w"></span>
<span class="w">                     </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jrow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nnb</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">jrow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nnb</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                        </span><span class="n">Work</span><span class="p">(</span><span class="n">ppw</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="n">ppw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ppw</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                     </span><span class="k">ENDDO</span>
<span class="k">                     CALL </span><span class="n">CTRMV</span><span class="p">(</span><span class="s1">&#39;Upper&#39;</span><span class="p">,</span><span class="s1">&#39;Conjugate&#39;</span><span class="p">,</span><span class="s1">&#39;Non-unit&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                          </span><span class="n">Work</span><span class="p">(</span><span class="n">ppwo</span><span class="o">+</span><span class="n">nnb</span><span class="p">),</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">pw</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="k">CALL </span><span class="n">CTRMV</span><span class="p">(</span><span class="s1">&#39;Lower&#39;</span><span class="p">,</span><span class="s1">&#39;Conjugate&#39;</span><span class="p">,</span><span class="s1">&#39;Non-unit&#39;</span><span class="p">,</span><span class="n">nnb</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                          </span><span class="n">Work</span><span class="p">(</span><span class="n">ppwo</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="nb">len</span><span class="o">*</span><span class="n">nnb</span><span class="p">),</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">pw</span><span class="o">+</span><span class="nb">len</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                          </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="k">CALL </span><span class="n">CGEMV</span><span class="p">(</span><span class="s1">&#39;Conjugate&#39;</span><span class="p">,</span><span class="n">nnb</span><span class="p">,</span><span class="nb">len</span><span class="p">,</span><span class="n">CONE</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ppwo</span><span class="p">),</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                          </span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="n">jrow</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">CONE</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">pw</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="k">CALL </span><span class="n">CGEMV</span><span class="p">(</span><span class="s1">&#39;Conjugate&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">,</span><span class="n">nnb</span><span class="p">,</span><span class="n">CONE</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                          </span><span class="n">Work</span><span class="p">(</span><span class="n">ppwo</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="nb">len</span><span class="o">*</span><span class="n">nnb</span><span class="o">+</span><span class="n">nnb</span><span class="p">),</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                          </span><span class="n">A</span><span class="p">(</span><span class="n">jrow</span><span class="o">+</span><span class="n">nnb</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">CONE</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">pw</span><span class="o">+</span><span class="nb">len</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="n">ppw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pw</span><span class="w"></span>
<span class="w">                     </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jrow</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">jrow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">len</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nnb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                        </span><span class="n">A</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">ppw</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="n">ppw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ppw</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                     </span><span class="k">ENDDO</span>
<span class="k">                     </span><span class="n">ppwo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ppwo</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4</span><span class="o">*</span><span class="n">nnb</span><span class="o">*</span><span class="n">nnb</span><span class="w"></span>
<span class="w">                  </span><span class="k">ENDDO</span>
<span class="k">               ENDIF</span>
<span class="k">            ENDDO</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Apply accumulated unitary matrices to A.</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">cola</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">jcol</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">nnb</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ihi</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">nblst</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CGEMM</span><span class="p">(</span><span class="s1">&#39;Conjugate&#39;</span><span class="p">,</span><span class="s1">&#39;No Transpose&#39;</span><span class="p">,</span><span class="n">nblst</span><span class="p">,</span><span class="n">cola</span><span class="p">,</span><span class="n">nblst</span><span class="p">,</span><span class="n">CONE</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                 </span><span class="n">Work</span><span class="p">,</span><span class="n">nblst</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">jcol</span><span class="o">+</span><span class="n">nnb</span><span class="p">),</span><span class="n">Lda</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">pw</span><span class="p">),</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                 </span><span class="n">nblst</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;All&#39;</span><span class="p">,</span><span class="n">nblst</span><span class="p">,</span><span class="n">cola</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">pw</span><span class="p">),</span><span class="n">nblst</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">jcol</span><span class="o">+</span><span class="n">nnb</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Lda</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">ppwo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nblst</span><span class="o">*</span><span class="n">nblst</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">j0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">nnb</span><span class="w"></span>
<span class="w">            </span><span class="k">DO </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j0</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">jcol</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">nnb</span><span class="w"></span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">blk22</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Exploit the structure of</span>
<span class="c">!</span>
<span class="c">!                        [  U11  U12  ]</span>
<span class="c">!                    U = [            ]</span>
<span class="c">!                        [  U21  U22  ],</span>
<span class="c">!</span>
<span class="c">!                 where all blocks are NNB-by-NNB, U21 is upper</span>
<span class="c">!                 triangular and U12 is lower triangular.</span>
<span class="c">!</span>
<span class="w">                  </span><span class="k">CALL </span><span class="n">CUNM22</span><span class="p">(</span><span class="s1">&#39;Left&#39;</span><span class="p">,</span><span class="s1">&#39;Conjugate&#39;</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="n">cola</span><span class="p">,</span><span class="n">nnb</span><span class="p">,</span><span class="n">nnb</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                        </span><span class="n">Work</span><span class="p">(</span><span class="n">ppwo</span><span class="p">),</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">jcol</span><span class="o">+</span><span class="n">nnb</span><span class="p">),</span><span class="n">Lda</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                        </span><span class="n">Work</span><span class="p">(</span><span class="n">pw</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">pw</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">ELSE</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Ignore the structure of U.</span>
<span class="c">!</span>
<span class="w">                  </span><span class="k">CALL </span><span class="n">CGEMM</span><span class="p">(</span><span class="s1">&#39;Conjugate&#39;</span><span class="p">,</span><span class="s1">&#39;No Transpose&#39;</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="n">cola</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                       </span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="n">CONE</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ppwo</span><span class="p">),</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">jcol</span><span class="o">+</span><span class="n">nnb</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                       </span><span class="n">Lda</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">pw</span><span class="p">),</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;All&#39;</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="n">cola</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">pw</span><span class="p">),</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                        </span><span class="n">A</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">jcol</span><span class="o">+</span><span class="n">nnb</span><span class="p">),</span><span class="n">Lda</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span>
<span class="k">               </span><span class="n">ppwo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ppwo</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4</span><span class="o">*</span><span class="n">nnb</span><span class="o">*</span><span class="n">nnb</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDDO</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Apply accumulated unitary matrices to Q.</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wantq</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ihi</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">nblst</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">initq</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                  </span><span class="n">topq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">nh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ihi</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">topq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="k">ELSE</span>
<span class="k">                  </span><span class="n">topq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                  </span><span class="n">nh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span>
<span class="k">               CALL </span><span class="n">CGEMM</span><span class="p">(</span><span class="s1">&#39;No Transpose&#39;</span><span class="p">,</span><span class="s1">&#39;No Transpose&#39;</span><span class="p">,</span><span class="n">nh</span><span class="p">,</span><span class="n">nblst</span><span class="p">,</span><span class="n">nblst</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                    </span><span class="n">CONE</span><span class="p">,</span><span class="n">Q</span><span class="p">(</span><span class="n">topq</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="n">Ldq</span><span class="p">,</span><span class="n">Work</span><span class="p">,</span><span class="n">nblst</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">pw</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                    </span><span class="n">nh</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;All&#39;</span><span class="p">,</span><span class="n">nh</span><span class="p">,</span><span class="n">nblst</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">pw</span><span class="p">),</span><span class="n">nh</span><span class="p">,</span><span class="n">Q</span><span class="p">(</span><span class="n">topq</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="n">Ldq</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">ppwo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nblst</span><span class="o">*</span><span class="n">nblst</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="n">j0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">nnb</span><span class="w"></span>
<span class="w">               </span><span class="k">DO </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j0</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">jcol</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">nnb</span><span class="w"></span>
<span class="w">                  </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">initq</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                     </span><span class="n">topq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="n">nh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ihi</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">topq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                  </span><span class="k">ENDIF</span>
<span class="k">                  IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">blk22</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                    Exploit the structure of U.</span>
<span class="c">!</span>
<span class="w">                     </span><span class="k">CALL </span><span class="n">CUNM22</span><span class="p">(</span><span class="s1">&#39;Right&#39;</span><span class="p">,</span><span class="s1">&#39;No Transpose&#39;</span><span class="p">,</span><span class="n">nh</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="n">nnb</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                           </span><span class="n">nnb</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ppwo</span><span class="p">),</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="n">Q</span><span class="p">(</span><span class="n">topq</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="n">Ldq</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                           </span><span class="n">Work</span><span class="p">(</span><span class="n">pw</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">pw</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">ELSE</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                    Ignore the structure of U.</span>
<span class="c">!</span>
<span class="w">                     </span><span class="k">CALL </span><span class="n">CGEMM</span><span class="p">(</span><span class="s1">&#39;No Transpose&#39;</span><span class="p">,</span><span class="s1">&#39;No Transpose&#39;</span><span class="p">,</span><span class="n">nh</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                          </span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="n">CONE</span><span class="p">,</span><span class="n">Q</span><span class="p">(</span><span class="n">topq</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="n">Ldq</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ppwo</span><span class="p">),</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                          </span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">pw</span><span class="p">),</span><span class="n">nh</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;All&#39;</span><span class="p">,</span><span class="n">nh</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">pw</span><span class="p">),</span><span class="n">nh</span><span class="p">,</span><span class="n">Q</span><span class="p">(</span><span class="n">topq</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                           </span><span class="n">Ldq</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">ENDIF</span>
<span class="k">                  </span><span class="n">ppwo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ppwo</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4</span><span class="o">*</span><span class="n">nnb</span><span class="o">*</span><span class="n">nnb</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDDO</span>
<span class="k">            ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Accumulate right Givens rotations if required.</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wantz</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">top</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Initialize small unitary factors that will hold the</span>
<span class="c">!              accumulated Givens rotations in workspace.</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLASET</span><span class="p">(</span><span class="s1">&#39;All&#39;</span><span class="p">,</span><span class="n">nblst</span><span class="p">,</span><span class="n">nblst</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">CONE</span><span class="p">,</span><span class="n">Work</span><span class="p">,</span><span class="n">nblst</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">pw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nblst</span><span class="o">*</span><span class="n">nblst</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">n2nb</span><span class="w"></span>
<span class="w">                  </span><span class="k">CALL </span><span class="n">CLASET</span><span class="p">(</span><span class="s1">&#39;All&#39;</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">CONE</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">pw</span><span class="p">),</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                        </span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">pw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pw</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4</span><span class="o">*</span><span class="n">nnb</span><span class="o">*</span><span class="n">nnb</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDDO</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Accumulate Givens rotations into workspace array.</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">DO </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jcol</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">jcol</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nnb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                  </span><span class="n">ppw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">nblst</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">nblst</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">jcol</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                  </span><span class="nb">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">jcol</span><span class="w"></span>
<span class="w">                  </span><span class="n">jrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n2nb</span><span class="o">*</span><span class="n">nnb</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="w">                  </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ihi</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">jrow</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="w">                     </span><span class="n">ctemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="n">A</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CZERO</span><span class="w"></span>
<span class="w">                     </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="n">B</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CZERO</span><span class="w"></span>
<span class="w">                     </span><span class="k">DO </span><span class="n">jj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ppw</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ppw</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                        </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">jj</span><span class="o">+</span><span class="n">nblst</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="n">Work</span><span class="p">(</span><span class="n">jj</span><span class="o">+</span><span class="n">nblst</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctemp</span><span class="o">*</span><span class="n">temp</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">CONJG</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">*</span><span class="n">Work</span><span class="p">(</span><span class="n">jj</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="n">Work</span><span class="p">(</span><span class="n">jj</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">temp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ctemp</span><span class="o">*</span><span class="n">Work</span><span class="p">(</span><span class="n">jj</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="k">ENDDO</span>
<span class="k">                     </span><span class="nb">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">len</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                     </span><span class="n">ppw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ppw</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">nblst</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                  </span><span class="k">ENDDO</span><span class="w"></span>
<span class="c">!</span>
<span class="w">                  </span><span class="n">ppwo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nblst</span><span class="o">*</span><span class="n">nblst</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">nnb</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nnb</span><span class="w"></span>
<span class="w">                  </span><span class="n">j0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jrow</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">nnb</span><span class="w"></span>
<span class="w">                  </span><span class="k">DO </span><span class="n">jrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j0</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">nnb</span><span class="w"></span>
<span class="w">                     </span><span class="n">ppw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ppwo</span><span class="w"></span>
<span class="w">                     </span><span class="nb">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">jcol</span><span class="w"></span>
<span class="w">                     </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jrow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nnb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">jrow</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="w">                        </span><span class="n">ctemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="n">A</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CZERO</span><span class="w"></span>
<span class="w">                        </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="n">B</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CZERO</span><span class="w"></span>
<span class="w">                        </span><span class="k">DO </span><span class="n">jj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ppw</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ppw</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                           </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">jj</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">)</span><span class="w"></span>
<span class="w">                           </span><span class="n">Work</span><span class="p">(</span><span class="n">jj</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctemp</span><span class="o">*</span><span class="n">temp</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">CONJG</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                        </span><span class="o">*</span><span class="n">Work</span><span class="p">(</span><span class="n">jj</span><span class="p">)</span><span class="w"></span>
<span class="w">                           </span><span class="n">Work</span><span class="p">(</span><span class="n">jj</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">temp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ctemp</span><span class="o">*</span><span class="n">Work</span><span class="p">(</span><span class="n">jj</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="k">ENDDO</span>
<span class="k">                        </span><span class="nb">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">len</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                        </span><span class="n">ppw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ppw</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                     </span><span class="k">ENDDO</span>
<span class="k">                     </span><span class="n">ppwo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ppwo</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4</span><span class="o">*</span><span class="n">nnb</span><span class="o">*</span><span class="n">nnb</span><span class="w"></span>
<span class="w">                  </span><span class="k">ENDDO</span>
<span class="k">               ENDDO</span>
<span class="k">            ELSE</span><span class="w"></span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLASET</span><span class="p">(</span><span class="s1">&#39;Lower&#39;</span><span class="p">,</span><span class="n">Ihi</span><span class="o">-</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">nnb</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">A</span><span class="p">(</span><span class="n">jcol</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">jcol</span><span class="p">),</span><span class="n">Lda</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLASET</span><span class="p">(</span><span class="s1">&#39;Lower&#39;</span><span class="p">,</span><span class="n">Ihi</span><span class="o">-</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">nnb</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">B</span><span class="p">(</span><span class="n">jcol</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">jcol</span><span class="p">),</span><span class="n">Ldb</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Apply accumulated unitary matrices to A and B.</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">top</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ihi</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">nblst</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CGEMM</span><span class="p">(</span><span class="s1">&#39;No Transpose&#39;</span><span class="p">,</span><span class="s1">&#39;No Transpose&#39;</span><span class="p">,</span><span class="n">top</span><span class="p">,</span><span class="n">nblst</span><span class="p">,</span><span class="n">nblst</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                    </span><span class="n">CONE</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">,</span><span class="n">nblst</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">pw</span><span class="p">),</span><span class="n">top</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;All&#39;</span><span class="p">,</span><span class="n">top</span><span class="p">,</span><span class="n">nblst</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">pw</span><span class="p">),</span><span class="n">top</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="n">Lda</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">ppwo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nblst</span><span class="o">*</span><span class="n">nblst</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="n">j0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">nnb</span><span class="w"></span>
<span class="w">               </span><span class="k">DO </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j0</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">jcol</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">nnb</span><span class="w"></span>
<span class="w">                  </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">blk22</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                    Exploit the structure of U.</span>
<span class="c">!</span>
<span class="w">                     </span><span class="k">CALL </span><span class="n">CUNM22</span><span class="p">(</span><span class="s1">&#39;Right&#39;</span><span class="p">,</span><span class="s1">&#39;No Transpose&#39;</span><span class="p">,</span><span class="n">top</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="n">nnb</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                           </span><span class="n">nnb</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ppwo</span><span class="p">),</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="n">Lda</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                           </span><span class="n">Work</span><span class="p">(</span><span class="n">pw</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">pw</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">ELSE</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                    Ignore the structure of U.</span>
<span class="c">!</span>
<span class="w">                     </span><span class="k">CALL </span><span class="n">CGEMM</span><span class="p">(</span><span class="s1">&#39;No Transpose&#39;</span><span class="p">,</span><span class="s1">&#39;No Transpose&#39;</span><span class="p">,</span><span class="n">top</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                          </span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="n">CONE</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ppwo</span><span class="p">),</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                          </span><span class="n">CZERO</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">pw</span><span class="p">),</span><span class="n">top</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;All&#39;</span><span class="p">,</span><span class="n">top</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">pw</span><span class="p">),</span><span class="n">top</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                           </span><span class="n">Lda</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">ENDIF</span>
<span class="k">                  </span><span class="n">ppwo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ppwo</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4</span><span class="o">*</span><span class="n">nnb</span><span class="o">*</span><span class="n">nnb</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDDO</span><span class="w"></span>
<span class="c">!</span>
<span class="w">               </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ihi</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">nblst</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CGEMM</span><span class="p">(</span><span class="s1">&#39;No Transpose&#39;</span><span class="p">,</span><span class="s1">&#39;No Transpose&#39;</span><span class="p">,</span><span class="n">top</span><span class="p">,</span><span class="n">nblst</span><span class="p">,</span><span class="n">nblst</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                    </span><span class="n">CONE</span><span class="p">,</span><span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="n">Ldb</span><span class="p">,</span><span class="n">Work</span><span class="p">,</span><span class="n">nblst</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">pw</span><span class="p">),</span><span class="n">top</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;All&#39;</span><span class="p">,</span><span class="n">top</span><span class="p">,</span><span class="n">nblst</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">pw</span><span class="p">),</span><span class="n">top</span><span class="p">,</span><span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="n">Ldb</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">ppwo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nblst</span><span class="o">*</span><span class="n">nblst</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="n">j0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">nnb</span><span class="w"></span>
<span class="w">               </span><span class="k">DO </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j0</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">jcol</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">nnb</span><span class="w"></span>
<span class="w">                  </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">blk22</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                    Exploit the structure of U.</span>
<span class="c">!</span>
<span class="w">                     </span><span class="k">CALL </span><span class="n">CUNM22</span><span class="p">(</span><span class="s1">&#39;Right&#39;</span><span class="p">,</span><span class="s1">&#39;No Transpose&#39;</span><span class="p">,</span><span class="n">top</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="n">nnb</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                           </span><span class="n">nnb</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ppwo</span><span class="p">),</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="n">Ldb</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                           </span><span class="n">Work</span><span class="p">(</span><span class="n">pw</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">pw</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">ELSE</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                    Ignore the structure of U.</span>
<span class="c">!</span>
<span class="w">                     </span><span class="k">CALL </span><span class="n">CGEMM</span><span class="p">(</span><span class="s1">&#39;No Transpose&#39;</span><span class="p">,</span><span class="s1">&#39;No Transpose&#39;</span><span class="p">,</span><span class="n">top</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                          </span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="n">CONE</span><span class="p">,</span><span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="n">Ldb</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ppwo</span><span class="p">),</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                          </span><span class="n">CZERO</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">pw</span><span class="p">),</span><span class="n">top</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;All&#39;</span><span class="p">,</span><span class="n">top</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">pw</span><span class="p">),</span><span class="n">top</span><span class="p">,</span><span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                           </span><span class="n">Ldb</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">ENDIF</span>
<span class="k">                  </span><span class="n">ppwo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ppwo</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4</span><span class="o">*</span><span class="n">nnb</span><span class="o">*</span><span class="n">nnb</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDDO</span>
<span class="k">            ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Apply accumulated unitary matrices to Z.</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wantz</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ihi</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">nblst</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">initq</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                  </span><span class="n">topq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">nh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ihi</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">topq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="k">ELSE</span>
<span class="k">                  </span><span class="n">topq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                  </span><span class="n">nh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span>
<span class="k">               CALL </span><span class="n">CGEMM</span><span class="p">(</span><span class="s1">&#39;No Transpose&#39;</span><span class="p">,</span><span class="s1">&#39;No Transpose&#39;</span><span class="p">,</span><span class="n">nh</span><span class="p">,</span><span class="n">nblst</span><span class="p">,</span><span class="n">nblst</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                    </span><span class="n">CONE</span><span class="p">,</span><span class="n">Z</span><span class="p">(</span><span class="n">topq</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="n">Ldz</span><span class="p">,</span><span class="n">Work</span><span class="p">,</span><span class="n">nblst</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">pw</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                    </span><span class="n">nh</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;All&#39;</span><span class="p">,</span><span class="n">nh</span><span class="p">,</span><span class="n">nblst</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">pw</span><span class="p">),</span><span class="n">nh</span><span class="p">,</span><span class="n">Z</span><span class="p">(</span><span class="n">topq</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="n">Ldz</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">ppwo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nblst</span><span class="o">*</span><span class="n">nblst</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="n">j0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">nnb</span><span class="w"></span>
<span class="w">               </span><span class="k">DO </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j0</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">jcol</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">nnb</span><span class="w"></span>
<span class="w">                  </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">initq</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                     </span><span class="n">topq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="n">nh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ihi</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">topq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                  </span><span class="k">ENDIF</span>
<span class="k">                  IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">blk22</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                    Exploit the structure of U.</span>
<span class="c">!</span>
<span class="w">                     </span><span class="k">CALL </span><span class="n">CUNM22</span><span class="p">(</span><span class="s1">&#39;Right&#39;</span><span class="p">,</span><span class="s1">&#39;No Transpose&#39;</span><span class="p">,</span><span class="n">nh</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="n">nnb</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                           </span><span class="n">nnb</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ppwo</span><span class="p">),</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="n">Z</span><span class="p">(</span><span class="n">topq</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="n">Ldz</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                           </span><span class="n">Work</span><span class="p">(</span><span class="n">pw</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">pw</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">ELSE</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                    Ignore the structure of U.</span>
<span class="c">!</span>
<span class="w">                     </span><span class="k">CALL </span><span class="n">CGEMM</span><span class="p">(</span><span class="s1">&#39;No Transpose&#39;</span><span class="p">,</span><span class="s1">&#39;No Transpose&#39;</span><span class="p">,</span><span class="n">nh</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                          </span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="n">CONE</span><span class="p">,</span><span class="n">Z</span><span class="p">(</span><span class="n">topq</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="n">Ldz</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ppwo</span><span class="p">),</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                          </span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">pw</span><span class="p">),</span><span class="n">nh</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;All&#39;</span><span class="p">,</span><span class="n">nh</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">nnb</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">pw</span><span class="p">),</span><span class="n">nh</span><span class="p">,</span><span class="n">Z</span><span class="p">(</span><span class="n">topq</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                           </span><span class="n">Ldz</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">ENDIF</span>
<span class="k">                  </span><span class="n">ppwo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ppwo</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4</span><span class="o">*</span><span class="n">nnb</span><span class="o">*</span><span class="n">nnb</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDDO</span>
<span class="k">            ENDIF</span>
<span class="k">         ENDDO</span>
<span class="k">      ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Use unblocked code to reduce the rest of the matrix</span>
<span class="c">!     Avoid re-initialization of modified Q and Z.</span>
<span class="c">!</span>
<span class="w">      </span><span class="n">compq2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Compq</span><span class="w"></span>
<span class="w">      </span><span class="n">compz2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Compz</span><span class="w"></span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">jcol</span><span class="o">/=</span><span class="n">Ilo</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wantq</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">compq2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;V&#39;</span><span class="w"></span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wantz</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">compz2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;V&#39;</span><span class="w"></span>
<span class="w">      </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">jcol</span><span class="o">&lt;</span><span class="n">Ihi</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">CALL </span><span class="n">CGGHRD</span><span class="p">(</span><span class="n">compq2</span><span class="p">,</span><span class="n">compz2</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">jcol</span><span class="p">,</span><span class="n">Ihi</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">Ldb</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                            </span><span class="n">Q</span><span class="p">,</span><span class="n">Ldq</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">Ldz</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">Work</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">CMPLX</span><span class="p">(</span><span class="n">lwkopt</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!</span>
<span class="c">!     End of CGGHD3</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">END SUBROUTINE </span><span class="n">CGGHD3</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              spag_lapack
 was developed by John S. Urban<br>              &copy; 2025 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2025-07-11 01:31 +0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>