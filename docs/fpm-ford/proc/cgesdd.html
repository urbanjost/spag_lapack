<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="spag_lapack module">
    <meta name="author" content="John S. Urban" >
    <link rel="icon" href="../favicon.png">

    <title>CGESDD &ndash; spag_lapack</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">spag_lapack </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>CGESDD
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 0.3% of total for procedures.">698 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/cgesdd.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/cgesdd.f90.html'>cgesdd.f90</a></li>
            <li class="breadcrumb-item active" aria-current="page">CGESDD</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#vars-0"
         aria-expanded="false" aria-controls="vars-0">
         <h4 class="card-header bg-primary text-white">Variables</h4>
      </a>
      <div id="vars-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../proc/cgesdd.html#variable-cone~173">CONE</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-czero~128">CZERO</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-one~1263">ONE</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-zero~1198">ZERO</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-anrm~146">anrm</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-bignum~265">bignum</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-blk~8">blk</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-cdum~35">cdum</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-chunk~12">chunk</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-dum~40">dum</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-eps~307">eps</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-i~1372">i</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-idum~15">idum</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-ie~30">ie</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-ierr~108">ierr</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-il~18">il</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-ir~13">ir</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-iru~2">iru</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-irvt~2">irvt</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-iscl~12">iscl</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-itau~66">itau</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-itaup~20">itaup</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-itauq~20">itauq</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-iu~10">iu</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-ivt~6">ivt</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-ldwkvt~4">ldwkvt</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-ldwrkl~4">ldwrkl</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-ldwrkr~8">ldwrkr</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-ldwrku~8">ldwrku</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-lquery~478">lquery</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-lwork_cgebrd_mm">lwork_cgebrd_mm</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-lwork_cgebrd_mn">lwork_cgebrd_mn</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-lwork_cgebrd_nn">lwork_cgebrd_nn</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-lwork_cgelqf_mn">lwork_cgelqf_mn</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-lwork_cgeqrf_mn">lwork_cgeqrf_mn</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-lwork_cungbr_p_mn">lwork_cungbr_p_mn</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-lwork_cungbr_p_nn">lwork_cungbr_p_nn</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-lwork_cungbr_q_mm">lwork_cungbr_q_mm</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-lwork_cungbr_q_mn">lwork_cungbr_q_mn</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-lwork_cunglq_mn">lwork_cunglq_mn</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-lwork_cunglq_nn">lwork_cunglq_nn</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-lwork_cungqr_mm">lwork_cungqr_mm</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-lwork_cungqr_mn">lwork_cungqr_mn</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-lwork_cunmbr_prc_mm">lwork_cunmbr_prc_mm</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-lwork_cunmbr_prc_mn">lwork_cunmbr_prc_mn</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-lwork_cunmbr_prc_nn">lwork_cunmbr_prc_nn</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-lwork_cunmbr_qln_mm">lwork_cunmbr_qln_mm</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-lwork_cunmbr_qln_mn">lwork_cunmbr_qln_mn</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-lwork_cunmbr_qln_nn">lwork_cunmbr_qln_nn</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-maxwrk~51">maxwrk</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-minmn~33">minmn</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-minwrk~53">minwrk</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-mnthr1~2">mnthr1</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-mnthr2~2">mnthr2</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-nrwork~6">nrwork</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-nwork~9">nwork</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-smlnum~315">smlnum</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-wntqa~4">wntqa</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-wntqas~4">wntqas</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-wntqn~4">wntqn</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-wntqo~4">wntqo</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-wntqs~4">wntqs</a>
            <a class="list-group-item" href="../proc/cgesdd.html#variable-wrkbl~8">wrkbl</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/cgesdd.html#src">CGESDD</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2> subroutine CGESDD(Jobz, M, N, A, Lda, S, U, Ldu, Vt, Ldvt, Work, Lwork, Rwork, Iwork, Info)  
</h2>
    

    <p>\brief \b CGESDD
 \htmlonly
 Download CGESDD + dependencies
 <a href="http://www.netlib.org/cgi-bin/netlibfiles.tgz?format=tgz&filename=/lapack/lapack_routine/cgesdd.f">
 [TGZ]</a>
 <a href="http://www.netlib.org/cgi-bin/netlibfiles.zip?format=zip&filename=/lapack/lapack_routine/cgesdd.f">
 [ZIP]</a>
 <a href="http://www.netlib.org/cgi-bin/netlibfiles.txt?format=txt&filename=/lapack/lapack_routine/cgesdd.f">
 [TXT]</a>
 \endhtmlonly
 \par Purpose:</p>
<p>\verbatim</p>
<p>CGESDD computes the singular value decomposition (SVD) of a complex
 M-by-N matrix A, optionally computing the left and/or right singular
 vectors, by using divide-and-conquer method. The SVD is written</p>
<div class="codehilite"><pre><span></span><code>  A = U * SIGMA * conjugate-transpose(V)
</code></pre></div>

<p>where SIGMA is an M-by-N matrix which is zero except for its
 min(m,n) diagonal elements, U is an M-by-M unitary matrix, and
 V is an N-by-N unitary matrix.  The diagonal elements of SIGMA
 are the singular values of A; they are real and non-negative, and
 are returned in descending order.  The first min(m,n) columns of
 U and V are the left and right singular vectors of A.</p>
<p>Note that the routine returns VT = V**H, not V.</p>
<p>The divide and conquer algorithm makes very mild assumptions about
 floating point arithmetic. It will work on machines with a guard
 digit in add/subtract, or on those binary machines without guard
 digits which subtract like the Cray X-MP, Cray Y-MP, Cray C-90, or
 Cray-2. It could conceivably fail on hexadecimal or decimal machines
 without guard digits, but we know of none.
 \endverbatim
 \param[in] JOBZ
 \verbatim
          JOBZ is CHARACTER<em>1
          Specifies options for computing all or part of the matrix U:
          = &lsquo;A&rsquo;:  all M columns of U and all N rows of V</em><em>H are
                  returned in the arrays U and VT;
          = &lsquo;S&rsquo;:  the first min(M,N) columns of U and the first
                  min(M,N) rows of V</em><em>H are returned in the arrays U
                  and VT;
          = &lsquo;O&rsquo;:  If M &gt;= N, the first N columns of U are overwritten
                  in the array A and all rows of V</em><em>H are returned in
                  the array VT;
                  otherwise, all columns of U are returned in the
                  array U and the first M rows of V</em><em>H are overwritten
                  in the array A;
          = &lsquo;N&rsquo;:  no columns of U or rows of V</em>*H are computed.
 \endverbatim</p>
<p>\param[in] M
 \verbatim
          M is INTEGER
          The number of rows of the input matrix A.  M &gt;= 0.
 \endverbatim</p>
<p>\param[in] N
 \verbatim
          N is INTEGER
          The number of columns of the input matrix A.  N &gt;= 0.
 \endverbatim</p>
<p>\param[in,out] A
 \verbatim
          A is COMPLEX array, dimension (LDA,N)
          On entry, the M-by-N matrix A.
          On exit,
          if JOBZ = &lsquo;O&rsquo;,  A is overwritten with the first N columns
                          of U (the left singular vectors, stored
                          columnwise) if M &gt;= N;
                          A is overwritten with the first M rows
                          of V**H (the right singular vectors, stored
                          rowwise) otherwise.
          if JOBZ .ne. &lsquo;O&rsquo;, the contents of A are destroyed.
 \endverbatim</p>
<p>\param[in] LDA
 \verbatim
          LDA is INTEGER
          The leading dimension of the array A.  LDA &gt;= max(1,M).
 \endverbatim</p>
<p>\param[out] S
 \verbatim
          S is REAL array, dimension (min(M,N))
          The singular values of A, sorted so that S(i) &gt;= S(i+1).
 \endverbatim</p>
<p>\param[out] U
 \verbatim
          U is COMPLEX array, dimension (LDU,UCOL)
          UCOL = M if JOBZ = &lsquo;A&rsquo; or JOBZ = &lsquo;O&rsquo; and M &lt; N;
          UCOL = min(M,N) if JOBZ = &lsquo;S&rsquo;.
          If JOBZ = &lsquo;A&rsquo; or JOBZ = &lsquo;O&rsquo; and M &lt; N, U contains the M-by-M
          unitary matrix U;
          if JOBZ = &lsquo;S&rsquo;, U contains the first min(M,N) columns of U
          (the left singular vectors, stored columnwise);
          if JOBZ = &lsquo;O&rsquo; and M &gt;= N, or JOBZ = &lsquo;N&rsquo;, U is not referenced.
 \endverbatim</p>
<p>\param[in] LDU
 \verbatim
          LDU is INTEGER
          The leading dimension of the array U.  LDU &gt;= 1;
          if JOBZ = &lsquo;S&rsquo; or &lsquo;A&rsquo; or JOBZ = &lsquo;O&rsquo; and M &lt; N, LDU &gt;= M.
 \endverbatim</p>
<p>\param[out] VT
 \verbatim
          VT is COMPLEX array, dimension (LDVT,N)
          If JOBZ = &lsquo;A&rsquo; or JOBZ = &lsquo;O&rsquo; and M &gt;= N, VT contains the
          N-by-N unitary matrix V<strong>H;
          if JOBZ = &lsquo;S&rsquo;, VT contains the first min(M,N) rows of
          V</strong>H (the right singular vectors, stored rowwise);
          if JOBZ = &lsquo;O&rsquo; and M &lt; N, or JOBZ = &lsquo;N&rsquo;, VT is not referenced.
 \endverbatim</p>
<p>\param[in] LDVT
 \verbatim
          LDVT is INTEGER
          The leading dimension of the array VT.  LDVT &gt;= 1;
          if JOBZ = &lsquo;A&rsquo; or JOBZ = &lsquo;O&rsquo; and M &gt;= N, LDVT &gt;= N;
          if JOBZ = &lsquo;S&rsquo;, LDVT &gt;= min(M,N).
 \endverbatim</p>
<p>\param[out] WORK
 \verbatim
          WORK is COMPLEX array, dimension (MAX(1,LWORK))
          On exit, if INFO = 0, WORK(1) returns the optimal LWORK.
 \endverbatim</p>
<p>\param[in] LWORK
 \verbatim
          LWORK is INTEGER
          The dimension of the array WORK. LWORK &gt;= 1.
          If LWORK = -1, a workspace query is assumed.  The optimal
          size for the WORK array is calculated and stored in WORK(1),
          and no other work except argument checking is performed.</p>
<div class="codehilite"><pre><span></span><code>      <span class="nv">Let</span> <span class="nv">mx</span> <span class="o">=</span> <span class="nv">max</span><span class="ss">(</span><span class="nv">M</span>,<span class="nv">N</span><span class="ss">)</span> <span class="nv">and</span> <span class="nv">mn</span> <span class="o">=</span> <span class="nv">min</span><span class="ss">(</span><span class="nv">M</span>,<span class="nv">N</span><span class="ss">)</span>.
      <span class="k">If</span> <span class="nv">JOBZ</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">N</span><span class="s1">&#39;</span>, <span class="nv">LWORK</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="o">*</span><span class="nv">mn</span> <span class="o">+</span> <span class="nv">mx</span>.
      <span class="k">If</span> <span class="nv">JOBZ</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">O</span><span class="s1">&#39;</span>, <span class="nv">LWORK</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="o">*</span><span class="nv">mn</span><span class="o">*</span><span class="nv">mn</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="nv">mn</span> <span class="o">+</span> <span class="nv">mx</span>.
      <span class="k">If</span> <span class="nv">JOBZ</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">S</span><span class="s1">&#39;</span>, <span class="nv">LWORK</span> <span class="o">&gt;=</span>   <span class="nv">mn</span><span class="o">*</span><span class="nv">mn</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="nv">mn</span>.
      <span class="k">If</span> <span class="nv">JOBZ</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">A</span><span class="s1">&#39;</span>, <span class="nv">LWORK</span> <span class="o">&gt;=</span>   <span class="nv">mn</span><span class="o">*</span><span class="nv">mn</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="nv">mn</span> <span class="o">+</span> <span class="nv">mx</span>.
      <span class="nv">These</span> <span class="nv">are</span> <span class="nv">not</span> <span class="nv">tight</span> <span class="nv">minimums</span> <span class="nv">in</span> <span class="nv">all</span> <span class="nv">cases</span><span class="c1">; see comments inside code.</span>
      <span class="k">For</span> <span class="nv">good</span> <span class="nv">performance</span>, <span class="nv">LWORK</span> <span class="nv">should</span> <span class="nv">generally</span> <span class="nv">be</span> <span class="nv">larger</span><span class="c1">;</span>
      <span class="nv">a</span> <span class="nv">query</span> <span class="nv">is</span> <span class="nv">recommended</span>.
</code></pre></div>

<p>\endverbatim</p>
<p>\param[out] RWORK
 \verbatim
          RWORK is REAL array, dimension (MAX(1,LRWORK))
          Let mx = max(M,N) and mn = min(M,N).
          If JOBZ = &lsquo;N&rsquo;,    LRWORK &gt;= 5<em>mn (LAPACK &lt;= 3.6 needs 7</em>mn);
          else if mx &gt;&gt; mn, LRWORK &gt;= 5<em>mn</em>mn + 5<em>mn;
          else              LRWORK &gt;= max( 5</em>mn<em>mn + 5</em>mn,
                                           2<em>mx</em>mn + 2<em>mn</em>mn + mn ).
 \endverbatim</p>
<p>\param[out] IWORK
 \verbatim
          IWORK is INTEGER array, dimension (8*min(M,N))
 \endverbatim</p>
<p>\param[out] INFO
 \verbatim
          INFO is INTEGER
          = 0:  successful exit.
          &lt; 0:  if INFO = -i, the i-th argument had an illegal value.
          &gt; 0:  The updating process of SBDSDC did not converge.
 \endverbatim
 \author Univ. of Tennessee
 \author Univ. of California Berkeley
 \author Univ. of Colorado Denver
 \author NAG Ltd.
 \date June 2016
 \ingroup complexGEsing
 \par Contributors:</p>
<div class="codehilite"><pre><span></span><code> Ming Gu and Huan Ren, Computer Science Division, University of
 California at Berkeley, USA
</code></pre></div>

<p>&ndash;CGESDD230</p>
<p>&ndash; LAPACK driver routine (version 3.7.0) &ndash;
  &ndash; LAPACK is a software package provided by Univ. of Tennessee,    &ndash;
  &ndash; Univ. of California Berkeley, Univ. of Colorado Denver and NAG Ltd..&ndash;
     June 2016</p>
<div class="codehilite"><pre><span></span><code> .. Scalar Arguments ..
</code></pre></div>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-jobz~122"></span>
              character(len=1)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Jobz</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-m~697"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>M</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-n~1866"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>N</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-a~1160"></span>
              complex
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>A</strong>(Lda,*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lda~1113"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Lda</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s~143"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>S</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-u~56"></span>
              complex
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>U</strong>(Ldu,*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldu~56"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ldu</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-vt~25"></span>
              complex
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Vt</strong>(Ldvt,*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldvt~27"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ldvt</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-work~1116"></span>
              complex
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Work</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork~527"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Lwork</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rwork~249"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Rwork</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iwork~279"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Iwork</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-info~1453"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Info</strong></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    <br>


    <section>    
      <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-cone~173"></span>
              complex,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>CONE</strong></td>
<td> =</td>
                <td>(1.0E+0,0.0E+0)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-czero~128"></span>
              complex,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>CZERO</strong></td>
<td> =</td>
                <td>(0.0E+0,0.0E+0)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-one~1263"></span>
              real,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>ONE</strong></td>
<td> =</td>
                <td>1.0E+0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-zero~1198"></span>
              real,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>ZERO</strong></td>
<td> =</td>
                <td>0.0E+0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-anrm~146"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>anrm</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-bignum~265"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>bignum</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-blk~8"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>blk</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-cdum~35"></span>
              complex,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>cdum</strong>(1)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-chunk~12"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>chunk</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-dum~40"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>dum</strong>(1)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-eps~307"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>eps</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-i~1372"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>i</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-idum~15"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>idum</strong>(1)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ie~30"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ie</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ierr~108"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ierr</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-il~18"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>il</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ir~13"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ir</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iru~2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iru</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-irvt~2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>irvt</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iscl~12"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iscl</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-itau~66"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>itau</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-itaup~20"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>itaup</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-itauq~20"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>itauq</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iu~10"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iu</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ivt~6"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ivt</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldwkvt~4"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ldwkvt</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldwrkl~4"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ldwrkl</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldwrkr~8"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ldwrkr</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldwrku~8"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ldwrku</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lquery~478"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lquery</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_cgebrd_mm"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_cgebrd_mm</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_cgebrd_mn"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_cgebrd_mn</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_cgebrd_nn"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_cgebrd_nn</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_cgelqf_mn"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_cgelqf_mn</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_cgeqrf_mn"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_cgeqrf_mn</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_cungbr_p_mn"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_cungbr_p_mn</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_cungbr_p_nn"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_cungbr_p_nn</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_cungbr_q_mm"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_cungbr_q_mm</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_cungbr_q_mn"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_cungbr_q_mn</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_cunglq_mn"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_cunglq_mn</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_cunglq_nn"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_cunglq_nn</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_cungqr_mm"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_cungqr_mm</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_cungqr_mn"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_cungqr_mn</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_cunmbr_prc_mm"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_cunmbr_prc_mm</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_cunmbr_prc_mn"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_cunmbr_prc_mn</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_cunmbr_prc_nn"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_cunmbr_prc_nn</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_cunmbr_qln_mm"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_cunmbr_qln_mm</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_cunmbr_qln_mn"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_cunmbr_qln_mn</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_cunmbr_qln_nn"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_cunmbr_qln_nn</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxwrk~51"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxwrk</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-minmn~33"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>minmn</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-minwrk~53"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>minwrk</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-mnthr1~2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>mnthr1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-mnthr2~2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>mnthr2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nrwork~6"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nrwork</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nwork~9"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nwork</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-smlnum~315"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>smlnum</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wntqa~4"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wntqa</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wntqas~4"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wntqas</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wntqn~4"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wntqn</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wntqo~4"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wntqo</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wntqs~4"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wntqs</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wrkbl~8"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wrkbl</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">      </span><span class="k">SUBROUTINE </span><span class="n">CGESDD</span><span class="p">(</span><span class="n">Jobz</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="n">Work</span><span class="p">,</span><span class="n">Lwork</span><span class="p">,</span><span class="n">Rwork</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">IMPLICIT NONE</span><span class="w"></span>
<span class="c">!*--CGESDD230</span>
<span class="c">!</span>
<span class="c">!  -- LAPACK driver routine (version 3.7.0) --</span>
<span class="c">!  -- LAPACK is a software package provided by Univ. of Tennessee,    --</span>
<span class="c">!  -- Univ. of California Berkeley, Univ. of Colorado Denver and NAG Ltd..--</span>
<span class="c">!     June 2016</span>
<span class="c">!</span>
<span class="c">!     .. Scalar Arguments ..</span>
<span class="w">      </span><span class="kt">CHARACTER </span><span class="n">Jobz</span><span class="w"></span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">Info</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Lda</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Ldu</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Ldvt</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Lwork</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Array Arguments ..</span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">Iwork</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="kt">REAL </span><span class="n">Rwork</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">S</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="kt">COMPLEX </span><span class="n">A</span><span class="p">(</span><span class="n">Lda</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">U</span><span class="p">(</span><span class="n">Ldu</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Vt</span><span class="p">(</span><span class="n">Ldvt</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!</span>
<span class="c">!  =====================================================================</span>
<span class="c">!</span>
<span class="c">!     .. Parameters ..</span>
<span class="w">      </span><span class="kt">COMPLEX </span><span class="n">CZERO</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">CONE</span><span class="w"></span>
<span class="w">      </span><span class="k">PARAMETER</span><span class="w"> </span><span class="p">(</span><span class="n">CZERO</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0E+0</span><span class="p">,</span><span class="mf">0.0E+0</span><span class="p">),</span><span class="n">CONE</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0E+0</span><span class="p">,</span><span class="mf">0.0E+0</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="kt">REAL </span><span class="n">ZERO</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ONE</span><span class="w"></span>
<span class="w">      </span><span class="k">PARAMETER</span><span class="w"> </span><span class="p">(</span><span class="n">ZERO</span><span class="o">=</span><span class="mf">0.0E+0</span><span class="p">,</span><span class="n">ONE</span><span class="o">=</span><span class="mf">1.0E+0</span><span class="p">)</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Local Scalars ..</span>
<span class="w">      </span><span class="kt">LOGICAL </span><span class="n">lquery</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">wntqa</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">wntqas</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">wntqn</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">wntqo</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">wntqs</span><span class="w"></span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">blk</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">chunk</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">il</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ir</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">iru</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">irvt</span><span class="w"> </span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">iscl</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">itau</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">itaup</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">itauq</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">iu</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ivt</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ldwkvt</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ldwrkl</span><span class="w"> </span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">ldwrkr</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ldwrku</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">maxwrk</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">minmn</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">minwrk</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">mnthr1</span><span class="w"> </span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">mnthr2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">nrwork</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">nwork</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">wrkbl</span><span class="w"></span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">lwork_cgebrd_mn</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lwork_cgebrd_mm</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lwork_cgebrd_nn</span><span class="w"> </span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">lwork_cgelqf_mn</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lwork_cgeqrf_mn</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lwork_cungbr_p_mn</span><span class="w"> </span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">lwork_cungbr_p_nn</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lwork_cungbr_q_mn</span><span class="w"> </span><span class="p">,</span><span class="w">                   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">lwork_cungbr_q_mm</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lwork_cunglq_mn</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lwork_cunglq_nn</span><span class="w"> </span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">lwork_cungqr_mm</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lwork_cungqr_mn</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lwork_cunmbr_prc_mm</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">lwork_cunmbr_qln_mm</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lwork_cunmbr_prc_mn</span><span class="w"> </span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">lwork_cunmbr_qln_mn</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lwork_cunmbr_prc_nn</span><span class="w"> </span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">lwork_cunmbr_qln_nn</span><span class="w"></span>
<span class="w">      </span><span class="kt">REAL </span><span class="n">anrm</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">bignum</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">eps</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">smlnum</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Local Arrays ..</span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">idum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="kt">REAL </span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="kt">COMPLEX </span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. External Subroutines ..</span>
<span class="w">      </span><span class="k">EXTERNAL </span><span class="n">CGEBRD</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">CGELQF</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">CGEMM</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">CGEQRF</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">CLACP2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">CLACPY</span><span class="w"> </span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">         </span><span class="n">CLACRM</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">CLARCM</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">CLASCL</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">CLASET</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">CUNGBR</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">CUNGLQ</span><span class="w"> </span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">         </span><span class="n">CUNGQR</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">CUNMBR</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">SBDSDC</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">SLASCL</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">XERBLA</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. External Functions ..</span>
<span class="w">      </span><span class="kt">LOGICAL </span><span class="n">LSAME</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">SISNAN</span><span class="w"></span>
<span class="w">      </span><span class="kt">REAL </span><span class="n">SLAMCH</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">CLANGE</span><span class="w"></span>
<span class="w">      </span><span class="k">EXTERNAL </span><span class="n">LSAME</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">SLAMCH</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">CLANGE</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">SISNAN</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Intrinsic Functions ..</span>
<span class="w">      </span><span class="k">INTRINSIC </span><span class="nb">INT</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nb">MAX</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nb">MIN</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nb">SQRT</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Executable Statements ..</span>
<span class="c">!</span>
<span class="c">!     Test the input arguments</span>
<span class="c">!</span>
<span class="w">      </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">minmn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">mnthr1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">minmn</span><span class="o">*</span><span class="mi">1</span><span class="mf">7.0E0</span><span class="o">/</span><span class="mf">9.0E0</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">mnthr2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">minmn</span><span class="o">*</span><span class="mf">5.0E0</span><span class="o">/</span><span class="mf">3.0E0</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">wntqa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LSAME</span><span class="p">(</span><span class="n">Jobz</span><span class="p">,</span><span class="s1">&#39;A&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">wntqs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LSAME</span><span class="p">(</span><span class="n">Jobz</span><span class="p">,</span><span class="s1">&#39;S&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">wntqas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wntqa</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">wntqs</span><span class="w"></span>
<span class="w">      </span><span class="n">wntqo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LSAME</span><span class="p">(</span><span class="n">Jobz</span><span class="p">,</span><span class="s1">&#39;O&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">wntqn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LSAME</span><span class="p">(</span><span class="n">Jobz</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">lquery</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Lwork</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.(</span><span class="n">wntqa</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">wntqs</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">wntqo</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">wntqn</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">M</span><span class="o">&lt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">N</span><span class="o">&lt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Lda</span><span class="o">&lt;</span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">5</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Ldu</span><span class="o">&lt;</span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">wntqas</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">Ldu</span><span class="o">&lt;</span><span class="n">M</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w">                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">         </span><span class="p">(</span><span class="n">wntqo</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">M</span><span class="o">&lt;</span><span class="n">N</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">Ldu</span><span class="o">&lt;</span><span class="n">M</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">8</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Ldvt</span><span class="o">&lt;</span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">wntqa</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">Ldvt</span><span class="o">&lt;</span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w">                    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">         </span><span class="p">(</span><span class="n">wntqs</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">Ldvt</span><span class="o">&lt;</span><span class="n">minmn</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w">                            </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">         </span><span class="p">(</span><span class="n">wntqo</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">M</span><span class="o">&gt;=</span><span class="n">N</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">Ldvt</span><span class="o">&lt;</span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">10</span><span class="w"></span>
<span class="w">      </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Compute workspace</span>
<span class="c">!       Note: Comments in the code beginning &quot;Workspace:&quot; describe the</span>
<span class="c">!       minimal amount of workspace allocated at that point in the code,</span>
<span class="c">!       as well as the preferred amount for good performance.</span>
<span class="c">!       CWorkspace refers to complex workspace, and RWorkspace to</span>
<span class="c">!       real workspace. NB refers to the optimal block size for the</span>
<span class="c">!       immediately following subroutine, as returned by ILAENV.)</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Info</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">M</span><span class="o">&gt;=</span><span class="n">N</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">minmn</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           There is no complex work space needed for bidiagonal SVD</span>
<span class="c">!           The real work space needed for bidiagonal SVD (sbdsdc) is</span>
<span class="c">!           BDSPAC = 3*N*N + 4*N for singular values and vectors;</span>
<span class="c">!           BDSPAC = 4*N         for singular values only;</span>
<span class="c">!           not including e, RU, and RVT matrices.</span>
<span class="c">!</span>
<span class="c">!           Compute space preferred for each routine</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CGEBRD</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_cgebrd_mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CGEBRD</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_cgebrd_nn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CGEQRF</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_cgeqrf_mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNGBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_cungbr_p_nn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNGBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_cungbr_q_mm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNGBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_cungbr_q_mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNGQR</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_cungqr_mm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNGQR</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_cungqr_mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNMBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_cunmbr_prc_nn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNMBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_cunmbr_qln_mm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNMBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_cunmbr_qln_mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNMBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_cunmbr_qln_nn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">M</span><span class="o">&gt;=</span><span class="n">mnthr1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqn</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Path 1 (M &gt;&gt; N, JOBZ=&#39;N&#39;)</span>
<span class="c">!</span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lwork_cgeqrf_mn</span><span class="w"></span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">maxwrk</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_cgebrd_nn</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqo</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Path 2 (M &gt;&gt; N, JOBZ=&#39;O&#39;)</span>
<span class="c">!</span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lwork_cgeqrf_mn</span><span class="w"></span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_cungqr_mn</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_cgebrd_nn</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_cunmbr_qln_nn</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_cunmbr_prc_nn</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">wrkbl</span><span class="w"></span>
<span class="w">                  </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqs</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Path 3 (M &gt;&gt; N, JOBZ=&#39;S&#39;)</span>
<span class="c">!</span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lwork_cgeqrf_mn</span><span class="w"></span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_cungqr_mn</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_cgebrd_nn</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_cunmbr_qln_nn</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_cunmbr_prc_nn</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">wrkbl</span><span class="w"></span>
<span class="w">                  </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqa</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Path 4 (M &gt;&gt; N, JOBZ=&#39;A&#39;)</span>
<span class="c">!</span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lwork_cgeqrf_mn</span><span class="w"></span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_cungqr_mm</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_cgebrd_nn</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_cunmbr_qln_nn</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_cunmbr_prc_nn</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">wrkbl</span><span class="w"></span>
<span class="w">                  </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="o">+</span><span class="n">M</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span>
<span class="k">            </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">M</span><span class="o">&gt;=</span><span class="n">mnthr2</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 5 (M &gt;&gt; N, but not as much as MNTHR1)</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lwork_cgebrd_mn</span><span class="w"></span>
<span class="w">               </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqo</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                 Path 5o (M &gt;&gt; N, JOBZ=&#39;O&#39;)</span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">maxwrk</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_cungbr_p_nn</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">maxwrk</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_cungbr_q_mn</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">                  </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">minwrk</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqs</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                 Path 5s (M &gt;&gt; N, JOBZ=&#39;S&#39;)</span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">maxwrk</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_cungbr_p_nn</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">maxwrk</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_cungbr_q_mn</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqa</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                 Path 5a (M &gt;&gt; N, JOBZ=&#39;A&#39;)</span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">maxwrk</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_cungbr_p_nn</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">maxwrk</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_cungbr_q_mm</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span>
<span class="k">            ELSE</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 6 (M &gt;= N, but not much larger)</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lwork_cgebrd_mn</span><span class="w"></span>
<span class="w">               </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqo</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                 Path 6o (M &gt;= N, JOBZ=&#39;O&#39;)</span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">maxwrk</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_cunmbr_prc_nn</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">maxwrk</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_cunmbr_qln_mn</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">                  </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">minwrk</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqs</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                 Path 6s (M &gt;= N, JOBZ=&#39;S&#39;)</span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">maxwrk</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_cunmbr_qln_mn</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">maxwrk</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_cunmbr_prc_nn</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqa</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                 Path 6a (M &gt;= N, JOBZ=&#39;A&#39;)</span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">maxwrk</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_cunmbr_qln_mm</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">maxwrk</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_cunmbr_prc_nn</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span>
<span class="k">            ENDIF</span>
<span class="k">         </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">minmn</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           There is no complex work space needed for bidiagonal SVD</span>
<span class="c">!           The real work space needed for bidiagonal SVD (sbdsdc) is</span>
<span class="c">!           BDSPAC = 3*M*M + 4*M for singular values and vectors;</span>
<span class="c">!           BDSPAC = 4*M         for singular values only;</span>
<span class="c">!           not including e, RU, and RVT matrices.</span>
<span class="c">!</span>
<span class="c">!           Compute space preferred for each routine</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CGEBRD</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_cgebrd_mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CGEBRD</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_cgebrd_mm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CGELQF</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_cgelqf_mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNGBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_cungbr_p_mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNGBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_cungbr_p_nn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNGBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_cungbr_q_mm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNGLQ</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_cunglq_mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNGLQ</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_cunglq_nn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNMBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_cunmbr_prc_mm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNMBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_cunmbr_prc_mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNMBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_cunmbr_prc_nn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNMBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_cunmbr_qln_mm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">cdum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">N</span><span class="o">&gt;=</span><span class="n">mnthr1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqn</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Path 1t (N &gt;&gt; M, JOBZ=&#39;N&#39;)</span>
<span class="c">!</span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lwork_cgelqf_mn</span><span class="w"></span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">maxwrk</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_cgebrd_mm</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">               </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqo</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Path 2t (N &gt;&gt; M, JOBZ=&#39;O&#39;)</span>
<span class="c">!</span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lwork_cgelqf_mn</span><span class="w"></span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_cunglq_mn</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_cgebrd_mm</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_cunmbr_qln_mm</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_cunmbr_prc_mm</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">wrkbl</span><span class="w"></span>
<span class="w">                  </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">               </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqs</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Path 3t (N &gt;&gt; M, JOBZ=&#39;S&#39;)</span>
<span class="c">!</span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lwork_cgelqf_mn</span><span class="w"></span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_cunglq_mn</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_cgebrd_mm</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_cunmbr_qln_mm</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_cunmbr_prc_mm</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">wrkbl</span><span class="w"></span>
<span class="w">                  </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">               </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqa</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Path 4t (N &gt;&gt; M, JOBZ=&#39;A&#39;)</span>
<span class="c">!</span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lwork_cgelqf_mn</span><span class="w"></span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_cunglq_nn</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_cgebrd_mm</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_cunmbr_qln_mm</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_cunmbr_prc_mm</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">wrkbl</span><span class="w"></span>
<span class="w">                  </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="o">+</span><span class="n">N</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span>
<span class="k">            </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">N</span><span class="o">&gt;=</span><span class="n">mnthr2</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 5t (N &gt;&gt; M, but not as much as MNTHR1)</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lwork_cgebrd_mn</span><span class="w"></span>
<span class="w">               </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqo</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                 Path 5to (N &gt;&gt; M, JOBZ=&#39;O&#39;)</span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">maxwrk</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_cungbr_q_mm</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">maxwrk</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_cungbr_p_mn</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">                  </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">minwrk</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">               </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqs</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                 Path 5ts (N &gt;&gt; M, JOBZ=&#39;S&#39;)</span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">maxwrk</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_cungbr_q_mm</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">maxwrk</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_cungbr_p_mn</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqa</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                 Path 5ta (N &gt;&gt; M, JOBZ=&#39;A&#39;)</span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">maxwrk</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_cungbr_q_mm</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">maxwrk</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_cungbr_p_nn</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span>
<span class="k">            ELSE</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 6t (N &gt; M, but not much larger)</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lwork_cgebrd_mn</span><span class="w"></span>
<span class="w">               </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqo</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                 Path 6to (N &gt; M, JOBZ=&#39;O&#39;)</span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">maxwrk</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_cunmbr_qln_mm</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">maxwrk</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_cunmbr_prc_mn</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">                  </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">minwrk</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">               </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqs</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                 Path 6ts (N &gt; M, JOBZ=&#39;S&#39;)</span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">maxwrk</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_cunmbr_qln_mm</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">maxwrk</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_cunmbr_prc_mn</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqa</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                 Path 6ta (N &gt; M, JOBZ=&#39;A&#39;)</span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">maxwrk</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_cunmbr_qln_mm</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">maxwrk</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_cunmbr_prc_nn</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span>
<span class="k">            ENDIF</span>
<span class="k">         ENDIF</span>
<span class="k">         </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">maxwrk</span><span class="p">,</span><span class="n">minwrk</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">ENDIF</span>
<span class="k">      IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Info</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Work</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">maxwrk</span><span class="w"></span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Lwork</span><span class="o">&lt;</span><span class="n">minwrk</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">lquery</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">12</span><span class="w"></span>
<span class="w">      </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Info</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         CALL </span><span class="n">XERBLA</span><span class="p">(</span><span class="s1">&#39;CGESDD&#39;</span><span class="p">,</span><span class="o">-</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">RETURN</span>
<span class="k">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">lquery</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         RETURN</span>
<span class="k">      ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Quick return if possible</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">M</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">N</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">RETURN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Get machine constants</span>
<span class="c">!</span>
<span class="w">      </span><span class="n">eps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SLAMCH</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">smlnum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">SQRT</span><span class="p">(</span><span class="n">SLAMCH</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">))</span><span class="o">/</span><span class="n">eps</span><span class="w"></span>
<span class="w">      </span><span class="n">bignum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ONE</span><span class="o">/</span><span class="n">smlnum</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Scale A if max element outside range [SMLNUM,BIGNUM]</span>
<span class="c">!</span>
<span class="w">      </span><span class="n">anrm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CLANGE</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">dum</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">SISNAN</span><span class="p">(</span><span class="n">anrm</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span><span class="w"></span>
<span class="w">         </span><span class="k">RETURN</span>
<span class="k">      ENDIF</span>
<span class="k">      </span><span class="n">iscl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">anrm</span><span class="o">&gt;</span><span class="n">ZERO</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">anrm</span><span class="o">&lt;</span><span class="n">smlnum</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">iscl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">CALL </span><span class="n">CLASCL</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">anrm</span><span class="p">,</span><span class="n">smlnum</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">anrm</span><span class="o">&gt;</span><span class="n">bignum</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">iscl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">CALL </span><span class="n">CLASCL</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">anrm</span><span class="p">,</span><span class="n">bignum</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">M</span><span class="o">&gt;=</span><span class="n">N</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!        A has at least as many rows as columns. If A has sufficiently</span>
<span class="c">!        more rows than columns, first reduce using the QR</span>
<span class="c">!        decomposition (if sufficient workspace available)</span>
<span class="c">!</span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">M</span><span class="o">&gt;=</span><span class="n">mnthr1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqn</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 1 (M &gt;&gt; N, JOBZ=&#39;N&#39;)</span>
<span class="c">!              No singular vectors to be computed</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">itau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itau</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Compute A=Q*R</span>
<span class="c">!              CWorkspace: need   N [tau] + N    [work]</span>
<span class="c">!              CWorkspace: prefer N [tau] + N*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CGEQRF</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itau</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Zero out below R</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLASET</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">Lda</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">ie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="n">itauq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="n">itaup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itauq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itaup</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Bidiagonalize R in A</span>
<span class="c">!              CWorkspace: need   2*N [tauq, taup] + N      [work]</span>
<span class="c">!              CWorkspace: prefer 2*N [tauq, taup] + 2*N*NB [work]</span>
<span class="c">!              RWorkspace: need   N [e]</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CGEBRD</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">)&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">nrwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Perform bidiagonal SVD, compute singular values only</span>
<span class="c">!              CWorkspace: need   0</span>
<span class="c">!              RWorkspace: need   N [e] + BDSPAC</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">dum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqo</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 2 (M &gt;&gt; N, JOBZ=&#39;O&#39;)</span>
<span class="c">!              N left singular vectors to be overwritten on A and</span>
<span class="c">!              N right singular vectors to be computed in VT</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">iu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              WORK(IU) is N by N</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">ldwrku</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="n">ir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iu</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ldwrku</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Lwork</span><span class="o">&gt;=</span><span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 WORK(IR) is M by N</span>
<span class="c">!</span>
<span class="w">                  </span><span class="n">ldwrkr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">               </span><span class="k">ELSE</span>
<span class="k">                  </span><span class="n">ldwrkr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Lwork</span><span class="o">-</span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span>
<span class="k">               </span><span class="n">itau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ir</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ldwrkr</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itau</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Compute A=Q*R</span>
<span class="c">!              CWorkspace: need   N*N [U] + N*N [R] + N [tau] + N    [work]</span>
<span class="c">!              CWorkspace: prefer N*N [U] + N*N [R] + N [tau] + N*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CGEQRF</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itau</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy R to WORK( IR ), zeroing out below it</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ir</span><span class="p">),</span><span class="n">ldwrkr</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLASET</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ir</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">ldwrkr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Generate Q in A</span>
<span class="c">!              CWorkspace: need   N*N [U] + N*N [R] + N [tau] + N    [work]</span>
<span class="c">!              CWorkspace: prefer N*N [U] + N*N [R] + N [tau] + N*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CUNGQR</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itau</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">ie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="n">itauq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itau</span><span class="w"></span>
<span class="w">               </span><span class="n">itaup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itauq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itaup</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Bidiagonalize R in WORK(IR)</span>
<span class="c">!              CWorkspace: need   N*N [U] + N*N [R] + 2*N [tauq, taup] + N      [work]</span>
<span class="c">!              CWorkspace: prefer N*N [U] + N*N [R] + 2*N [tauq, taup] + 2*N*NB [work]</span>
<span class="c">!              RWorkspace: need   N [e]</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CGEBRD</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ir</span><span class="p">),</span><span class="n">ldwrkr</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Perform bidiagonal SVD, computing left singular vectors</span>
<span class="c">!              of R in WORK(IRU) and computing right singular vectors</span>
<span class="c">!              of R in WORK(IRVT)</span>
<span class="c">!              CWorkspace: need   0</span>
<span class="c">!              RWorkspace: need   N [e] + N*N [RU] + N*N [RVT] + BDSPAC</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">iru</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="n">irvt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iru</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="n">nrwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">irvt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy real matrix RWORK(IRU) to complex matrix WORK(IU)</span>
<span class="c">!              Overwrite WORK(IU) by the left singular vectors of R</span>
<span class="c">!              CWorkspace: need   N*N [U] + N*N [R] + 2*N [tauq, taup] + N    [work]</span>
<span class="c">!              CWorkspace: prefer N*N [U] + N*N [R] + 2*N [tauq, taup] + N*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACP2</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">iu</span><span class="p">),</span><span class="n">ldwrku</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CUNMBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ir</span><span class="p">),</span><span class="n">ldwrkr</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">)&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">iu</span><span class="p">),</span><span class="n">ldwrku</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy real matrix RWORK(IRVT) to complex matrix VT</span>
<span class="c">!              Overwrite VT by the right singular vectors of R</span>
<span class="c">!              CWorkspace: need   N*N [U] + N*N [R] + 2*N [tauq, taup] + N    [work]</span>
<span class="c">!              CWorkspace: prefer N*N [U] + N*N [R] + 2*N [tauq, taup] + N*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACP2</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CUNMBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ir</span><span class="p">),</span><span class="n">ldwrkr</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">)&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Multiply Q in A by left singular vectors of R in</span>
<span class="c">!              WORK(IU), storing result in WORK(IR) and copying to A</span>
<span class="c">!              CWorkspace: need   N*N [U] + N*N [R]</span>
<span class="c">!              CWorkspace: prefer N*N [U] + M*N [R]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ldwrkr</span><span class="w"></span>
<span class="w">                  </span><span class="n">chunk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">M</span><span class="o">-</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ldwrkr</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">CALL </span><span class="n">CGEMM</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">chunk</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">CONE</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">iu</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                       </span><span class="n">ldwrku</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ir</span><span class="p">),</span><span class="n">ldwrkr</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">chunk</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ir</span><span class="p">),</span><span class="n">ldwrkr</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">Lda</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDDO</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqs</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 3 (M &gt;&gt; N, JOBZ=&#39;S&#39;)</span>
<span class="c">!              N left singular vectors to be computed in U and</span>
<span class="c">!              N right singular vectors to be computed in VT</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">ir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              WORK(IR) is N by N</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">ldwrkr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="n">itau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ir</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ldwrkr</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itau</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Compute A=Q*R</span>
<span class="c">!              CWorkspace: need   N*N [R] + N [tau] + N    [work]</span>
<span class="c">!              CWorkspace: prefer N*N [R] + N [tau] + N*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CGEQRF</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itau</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy R to WORK(IR), zeroing out below it</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ir</span><span class="p">),</span><span class="n">ldwrkr</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLASET</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ir</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">ldwrkr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Generate Q in A</span>
<span class="c">!              CWorkspace: need   N*N [R] + N [tau] + N    [work]</span>
<span class="c">!              CWorkspace: prefer N*N [R] + N [tau] + N*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CUNGQR</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itau</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">ie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="n">itauq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itau</span><span class="w"></span>
<span class="w">               </span><span class="n">itaup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itauq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itaup</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Bidiagonalize R in WORK(IR)</span>
<span class="c">!              CWorkspace: need   N*N [R] + 2*N [tauq, taup] + N      [work]</span>
<span class="c">!              CWorkspace: prefer N*N [R] + 2*N [tauq, taup] + 2*N*NB [work]</span>
<span class="c">!              RWorkspace: need   N [e]</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CGEBRD</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ir</span><span class="p">),</span><span class="n">ldwrkr</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Perform bidiagonal SVD, computing left singular vectors</span>
<span class="c">!              of bidiagonal matrix in RWORK(IRU) and computing right</span>
<span class="c">!              singular vectors of bidiagonal matrix in RWORK(IRVT)</span>
<span class="c">!              CWorkspace: need   0</span>
<span class="c">!              RWorkspace: need   N [e] + N*N [RU] + N*N [RVT] + BDSPAC</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">iru</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="n">irvt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iru</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="n">nrwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">irvt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy real matrix RWORK(IRU) to complex matrix U</span>
<span class="c">!              Overwrite U by left singular vectors of R</span>
<span class="c">!              CWorkspace: need   N*N [R] + 2*N [tauq, taup] + N    [work]</span>
<span class="c">!              CWorkspace: prefer N*N [R] + 2*N [tauq, taup] + N*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACP2</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CUNMBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ir</span><span class="p">),</span><span class="n">ldwrkr</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">)&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy real matrix RWORK(IRVT) to complex matrix VT</span>
<span class="c">!              Overwrite VT by right singular vectors of R</span>
<span class="c">!              CWorkspace: need   N*N [R] + 2*N [tauq, taup] + N    [work]</span>
<span class="c">!              CWorkspace: prefer N*N [R] + 2*N [tauq, taup] + N*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACP2</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CUNMBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ir</span><span class="p">),</span><span class="n">ldwrkr</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">)&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Multiply Q in A by left singular vectors of R in</span>
<span class="c">!              WORK(IR), storing result in U</span>
<span class="c">!              CWorkspace: need   N*N [R]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ir</span><span class="p">),</span><span class="n">ldwrkr</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CGEMM</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">CONE</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ir</span><span class="p">),</span><span class="n">ldwrkr</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                    </span><span class="n">CZERO</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqa</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 4 (M &gt;&gt; N, JOBZ=&#39;A&#39;)</span>
<span class="c">!              M left singular vectors to be computed in U and</span>
<span class="c">!              N right singular vectors to be computed in VT</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">iu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              WORK(IU) is N by N</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">ldwrku</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="n">itau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iu</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ldwrku</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itau</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Compute A=Q*R, copying result to U</span>
<span class="c">!              CWorkspace: need   N*N [U] + N [tau] + N    [work]</span>
<span class="c">!              CWorkspace: prefer N*N [U] + N [tau] + N*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CGEQRF</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itau</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Generate Q in U</span>
<span class="c">!              CWorkspace: need   N*N [U] + N [tau] + M    [work]</span>
<span class="c">!              CWorkspace: prefer N*N [U] + N [tau] + M*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CUNGQR</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itau</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Produce R in A, zeroing out below it</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLASET</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">Lda</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">ie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="n">itauq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itau</span><span class="w"></span>
<span class="w">               </span><span class="n">itaup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itauq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itaup</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Bidiagonalize R in A</span>
<span class="c">!              CWorkspace: need   N*N [U] + 2*N [tauq, taup] + N      [work]</span>
<span class="c">!              CWorkspace: prefer N*N [U] + 2*N [tauq, taup] + 2*N*NB [work]</span>
<span class="c">!              RWorkspace: need   N [e]</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CGEBRD</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">)&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">iru</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="n">irvt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iru</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="n">nrwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">irvt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Perform bidiagonal SVD, computing left singular vectors</span>
<span class="c">!              of bidiagonal matrix in RWORK(IRU) and computing right</span>
<span class="c">!              singular vectors of bidiagonal matrix in RWORK(IRVT)</span>
<span class="c">!              CWorkspace: need   0</span>
<span class="c">!              RWorkspace: need   N [e] + N*N [RU] + N*N [RVT] + BDSPAC</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy real matrix RWORK(IRU) to complex matrix WORK(IU)</span>
<span class="c">!              Overwrite WORK(IU) by left singular vectors of R</span>
<span class="c">!              CWorkspace: need   N*N [U] + 2*N [tauq, taup] + N    [work]</span>
<span class="c">!              CWorkspace: prefer N*N [U] + 2*N [tauq, taup] + N*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACP2</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">iu</span><span class="p">),</span><span class="n">ldwrku</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CUNMBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">iu</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">ldwrku</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy real matrix RWORK(IRVT) to complex matrix VT</span>
<span class="c">!              Overwrite VT by right singular vectors of R</span>
<span class="c">!              CWorkspace: need   N*N [U] + 2*N [tauq, taup] + N    [work]</span>
<span class="c">!              CWorkspace: prefer N*N [U] + 2*N [tauq, taup] + N*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACP2</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CUNMBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Multiply Q in U by left singular vectors of R in</span>
<span class="c">!              WORK(IU), storing result in A</span>
<span class="c">!              CWorkspace: need   N*N [U]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CGEMM</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">CONE</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">iu</span><span class="p">),</span><span class="n">ldwrku</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                    </span><span class="n">CZERO</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy left singular vectors of A from A to U</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="w">         </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">M</span><span class="o">&gt;=</span><span class="n">mnthr2</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           MNTHR2 &lt;= M &lt; MNTHR1</span>
<span class="c">!</span>
<span class="c">!           Path 5 (M &gt;&gt; N, but not as much as MNTHR1)</span>
<span class="c">!           Reduce to bidiagonal form without QR decomposition, use</span>
<span class="c">!           CUNGBR and matrix multiplication to compute singular vectors</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">ie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">nrwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">            </span><span class="n">itauq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">itaup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itauq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">            </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itaup</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Bidiagonalize A</span>
<span class="c">!           CWorkspace: need   2*N [tauq, taup] + M        [work]</span>
<span class="c">!           CWorkspace: prefer 2*N [tauq, taup] + (M+N)*NB [work]</span>
<span class="c">!           RWorkspace: need   N [e]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CGEBRD</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqn</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 5n (M &gt;&gt; N, JOBZ=&#39;N&#39;)</span>
<span class="c">!              Compute singular values only</span>
<span class="c">!              CWorkspace: need   0</span>
<span class="c">!              RWorkspace: need   N [e] + BDSPAC</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">dum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqo</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">iu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nwork</span><span class="w"></span>
<span class="w">               </span><span class="n">iru</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nrwork</span><span class="w"></span>
<span class="w">               </span><span class="n">irvt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iru</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="n">nrwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">irvt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 5o (M &gt;&gt; N, JOBZ=&#39;O&#39;)</span>
<span class="c">!              Copy A to VT, generate P**H</span>
<span class="c">!              CWorkspace: need   2*N [tauq, taup] + N    [work]</span>
<span class="c">!              CWorkspace: prefer 2*N [tauq, taup] + N*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CUNGBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Generate Q in A</span>
<span class="c">!              CWorkspace: need   2*N [tauq, taup] + N    [work]</span>
<span class="c">!              CWorkspace: prefer 2*N [tauq, taup] + N*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CUNGBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Lwork</span><span class="o">&gt;=</span><span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 WORK( IU ) is M by N</span>
<span class="c">!</span>
<span class="w">                  </span><span class="n">ldwrku</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">               </span><span class="k">ELSE</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 WORK(IU) is LDWRKU by N</span>
<span class="c">!</span>
<span class="w">                  </span><span class="n">ldwrku</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Lwork</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span>
<span class="k">               </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iu</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ldwrku</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Perform bidiagonal SVD, computing left singular vectors</span>
<span class="c">!              of bidiagonal matrix in RWORK(IRU) and computing right</span>
<span class="c">!              singular vectors of bidiagonal matrix in RWORK(IRVT)</span>
<span class="c">!              CWorkspace: need   0</span>
<span class="c">!              RWorkspace: need   N [e] + N*N [RU] + N*N [RVT] + BDSPAC</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Multiply real matrix RWORK(IRVT) by P**H in VT,</span>
<span class="c">!              storing the result in WORK(IU), copying to VT</span>
<span class="c">!              CWorkspace: need   2*N [tauq, taup] + N*N [U]</span>
<span class="c">!              RWorkspace: need   N [e] + N*N [RU] + N*N [RVT] + 2*N*N [rwork]</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLARCM</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">iu</span><span class="p">),</span><span class="n">ldwrku</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">))</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">iu</span><span class="p">),</span><span class="n">ldwrku</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Multiply Q in A by real matrix RWORK(IRU), storing the</span>
<span class="c">!              result in WORK(IU), copying to A</span>
<span class="c">!              CWorkspace: need   2*N [tauq, taup] + N*N [U]</span>
<span class="c">!              CWorkspace: prefer 2*N [tauq, taup] + M*N [U]</span>
<span class="c">!              RWorkspace: need   N [e] + N*N [RU] + 2*N*N [rwork]</span>
<span class="c">!              RWorkspace: prefer N [e] + N*N [RU] + 2*M*N [rwork] &lt; N + 5*N*N since M &lt; 2*N here</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">nrwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">irvt</span><span class="w"></span>
<span class="w">               </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ldwrku</span><span class="w"></span>
<span class="w">                  </span><span class="n">chunk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">M</span><span class="o">-</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ldwrku</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">CALL </span><span class="n">CLACRM</span><span class="p">(</span><span class="n">chunk</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">Lda</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">iu</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                        </span><span class="n">ldwrku</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">))</span><span class="w"></span>
<span class="w">                  </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">chunk</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">iu</span><span class="p">),</span><span class="n">ldwrku</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">Lda</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDDO</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqs</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 5s (M &gt;&gt; N, JOBZ=&#39;S&#39;)</span>
<span class="c">!              Copy A to VT, generate P**H</span>
<span class="c">!              CWorkspace: need   2*N [tauq, taup] + N    [work]</span>
<span class="c">!              CWorkspace: prefer 2*N [tauq, taup] + N*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CUNGBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy A to U, generate Q</span>
<span class="c">!              CWorkspace: need   2*N [tauq, taup] + N    [work]</span>
<span class="c">!              CWorkspace: prefer 2*N [tauq, taup] + N*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CUNGBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Perform bidiagonal SVD, computing left singular vectors</span>
<span class="c">!              of bidiagonal matrix in RWORK(IRU) and computing right</span>
<span class="c">!              singular vectors of bidiagonal matrix in RWORK(IRVT)</span>
<span class="c">!              CWorkspace: need   0</span>
<span class="c">!              RWorkspace: need   N [e] + N*N [RU] + N*N [RVT] + BDSPAC</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">iru</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nrwork</span><span class="w"></span>
<span class="w">               </span><span class="n">irvt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iru</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="n">nrwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">irvt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Multiply real matrix RWORK(IRVT) by P**H in VT,</span>
<span class="c">!              storing the result in A, copying to VT</span>
<span class="c">!              CWorkspace: need   0</span>
<span class="c">!              RWorkspace: need   N [e] + N*N [RU] + N*N [RVT] + 2*N*N [rwork]</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLARCM</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">)&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Multiply Q in U by real matrix RWORK(IRU), storing the</span>
<span class="c">!              result in A, copying to U</span>
<span class="c">!              CWorkspace: need   0</span>
<span class="c">!              RWorkspace: need   N [e] + N*N [RU] + 2*M*N [rwork] &lt; N + 5*N*N since M &lt; 2*N here</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">nrwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">irvt</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACRM</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">))</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">ELSE</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 5a (M &gt;&gt; N, JOBZ=&#39;A&#39;)</span>
<span class="c">!              Copy A to VT, generate P**H</span>
<span class="c">!              CWorkspace: need   2*N [tauq, taup] + N    [work]</span>
<span class="c">!              CWorkspace: prefer 2*N [tauq, taup] + N*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CUNGBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy A to U, generate Q</span>
<span class="c">!              CWorkspace: need   2*N [tauq, taup] + M    [work]</span>
<span class="c">!              CWorkspace: prefer 2*N [tauq, taup] + M*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CUNGBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Perform bidiagonal SVD, computing left singular vectors</span>
<span class="c">!              of bidiagonal matrix in RWORK(IRU) and computing right</span>
<span class="c">!              singular vectors of bidiagonal matrix in RWORK(IRVT)</span>
<span class="c">!              CWorkspace: need   0</span>
<span class="c">!              RWorkspace: need   N [e] + N*N [RU] + N*N [RVT] + BDSPAC</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">iru</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nrwork</span><span class="w"></span>
<span class="w">               </span><span class="n">irvt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iru</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="n">nrwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">irvt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Multiply real matrix RWORK(IRVT) by P**H in VT,</span>
<span class="c">!              storing the result in A, copying to VT</span>
<span class="c">!              CWorkspace: need   0</span>
<span class="c">!              RWorkspace: need   N [e] + N*N [RU] + N*N [RVT] + 2*N*N [rwork]</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLARCM</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">)&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Multiply Q in U by real matrix RWORK(IRU), storing the</span>
<span class="c">!              result in A, copying to U</span>
<span class="c">!              CWorkspace: need   0</span>
<span class="c">!              RWorkspace: need   N [e] + N*N [RU] + 2*M*N [rwork] &lt; N + 5*N*N since M &lt; 2*N here</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">nrwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">irvt</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACRM</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">))</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="w">         </span><span class="k">ELSE</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           M .LT. MNTHR2</span>
<span class="c">!</span>
<span class="c">!           Path 6 (M &gt;= N, but not much larger)</span>
<span class="c">!           Reduce to bidiagonal form without QR decomposition</span>
<span class="c">!           Use CUNMBR to compute singular vectors</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">ie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">nrwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">            </span><span class="n">itauq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">itaup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itauq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">            </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itaup</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Bidiagonalize A</span>
<span class="c">!           CWorkspace: need   2*N [tauq, taup] + M        [work]</span>
<span class="c">!           CWorkspace: prefer 2*N [tauq, taup] + (M+N)*NB [work]</span>
<span class="c">!           RWorkspace: need   N [e]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CGEBRD</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqn</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 6n (M &gt;= N, JOBZ=&#39;N&#39;)</span>
<span class="c">!              Compute singular values only</span>
<span class="c">!              CWorkspace: need   0</span>
<span class="c">!              RWorkspace: need   N [e] + BDSPAC</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">dum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqo</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">iu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nwork</span><span class="w"></span>
<span class="w">               </span><span class="n">iru</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nrwork</span><span class="w"></span>
<span class="w">               </span><span class="n">irvt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iru</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="n">nrwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">irvt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Lwork</span><span class="o">&gt;=</span><span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 WORK( IU ) is M by N</span>
<span class="c">!</span>
<span class="w">                  </span><span class="n">ldwrku</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">               </span><span class="k">ELSE</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 WORK( IU ) is LDWRKU by N</span>
<span class="c">!</span>
<span class="w">                  </span><span class="n">ldwrku</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Lwork</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span>
<span class="k">               </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iu</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ldwrku</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 6o (M &gt;= N, JOBZ=&#39;O&#39;)</span>
<span class="c">!              Perform bidiagonal SVD, computing left singular vectors</span>
<span class="c">!              of bidiagonal matrix in RWORK(IRU) and computing right</span>
<span class="c">!              singular vectors of bidiagonal matrix in RWORK(IRVT)</span>
<span class="c">!              CWorkspace: need   0</span>
<span class="c">!              RWorkspace: need   N [e] + N*N [RU] + N*N [RVT] + BDSPAC</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy real matrix RWORK(IRVT) to complex matrix VT</span>
<span class="c">!              Overwrite VT by right singular vectors of A</span>
<span class="c">!              CWorkspace: need   2*N [tauq, taup] + N*N [U] + N    [work]</span>
<span class="c">!              CWorkspace: prefer 2*N [tauq, taup] + N*N [U] + N*NB [work]</span>
<span class="c">!              RWorkspace: need   N [e] + N*N [RU] + N*N [RVT]</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACP2</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CUNMBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Lwork</span><span class="o">&gt;=</span><span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Path 6o-fast</span>
<span class="c">!                 Copy real matrix RWORK(IRU) to complex matrix WORK(IU)</span>
<span class="c">!                 Overwrite WORK(IU) by left singular vectors of A, copying</span>
<span class="c">!                 to A</span>
<span class="c">!                 CWorkspace: need   2*N [tauq, taup] + M*N [U] + N    [work]</span>
<span class="c">!                 CWorkspace: prefer 2*N [tauq, taup] + M*N [U] + N*NB [work]</span>
<span class="c">!                 RWorkspace: need   N [e] + N*N [RU]</span>
<span class="c">!</span>
<span class="w">                  </span><span class="k">CALL </span><span class="n">CLASET</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">iu</span><span class="p">),</span><span class="n">ldwrku</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">CALL </span><span class="n">CLACP2</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">iu</span><span class="p">),</span><span class="n">ldwrku</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">CALL </span><span class="n">CUNMBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                        </span><span class="n">Work</span><span class="p">(</span><span class="n">iu</span><span class="p">),</span><span class="n">ldwrku</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                        </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">iu</span><span class="p">),</span><span class="n">ldwrku</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">ELSE</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Path 6o-slow</span>
<span class="c">!                 Generate Q in A</span>
<span class="c">!                 CWorkspace: need   2*N [tauq, taup] + N*N [U] + N    [work]</span>
<span class="c">!                 CWorkspace: prefer 2*N [tauq, taup] + N*N [U] + N*NB [work]</span>
<span class="c">!                 RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">                  </span><span class="k">CALL </span><span class="n">CUNGBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                        </span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Multiply Q in A by real matrix RWORK(IRU), storing the</span>
<span class="c">!                 result in WORK(IU), copying to A</span>
<span class="c">!                 CWorkspace: need   2*N [tauq, taup] + N*N [U]</span>
<span class="c">!                 CWorkspace: prefer 2*N [tauq, taup] + M*N [U]</span>
<span class="c">!                 RWorkspace: need   N [e] + N*N [RU] + 2*N*N [rwork]</span>
<span class="c">!                 RWorkspace: prefer N [e] + N*N [RU] + 2*M*N [rwork] &lt; N + 5*N*N since M &lt; 2*N here</span>
<span class="c">!</span>
<span class="w">                  </span><span class="n">nrwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">irvt</span><span class="w"></span>
<span class="w">                  </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ldwrku</span><span class="w"></span>
<span class="w">                     </span><span class="n">chunk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">M</span><span class="o">-</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ldwrku</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="k">CALL </span><span class="n">CLACRM</span><span class="p">(</span><span class="n">chunk</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">Lda</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                           </span><span class="n">Work</span><span class="p">(</span><span class="n">iu</span><span class="p">),</span><span class="n">ldwrku</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">))</span><span class="w"></span>
<span class="w">                     </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">chunk</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">iu</span><span class="p">),</span><span class="n">ldwrku</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">Lda</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">ENDDO</span>
<span class="k">               ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqs</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 6s (M &gt;= N, JOBZ=&#39;S&#39;)</span>
<span class="c">!              Perform bidiagonal SVD, computing left singular vectors</span>
<span class="c">!              of bidiagonal matrix in RWORK(IRU) and computing right</span>
<span class="c">!              singular vectors of bidiagonal matrix in RWORK(IRVT)</span>
<span class="c">!              CWorkspace: need   0</span>
<span class="c">!              RWorkspace: need   N [e] + N*N [RU] + N*N [RVT] + BDSPAC</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">iru</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nrwork</span><span class="w"></span>
<span class="w">               </span><span class="n">irvt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iru</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="n">nrwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">irvt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy real matrix RWORK(IRU) to complex matrix U</span>
<span class="c">!              Overwrite U by left singular vectors of A</span>
<span class="c">!              CWorkspace: need   2*N [tauq, taup] + N    [work]</span>
<span class="c">!              CWorkspace: prefer 2*N [tauq, taup] + N*NB [work]</span>
<span class="c">!              RWorkspace: need   N [e] + N*N [RU] + N*N [RVT]</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLASET</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACP2</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CUNMBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy real matrix RWORK(IRVT) to complex matrix VT</span>
<span class="c">!              Overwrite VT by right singular vectors of A</span>
<span class="c">!              CWorkspace: need   2*N [tauq, taup] + N    [work]</span>
<span class="c">!              CWorkspace: prefer 2*N [tauq, taup] + N*NB [work]</span>
<span class="c">!              RWorkspace: need   N [e] + N*N [RU] + N*N [RVT]</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACP2</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CUNMBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">ELSE</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 6a (M &gt;= N, JOBZ=&#39;A&#39;)</span>
<span class="c">!              Perform bidiagonal SVD, computing left singular vectors</span>
<span class="c">!              of bidiagonal matrix in RWORK(IRU) and computing right</span>
<span class="c">!              singular vectors of bidiagonal matrix in RWORK(IRVT)</span>
<span class="c">!              CWorkspace: need   0</span>
<span class="c">!              RWorkspace: need   N [e] + N*N [RU] + N*N [RVT] + BDSPAC</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">iru</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nrwork</span><span class="w"></span>
<span class="w">               </span><span class="n">irvt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iru</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="n">nrwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">irvt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Set the right corner of U to identity matrix</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLASET</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">M</span><span class="o">&gt;</span><span class="n">N</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">CALL </span><span class="n">CLASET</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">N</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">CONE</span><span class="p">,</span><span class="n">U</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                                </span><span class="n">Ldu</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy real matrix RWORK(IRU) to complex matrix U</span>
<span class="c">!              Overwrite U by left singular vectors of A</span>
<span class="c">!              CWorkspace: need   2*N [tauq, taup] + M    [work]</span>
<span class="c">!              CWorkspace: prefer 2*N [tauq, taup] + M*NB [work]</span>
<span class="c">!              RWorkspace: need   N [e] + N*N [RU] + N*N [RVT]</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACP2</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CUNMBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy real matrix RWORK(IRVT) to complex matrix VT</span>
<span class="c">!              Overwrite VT by right singular vectors of A</span>
<span class="c">!              CWorkspace: need   2*N [tauq, taup] + N    [work]</span>
<span class="c">!              CWorkspace: prefer 2*N [tauq, taup] + N*NB [work]</span>
<span class="c">!              RWorkspace: need   N [e] + N*N [RU] + N*N [RVT]</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACP2</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CUNMBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="w">         </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!</span>
<span class="c">!        A has more columns than rows. If A has sufficiently more</span>
<span class="c">!        columns than rows, first reduce using the LQ decomposition (if</span>
<span class="c">!        sufficient workspace available)</span>
<span class="c">!</span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">N</span><span class="o">&gt;=</span><span class="n">mnthr1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqn</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 1t (N &gt;&gt; M, JOBZ=&#39;N&#39;)</span>
<span class="c">!              No singular vectors to be computed</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">itau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itau</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Compute A=L*Q</span>
<span class="c">!              CWorkspace: need   M [tau] + M    [work]</span>
<span class="c">!              CWorkspace: prefer M [tau] + M*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CGELQF</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itau</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Zero out above L</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLASET</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">Lda</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">ie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">itauq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">itaup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itauq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itaup</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Bidiagonalize L in A</span>
<span class="c">!              CWorkspace: need   2*M [tauq, taup] + M      [work]</span>
<span class="c">!              CWorkspace: prefer 2*M [tauq, taup] + 2*M*NB [work]</span>
<span class="c">!              RWorkspace: need   M [e]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CGEBRD</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">nrwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Perform bidiagonal SVD, compute singular values only</span>
<span class="c">!              CWorkspace: need   0</span>
<span class="c">!              RWorkspace: need   M [e] + BDSPAC</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">dum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="w">         </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqo</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 2t (N &gt;&gt; M, JOBZ=&#39;O&#39;)</span>
<span class="c">!              M right singular vectors to be overwritten on A and</span>
<span class="c">!              M left singular vectors to be computed in U</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">ivt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">ldwkvt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              WORK(IVT) is M by M</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">il</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ldwkvt</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Lwork</span><span class="o">&gt;=</span><span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 WORK(IL) M by N</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">ldwrkl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">               </span><span class="n">chunk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">            </span><span class="k">ELSE</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 WORK(IL) is M by CHUNK</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">ldwrkl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">               </span><span class="n">chunk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Lwork</span><span class="o">-</span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="p">)</span><span class="o">/</span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span>
<span class="k">            </span><span class="n">itau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">il</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ldwrkl</span><span class="o">*</span><span class="n">chunk</span><span class="w"></span>
<span class="w">            </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itau</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Compute A=L*Q</span>
<span class="c">!              CWorkspace: need   M*M [VT] + M*M [L] + M [tau] + M    [work]</span>
<span class="c">!              CWorkspace: prefer M*M [VT] + M*M [L] + M [tau] + M*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CGELQF</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itau</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy L to WORK(IL), zeroing about above it</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">il</span><span class="p">),</span><span class="n">ldwrkl</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLASET</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">il</span><span class="o">+</span><span class="n">ldwrkl</span><span class="p">),</span><span class="n">ldwrkl</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Generate Q in A</span>
<span class="c">!              CWorkspace: need   M*M [VT] + M*M [L] + M [tau] + M    [work]</span>
<span class="c">!              CWorkspace: prefer M*M [VT] + M*M [L] + M [tau] + M*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNGLQ</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itau</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">ie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">itauq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itau</span><span class="w"></span>
<span class="w">            </span><span class="n">itaup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itauq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itaup</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Bidiagonalize L in WORK(IL)</span>
<span class="c">!              CWorkspace: need   M*M [VT] + M*M [L] + 2*M [tauq, taup] + M      [work]</span>
<span class="c">!              CWorkspace: prefer M*M [VT] + M*M [L] + 2*M [tauq, taup] + 2*M*NB [work]</span>
<span class="c">!              RWorkspace: need   M [e]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CGEBRD</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">il</span><span class="p">),</span><span class="n">ldwrkl</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Perform bidiagonal SVD, computing left singular vectors</span>
<span class="c">!              of bidiagonal matrix in RWORK(IRU) and computing right</span>
<span class="c">!              singular vectors of bidiagonal matrix in RWORK(IRVT)</span>
<span class="c">!              CWorkspace: need   0</span>
<span class="c">!              RWorkspace: need   M [e] + M*M [RU] + M*M [RVT] + BDSPAC</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">iru</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">irvt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iru</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">nrwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">irvt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">M</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy real matrix RWORK(IRU) to complex matrix WORK(IU)</span>
<span class="c">!              Overwrite WORK(IU) by the left singular vectors of L</span>
<span class="c">!              CWorkspace: need   M*M [VT] + M*M [L] + 2*M [tauq, taup] + M    [work]</span>
<span class="c">!              CWorkspace: prefer M*M [VT] + M*M [L] + 2*M [tauq, taup] + M*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLACP2</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNMBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">il</span><span class="p">),</span><span class="n">ldwrkl</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">U</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Ldu</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy real matrix RWORK(IRVT) to complex matrix WORK(IVT)</span>
<span class="c">!              Overwrite WORK(IVT) by the right singular vectors of L</span>
<span class="c">!              CWorkspace: need   M*M [VT] + M*M [L] + 2*M [tauq, taup] + M    [work]</span>
<span class="c">!              CWorkspace: prefer M*M [VT] + M*M [L] + 2*M [tauq, taup] + M*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLACP2</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ivt</span><span class="p">),</span><span class="n">ldwkvt</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNMBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">il</span><span class="p">),</span><span class="n">ldwrkl</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">ivt</span><span class="p">),</span><span class="n">ldwkvt</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Multiply right singular vectors of L in WORK(IL) by Q</span>
<span class="c">!              in A, storing result in WORK(IL) and copying to A</span>
<span class="c">!              CWorkspace: need   M*M [VT] + M*M [L]</span>
<span class="c">!              CWorkspace: prefer M*M [VT] + M*N [L]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">chunk</span><span class="w"></span>
<span class="w">               </span><span class="n">blk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">chunk</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CGEMM</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">blk</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">CONE</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ivt</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">),</span><span class="n">Lda</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                    </span><span class="n">CZERO</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">il</span><span class="p">),</span><span class="n">ldwrkl</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">blk</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">il</span><span class="p">),</span><span class="n">ldwrkl</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">),</span><span class="n">Lda</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDDO</span><span class="w"></span>
<span class="c">!</span>
<span class="w">         </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqs</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 3t (N &gt;&gt; M, JOBZ=&#39;S&#39;)</span>
<span class="c">!              M right singular vectors to be computed in VT and</span>
<span class="c">!              M left singular vectors to be computed in U</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">il</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              WORK(IL) is M by M</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">ldwrkl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">itau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">il</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ldwrkl</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itau</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Compute A=L*Q</span>
<span class="c">!              CWorkspace: need   M*M [L] + M [tau] + M    [work]</span>
<span class="c">!              CWorkspace: prefer M*M [L] + M [tau] + M*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CGELQF</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itau</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy L to WORK(IL), zeroing out above it</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">il</span><span class="p">),</span><span class="n">ldwrkl</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLASET</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">il</span><span class="o">+</span><span class="n">ldwrkl</span><span class="p">),</span><span class="n">ldwrkl</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Generate Q in A</span>
<span class="c">!              CWorkspace: need   M*M [L] + M [tau] + M    [work]</span>
<span class="c">!              CWorkspace: prefer M*M [L] + M [tau] + M*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNGLQ</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itau</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">ie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">itauq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itau</span><span class="w"></span>
<span class="w">            </span><span class="n">itaup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itauq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itaup</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Bidiagonalize L in WORK(IL)</span>
<span class="c">!              CWorkspace: need   M*M [L] + 2*M [tauq, taup] + M      [work]</span>
<span class="c">!              CWorkspace: prefer M*M [L] + 2*M [tauq, taup] + 2*M*NB [work]</span>
<span class="c">!              RWorkspace: need   M [e]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CGEBRD</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">il</span><span class="p">),</span><span class="n">ldwrkl</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Perform bidiagonal SVD, computing left singular vectors</span>
<span class="c">!              of bidiagonal matrix in RWORK(IRU) and computing right</span>
<span class="c">!              singular vectors of bidiagonal matrix in RWORK(IRVT)</span>
<span class="c">!              CWorkspace: need   0</span>
<span class="c">!              RWorkspace: need   M [e] + M*M [RU] + M*M [RVT] + BDSPAC</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">iru</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">irvt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iru</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">nrwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">irvt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">M</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy real matrix RWORK(IRU) to complex matrix U</span>
<span class="c">!              Overwrite U by left singular vectors of L</span>
<span class="c">!              CWorkspace: need   M*M [L] + 2*M [tauq, taup] + M    [work]</span>
<span class="c">!              CWorkspace: prefer M*M [L] + 2*M [tauq, taup] + M*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLACP2</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNMBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">il</span><span class="p">),</span><span class="n">ldwrkl</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">U</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Ldu</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy real matrix RWORK(IRVT) to complex matrix VT</span>
<span class="c">!              Overwrite VT by left singular vectors of L</span>
<span class="c">!              CWorkspace: need   M*M [L] + 2*M [tauq, taup] + M    [work]</span>
<span class="c">!              CWorkspace: prefer M*M [L] + 2*M [tauq, taup] + M*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLACP2</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNMBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">il</span><span class="p">),</span><span class="n">ldwrkl</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy VT to WORK(IL), multiply right singular vectors of L</span>
<span class="c">!              in WORK(IL) by Q in A, storing result in VT</span>
<span class="c">!              CWorkspace: need   M*M [L]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">il</span><span class="p">),</span><span class="n">ldwrkl</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CGEMM</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">CONE</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">il</span><span class="p">),</span><span class="n">ldwrkl</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                 </span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="w">         </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqa</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 4t (N &gt;&gt; M, JOBZ=&#39;A&#39;)</span>
<span class="c">!              N right singular vectors to be computed in VT and</span>
<span class="c">!              M left singular vectors to be computed in U</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">ivt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              WORK(IVT) is M by M</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">ldwkvt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">itau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ldwkvt</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itau</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Compute A=L*Q, copying result to VT</span>
<span class="c">!              CWorkspace: need   M*M [VT] + M [tau] + M    [work]</span>
<span class="c">!              CWorkspace: prefer M*M [VT] + M [tau] + M*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CGELQF</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itau</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Generate Q in VT</span>
<span class="c">!              CWorkspace: need   M*M [VT] + M [tau] + N    [work]</span>
<span class="c">!              CWorkspace: prefer M*M [VT] + M [tau] + N*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNGLQ</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itau</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Produce L in A, zeroing out above it</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLASET</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">Lda</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">ie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">itauq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itau</span><span class="w"></span>
<span class="w">            </span><span class="n">itaup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itauq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itaup</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Bidiagonalize L in A</span>
<span class="c">!              CWorkspace: need   M*M [VT] + 2*M [tauq, taup] + M      [work]</span>
<span class="c">!              CWorkspace: prefer M*M [VT] + 2*M [tauq, taup] + 2*M*NB [work]</span>
<span class="c">!              RWorkspace: need   M [e]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CGEBRD</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Perform bidiagonal SVD, computing left singular vectors</span>
<span class="c">!              of bidiagonal matrix in RWORK(IRU) and computing right</span>
<span class="c">!              singular vectors of bidiagonal matrix in RWORK(IRVT)</span>
<span class="c">!              CWorkspace: need   0</span>
<span class="c">!              RWorkspace: need   M [e] + M*M [RU] + M*M [RVT] + BDSPAC</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">iru</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">irvt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iru</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">nrwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">irvt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">M</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy real matrix RWORK(IRU) to complex matrix U</span>
<span class="c">!              Overwrite U by left singular vectors of L</span>
<span class="c">!              CWorkspace: need   M*M [VT] + 2*M [tauq, taup] + M    [work]</span>
<span class="c">!              CWorkspace: prefer M*M [VT] + 2*M [tauq, taup] + M*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLACP2</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNMBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy real matrix RWORK(IRVT) to complex matrix WORK(IVT)</span>
<span class="c">!              Overwrite WORK(IVT) by right singular vectors of L</span>
<span class="c">!              CWorkspace: need   M*M [VT] + 2*M [tauq, taup] + M    [work]</span>
<span class="c">!              CWorkspace: prefer M*M [VT] + 2*M [tauq, taup] + M*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLACP2</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ivt</span><span class="p">),</span><span class="n">ldwkvt</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNMBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">ivt</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">ldwkvt</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Multiply right singular vectors of L in WORK(IVT) by</span>
<span class="c">!              Q in VT, storing result in A</span>
<span class="c">!              CWorkspace: need   M*M [VT]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CGEMM</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">CONE</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ivt</span><span class="p">),</span><span class="n">ldwkvt</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                 </span><span class="n">CZERO</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy right singular vectors of A from A to VT</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="w">         </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">N</span><span class="o">&gt;=</span><span class="n">mnthr2</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           MNTHR2 &lt;= N &lt; MNTHR1</span>
<span class="c">!</span>
<span class="c">!           Path 5t (N &gt;&gt; M, but not as much as MNTHR1)</span>
<span class="c">!           Reduce to bidiagonal form without QR decomposition, use</span>
<span class="c">!           CUNGBR and matrix multiplication to compute singular vectors</span>
<span class="c">!</span>
<span class="w">         </span><span class="n">ie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="n">nrwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">         </span><span class="n">itauq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="n">itaup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itauq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">         </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itaup</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Bidiagonalize A</span>
<span class="c">!           CWorkspace: need   2*M [tauq, taup] + N        [work]</span>
<span class="c">!           CWorkspace: prefer 2*M [tauq, taup] + (M+N)*NB [work]</span>
<span class="c">!           RWorkspace: need   M [e]</span>
<span class="c">!</span>
<span class="w">         </span><span class="k">CALL </span><span class="n">CGEBRD</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">               </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqn</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 5tn (N &gt;&gt; M, JOBZ=&#39;N&#39;)</span>
<span class="c">!              Compute singular values only</span>
<span class="c">!              CWorkspace: need   0</span>
<span class="c">!              RWorkspace: need   M [e] + BDSPAC</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">dum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqo</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            </span><span class="n">irvt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nrwork</span><span class="w"></span>
<span class="w">            </span><span class="n">iru</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">irvt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">nrwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iru</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">ivt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nwork</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 5to (N &gt;&gt; M, JOBZ=&#39;O&#39;)</span>
<span class="c">!              Copy A to U, generate Q</span>
<span class="c">!              CWorkspace: need   2*M [tauq, taup] + M    [work]</span>
<span class="c">!              CWorkspace: prefer 2*M [tauq, taup] + M*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNGBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Generate P**H in A</span>
<span class="c">!              CWorkspace: need   2*M [tauq, taup] + M    [work]</span>
<span class="c">!              CWorkspace: prefer 2*M [tauq, taup] + M*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNGBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="n">ldwkvt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Lwork</span><span class="o">&gt;=</span><span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 WORK( IVT ) is M by N</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ldwkvt</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="n">chunk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">            </span><span class="k">ELSE</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 WORK( IVT ) is M by CHUNK</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">chunk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Lwork</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="p">)</span><span class="o">/</span><span class="n">M</span><span class="w"></span>
<span class="w">               </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ldwkvt</span><span class="o">*</span><span class="n">chunk</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Perform bidiagonal SVD, computing left singular vectors</span>
<span class="c">!              of bidiagonal matrix in RWORK(IRU) and computing right</span>
<span class="c">!              singular vectors of bidiagonal matrix in RWORK(IRVT)</span>
<span class="c">!              CWorkspace: need   0</span>
<span class="c">!              RWorkspace: need   M [e] + M*M [RVT] + M*M [RU] + BDSPAC</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">M</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Multiply Q in U by real matrix RWORK(IRVT)</span>
<span class="c">!              storing the result in WORK(IVT), copying to U</span>
<span class="c">!              CWorkspace: need   2*M [tauq, taup] + M*M [VT]</span>
<span class="c">!              RWorkspace: need   M [e] + M*M [RVT] + M*M [RU] + 2*M*M [rwork]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLACRM</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ivt</span><span class="p">),</span><span class="n">ldwkvt</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ivt</span><span class="p">),</span><span class="n">ldwkvt</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Multiply RWORK(IRVT) by P**H in A, storing the</span>
<span class="c">!              result in WORK(IVT), copying to A</span>
<span class="c">!              CWorkspace: need   2*M [tauq, taup] + M*M [VT]</span>
<span class="c">!              CWorkspace: prefer 2*M [tauq, taup] + M*N [VT]</span>
<span class="c">!              RWorkspace: need   M [e] + M*M [RVT] + 2*M*M [rwork]</span>
<span class="c">!              RWorkspace: prefer M [e] + M*M [RVT] + 2*M*N [rwork] &lt; M + 5*M*M since N &lt; 2*M here</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">nrwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iru</span><span class="w"></span>
<span class="w">            </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">chunk</span><span class="w"></span>
<span class="w">               </span><span class="n">blk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">chunk</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLARCM</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">blk</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">),</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ivt</span><span class="p">),</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">ldwkvt</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">))</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">blk</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ivt</span><span class="p">),</span><span class="n">ldwkvt</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">),</span><span class="n">Lda</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDDO</span>
<span class="k">         </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqs</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 5ts (N &gt;&gt; M, JOBZ=&#39;S&#39;)</span>
<span class="c">!              Copy A to U, generate Q</span>
<span class="c">!              CWorkspace: need   2*M [tauq, taup] + M    [work]</span>
<span class="c">!              CWorkspace: prefer 2*M [tauq, taup] + M*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNGBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy A to VT, generate P**H</span>
<span class="c">!              CWorkspace: need   2*M [tauq, taup] + M    [work]</span>
<span class="c">!              CWorkspace: prefer 2*M [tauq, taup] + M*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNGBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Perform bidiagonal SVD, computing left singular vectors</span>
<span class="c">!              of bidiagonal matrix in RWORK(IRU) and computing right</span>
<span class="c">!              singular vectors of bidiagonal matrix in RWORK(IRVT)</span>
<span class="c">!              CWorkspace: need   0</span>
<span class="c">!              RWorkspace: need   M [e] + M*M [RVT] + M*M [RU] + BDSPAC</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">irvt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nrwork</span><span class="w"></span>
<span class="w">            </span><span class="n">iru</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">irvt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">nrwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iru</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">M</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Multiply Q in U by real matrix RWORK(IRU), storing the</span>
<span class="c">!              result in A, copying to U</span>
<span class="c">!              CWorkspace: need   0</span>
<span class="c">!              RWorkspace: need   M [e] + M*M [RVT] + M*M [RU] + 2*M*M [rwork]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLACRM</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Multiply real matrix RWORK(IRVT) by P**H in VT,</span>
<span class="c">!              storing the result in A, copying to VT</span>
<span class="c">!              CWorkspace: need   0</span>
<span class="c">!              RWorkspace: need   M [e] + M*M [RVT] + 2*M*N [rwork] &lt; M + 5*M*M since N &lt; 2*M here</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">nrwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iru</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLARCM</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">ELSE</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 5ta (N &gt;&gt; M, JOBZ=&#39;A&#39;)</span>
<span class="c">!              Copy A to U, generate Q</span>
<span class="c">!              CWorkspace: need   2*M [tauq, taup] + M    [work]</span>
<span class="c">!              CWorkspace: prefer 2*M [tauq, taup] + M*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNGBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy A to VT, generate P**H</span>
<span class="c">!              CWorkspace: need   2*M [tauq, taup] + N    [work]</span>
<span class="c">!              CWorkspace: prefer 2*M [tauq, taup] + N*NB [work]</span>
<span class="c">!              RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNGBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Perform bidiagonal SVD, computing left singular vectors</span>
<span class="c">!              of bidiagonal matrix in RWORK(IRU) and computing right</span>
<span class="c">!              singular vectors of bidiagonal matrix in RWORK(IRVT)</span>
<span class="c">!              CWorkspace: need   0</span>
<span class="c">!              RWorkspace: need   M [e] + M*M [RVT] + M*M [RU] + BDSPAC</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">irvt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nrwork</span><span class="w"></span>
<span class="w">            </span><span class="n">iru</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">irvt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">nrwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iru</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">M</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Multiply Q in U by real matrix RWORK(IRU), storing the</span>
<span class="c">!              result in A, copying to U</span>
<span class="c">!              CWorkspace: need   0</span>
<span class="c">!              RWorkspace: need   M [e] + M*M [RVT] + M*M [RU] + 2*M*M [rwork]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLACRM</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Multiply real matrix RWORK(IRVT) by P**H in VT,</span>
<span class="c">!              storing the result in A, copying to VT</span>
<span class="c">!              CWorkspace: need   0</span>
<span class="c">!              RWorkspace: need   M [e] + M*M [RVT] + 2*M*N [rwork] &lt; M + 5*M*M since N &lt; 2*M here</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">nrwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iru</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLARCM</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="w">      </span><span class="k">ELSE</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           N .LT. MNTHR2</span>
<span class="c">!</span>
<span class="c">!           Path 6t (N &gt; M, but not much larger)</span>
<span class="c">!           Reduce to bidiagonal form without LQ decomposition</span>
<span class="c">!           Use CUNMBR to compute singular vectors</span>
<span class="c">!</span>
<span class="w">         </span><span class="n">ie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="n">nrwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">         </span><span class="n">itauq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="n">itaup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itauq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">         </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itaup</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Bidiagonalize A</span>
<span class="c">!           CWorkspace: need   2*M [tauq, taup] + N        [work]</span>
<span class="c">!           CWorkspace: prefer 2*M [tauq, taup] + (M+N)*NB [work]</span>
<span class="c">!           RWorkspace: need   M [e]</span>
<span class="c">!</span>
<span class="w">         </span><span class="k">CALL </span><span class="n">CGEBRD</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">               </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqn</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 6tn (N &gt; M, JOBZ=&#39;N&#39;)</span>
<span class="c">!              Compute singular values only</span>
<span class="c">!              CWorkspace: need   0</span>
<span class="c">!              RWorkspace: need   M [e] + BDSPAC</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">dum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqo</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!              Path 6to (N &gt; M, JOBZ=&#39;O&#39;)</span>
<span class="w">            </span><span class="n">ldwkvt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">ivt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nwork</span><span class="w"></span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Lwork</span><span class="o">&gt;=</span><span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 WORK( IVT ) is M by N</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLASET</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ivt</span><span class="p">),</span><span class="n">ldwkvt</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ldwkvt</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">            </span><span class="k">ELSE</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 WORK( IVT ) is M by CHUNK</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">chunk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Lwork</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="p">)</span><span class="o">/</span><span class="n">M</span><span class="w"></span>
<span class="w">               </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ldwkvt</span><span class="o">*</span><span class="n">chunk</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Perform bidiagonal SVD, computing left singular vectors</span>
<span class="c">!              of bidiagonal matrix in RWORK(IRU) and computing right</span>
<span class="c">!              singular vectors of bidiagonal matrix in RWORK(IRVT)</span>
<span class="c">!              CWorkspace: need   0</span>
<span class="c">!              RWorkspace: need   M [e] + M*M [RVT] + M*M [RU] + BDSPAC</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">irvt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nrwork</span><span class="w"></span>
<span class="w">            </span><span class="n">iru</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">irvt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">nrwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iru</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">M</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy real matrix RWORK(IRU) to complex matrix U</span>
<span class="c">!              Overwrite U by left singular vectors of A</span>
<span class="c">!              CWorkspace: need   2*M [tauq, taup] + M*M [VT] + M    [work]</span>
<span class="c">!              CWorkspace: prefer 2*M [tauq, taup] + M*M [VT] + M*NB [work]</span>
<span class="c">!              RWorkspace: need   M [e] + M*M [RVT] + M*M [RU]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLACP2</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNMBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Lwork</span><span class="o">&gt;=</span><span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Path 6to-fast</span>
<span class="c">!                 Copy real matrix RWORK(IRVT) to complex matrix WORK(IVT)</span>
<span class="c">!                 Overwrite WORK(IVT) by right singular vectors of A,</span>
<span class="c">!                 copying to A</span>
<span class="c">!                 CWorkspace: need   2*M [tauq, taup] + M*N [VT] + M    [work]</span>
<span class="c">!                 CWorkspace: prefer 2*M [tauq, taup] + M*N [VT] + M*NB [work]</span>
<span class="c">!                 RWorkspace: need   M [e] + M*M [RVT]</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACP2</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ivt</span><span class="p">),</span><span class="n">ldwkvt</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CUNMBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">ivt</span><span class="p">)&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="p">,</span><span class="n">ldwkvt</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ivt</span><span class="p">),</span><span class="n">ldwkvt</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">ELSE</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Path 6to-slow</span>
<span class="c">!                 Generate P**H in A</span>
<span class="c">!                 CWorkspace: need   2*M [tauq, taup] + M*M [VT] + M    [work]</span>
<span class="c">!                 CWorkspace: prefer 2*M [tauq, taup] + M*M [VT] + M*NB [work]</span>
<span class="c">!                 RWorkspace: need   0</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CUNGBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Multiply Q in A by real matrix RWORK(IRU), storing the</span>
<span class="c">!                 result in WORK(IU), copying to A</span>
<span class="c">!                 CWorkspace: need   2*M [tauq, taup] + M*M [VT]</span>
<span class="c">!                 CWorkspace: prefer 2*M [tauq, taup] + M*N [VT]</span>
<span class="c">!                 RWorkspace: need   M [e] + M*M [RVT] + 2*M*M [rwork]</span>
<span class="c">!                 RWorkspace: prefer M [e] + M*M [RVT] + 2*M*N [rwork] &lt; M + 5*M*M since N &lt; 2*M here</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">nrwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iru</span><span class="w"></span>
<span class="w">               </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">chunk</span><span class="w"></span>
<span class="w">                  </span><span class="n">blk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">chunk</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">CALL </span><span class="n">CLARCM</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">blk</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">),</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ivt</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                        </span><span class="n">ldwkvt</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">))</span><span class="w"></span>
<span class="w">                  </span><span class="k">CALL </span><span class="n">CLACPY</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">blk</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ivt</span><span class="p">),</span><span class="n">ldwkvt</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">),</span><span class="n">Lda</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDDO</span>
<span class="k">            ENDIF</span>
<span class="k">         </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqs</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 6ts (N &gt; M, JOBZ=&#39;S&#39;)</span>
<span class="c">!              Perform bidiagonal SVD, computing left singular vectors</span>
<span class="c">!              of bidiagonal matrix in RWORK(IRU) and computing right</span>
<span class="c">!              singular vectors of bidiagonal matrix in RWORK(IRVT)</span>
<span class="c">!              CWorkspace: need   0</span>
<span class="c">!              RWorkspace: need   M [e] + M*M [RVT] + M*M [RU] + BDSPAC</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">irvt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nrwork</span><span class="w"></span>
<span class="w">            </span><span class="n">iru</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">irvt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">nrwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iru</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">M</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy real matrix RWORK(IRU) to complex matrix U</span>
<span class="c">!              Overwrite U by left singular vectors of A</span>
<span class="c">!              CWorkspace: need   2*M [tauq, taup] + M    [work]</span>
<span class="c">!              CWorkspace: prefer 2*M [tauq, taup] + M*NB [work]</span>
<span class="c">!              RWorkspace: need   M [e] + M*M [RVT] + M*M [RU]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLACP2</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNMBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy real matrix RWORK(IRVT) to complex matrix VT</span>
<span class="c">!              Overwrite VT by right singular vectors of A</span>
<span class="c">!              CWorkspace: need   2*M [tauq, taup] + M    [work]</span>
<span class="c">!              CWorkspace: prefer 2*M [tauq, taup] + M*NB [work]</span>
<span class="c">!              RWorkspace: need   M [e] + M*M [RVT]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLASET</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLACP2</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNMBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">ELSE</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 6ta (N &gt; M, JOBZ=&#39;A&#39;)</span>
<span class="c">!              Perform bidiagonal SVD, computing left singular vectors</span>
<span class="c">!              of bidiagonal matrix in RWORK(IRU) and computing right</span>
<span class="c">!              singular vectors of bidiagonal matrix in RWORK(IRVT)</span>
<span class="c">!              CWorkspace: need   0</span>
<span class="c">!              RWorkspace: need   M [e] + M*M [RVT] + M*M [RU] + BDSPAC</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">irvt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nrwork</span><span class="w"></span>
<span class="w">            </span><span class="n">iru</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">irvt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">nrwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iru</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">M</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">nrwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy real matrix RWORK(IRU) to complex matrix U</span>
<span class="c">!              Overwrite U by left singular vectors of A</span>
<span class="c">!              CWorkspace: need   2*M [tauq, taup] + M    [work]</span>
<span class="c">!              CWorkspace: prefer 2*M [tauq, taup] + M*NB [work]</span>
<span class="c">!              RWorkspace: need   M [e] + M*M [RVT] + M*M [RU]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLACP2</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iru</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNMBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Set all of VT to identity matrix</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLASET</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">CONE</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy real matrix RWORK(IRVT) to complex matrix VT</span>
<span class="c">!              Overwrite VT by right singular vectors of A</span>
<span class="c">!              CWorkspace: need   2*M [tauq, taup] + N    [work]</span>
<span class="c">!              CWorkspace: prefer 2*M [tauq, taup] + N*NB [work]</span>
<span class="c">!              RWorkspace: need   M [e] + M*M [RVT]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLACP2</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">irvt</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CUNMBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Undo scaling if necessary</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iscl</span><span class="o">==</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">anrm</span><span class="o">&gt;</span><span class="n">bignum</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">CALL </span><span class="n">SLASCL</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">bignum</span><span class="p">,</span><span class="n">anrm</span><span class="p">,</span><span class="n">minmn</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                                  </span><span class="n">minmn</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Info</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">anrm</span><span class="o">&gt;</span><span class="n">bignum</span><span class="w"> </span><span class="p">)</span><span class="w">                               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="k">CALL </span><span class="n">SLASCL</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">bignum</span><span class="p">,</span><span class="n">anrm</span><span class="p">,</span><span class="n">minmn</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">minmn</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">anrm</span><span class="o">&lt;</span><span class="n">smlnum</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">CALL </span><span class="n">SLASCL</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">smlnum</span><span class="p">,</span><span class="n">anrm</span><span class="p">,</span><span class="n">minmn</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                                  </span><span class="n">minmn</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Info</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">anrm</span><span class="o">&lt;</span><span class="n">smlnum</span><span class="w"> </span><span class="p">)</span><span class="w">                               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="k">CALL </span><span class="n">SLASCL</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">smlnum</span><span class="p">,</span><span class="n">anrm</span><span class="p">,</span><span class="n">minmn</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">minmn</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Return optimal workspace in WORK(1)</span>
<span class="c">!</span>
<span class="w">      </span><span class="n">Work</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">maxwrk</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!</span>
<span class="c">!     End of CGESDD</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">END SUBROUTINE </span><span class="n">CGESDD</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              spag_lapack
 was developed by John S. Urban<br>              &copy; 2025 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2025-07-11 01:31 +0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>