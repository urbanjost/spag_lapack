<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="spag_lapack module">
    <meta name="author" content="John S. Urban" >
    <link rel="icon" href="../favicon.png">

    <title>SGESDD &ndash; spag_lapack</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">spag_lapack </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>SGESDD
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 0.2% of total for procedures.">495 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/sgesdd.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/sgesdd.f90.html'>sgesdd.f90</a></li>
            <li class="breadcrumb-item active" aria-current="page">SGESDD</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#vars-0"
         aria-expanded="false" aria-controls="vars-0">
         <h4 class="card-header bg-primary text-white">Variables</h4>
      </a>
      <div id="vars-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../proc/sgesdd.html#variable-one~487">ONE</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-zero~461">ZERO</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-anrm~61">anrm</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-bdspac~3">bdspac</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-bignum~102">bignum</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-blk~3">blk</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-chunk~6">chunk</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-dum~18">dum</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-eps~128">eps</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-i~529">i</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-idum~8">idum</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-ie~11">ie</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-ierr~42">ierr</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-il~8">il</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-ir~5">ir</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-iscl~4">iscl</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-itau~27">itau</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-itaup~8">itaup</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-itauq~8">itauq</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-iu~3">iu</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-ivt~2">ivt</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-ldwkvt~2">ldwkvt</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-ldwrkl~2">ldwrkl</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-ldwrkr~3">ldwrkr</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-ldwrku~3">ldwrku</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-lquery~186">lquery</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-lwork_sgebrd_mm">lwork_sgebrd_mm</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-lwork_sgebrd_mn">lwork_sgebrd_mn</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-lwork_sgebrd_nn">lwork_sgebrd_nn</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-lwork_sgelqf_mn">lwork_sgelqf_mn</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-lwork_sgeqrf_mn">lwork_sgeqrf_mn</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-lwork_sorgbr_p_mm">lwork_sorgbr_p_mm</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-lwork_sorgbr_q_nn">lwork_sorgbr_q_nn</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-lwork_sorglq_mn">lwork_sorglq_mn</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-lwork_sorglq_nn">lwork_sorglq_nn</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-lwork_sorgqr_mm">lwork_sorgqr_mm</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-lwork_sorgqr_mn">lwork_sorgqr_mn</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-lwork_sormbr_prt_mm">lwork_sormbr_prt_mm</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-lwork_sormbr_prt_mn">lwork_sormbr_prt_mn</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-lwork_sormbr_prt_nn">lwork_sormbr_prt_nn</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-lwork_sormbr_qln_mm">lwork_sormbr_qln_mm</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-lwork_sormbr_qln_mn">lwork_sormbr_qln_mn</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-lwork_sormbr_qln_nn">lwork_sormbr_qln_nn</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-maxwrk~22">maxwrk</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-minmn~12">minmn</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-minwrk~24">minwrk</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-mnthr~7">mnthr</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-nwork~3">nwork</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-smlnum~122">smlnum</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-wntqa~2">wntqa</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-wntqas~2">wntqas</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-wntqn~2">wntqn</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-wntqo~2">wntqo</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-wntqs~2">wntqs</a>
            <a class="list-group-item" href="../proc/sgesdd.html#variable-wrkbl~3">wrkbl</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/sgesdd.html#src">SGESDD</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2> subroutine SGESDD(Jobz, M, N, A, Lda, S, U, Ldu, Vt, Ldvt, Work, Lwork, Iwork, Info)  
</h2>
    

    <p>\brief \b SGESDD
 \htmlonly
 Download SGESDD + dependencies
 <a href="http://www.netlib.org/cgi-bin/netlibfiles.tgz?format=tgz&filename=/lapack/lapack_routine/sgesdd.f">
 [TGZ]</a>
 <a href="http://www.netlib.org/cgi-bin/netlibfiles.zip?format=zip&filename=/lapack/lapack_routine/sgesdd.f">
 [ZIP]</a>
 <a href="http://www.netlib.org/cgi-bin/netlibfiles.txt?format=txt&filename=/lapack/lapack_routine/sgesdd.f">
 [TXT]</a>
 \endhtmlonly
 \par Purpose:</p>
<p>\verbatim</p>
<p>SGESDD computes the singular value decomposition (SVD) of a real
 M-by-N matrix A, optionally computing the left and right singular
 vectors.  If singular vectors are desired, it uses a
 divide-and-conquer algorithm.</p>
<p>The SVD is written</p>
<div class="codehilite"><pre><span></span><code>  A = U * SIGMA * transpose(V)
</code></pre></div>

<p>where SIGMA is an M-by-N matrix which is zero except for its
 min(m,n) diagonal elements, U is an M-by-M orthogonal matrix, and
 V is an N-by-N orthogonal matrix.  The diagonal elements of SIGMA
 are the singular values of A; they are real and non-negative, and
 are returned in descending order.  The first min(m,n) columns of
 U and V are the left and right singular vectors of A.</p>
<p>Note that the routine returns VT = V**T, not V.</p>
<p>The divide and conquer algorithm makes very mild assumptions about
 floating point arithmetic. It will work on machines with a guard
 digit in add/subtract, or on those binary machines without guard
 digits which subtract like the Cray X-MP, Cray Y-MP, Cray C-90, or
 Cray-2. It could conceivably fail on hexadecimal or decimal machines
 without guard digits, but we know of none.
 \endverbatim
 \param[in] JOBZ
 \verbatim
          JOBZ is CHARACTER<em>1
          Specifies options for computing all or part of the matrix U:
          = &lsquo;A&rsquo;:  all M columns of U and all N rows of V</em><em>T are
                  returned in the arrays U and VT;
          = &lsquo;S&rsquo;:  the first min(M,N) columns of U and the first
                  min(M,N) rows of V</em><em>T are returned in the arrays U
                  and VT;
          = &lsquo;O&rsquo;:  If M &gt;= N, the first N columns of U are overwritten
                  on the array A and all rows of V</em><em>T are returned in
                  the array VT;
                  otherwise, all columns of U are returned in the
                  array U and the first M rows of V</em><em>T are overwritten
                  in the array A;
          = &lsquo;N&rsquo;:  no columns of U or rows of V</em>*T are computed.
 \endverbatim</p>
<p>\param[in] M
 \verbatim
          M is INTEGER
          The number of rows of the input matrix A.  M &gt;= 0.
 \endverbatim</p>
<p>\param[in] N
 \verbatim
          N is INTEGER
          The number of columns of the input matrix A.  N &gt;= 0.
 \endverbatim</p>
<p>\param[in,out] A
 \verbatim
          A is REAL array, dimension (LDA,N)
          On entry, the M-by-N matrix A.
          On exit,
          if JOBZ = &lsquo;O&rsquo;,  A is overwritten with the first N columns
                          of U (the left singular vectors, stored
                          columnwise) if M &gt;= N;
                          A is overwritten with the first M rows
                          of V**T (the right singular vectors, stored
                          rowwise) otherwise.
          if JOBZ .ne. &lsquo;O&rsquo;, the contents of A are destroyed.
 \endverbatim</p>
<p>\param[in] LDA
 \verbatim
          LDA is INTEGER
          The leading dimension of the array A.  LDA &gt;= max(1,M).
 \endverbatim</p>
<p>\param[out] S
 \verbatim
          S is REAL array, dimension (min(M,N))
          The singular values of A, sorted so that S(i) &gt;= S(i+1).
 \endverbatim</p>
<p>\param[out] U
 \verbatim
          U is REAL array, dimension (LDU,UCOL)
          UCOL = M if JOBZ = &lsquo;A&rsquo; or JOBZ = &lsquo;O&rsquo; and M &lt; N;
          UCOL = min(M,N) if JOBZ = &lsquo;S&rsquo;.
          If JOBZ = &lsquo;A&rsquo; or JOBZ = &lsquo;O&rsquo; and M &lt; N, U contains the M-by-M
          orthogonal matrix U;
          if JOBZ = &lsquo;S&rsquo;, U contains the first min(M,N) columns of U
          (the left singular vectors, stored columnwise);
          if JOBZ = &lsquo;O&rsquo; and M &gt;= N, or JOBZ = &lsquo;N&rsquo;, U is not referenced.
 \endverbatim</p>
<p>\param[in] LDU
 \verbatim
          LDU is INTEGER
          The leading dimension of the array U.  LDU &gt;= 1; if
          JOBZ = &lsquo;S&rsquo; or &lsquo;A&rsquo; or JOBZ = &lsquo;O&rsquo; and M &lt; N, LDU &gt;= M.
 \endverbatim</p>
<p>\param[out] VT
 \verbatim
          VT is REAL array, dimension (LDVT,N)
          If JOBZ = &lsquo;A&rsquo; or JOBZ = &lsquo;O&rsquo; and M &gt;= N, VT contains the
          N-by-N orthogonal matrix V<strong>T;
          if JOBZ = &lsquo;S&rsquo;, VT contains the first min(M,N) rows of
          V</strong>T (the right singular vectors, stored rowwise);
          if JOBZ = &lsquo;O&rsquo; and M &lt; N, or JOBZ = &lsquo;N&rsquo;, VT is not referenced.
 \endverbatim</p>
<p>\param[in] LDVT
 \verbatim
          LDVT is INTEGER
          The leading dimension of the array VT.  LDVT &gt;= 1;
          if JOBZ = &lsquo;A&rsquo; or JOBZ = &lsquo;O&rsquo; and M &gt;= N, LDVT &gt;= N;
          if JOBZ = &lsquo;S&rsquo;, LDVT &gt;= min(M,N).
 \endverbatim</p>
<p>\param[out] WORK
 \verbatim
          WORK is REAL array, dimension (MAX(1,LWORK))
          On exit, if INFO = 0, WORK(1) returns the optimal LWORK;
 \endverbatim</p>
<p>\param[in] LWORK
 \verbatim
          LWORK is INTEGER
          The dimension of the array WORK. LWORK &gt;= 1.
          If LWORK = -1, a workspace query is assumed.  The optimal
          size for the WORK array is calculated and stored in WORK(1),
          and no other work except argument checking is performed.</p>
<div class="codehilite"><pre><span></span><code>      <span class="nv">Let</span> <span class="nv">mx</span> <span class="o">=</span> <span class="nv">max</span><span class="ss">(</span><span class="nv">M</span>,<span class="nv">N</span><span class="ss">)</span> <span class="nv">and</span> <span class="nv">mn</span> <span class="o">=</span> <span class="nv">min</span><span class="ss">(</span><span class="nv">M</span>,<span class="nv">N</span><span class="ss">)</span>.
      <span class="k">If</span> <span class="nv">JOBZ</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">N</span><span class="s1">&#39;</span>, <span class="nv">LWORK</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="o">*</span><span class="nv">mn</span> <span class="o">+</span> <span class="nv">max</span><span class="ss">(</span> <span class="nv">mx</span>, <span class="mi">7</span><span class="o">*</span><span class="nv">mn</span> <span class="ss">)</span>.
      <span class="k">If</span> <span class="nv">JOBZ</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">O</span><span class="s1">&#39;</span>, <span class="nv">LWORK</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="o">*</span><span class="nv">mn</span> <span class="o">+</span> <span class="nv">max</span><span class="ss">(</span> <span class="nv">mx</span>, <span class="mi">5</span><span class="o">*</span><span class="nv">mn</span><span class="o">*</span><span class="nv">mn</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="nv">mn</span> <span class="ss">)</span>.
      <span class="k">If</span> <span class="nv">JOBZ</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">S</span><span class="s1">&#39;</span>, <span class="nv">LWORK</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="o">*</span><span class="nv">mn</span><span class="o">*</span><span class="nv">mn</span> <span class="o">+</span> <span class="mi">7</span><span class="o">*</span><span class="nv">mn</span>.
      <span class="k">If</span> <span class="nv">JOBZ</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">A</span><span class="s1">&#39;</span>, <span class="nv">LWORK</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="o">*</span><span class="nv">mn</span><span class="o">*</span><span class="nv">mn</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="nv">mn</span> <span class="o">+</span> <span class="nv">mx</span>.
      <span class="nv">These</span> <span class="nv">are</span> <span class="nv">not</span> <span class="nv">tight</span> <span class="nv">minimums</span> <span class="nv">in</span> <span class="nv">all</span> <span class="nv">cases</span><span class="c1">; see comments inside code.</span>
      <span class="k">For</span> <span class="nv">good</span> <span class="nv">performance</span>, <span class="nv">LWORK</span> <span class="nv">should</span> <span class="nv">generally</span> <span class="nv">be</span> <span class="nv">larger</span><span class="c1">;</span>
      <span class="nv">a</span> <span class="nv">query</span> <span class="nv">is</span> <span class="nv">recommended</span>.
</code></pre></div>

<p>\endverbatim</p>
<p>\param[out] IWORK
 \verbatim
          IWORK is INTEGER array, dimension (8*min(M,N))
 \endverbatim</p>
<p>\param[out] INFO
 \verbatim
          INFO is INTEGER
          = 0:  successful exit.
          &lt; 0:  if INFO = -i, the i-th argument had an illegal value.
          &gt; 0:  SBDSDC did not converge, updating process failed.
 \endverbatim
 \author Univ. of Tennessee
 \author Univ. of California Berkeley
 \author Univ. of Colorado Denver
 \author NAG Ltd.
 \date June 2016
 \ingroup realGEsing
 \par Contributors:</p>
<div class="codehilite"><pre><span></span><code> Ming Gu and Huan Ren, Computer Science Division, University of
 California at Berkeley, USA
</code></pre></div>

<p>&ndash;SGESDD222</p>
<p>&ndash; LAPACK driver routine (version 3.7.0) &ndash;
  &ndash; LAPACK is a software package provided by Univ. of Tennessee,    &ndash;
  &ndash; Univ. of California Berkeley, Univ. of Colorado Denver and NAG Ltd..&ndash;
     June 2016</p>
<div class="codehilite"><pre><span></span><code> .. Scalar Arguments ..
</code></pre></div>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-jobz~49"></span>
              character(len=1)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Jobz</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-m~262"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>M</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-n~737"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>N</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-a~445"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>A</strong>(Lda,*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lda~429"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Lda</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s~53"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>S</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-u~22"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>U</strong>(Ldu,*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldu~22"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ldu</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-vt~11"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Vt</strong>(Ldvt,*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldvt~11"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ldvt</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-work~428"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Work</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork~200"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Lwork</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iwork~103"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Iwork</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-info~581"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Info</strong></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    <br>


    <section>    
      <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-one~487"></span>
              real,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>ONE</strong></td>
<td> =</td>
                <td>1.0E0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-zero~461"></span>
              real,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>ZERO</strong></td>
<td> =</td>
                <td>0.0E0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-anrm~61"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>anrm</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-bdspac~3"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>bdspac</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-bignum~102"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>bignum</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-blk~3"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>blk</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-chunk~6"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>chunk</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-dum~18"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>dum</strong>(1)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-eps~128"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>eps</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-i~529"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>i</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-idum~8"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>idum</strong>(1)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ie~11"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ie</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ierr~42"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ierr</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-il~8"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>il</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ir~5"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ir</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iscl~4"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iscl</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-itau~27"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>itau</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-itaup~8"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>itaup</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-itauq~8"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>itauq</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iu~3"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iu</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ivt~2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ivt</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldwkvt~2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ldwkvt</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldwrkl~2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ldwrkl</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldwrkr~3"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ldwrkr</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldwrku~3"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ldwrku</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lquery~186"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lquery</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_sgebrd_mm"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_sgebrd_mm</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_sgebrd_mn"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_sgebrd_mn</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_sgebrd_nn"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_sgebrd_nn</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_sgelqf_mn"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_sgelqf_mn</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_sgeqrf_mn"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_sgeqrf_mn</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_sorgbr_p_mm"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_sorgbr_p_mm</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_sorgbr_q_nn"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_sorgbr_q_nn</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_sorglq_mn"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_sorglq_mn</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_sorglq_nn"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_sorglq_nn</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_sorgqr_mm"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_sorgqr_mm</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_sorgqr_mn"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_sorgqr_mn</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_sormbr_prt_mm"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_sormbr_prt_mm</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_sormbr_prt_mn"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_sormbr_prt_mn</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_sormbr_prt_nn"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_sormbr_prt_nn</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_sormbr_qln_mm"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_sormbr_qln_mm</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_sormbr_qln_mn"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_sormbr_qln_mn</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork_sormbr_qln_nn"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwork_sormbr_qln_nn</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxwrk~22"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxwrk</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-minmn~12"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>minmn</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-minwrk~24"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>minwrk</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-mnthr~7"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>mnthr</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nwork~3"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nwork</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-smlnum~122"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>smlnum</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wntqa~2"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wntqa</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wntqas~2"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wntqas</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wntqn~2"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wntqn</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wntqo~2"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wntqo</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wntqs~2"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wntqs</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wrkbl~3"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wrkbl</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">      </span><span class="k">SUBROUTINE </span><span class="n">SGESDD</span><span class="p">(</span><span class="n">Jobz</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="n">Work</span><span class="p">,</span><span class="n">Lwork</span><span class="p">,</span><span class="n">Iwork</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">IMPLICIT NONE</span><span class="w"></span>
<span class="c">!*--SGESDD222</span>
<span class="c">!</span>
<span class="c">!  -- LAPACK driver routine (version 3.7.0) --</span>
<span class="c">!  -- LAPACK is a software package provided by Univ. of Tennessee,    --</span>
<span class="c">!  -- Univ. of California Berkeley, Univ. of Colorado Denver and NAG Ltd..--</span>
<span class="c">!     June 2016</span>
<span class="c">!</span>
<span class="c">!     .. Scalar Arguments ..</span>
<span class="w">      </span><span class="kt">CHARACTER </span><span class="n">Jobz</span><span class="w"></span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">Info</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Lda</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Ldu</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Ldvt</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Lwork</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Array Arguments ..</span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">Iwork</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="kt">REAL </span><span class="n">A</span><span class="p">(</span><span class="n">Lda</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">S</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">U</span><span class="p">(</span><span class="n">Ldu</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Vt</span><span class="p">(</span><span class="n">Ldvt</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!</span>
<span class="c">!  =====================================================================</span>
<span class="c">!</span>
<span class="c">!     .. Parameters ..</span>
<span class="w">      </span><span class="kt">REAL </span><span class="n">ZERO</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ONE</span><span class="w"></span>
<span class="w">      </span><span class="k">PARAMETER</span><span class="w"> </span><span class="p">(</span><span class="n">ZERO</span><span class="o">=</span><span class="mf">0.0E0</span><span class="p">,</span><span class="n">ONE</span><span class="o">=</span><span class="mf">1.0E0</span><span class="p">)</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Local Scalars ..</span>
<span class="w">      </span><span class="kt">LOGICAL </span><span class="n">lquery</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">wntqa</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">wntqas</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">wntqn</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">wntqo</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">wntqs</span><span class="w"></span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">bdspac</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">blk</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">chunk</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">il</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ir</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">iscl</span><span class="w"> </span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">itau</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">itaup</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">itauq</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">iu</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ivt</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ldwkvt</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ldwrkl</span><span class="w"> </span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">ldwrkr</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ldwrku</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">maxwrk</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">minmn</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">minwrk</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">mnthr</span><span class="w"> </span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">nwork</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">wrkbl</span><span class="w"></span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">lwork_sgebrd_mn</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lwork_sgebrd_mm</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lwork_sgebrd_nn</span><span class="w"> </span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">lwork_sgelqf_mn</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lwork_sgeqrf_mn</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lwork_sorgbr_p_mm</span><span class="w"> </span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">lwork_sorgbr_q_nn</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lwork_sorglq_mn</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lwork_sorglq_nn</span><span class="w"> </span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">lwork_sorgqr_mm</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lwork_sorgqr_mn</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lwork_sormbr_prt_mm</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">lwork_sormbr_qln_mm</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lwork_sormbr_prt_mn</span><span class="w"> </span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">lwork_sormbr_qln_mn</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lwork_sormbr_prt_nn</span><span class="w"> </span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">lwork_sormbr_qln_nn</span><span class="w"></span>
<span class="w">      </span><span class="kt">REAL </span><span class="n">anrm</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">bignum</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">eps</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">smlnum</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Local Arrays ..</span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">idum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="kt">REAL </span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. External Subroutines ..</span>
<span class="w">      </span><span class="k">EXTERNAL </span><span class="n">SBDSDC</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">SGEBRD</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">SGELQF</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">SGEMM</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">SGEQRF</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">SLACPY</span><span class="w"> </span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">         </span><span class="n">SLASCL</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">SLASET</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">SORGBR</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">SORGLQ</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">SORGQR</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">SORMBR</span><span class="w"> </span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">         </span><span class="n">XERBLA</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. External Functions ..</span>
<span class="w">      </span><span class="kt">LOGICAL </span><span class="n">LSAME</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">SISNAN</span><span class="w"></span>
<span class="w">      </span><span class="kt">REAL </span><span class="n">SLAMCH</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">SLANGE</span><span class="w"></span>
<span class="w">      </span><span class="k">EXTERNAL </span><span class="n">SLAMCH</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">SLANGE</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">LSAME</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">SISNAN</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Intrinsic Functions ..</span>
<span class="w">      </span><span class="k">INTRINSIC </span><span class="nb">INT</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nb">MAX</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nb">MIN</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nb">SQRT</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Executable Statements ..</span>
<span class="c">!</span>
<span class="c">!     Test the input arguments</span>
<span class="c">!</span>
<span class="w">      </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">minmn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">wntqa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LSAME</span><span class="p">(</span><span class="n">Jobz</span><span class="p">,</span><span class="s1">&#39;A&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">wntqs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LSAME</span><span class="p">(</span><span class="n">Jobz</span><span class="p">,</span><span class="s1">&#39;S&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">wntqas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wntqa</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">wntqs</span><span class="w"></span>
<span class="w">      </span><span class="n">wntqo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LSAME</span><span class="p">(</span><span class="n">Jobz</span><span class="p">,</span><span class="s1">&#39;O&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">wntqn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LSAME</span><span class="p">(</span><span class="n">Jobz</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">lquery</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Lwork</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.(</span><span class="n">wntqa</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">wntqs</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">wntqo</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">wntqn</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">M</span><span class="o">&lt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">N</span><span class="o">&lt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Lda</span><span class="o">&lt;</span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">5</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Ldu</span><span class="o">&lt;</span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">wntqas</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">Ldu</span><span class="o">&lt;</span><span class="n">M</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w">                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">         </span><span class="p">(</span><span class="n">wntqo</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">M</span><span class="o">&lt;</span><span class="n">N</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">Ldu</span><span class="o">&lt;</span><span class="n">M</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">8</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Ldvt</span><span class="o">&lt;</span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">wntqa</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">Ldvt</span><span class="o">&lt;</span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w">                    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">         </span><span class="p">(</span><span class="n">wntqs</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">Ldvt</span><span class="o">&lt;</span><span class="n">minmn</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w">                            </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">         </span><span class="p">(</span><span class="n">wntqo</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">M</span><span class="o">&gt;=</span><span class="n">N</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">Ldvt</span><span class="o">&lt;</span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">10</span><span class="w"></span>
<span class="w">      </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Compute workspace</span>
<span class="c">!       Note: Comments in the code beginning &quot;Workspace:&quot; describe the</span>
<span class="c">!       minimal amount of workspace allocated at that point in the code,</span>
<span class="c">!       as well as the preferred amount for good performance.</span>
<span class="c">!       NB refers to the optimal block size for the immediately</span>
<span class="c">!       following subroutine, as returned by ILAENV.</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Info</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="n">bdspac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">         </span><span class="n">mnthr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">minmn</span><span class="o">*</span><span class="mi">1</span><span class="mf">1.0E0</span><span class="o">/</span><span class="mf">6.0E0</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">M</span><span class="o">&gt;=</span><span class="n">N</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">minmn</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Compute space needed for SBDSDC</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqn</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!              sbdsdc needs only 4*N (or 6*N for uplo=L for LAPACK &lt;= 3.6)</span>
<span class="c">!              keep 7*N for backwards compatibility.</span>
<span class="w">               </span><span class="n">bdspac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">            </span><span class="k">ELSE</span>
<span class="k">               </span><span class="n">bdspac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Compute space preferred for each routine</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SGEBRD</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_sgebrd_mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SGEBRD</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_sgebrd_nn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SGEQRF</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_sgeqrf_mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORGBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_sorgbr_q_nn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORGQR</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_sorgqr_mm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORGQR</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_sorgqr_mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORMBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_sormbr_prt_nn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORMBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_sormbr_qln_nn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORMBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_sormbr_qln_mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORMBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_sormbr_qln_mm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">M</span><span class="o">&lt;</span><span class="n">mnthr</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 5 (M &gt;= N, but not much larger)</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lwork_sgebrd_mn</span><span class="w"></span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqn</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                 Path 5n (M &gt;= N, jobz=&#39;N&#39;)</span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">bdspac</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">bdspac</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqo</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                 Path 5o (M &gt;= N, jobz=&#39;O&#39;)</span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_sormbr_prt_nn</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_sormbr_qln_mn</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">bdspac</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">                  </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">bdspac</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqs</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                 Path 5s (M &gt;= N, jobz=&#39;S&#39;)</span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_sormbr_qln_mn</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_sormbr_prt_nn</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">bdspac</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">bdspac</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqa</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                 Path 5a (M &gt;= N, jobz=&#39;A&#39;)</span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_sormbr_qln_mm</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_sormbr_prt_nn</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">bdspac</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">bdspac</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span>
<span class="k">            </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqn</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Path 1 (M &gt;&gt; N, JOBZ=&#39;N&#39;)</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lwork_sgeqrf_mn</span><span class="w"></span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_sgebrd_nn</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="n">bdspac</span><span class="o">+</span><span class="n">N</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bdspac</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">            </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqo</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Path 2 (M &gt;&gt; N, JOBZ=&#39;O&#39;)</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lwork_sgeqrf_mn</span><span class="w"></span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_sorgqr_mn</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_sgebrd_nn</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_sormbr_qln_nn</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_sormbr_prt_nn</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">bdspac</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bdspac</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">            </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqs</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Path 3 (M &gt;&gt; N, JOBZ=&#39;S&#39;)</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lwork_sgeqrf_mn</span><span class="w"></span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_sorgqr_mn</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_sgebrd_nn</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_sormbr_qln_nn</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_sormbr_prt_nn</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">bdspac</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bdspac</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">            </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqa</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Path 4 (M &gt;&gt; N, JOBZ=&#39;A&#39;)</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lwork_sgeqrf_mn</span><span class="w"></span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_sorgqr_mm</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_sgebrd_nn</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_sormbr_qln_nn</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">lwork_sormbr_prt_nn</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">bdspac</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">bdspac</span><span class="p">,</span><span class="n">N</span><span class="o">+</span><span class="n">M</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span>
<span class="k">         </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">minmn</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Compute space needed for SBDSDC</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqn</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!              sbdsdc needs only 4*N (or 6*N for uplo=L for LAPACK &lt;= 3.6)</span>
<span class="c">!              keep 7*N for backwards compatibility.</span>
<span class="w">               </span><span class="n">bdspac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="k">ELSE</span>
<span class="k">               </span><span class="n">bdspac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Compute space preferred for each routine</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SGEBRD</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_sgebrd_mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SGEBRD</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_sgebrd_mm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SGELQF</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_sgelqf_mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORGLQ</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_sorglq_nn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORGLQ</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_sorglq_mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORGBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_sorgbr_p_mm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORMBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_sormbr_prt_mm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORMBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_sormbr_prt_mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORMBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_sormbr_prt_nn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORMBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lwork_sormbr_qln_mm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">dum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">N</span><span class="o">&lt;</span><span class="n">mnthr</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 5t (N &gt; M, but not much larger)</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lwork_sgebrd_mn</span><span class="w"></span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqn</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                 Path 5tn (N &gt; M, jobz=&#39;N&#39;)</span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">bdspac</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">bdspac</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqo</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                 Path 5to (N &gt; M, jobz=&#39;O&#39;)</span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_sormbr_qln_mm</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_sormbr_prt_mn</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">bdspac</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">                  </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">bdspac</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqs</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                 Path 5ts (N &gt; M, jobz=&#39;S&#39;)</span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_sormbr_qln_mm</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_sormbr_prt_mn</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">bdspac</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">bdspac</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqa</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                 Path 5ta (N &gt; M, jobz=&#39;A&#39;)</span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_sormbr_qln_mm</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_sormbr_prt_nn</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">bdspac</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">bdspac</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span>
<span class="k">            </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqn</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Path 1t (N &gt;&gt; M, JOBZ=&#39;N&#39;)</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lwork_sgelqf_mn</span><span class="w"></span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_sgebrd_mm</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="n">bdspac</span><span class="o">+</span><span class="n">M</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bdspac</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqo</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Path 2t (N &gt;&gt; M, JOBZ=&#39;O&#39;)</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lwork_sgelqf_mn</span><span class="w"></span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_sorglq_mn</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_sgebrd_mm</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_sormbr_qln_mm</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_sormbr_prt_mm</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">bdspac</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">               </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bdspac</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqs</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Path 3t (N &gt;&gt; M, JOBZ=&#39;S&#39;)</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lwork_sgelqf_mn</span><span class="w"></span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_sorglq_mn</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_sgebrd_mm</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_sormbr_qln_mm</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_sormbr_prt_mm</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">bdspac</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">               </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bdspac</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqa</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Path 4t (N &gt;&gt; M, JOBZ=&#39;A&#39;)</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lwork_sgelqf_mn</span><span class="w"></span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_sorglq_nn</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_sgebrd_mm</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_sormbr_qln_mm</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">lwork_sormbr_prt_mm</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">wrkbl</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">bdspac</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wrkbl</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">               </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">bdspac</span><span class="p">,</span><span class="n">M</span><span class="o">+</span><span class="n">N</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span>
<span class="k">         ENDIF</span>
<span class="k"> </span>
<span class="k">         </span><span class="n">maxwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">maxwrk</span><span class="p">,</span><span class="n">minwrk</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">Work</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">maxwrk</span><span class="w"></span>
<span class="c">!</span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Lwork</span><span class="o">&lt;</span><span class="n">minwrk</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">lquery</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">12</span><span class="w"></span>
<span class="w">      </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Info</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         CALL </span><span class="n">XERBLA</span><span class="p">(</span><span class="s1">&#39;SGESDD&#39;</span><span class="p">,</span><span class="o">-</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">RETURN</span>
<span class="k">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">lquery</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         RETURN</span>
<span class="k">      ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Quick return if possible</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">M</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">N</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">RETURN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Get machine constants</span>
<span class="c">!</span>
<span class="w">      </span><span class="n">eps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SLAMCH</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">smlnum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">SQRT</span><span class="p">(</span><span class="n">SLAMCH</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">))</span><span class="o">/</span><span class="n">eps</span><span class="w"></span>
<span class="w">      </span><span class="n">bignum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ONE</span><span class="o">/</span><span class="n">smlnum</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Scale A if max element outside range [SMLNUM,BIGNUM]</span>
<span class="c">!</span>
<span class="w">      </span><span class="n">anrm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SLANGE</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">dum</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">SISNAN</span><span class="p">(</span><span class="n">anrm</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span><span class="w"></span>
<span class="w">         </span><span class="k">RETURN</span>
<span class="k">      ENDIF</span>
<span class="k">      </span><span class="n">iscl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">anrm</span><span class="o">&gt;</span><span class="n">ZERO</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">anrm</span><span class="o">&lt;</span><span class="n">smlnum</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">iscl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">CALL </span><span class="n">SLASCL</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">anrm</span><span class="p">,</span><span class="n">smlnum</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">anrm</span><span class="o">&gt;</span><span class="n">bignum</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">iscl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">CALL </span><span class="n">SLASCL</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">anrm</span><span class="p">,</span><span class="n">bignum</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">M</span><span class="o">&gt;=</span><span class="n">N</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!        A has at least as many rows as columns. If A has sufficiently</span>
<span class="c">!        more rows than columns, first reduce using the QR</span>
<span class="c">!        decomposition (if sufficient workspace available)</span>
<span class="c">!</span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">M</span><span class="o">&lt;</span><span class="n">mnthr</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           M .LT. MNTHR</span>
<span class="c">!</span>
<span class="c">!           Path 5 (M &gt;= N, but not much larger)</span>
<span class="c">!           Reduce to bidiagonal form without QR decomposition</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">ie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">itauq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">            </span><span class="n">itaup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itauq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">            </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itaup</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Bidiagonalize A</span>
<span class="c">!           Workspace: need   3*N [e, tauq, taup] + M        [work]</span>
<span class="c">!           Workspace: prefer 3*N [e, tauq, taup] + (M+N)*NB [work]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SGEBRD</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqn</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 5n (M &gt;= N, JOBZ=&#39;N&#39;)</span>
<span class="c">!              Perform bidiagonal SVD, only computing singular values</span>
<span class="c">!              Workspace: need   3*N [e, tauq, taup] + BDSPAC</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">dum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqo</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!              Path 5o (M &gt;= N, JOBZ=&#39;O&#39;)</span>
<span class="w">               </span><span class="n">iu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nwork</span><span class="w"></span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Lwork</span><span class="o">&gt;=</span><span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">bdspac</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 WORK( IU ) is M by N</span>
<span class="c">!</span>
<span class="w">                  </span><span class="n">ldwrku</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">                  </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iu</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ldwrku</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">                  </span><span class="k">CALL </span><span class="n">SLASET</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">iu</span><span class="p">),</span><span class="n">ldwrku</span><span class="p">)</span><span class="w"></span>
<span class="c">!                 IR is unused; silence compile warnings</span>
<span class="w">                  </span><span class="n">ir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="k">ELSE</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 WORK( IU ) is N by N</span>
<span class="c">!</span>
<span class="w">                  </span><span class="n">ldwrku</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">                  </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iu</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ldwrku</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 WORK(IR) is LDWRKR by N</span>
<span class="c">!</span>
<span class="w">                  </span><span class="n">ir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nwork</span><span class="w"></span>
<span class="w">                  </span><span class="n">ldwrkr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Lwork</span><span class="o">-</span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="n">N</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span>
<span class="k">               </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iu</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ldwrku</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Perform bidiagonal SVD, computing left singular vectors</span>
<span class="c">!              of bidiagonal matrix in WORK(IU) and computing right</span>
<span class="c">!              singular vectors of bidiagonal matrix in VT</span>
<span class="c">!              Workspace: need   3*N [e, tauq, taup] + N*N [U] + BDSPAC</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">iu</span><span class="p">),</span><span class="n">ldwrku</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Overwrite VT by right singular vectors of A</span>
<span class="c">!              Workspace: need   3*N [e, tauq, taup] + N*N [U] + N    [work]</span>
<span class="c">!              Workspace: prefer 3*N [e, tauq, taup] + N*N [U] + N*NB [work]</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">SORMBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Lwork</span><span class="o">&gt;=</span><span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">bdspac</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Path 5o-fast</span>
<span class="c">!                 Overwrite WORK(IU) by left singular vectors of A</span>
<span class="c">!                 Workspace: need   3*N [e, tauq, taup] + M*N [U] + N    [work]</span>
<span class="c">!                 Workspace: prefer 3*N [e, tauq, taup] + M*N [U] + N*NB [work]</span>
<span class="c">!</span>
<span class="w">                  </span><span class="k">CALL </span><span class="n">SORMBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                        </span><span class="n">Work</span><span class="p">(</span><span class="n">iu</span><span class="p">),</span><span class="n">ldwrku</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                        </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Copy left singular vectors of A from WORK(IU) to A</span>
<span class="c">!</span>
<span class="w">                  </span><span class="k">CALL </span><span class="n">SLACPY</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">iu</span><span class="p">),</span><span class="n">ldwrku</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">ELSE</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Path 5o-slow</span>
<span class="c">!                 Generate Q in A</span>
<span class="c">!                 Workspace: need   3*N [e, tauq, taup] + N*N [U] + N    [work]</span>
<span class="c">!                 Workspace: prefer 3*N [e, tauq, taup] + N*N [U] + N*NB [work]</span>
<span class="c">!</span>
<span class="w">                  </span><span class="k">CALL </span><span class="n">SORGBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                        </span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Multiply Q in A by left singular vectors of</span>
<span class="c">!                 bidiagonal matrix in WORK(IU), storing result in</span>
<span class="c">!                 WORK(IR) and copying to A</span>
<span class="c">!                 Workspace: need   3*N [e, tauq, taup] + N*N [U] + NB*N [R]</span>
<span class="c">!                 Workspace: prefer 3*N [e, tauq, taup] + N*N [U] + M*N  [R]</span>
<span class="c">!</span>
<span class="w">                  </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ldwrkr</span><span class="w"></span>
<span class="w">                     </span><span class="n">chunk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">M</span><span class="o">-</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ldwrkr</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="k">CALL </span><span class="n">SGEMM</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">chunk</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">ONE</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">Lda</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                          </span><span class="n">Work</span><span class="p">(</span><span class="n">iu</span><span class="p">),</span><span class="n">ldwrku</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ir</span><span class="p">),</span><span class="n">ldwrkr</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="k">CALL </span><span class="n">SLACPY</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">chunk</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ir</span><span class="p">),</span><span class="n">ldwrkr</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">Lda</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">ENDDO</span>
<span class="k">               ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqs</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 5s (M &gt;= N, JOBZ=&#39;S&#39;)</span>
<span class="c">!              Perform bidiagonal SVD, computing left singular vectors</span>
<span class="c">!              of bidiagonal matrix in U and computing right singular</span>
<span class="c">!              vectors of bidiagonal matrix in VT</span>
<span class="c">!              Workspace: need   3*N [e, tauq, taup] + BDSPAC</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">SLASET</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Overwrite U by left singular vectors of A and VT</span>
<span class="c">!              by right singular vectors of A</span>
<span class="c">!              Workspace: need   3*N [e, tauq, taup] + N    [work]</span>
<span class="c">!              Workspace: prefer 3*N [e, tauq, taup] + N*NB [work]</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">SORMBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">SORMBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqa</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 5a (M &gt;= N, JOBZ=&#39;A&#39;)</span>
<span class="c">!              Perform bidiagonal SVD, computing left singular vectors</span>
<span class="c">!              of bidiagonal matrix in U and computing right singular</span>
<span class="c">!              vectors of bidiagonal matrix in VT</span>
<span class="c">!              Workspace: need   3*N [e, tauq, taup] + BDSPAC</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">SLASET</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Set the right corner of U to identity matrix</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">M</span><span class="o">&gt;</span><span class="n">N</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">CALL </span><span class="n">SLASET</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">N</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">ONE</span><span class="p">,</span><span class="n">U</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                                </span><span class="n">Ldu</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Overwrite U by left singular vectors of A and VT</span>
<span class="c">!              by right singular vectors of A</span>
<span class="c">!              Workspace: need   3*N [e, tauq, taup] + M    [work]</span>
<span class="c">!              Workspace: prefer 3*N [e, tauq, taup] + M*NB [work]</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">SORMBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">SORMBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="w">         </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqn</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 1 (M &gt;&gt; N, JOBZ=&#39;N&#39;)</span>
<span class="c">!              No singular vectors to be computed</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">itau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itau</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Compute A=Q*R</span>
<span class="c">!              Workspace: need   N [tau] + N    [work]</span>
<span class="c">!              Workspace: prefer N [tau] + N*NB [work]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SGEQRF</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itau</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Zero out below R</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SLASET</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">Lda</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">ie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">itauq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">            </span><span class="n">itaup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itauq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">            </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itaup</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Bidiagonalize R in A</span>
<span class="c">!              Workspace: need   3*N [e, tauq, taup] + N      [work]</span>
<span class="c">!              Workspace: prefer 3*N [e, tauq, taup] + 2*N*NB [work]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SGEBRD</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Perform bidiagonal SVD, computing singular values only</span>
<span class="c">!              Workspace: need   N [e] + BDSPAC</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">dum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="w">         </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqo</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 2 (M &gt;&gt; N, JOBZ = &#39;O&#39;)</span>
<span class="c">!              N left singular vectors to be overwritten on A and</span>
<span class="c">!              N right singular vectors to be computed in VT</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">ir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              WORK(IR) is LDWRKR by N</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Lwork</span><span class="o">&gt;=</span><span class="n">Lda</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">bdspac</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">ldwrkr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Lda</span><span class="w"></span>
<span class="w">            </span><span class="k">ELSE</span>
<span class="k">               </span><span class="n">ldwrkr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Lwork</span><span class="o">-</span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="o">-</span><span class="n">bdspac</span><span class="p">)</span><span class="o">/</span><span class="n">N</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span>
<span class="k">            </span><span class="n">itau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ir</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ldwrkr</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">            </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itau</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Compute A=Q*R</span>
<span class="c">!              Workspace: need   N*N [R] + N [tau] + N    [work]</span>
<span class="c">!              Workspace: prefer N*N [R] + N [tau] + N*NB [work]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SGEQRF</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itau</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy R to WORK(IR), zeroing out below it</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SLACPY</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ir</span><span class="p">),</span><span class="n">ldwrkr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SLASET</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ir</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">ldwrkr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Generate Q in A</span>
<span class="c">!              Workspace: need   N*N [R] + N [tau] + N    [work]</span>
<span class="c">!              Workspace: prefer N*N [R] + N [tau] + N*NB [work]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORGQR</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itau</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">ie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itau</span><span class="w"></span>
<span class="w">            </span><span class="n">itauq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">            </span><span class="n">itaup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itauq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">            </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itaup</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Bidiagonalize R in WORK(IR)</span>
<span class="c">!              Workspace: need   N*N [R] + 3*N [e, tauq, taup] + N      [work]</span>
<span class="c">!              Workspace: prefer N*N [R] + 3*N [e, tauq, taup] + 2*N*NB [work]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SGEBRD</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ir</span><span class="p">),</span><span class="n">ldwrkr</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              WORK(IU) is N by N</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">iu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nwork</span><span class="w"></span>
<span class="w">            </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iu</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Perform bidiagonal SVD, computing left singular vectors</span>
<span class="c">!              of bidiagonal matrix in WORK(IU) and computing right</span>
<span class="c">!              singular vectors of bidiagonal matrix in VT</span>
<span class="c">!              Workspace: need   N*N [R] + 3*N [e, tauq, taup] + N*N [U] + BDSPAC</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">iu</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">idum</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Overwrite WORK(IU) by left singular vectors of R</span>
<span class="c">!              and VT by right singular vectors of R</span>
<span class="c">!              Workspace: need   N*N [R] + 3*N [e, tauq, taup] + N*N [U] + N    [work]</span>
<span class="c">!              Workspace: prefer N*N [R] + 3*N [e, tauq, taup] + N*N [U] + N*NB [work]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORMBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ir</span><span class="p">),</span><span class="n">ldwrkr</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">iu</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORMBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ir</span><span class="p">),</span><span class="n">ldwrkr</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Multiply Q in A by left singular vectors of R in</span>
<span class="c">!              WORK(IU), storing result in WORK(IR) and copying to A</span>
<span class="c">!              Workspace: need   N*N [R] + 3*N [e, tauq, taup] + N*N [U]</span>
<span class="c">!              Workspace: prefer M*N [R] + 3*N [e, tauq, taup] + N*N [U]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ldwrkr</span><span class="w"></span>
<span class="w">               </span><span class="n">chunk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">M</span><span class="o">-</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ldwrkr</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">SGEMM</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">chunk</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">ONE</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">iu</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                    </span><span class="n">ZERO</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ir</span><span class="p">),</span><span class="n">ldwrkr</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">SLACPY</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">chunk</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ir</span><span class="p">),</span><span class="n">ldwrkr</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">Lda</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDDO</span><span class="w"></span>
<span class="c">!</span>
<span class="w">         </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqs</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 3 (M &gt;&gt; N, JOBZ=&#39;S&#39;)</span>
<span class="c">!              N left singular vectors to be computed in U and</span>
<span class="c">!              N right singular vectors to be computed in VT</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">ir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              WORK(IR) is N by N</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">ldwrkr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">            </span><span class="n">itau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ir</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ldwrkr</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">            </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itau</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Compute A=Q*R</span>
<span class="c">!              Workspace: need   N*N [R] + N [tau] + N    [work]</span>
<span class="c">!              Workspace: prefer N*N [R] + N [tau] + N*NB [work]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SGEQRF</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itau</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy R to WORK(IR), zeroing out below it</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SLACPY</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ir</span><span class="p">),</span><span class="n">ldwrkr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SLASET</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ir</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">ldwrkr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Generate Q in A</span>
<span class="c">!              Workspace: need   N*N [R] + N [tau] + N    [work]</span>
<span class="c">!              Workspace: prefer N*N [R] + N [tau] + N*NB [work]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORGQR</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itau</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">ie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itau</span><span class="w"></span>
<span class="w">            </span><span class="n">itauq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">            </span><span class="n">itaup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itauq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">            </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itaup</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Bidiagonalize R in WORK(IR)</span>
<span class="c">!              Workspace: need   N*N [R] + 3*N [e, tauq, taup] + N      [work]</span>
<span class="c">!              Workspace: prefer N*N [R] + 3*N [e, tauq, taup] + 2*N*NB [work]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SGEBRD</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ir</span><span class="p">),</span><span class="n">ldwrkr</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Perform bidiagonal SVD, computing left singular vectors</span>
<span class="c">!              of bidiagoal matrix in U and computing right singular</span>
<span class="c">!              vectors of bidiagonal matrix in VT</span>
<span class="c">!              Workspace: need   N*N [R] + 3*N [e, tauq, taup] + BDSPAC</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Overwrite U by left singular vectors of R and VT</span>
<span class="c">!              by right singular vectors of R</span>
<span class="c">!              Workspace: need   N*N [R] + 3*N [e, tauq, taup] + N    [work]</span>
<span class="c">!              Workspace: prefer N*N [R] + 3*N [e, tauq, taup] + N*NB [work]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORMBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ir</span><span class="p">),</span><span class="n">ldwrkr</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">U</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Ldu</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORMBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ir</span><span class="p">),</span><span class="n">ldwrkr</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Multiply Q in A by left singular vectors of R in</span>
<span class="c">!              WORK(IR), storing result in U</span>
<span class="c">!              Workspace: need   N*N [R]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SLACPY</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ir</span><span class="p">),</span><span class="n">ldwrkr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SGEMM</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">ONE</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ir</span><span class="p">),</span><span class="n">ldwrkr</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                 </span><span class="n">Ldu</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="w">         </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqa</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 4 (M &gt;&gt; N, JOBZ=&#39;A&#39;)</span>
<span class="c">!              M left singular vectors to be computed in U and</span>
<span class="c">!              N right singular vectors to be computed in VT</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">iu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              WORK(IU) is N by N</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">ldwrku</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">            </span><span class="n">itau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iu</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ldwrku</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">            </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itau</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Compute A=Q*R, copying result to U</span>
<span class="c">!              Workspace: need   N*N [U] + N [tau] + N    [work]</span>
<span class="c">!              Workspace: prefer N*N [U] + N [tau] + N*NB [work]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SGEQRF</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itau</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SLACPY</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Generate Q in U</span>
<span class="c">!              Workspace: need   N*N [U] + N [tau] + M    [work]</span>
<span class="c">!              Workspace: prefer N*N [U] + N [tau] + M*NB [work]</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORGQR</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itau</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Produce R in A, zeroing out other entries</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SLASET</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">Lda</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">ie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itau</span><span class="w"></span>
<span class="w">            </span><span class="n">itauq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">            </span><span class="n">itaup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itauq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">            </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itaup</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Bidiagonalize R in A</span>
<span class="c">!              Workspace: need   N*N [U] + 3*N [e, tauq, taup] + N      [work]</span>
<span class="c">!              Workspace: prefer N*N [U] + 3*N [e, tauq, taup] + 2*N*NB [work]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SGEBRD</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Perform bidiagonal SVD, computing left singular vectors</span>
<span class="c">!              of bidiagonal matrix in WORK(IU) and computing right</span>
<span class="c">!              singular vectors of bidiagonal matrix in VT</span>
<span class="c">!              Workspace: need   N*N [U] + 3*N [e, tauq, taup] + BDSPAC</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">iu</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">idum</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Overwrite WORK(IU) by left singular vectors of R and VT</span>
<span class="c">!              by right singular vectors of R</span>
<span class="c">!              Workspace: need   N*N [U] + 3*N [e, tauq, taup] + N    [work]</span>
<span class="c">!              Workspace: prefer N*N [U] + 3*N [e, tauq, taup] + N*NB [work]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORMBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">iu</span><span class="p">),</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">ldwrku</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORMBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Multiply Q in U by left singular vectors of R in</span>
<span class="c">!              WORK(IU), storing result in A</span>
<span class="c">!              Workspace: need   N*N [U]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SGEMM</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">ONE</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">iu</span><span class="p">),</span><span class="n">ldwrku</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                 </span><span class="n">Lda</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy left singular vectors of A from A to U</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SLACPY</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="w">         </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!</span>
<span class="c">!        A has more columns than rows. If A has sufficiently more</span>
<span class="c">!        columns than rows, first reduce using the LQ decomposition (if</span>
<span class="c">!        sufficient workspace available)</span>
<span class="c">!</span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">N</span><span class="o">&gt;=</span><span class="n">mnthr</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqn</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 1t (N &gt;&gt; M, JOBZ=&#39;N&#39;)</span>
<span class="c">!              No singular vectors to be computed</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">itau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itau</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Compute A=L*Q</span>
<span class="c">!              Workspace: need   M [tau] + M [work]</span>
<span class="c">!              Workspace: prefer M [tau] + M*NB [work]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SGELQF</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itau</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Zero out above L</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SLASET</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">Lda</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">ie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">itauq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">itaup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itauq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itaup</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Bidiagonalize L in A</span>
<span class="c">!              Workspace: need   3*M [e, tauq, taup] + M      [work]</span>
<span class="c">!              Workspace: prefer 3*M [e, tauq, taup] + 2*M*NB [work]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SGEBRD</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Perform bidiagonal SVD, computing singular values only</span>
<span class="c">!              Workspace: need   M [e] + BDSPAC</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">dum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="w">         </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqo</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 2t (N &gt;&gt; M, JOBZ=&#39;O&#39;)</span>
<span class="c">!              M right singular vectors to be overwritten on A and</span>
<span class="c">!              M left singular vectors to be computed in U</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">ivt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              WORK(IVT) is M by M</span>
<span class="c">!              WORK(IL)  is M by M; it is later resized to M by chunk for gemm</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">il</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Lwork</span><span class="o">&gt;=</span><span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">bdspac</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">ldwrkl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">               </span><span class="n">chunk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">            </span><span class="k">ELSE</span>
<span class="k">               </span><span class="n">ldwrkl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">               </span><span class="n">chunk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Lwork</span><span class="o">-</span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="p">)</span><span class="o">/</span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span>
<span class="k">            </span><span class="n">itau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">il</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ldwrkl</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itau</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Compute A=L*Q</span>
<span class="c">!              Workspace: need   M*M [VT] + M*M [L] + M [tau] + M    [work]</span>
<span class="c">!              Workspace: prefer M*M [VT] + M*M [L] + M [tau] + M*NB [work]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SGELQF</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itau</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy L to WORK(IL), zeroing about above it</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SLACPY</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">il</span><span class="p">),</span><span class="n">ldwrkl</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SLASET</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">il</span><span class="o">+</span><span class="n">ldwrkl</span><span class="p">),</span><span class="n">ldwrkl</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Generate Q in A</span>
<span class="c">!              Workspace: need   M*M [VT] + M*M [L] + M [tau] + M    [work]</span>
<span class="c">!              Workspace: prefer M*M [VT] + M*M [L] + M [tau] + M*NB [work]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORGLQ</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itau</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">ie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itau</span><span class="w"></span>
<span class="w">            </span><span class="n">itauq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">itaup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itauq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itaup</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Bidiagonalize L in WORK(IL)</span>
<span class="c">!              Workspace: need   M*M [VT] + M*M [L] + 3*M [e, tauq, taup] + M      [work]</span>
<span class="c">!              Workspace: prefer M*M [VT] + M*M [L] + 3*M [e, tauq, taup] + 2*M*NB [work]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SGEBRD</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">il</span><span class="p">),</span><span class="n">ldwrkl</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Perform bidiagonal SVD, computing left singular vectors</span>
<span class="c">!              of bidiagonal matrix in U, and computing right singular</span>
<span class="c">!              vectors of bidiagonal matrix in WORK(IVT)</span>
<span class="c">!              Workspace: need   M*M [VT] + M*M [L] + 3*M [e, tauq, taup] + BDSPAC</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ivt</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Overwrite U by left singular vectors of L and WORK(IVT)</span>
<span class="c">!              by right singular vectors of L</span>
<span class="c">!              Workspace: need   M*M [VT] + M*M [L] + 3*M [e, tauq, taup] + M    [work]</span>
<span class="c">!              Workspace: prefer M*M [VT] + M*M [L] + 3*M [e, tauq, taup] + M*NB [work]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORMBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">il</span><span class="p">),</span><span class="n">ldwrkl</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">U</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Ldu</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORMBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">il</span><span class="p">),</span><span class="n">ldwrkl</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">ivt</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Multiply right singular vectors of L in WORK(IVT) by Q</span>
<span class="c">!              in A, storing result in WORK(IL) and copying to A</span>
<span class="c">!              Workspace: need   M*M [VT] + M*M [L]</span>
<span class="c">!              Workspace: prefer M*M [VT] + M*N [L]</span>
<span class="c">!              At this point, L is resized as M by chunk.</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">chunk</span><span class="w"></span>
<span class="w">               </span><span class="n">blk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">chunk</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">SGEMM</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">blk</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">ONE</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ivt</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">),</span><span class="n">Lda</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                    </span><span class="n">ZERO</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">il</span><span class="p">),</span><span class="n">ldwrkl</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">SLACPY</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">blk</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">il</span><span class="p">),</span><span class="n">ldwrkl</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">),</span><span class="n">Lda</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDDO</span><span class="w"></span>
<span class="c">!</span>
<span class="w">         </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqs</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 3t (N &gt;&gt; M, JOBZ=&#39;S&#39;)</span>
<span class="c">!              M right singular vectors to be computed in VT and</span>
<span class="c">!              M left singular vectors to be computed in U</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">il</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              WORK(IL) is M by M</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">ldwrkl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">itau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">il</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ldwrkl</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itau</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Compute A=L*Q</span>
<span class="c">!              Workspace: need   M*M [L] + M [tau] + M    [work]</span>
<span class="c">!              Workspace: prefer M*M [L] + M [tau] + M*NB [work]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SGELQF</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itau</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy L to WORK(IL), zeroing out above it</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SLACPY</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">il</span><span class="p">),</span><span class="n">ldwrkl</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SLASET</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">il</span><span class="o">+</span><span class="n">ldwrkl</span><span class="p">),</span><span class="n">ldwrkl</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Generate Q in A</span>
<span class="c">!              Workspace: need   M*M [L] + M [tau] + M    [work]</span>
<span class="c">!              Workspace: prefer M*M [L] + M [tau] + M*NB [work]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORGLQ</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itau</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">ie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itau</span><span class="w"></span>
<span class="w">            </span><span class="n">itauq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">itaup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itauq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itaup</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Bidiagonalize L in WORK(IU).</span>
<span class="c">!              Workspace: need   M*M [L] + 3*M [e, tauq, taup] + M      [work]</span>
<span class="c">!              Workspace: prefer M*M [L] + 3*M [e, tauq, taup] + 2*M*NB [work]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SGEBRD</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">il</span><span class="p">),</span><span class="n">ldwrkl</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Perform bidiagonal SVD, computing left singular vectors</span>
<span class="c">!              of bidiagonal matrix in U and computing right singular</span>
<span class="c">!              vectors of bidiagonal matrix in VT</span>
<span class="c">!              Workspace: need   M*M [L] + 3*M [e, tauq, taup] + BDSPAC</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Overwrite U by left singular vectors of L and VT</span>
<span class="c">!              by right singular vectors of L</span>
<span class="c">!              Workspace: need   M*M [L] + 3*M [e, tauq, taup] + M    [work]</span>
<span class="c">!              Workspace: prefer M*M [L] + 3*M [e, tauq, taup] + M*NB [work]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORMBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">il</span><span class="p">),</span><span class="n">ldwrkl</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">U</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Ldu</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORMBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">il</span><span class="p">),</span><span class="n">ldwrkl</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Multiply right singular vectors of L in WORK(IL) by</span>
<span class="c">!              Q in A, storing result in VT</span>
<span class="c">!              Workspace: need   M*M [L]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SLACPY</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">il</span><span class="p">),</span><span class="n">ldwrkl</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SGEMM</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">ONE</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">il</span><span class="p">),</span><span class="n">ldwrkl</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                 </span><span class="n">Ldvt</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="w">         </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqa</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 4t (N &gt;&gt; M, JOBZ=&#39;A&#39;)</span>
<span class="c">!              N right singular vectors to be computed in VT and</span>
<span class="c">!              M left singular vectors to be computed in U</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">ivt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              WORK(IVT) is M by M</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">ldwkvt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">itau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ldwkvt</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itau</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Compute A=L*Q, copying result to VT</span>
<span class="c">!              Workspace: need   M*M [VT] + M [tau] + M    [work]</span>
<span class="c">!              Workspace: prefer M*M [VT] + M [tau] + M*NB [work]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SGELQF</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itau</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SLACPY</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Generate Q in VT</span>
<span class="c">!              Workspace: need   M*M [VT] + M [tau] + N    [work]</span>
<span class="c">!              Workspace: prefer M*M [VT] + M [tau] + N*NB [work]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORGLQ</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itau</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Produce L in A, zeroing out other entries</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SLASET</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">Lda</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">ie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itau</span><span class="w"></span>
<span class="w">            </span><span class="n">itauq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">itaup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itauq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itaup</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Bidiagonalize L in A</span>
<span class="c">!              Workspace: need   M*M [VT] + 3*M [e, tauq, taup] + M      [work]</span>
<span class="c">!              Workspace: prefer M*M [VT] + 3*M [e, tauq, taup] + 2*M*NB [work]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SGEBRD</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Perform bidiagonal SVD, computing left singular vectors</span>
<span class="c">!              of bidiagonal matrix in U and computing right singular</span>
<span class="c">!              vectors of bidiagonal matrix in WORK(IVT)</span>
<span class="c">!              Workspace: need   M*M [VT] + 3*M [e, tauq, taup] + BDSPAC</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ivt</span><span class="p">),</span><span class="n">ldwkvt</span><span class="p">,</span><span class="n">dum</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">idum</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Overwrite U by left singular vectors of L and WORK(IVT)</span>
<span class="c">!              by right singular vectors of L</span>
<span class="c">!              Workspace: need   M*M [VT] + 3*M [e, tauq, taup]+ M    [work]</span>
<span class="c">!              Workspace: prefer M*M [VT] + 3*M [e, tauq, taup]+ M*NB [work]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORMBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORMBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">ivt</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">ldwkvt</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Multiply right singular vectors of L in WORK(IVT) by</span>
<span class="c">!              Q in VT, storing result in A</span>
<span class="c">!              Workspace: need   M*M [VT]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SGEMM</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">ONE</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ivt</span><span class="p">),</span><span class="n">ldwkvt</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                 </span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Copy right singular vectors of A from A to VT</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SLACPY</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="w">         </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="w">      </span><span class="k">ELSE</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           N .LT. MNTHR</span>
<span class="c">!</span>
<span class="c">!           Path 5t (N &gt; M, but not much larger)</span>
<span class="c">!           Reduce to bidiagonal form without LQ decomposition</span>
<span class="c">!</span>
<span class="w">         </span><span class="n">ie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="n">itauq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">         </span><span class="n">itaup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itauq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">         </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itaup</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Bidiagonalize A</span>
<span class="c">!           Workspace: need   3*M [e, tauq, taup] + N        [work]</span>
<span class="c">!           Workspace: prefer 3*M [e, tauq, taup] + (M+N)*NB [work]</span>
<span class="c">!</span>
<span class="w">         </span><span class="k">CALL </span><span class="n">SGEBRD</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">               </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqn</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 5tn (N &gt; M, JOBZ=&#39;N&#39;)</span>
<span class="c">!              Perform bidiagonal SVD, only computing singular values</span>
<span class="c">!              Workspace: need   3*M [e, tauq, taup] + BDSPAC</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">dum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqo</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!              Path 5to (N &gt; M, JOBZ=&#39;O&#39;)</span>
<span class="w">            </span><span class="n">ldwkvt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="n">ivt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nwork</span><span class="w"></span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Lwork</span><span class="o">&gt;=</span><span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">bdspac</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 WORK( IVT ) is M by N</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">SLASET</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ivt</span><span class="p">),</span><span class="n">ldwkvt</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ldwkvt</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="c">!                 IL is unused; silence compile warnings</span>
<span class="w">               </span><span class="n">il</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="k">ELSE</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 WORK( IVT ) is M by M</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">nwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ldwkvt</span><span class="o">*</span><span class="n">M</span><span class="w"></span>
<span class="w">               </span><span class="n">il</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nwork</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 WORK(IL) is M by CHUNK</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">chunk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Lwork</span><span class="o">-</span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="p">)</span><span class="o">/</span><span class="n">M</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Perform bidiagonal SVD, computing left singular vectors</span>
<span class="c">!              of bidiagonal matrix in U and computing right singular</span>
<span class="c">!              vectors of bidiagonal matrix in WORK(IVT)</span>
<span class="c">!              Workspace: need   3*M [e, tauq, taup] + M*M [VT] + BDSPAC</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ivt</span><span class="p">),</span><span class="n">ldwkvt</span><span class="p">,</span><span class="n">dum</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">idum</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Overwrite U by left singular vectors of A</span>
<span class="c">!              Workspace: need   3*M [e, tauq, taup] + M*M [VT] + M    [work]</span>
<span class="c">!              Workspace: prefer 3*M [e, tauq, taup] + M*M [VT] + M*NB [work]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORMBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Lwork</span><span class="o">&gt;=</span><span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="o">+</span><span class="n">bdspac</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Path 5to-fast</span>
<span class="c">!                 Overwrite WORK(IVT) by left singular vectors of A</span>
<span class="c">!                 Workspace: need   3*M [e, tauq, taup] + M*N [VT] + M    [work]</span>
<span class="c">!                 Workspace: prefer 3*M [e, tauq, taup] + M*N [VT] + M*NB [work]</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">SORMBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">ivt</span><span class="p">)&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="p">,</span><span class="n">ldwkvt</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Copy right singular vectors of A from WORK(IVT) to A</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">SLACPY</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ivt</span><span class="p">),</span><span class="n">ldwkvt</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">ELSE</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Path 5to-slow</span>
<span class="c">!                 Generate P**T in A</span>
<span class="c">!                 Workspace: need   3*M [e, tauq, taup] + M*M [VT] + M    [work]</span>
<span class="c">!                 Workspace: prefer 3*M [e, tauq, taup] + M*M [VT] + M*NB [work]</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">SORGBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Multiply Q in A by right singular vectors of</span>
<span class="c">!                 bidiagonal matrix in WORK(IVT), storing result in</span>
<span class="c">!                 WORK(IL) and copying to A</span>
<span class="c">!                 Workspace: need   3*M [e, tauq, taup] + M*M [VT] + M*NB [L]</span>
<span class="c">!                 Workspace: prefer 3*M [e, tauq, taup] + M*M [VT] + M*N  [L]</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">chunk</span><span class="w"></span>
<span class="w">                  </span><span class="n">blk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">chunk</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">CALL </span><span class="n">SGEMM</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">blk</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">ONE</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ivt</span><span class="p">),</span><span class="n">ldwkvt</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">)&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                       </span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">il</span><span class="p">),</span><span class="n">M</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">CALL </span><span class="n">SLACPY</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">blk</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">il</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">),</span><span class="n">Lda</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDDO</span>
<span class="k">            ENDIF</span>
<span class="k">         </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqs</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 5ts (N &gt; M, JOBZ=&#39;S&#39;)</span>
<span class="c">!              Perform bidiagonal SVD, computing left singular vectors</span>
<span class="c">!              of bidiagonal matrix in U and computing right singular</span>
<span class="c">!              vectors of bidiagonal matrix in VT</span>
<span class="c">!              Workspace: need   3*M [e, tauq, taup] + BDSPAC</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SLASET</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Overwrite U by left singular vectors of A and VT</span>
<span class="c">!              by right singular vectors of A</span>
<span class="c">!              Workspace: need   3*M [e, tauq, taup] + M    [work]</span>
<span class="c">!              Workspace: prefer 3*M [e, tauq, taup] + M*NB [work]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORMBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORMBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntqa</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Path 5ta (N &gt; M, JOBZ=&#39;A&#39;)</span>
<span class="c">!              Perform bidiagonal SVD, computing left singular vectors</span>
<span class="c">!              of bidiagonal matrix in U and computing right singular</span>
<span class="c">!              vectors of bidiagonal matrix in VT</span>
<span class="c">!              Workspace: need   3*M [e, tauq, taup] + BDSPAC</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SLASET</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SBDSDC</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ie</span><span class="p">),</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="n">dum</span><span class="p">,</span><span class="n">idum</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Set the right corner of VT to identity matrix</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">N</span><span class="o">&gt;</span><span class="n">M</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">CALL </span><span class="n">SLASET</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="n">M</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">ONE</span><span class="p">,</span><span class="n">Vt</span><span class="p">(</span><span class="n">M</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">M</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                             </span><span class="n">Ldvt</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Overwrite U by left singular vectors of A and VT</span>
<span class="c">!              by right singular vectors of A</span>
<span class="c">!              Workspace: need   3*M [e, tauq, taup] + N    [work]</span>
<span class="c">!              Workspace: prefer 3*M [e, tauq, taup] + N*NB [work]</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORMBR</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq</span><span class="p">),</span><span class="n">U</span><span class="p">,</span><span class="n">Ldu</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SORMBR</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup</span><span class="p">),</span><span class="n">Vt</span><span class="p">,</span><span class="n">Ldvt</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">nwork</span><span class="p">),</span><span class="n">Lwork</span><span class="o">-</span><span class="n">nwork</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Undo scaling if necessary</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iscl</span><span class="o">==</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">anrm</span><span class="o">&gt;</span><span class="n">bignum</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">CALL </span><span class="n">SLASCL</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">bignum</span><span class="p">,</span><span class="n">anrm</span><span class="p">,</span><span class="n">minmn</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                                  </span><span class="n">minmn</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">anrm</span><span class="o">&lt;</span><span class="n">smlnum</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">CALL </span><span class="n">SLASCL</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">smlnum</span><span class="p">,</span><span class="n">anrm</span><span class="p">,</span><span class="n">minmn</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                                  </span><span class="n">minmn</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Return optimal workspace in WORK(1)</span>
<span class="c">!</span>
<span class="w">      </span><span class="n">Work</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">maxwrk</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!</span>
<span class="c">!     End of SGESDD</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">END SUBROUTINE </span><span class="n">SGESDD</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              spag_lapack
 was developed by John S. Urban<br>              &copy; 2025 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2025-07-11 01:31 +0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>