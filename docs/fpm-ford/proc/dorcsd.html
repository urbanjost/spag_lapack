<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="spag_lapack module">
    <meta name="author" content="John S. Urban" >
    <link rel="icon" href="../favicon.png">

    <title>DORCSD &ndash; spag_lapack</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">spag_lapack </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>DORCSD
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 0.1% of total for procedures.">202 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/dorcsd.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/dorcsd.f90.html'>dorcsd.f90</a></li>
            <li class="breadcrumb-item active" aria-current="page">DORCSD</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#vars-0"
         aria-expanded="false" aria-controls="vars-0">
         <h4 class="card-header bg-primary text-white">Variables</h4>
      </a>
      <div id="vars-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../proc/dorcsd.html#variable-one~146">ONE</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-zero~137">ZERO</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-childinfo~3">childinfo</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-colmajor~3">colmajor</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-defaultsigns">defaultsigns</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-i~144">i</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-ib11d">ib11d</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-ib11e">ib11e</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-ib12d">ib12d</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-ib12e">ib12e</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-ib21d">ib21d</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-ib21e">ib21e</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-ib22d">ib22d</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-ib22e">ib22e</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-ibbcsd">ibbcsd</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-iorbdb">iorbdb</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-iorglq">iorglq</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-iorgqr">iorgqr</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-iphi">iphi</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-itaup1">itaup1</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-itaup2">itaup2</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-itauq1">itauq1</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-itauq2">itauq2</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-j~105">j</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-lbbcsdwork">lbbcsdwork</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-lbbcsdworkmin">lbbcsdworkmin</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-lbbcsdworkopt">lbbcsdworkopt</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-lorbdbwork">lorbdbwork</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-lorbdbworkmin">lorbdbworkmin</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-lorbdbworkopt">lorbdbworkopt</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-lorglqwork">lorglqwork</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-lorglqworkmin">lorglqworkmin</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-lorglqworkopt">lorglqworkopt</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-lorgqrwork">lorgqrwork</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-lorgqrworkmin">lorgqrworkmin</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-lorgqrworkopt">lorgqrworkopt</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-lquery~59">lquery</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-lworkmin~5">lworkmin</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-lworkopt~5">lworkopt</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-signst">signst</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-transt~6">transt</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-wantu1">wantu1</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-wantu2">wantu2</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-wantv1t">wantv1t</a>
            <a class="list-group-item" href="../proc/dorcsd.html#variable-wantv2t">wantv2t</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/dorcsd.html#src">DORCSD</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>recursive subroutine DORCSD(Jobu1, Jobu2, Jobv1t, Jobv2t, Trans, Signs, M, P, Q, X11, Ldx11, X12, Ldx12, X21, Ldx21, X22, Ldx22, Theta, U1, Ldu1, U2, Ldu2, V1t, Ldv1t, V2t, Ldv2t, Work, Lwork, Iwork, Info)  
</h2>
    

    <p>\brief \b DORCSD
 \htmlonly
 Download DORCSD + dependencies
 <a href="http://www.netlib.org/cgi-bin/netlibfiles.tgz?format=tgz&filename=/lapack/lapack_routine/dorcsd.f">
 [TGZ]</a>
 <a href="http://www.netlib.org/cgi-bin/netlibfiles.zip?format=zip&filename=/lapack/lapack_routine/dorcsd.f">
 [ZIP]</a>
 <a href="http://www.netlib.org/cgi-bin/netlibfiles.txt?format=txt&filename=/lapack/lapack_routine/dorcsd.f">
 [TXT]</a>
 \endhtmlonly
 \par Purpose:</p>
<p>\verbatim</p>
<p>DORCSD computes the CS decomposition of an M-by-M partitioned
 orthogonal matrix X:</p>
<div class="codehilite"><pre><span></span><code>                             [  I  0  0 |  0  0  0 ]
                             [  0  C  0 |  0 -S  0 ]
 [ X11 | X12 ]   [ U1 |    ] [  0  0  0 |  0  0 -I ] [ V1 |    ]**T
</code></pre></div>

<p>X = [-----------] = [---------] [---------------------] [---------]   .
     [ X21 | X22 ]   [    | U2 ] [  0  0  0 |  I  0  0 ] [    | V2 ]
                                 [  0  S  0 |  0  C  0 ]
                                 [  0  0  I |  0  0  0 ]</p>
<p>X11 is P-by-Q. The orthogonal matrices U1, U2, V1, and V2 are P-by-P,
 (M-P)-by-(M-P), Q-by-Q, and (M-Q)-by-(M-Q), respectively. C and S are
 R-by-R nonnegative diagonal matrices satisfying C^2 + S^2 = I, in
 which R = MIN(P,M-P,Q,M-Q).
 \endverbatim
 \param[in] JOBU1
 \verbatim
          JOBU1 is CHARACTER
          = &lsquo;Y&rsquo;:      U1 is computed;
          otherwise:  U1 is not computed.
 \endverbatim</p>
<p>\param[in] JOBU2
 \verbatim
          JOBU2 is CHARACTER
          = &lsquo;Y&rsquo;:      U2 is computed;
          otherwise:  U2 is not computed.
 \endverbatim</p>
<p>\param[in] JOBV1T
 \verbatim
          JOBV1T is CHARACTER
          = &lsquo;Y&rsquo;:      V1T is computed;
          otherwise:  V1T is not computed.
 \endverbatim</p>
<p>\param[in] JOBV2T
 \verbatim
          JOBV2T is CHARACTER
          = &lsquo;Y&rsquo;:      V2T is computed;
          otherwise:  V2T is not computed.
 \endverbatim</p>
<p>\param[in] TRANS
 \verbatim
          TRANS is CHARACTER
          = &lsquo;T&rsquo;:      X, U1, U2, V1T, and V2T are stored in row-major
                      order;
          otherwise:  X, U1, U2, V1T, and V2T are stored in column-
                      major order.
 \endverbatim</p>
<p>\param[in] SIGNS
 \verbatim
          SIGNS is CHARACTER
          = &lsquo;O&rsquo;:      The lower-left block is made nonpositive (the
                      &ldquo;other&rdquo; convention);
          otherwise:  The upper-right block is made nonpositive (the
                      &ldquo;default&rdquo; convention).
 \endverbatim</p>
<p>\param[in] M
 \verbatim
          M is INTEGER
          The number of rows and columns in X.
 \endverbatim</p>
<p>\param[in] P
 \verbatim
          P is INTEGER
          The number of rows in X11 and X12. 0 &lt;= P &lt;= M.
 \endverbatim</p>
<p>\param[in] Q
 \verbatim
          Q is INTEGER
          The number of columns in X11 and X21. 0 &lt;= Q &lt;= M.
 \endverbatim</p>
<p>\param[in,out] X11
 \verbatim
          X11 is DOUBLE PRECISION array, dimension (LDX11,Q)
          On entry, part of the orthogonal matrix whose CSD is desired.
 \endverbatim</p>
<p>\param[in] LDX11
 \verbatim
          LDX11 is INTEGER
          The leading dimension of X11. LDX11 &gt;= MAX(1,P).
 \endverbatim</p>
<p>\param[in,out] X12
 \verbatim
          X12 is DOUBLE PRECISION array, dimension (LDX12,M-Q)
          On entry, part of the orthogonal matrix whose CSD is desired.
 \endverbatim</p>
<p>\param[in] LDX12
 \verbatim
          LDX12 is INTEGER
          The leading dimension of X12. LDX12 &gt;= MAX(1,P).
 \endverbatim</p>
<p>\param[in,out] X21
 \verbatim
          X21 is DOUBLE PRECISION array, dimension (LDX21,Q)
          On entry, part of the orthogonal matrix whose CSD is desired.
 \endverbatim</p>
<p>\param[in] LDX21
 \verbatim
          LDX21 is INTEGER
          The leading dimension of X11. LDX21 &gt;= MAX(1,M-P).
 \endverbatim</p>
<p>\param[in,out] X22
 \verbatim
          X22 is DOUBLE PRECISION array, dimension (LDX22,M-Q)
          On entry, part of the orthogonal matrix whose CSD is desired.
 \endverbatim</p>
<p>\param[in] LDX22
 \verbatim
          LDX22 is INTEGER
          The leading dimension of X11. LDX22 &gt;= MAX(1,M-P).
 \endverbatim</p>
<p>\param[out] THETA
 \verbatim
          THETA is DOUBLE PRECISION array, dimension (R), in which R =
          MIN(P,M-P,Q,M-Q).
          C = DIAG( COS(THETA(1)), &hellip; , COS(THETA(R)) ) and
          S = DIAG( SIN(THETA(1)), &hellip; , SIN(THETA(R)) ).
 \endverbatim</p>
<p>\param[out] U1
 \verbatim
          U1 is DOUBLE PRECISION array, dimension (LDU1,P)
          If JOBU1 = &lsquo;Y&rsquo;, U1 contains the P-by-P orthogonal matrix U1.
 \endverbatim</p>
<p>\param[in] LDU1
 \verbatim
          LDU1 is INTEGER
          The leading dimension of U1. If JOBU1 = &lsquo;Y&rsquo;, LDU1 &gt;=
          MAX(1,P).
 \endverbatim</p>
<p>\param[out] U2
 \verbatim
          U2 is DOUBLE PRECISION array, dimension (LDU2,M-P)
          If JOBU2 = &lsquo;Y&rsquo;, U2 contains the (M-P)-by-(M-P) orthogonal
          matrix U2.
 \endverbatim</p>
<p>\param[in] LDU2
 \verbatim
          LDU2 is INTEGER
          The leading dimension of U2. If JOBU2 = &lsquo;Y&rsquo;, LDU2 &gt;=
          MAX(1,M-P).
 \endverbatim</p>
<p>\param[out] V1T
 \verbatim
          V1T is DOUBLE PRECISION array, dimension (LDV1T,Q)
          If JOBV1T = &lsquo;Y&rsquo;, V1T contains the Q-by-Q matrix orthogonal
          matrix V1**T.
 \endverbatim</p>
<p>\param[in] LDV1T
 \verbatim
          LDV1T is INTEGER
          The leading dimension of V1T. If JOBV1T = &lsquo;Y&rsquo;, LDV1T &gt;=
          MAX(1,Q).
 \endverbatim</p>
<p>\param[out] V2T
 \verbatim
          V2T is DOUBLE PRECISION array, dimension (LDV2T,M-Q)
          If JOBV2T = &lsquo;Y&rsquo;, V2T contains the (M-Q)-by-(M-Q) orthogonal
          matrix V2**T.
 \endverbatim</p>
<p>\param[in] LDV2T
 \verbatim
          LDV2T is INTEGER
          The leading dimension of V2T. If JOBV2T = &lsquo;Y&rsquo;, LDV2T &gt;=
          MAX(1,M-Q).
 \endverbatim</p>
<p>\param[out] WORK
 \verbatim
          WORK is DOUBLE PRECISION array, dimension (MAX(1,LWORK))
          On exit, if INFO = 0, WORK(1) returns the optimal LWORK.
          If INFO &gt; 0 on exit, WORK(2:R) contains the values PHI(1),
          &hellip;, PHI(R-1) that, together with THETA(1), &hellip;, THETA(R),
          define the matrix in intermediate bidiagonal-block form
          remaining after nonconvergence. INFO specifies the number
          of nonzero PHI&rsquo;s.
 \endverbatim</p>
<p>\param[in] LWORK
 \verbatim
          LWORK is INTEGER
          The dimension of the array WORK.</p>
<div class="codehilite"><pre><span></span><code>      <span class="k">If</span> <span class="nv">LWORK</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>, <span class="k">then</span> <span class="nv">a</span> <span class="nv">workspace</span> <span class="nv">query</span> <span class="nv">is</span> <span class="nv">assumed</span><span class="c1">; the routine</span>
      <span class="nv">only</span> <span class="nv">calculates</span> <span class="nv">the</span> <span class="nv">optimal</span> <span class="nv">size</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">WORK</span> <span class="nv">array</span>, <span class="nv">returns</span>
      <span class="nv">this</span> <span class="nv">value</span> <span class="nv">as</span> <span class="nv">the</span> <span class="nv">first</span> <span class="nv">entry</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">work</span> <span class="nv">array</span>, <span class="nv">and</span> <span class="nv">no</span> <span class="nv">error</span>
      <span class="nv">message</span> <span class="nv">related</span> <span class="nv">to</span> <span class="nv">LWORK</span> <span class="nv">is</span> <span class="nv">issued</span> <span class="nv">by</span> <span class="nv">XERBLA</span>.
</code></pre></div>

<p>\endverbatim</p>
<p>\param[out] IWORK
 \verbatim
          IWORK is INTEGER array, dimension (M-MIN(P, M-P, Q, M-Q))
 \endverbatim</p>
<p>\param[out] INFO
 \verbatim
          INFO is INTEGER
          = 0:  successful exit.
          &lt; 0:  if INFO = -i, the i-th argument had an illegal value.
          &gt; 0:  DBBCSD did not converge. See the description of WORK
                above for details.
 \endverbatim
 \par References:</p>
<p>[1] Brian D. Sutton. Computing the complete CS decomposition. Numer.
      Algorithms, 50(1):33-65, 2009.
 \author Univ. of Tennessee
 \author Univ. of California Berkeley
 \author Univ. of Colorado Denver
 \author NAG Ltd.
 \date June 2017
 \ingroup doubleOTHERcomputational
&ndash;DORCSD304</p>
<p>&ndash; LAPACK computational routine (version 3.7.1) &ndash;
  &ndash; LAPACK is a software package provided by Univ. of Tennessee,    &ndash;
  &ndash; Univ. of California Berkeley, Univ. of Colorado Denver and NAG Ltd..&ndash;
     June 2017</p>
<div class="codehilite"><pre><span></span><code> .. Scalar Arguments ..
</code></pre></div>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-jobu1"></span>
              character(len=1)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Jobu1</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jobu2"></span>
              character(len=1)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Jobu2</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jobv1t"></span>
              character(len=1)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Jobv1t</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jobv2t"></span>
              character(len=1)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Jobv2t</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-trans~23"></span>
              character(len=1)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Trans</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-signs~3"></span>
              character(len=1)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Signs</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-m~67"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>M</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-p~8"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>P</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-q~13"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Q</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-x11~5"></span>
              double precision
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>X11</strong>(Ldx11,*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldx11~5"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ldx11</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-x12~3"></span>
              double precision
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>X12</strong>(Ldx12,*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldx12~3"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ldx12</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-x21~5"></span>
              double precision
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>X21</strong>(Ldx21,*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldx21~5"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ldx21</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-x22~3"></span>
              double precision
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>X22</strong>(Ldx22,*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldx22~3"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ldx22</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-theta~5"></span>
              double precision
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Theta</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-u1"></span>
              double precision
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>U1</strong>(Ldu1,*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldu1"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ldu1</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-u2"></span>
              double precision
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>U2</strong>(Ldu2,*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldu2"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ldu2</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-v1t"></span>
              double precision
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>V1t</strong>(Ldv1t,*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldv1t"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ldv1t</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-v2t"></span>
              double precision
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>V2t</strong>(Ldv2t,*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldv2t"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ldv2t</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-work~127"></span>
              double precision
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Work</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork~65"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Lwork</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iwork~31"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Iwork</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-info~176"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Info</strong></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    <br>


    <section>    
      <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-one~146"></span>
              double precision,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>ONE</strong></td>
<td> =</td>
                <td>1.0D0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-zero~137"></span>
              double precision,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>ZERO</strong></td>
<td> =</td>
                <td>0.0D0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-childinfo~3"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>childinfo</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-colmajor~3"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>colmajor</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-defaultsigns"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>defaultsigns</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-i~144"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>i</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ib11d"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ib11d</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ib11e"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ib11e</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ib12d"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ib12d</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ib12e"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ib12e</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ib21d"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ib21d</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ib21e"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ib21e</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ib22d"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ib22d</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ib22e"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ib22e</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ibbcsd"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ibbcsd</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iorbdb"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iorbdb</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iorglq"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iorglq</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iorgqr"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iorgqr</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iphi"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iphi</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-itaup1"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>itaup1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-itaup2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>itaup2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-itauq1"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>itauq1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-itauq2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>itauq2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-j~105"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>j</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lbbcsdwork"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lbbcsdwork</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lbbcsdworkmin"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lbbcsdworkmin</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lbbcsdworkopt"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lbbcsdworkopt</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lorbdbwork"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lorbdbwork</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lorbdbworkmin"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lorbdbworkmin</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lorbdbworkopt"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lorbdbworkopt</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lorglqwork"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lorglqwork</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lorglqworkmin"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lorglqworkmin</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lorglqworkopt"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lorglqworkopt</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lorgqrwork"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lorgqrwork</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lorgqrworkmin"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lorgqrworkmin</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lorgqrworkopt"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lorgqrworkopt</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lquery~59"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lquery</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lworkmin~5"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lworkmin</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lworkopt~5"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lworkopt</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-signst"></span>
              character(len=1),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>signst</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-transt~6"></span>
              character(len=1),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>transt</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wantu1"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wantu1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wantu2"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wantu2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wantv1t"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wantv1t</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wantv2t"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wantv2t</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">      </span><span class="k">RECURSIVE SUBROUTINE </span><span class="n">DORCSD</span><span class="p">(</span><span class="n">Jobu1</span><span class="p">,</span><span class="n">Jobu2</span><span class="p">,</span><span class="n">Jobv1t</span><span class="p">,</span><span class="n">Jobv2t</span><span class="p">,</span><span class="n">Trans</span><span class="p">,</span><span class="n">Signs</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                            </span><span class="n">M</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="n">X11</span><span class="p">,</span><span class="n">Ldx11</span><span class="p">,</span><span class="n">X12</span><span class="p">,</span><span class="n">Ldx12</span><span class="p">,</span><span class="n">X21</span><span class="p">,</span><span class="n">Ldx21</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                            </span><span class="n">X22</span><span class="p">,</span><span class="n">Ldx22</span><span class="p">,</span><span class="n">Theta</span><span class="p">,</span><span class="n">U1</span><span class="p">,</span><span class="n">Ldu1</span><span class="p">,</span><span class="n">U2</span><span class="p">,</span><span class="n">Ldu2</span><span class="p">,</span><span class="n">V1t</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                            </span><span class="n">Ldv1t</span><span class="p">,</span><span class="n">V2t</span><span class="p">,</span><span class="n">Ldv2t</span><span class="p">,</span><span class="n">Work</span><span class="p">,</span><span class="n">Lwork</span><span class="p">,</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">IMPLICIT NONE</span><span class="w"></span>
<span class="c">!*--DORCSD304</span>
<span class="c">!</span>
<span class="c">!  -- LAPACK computational routine (version 3.7.1) --</span>
<span class="c">!  -- LAPACK is a software package provided by Univ. of Tennessee,    --</span>
<span class="c">!  -- Univ. of California Berkeley, Univ. of Colorado Denver and NAG Ltd..--</span>
<span class="c">!     June 2017</span>
<span class="c">!</span>
<span class="c">!     .. Scalar Arguments ..</span>
<span class="w">      </span><span class="kt">CHARACTER </span><span class="n">Jobu1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Jobu2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Jobv1t</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Jobv2t</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Signs</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Trans</span><span class="w"></span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">Info</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Ldu1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Ldu2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Ldv1t</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Ldv2t</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Ldx11</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Ldx12</span><span class="w"> </span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">Ldx21</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Ldx22</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Lwork</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Q</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Array Arguments ..</span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">Iwork</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="kt">DOUBLE PRECISION </span><span class="n">Theta</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="kt">DOUBLE PRECISION </span><span class="n">U1</span><span class="p">(</span><span class="n">Ldu1</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">U2</span><span class="p">(</span><span class="n">Ldu2</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">V1t</span><span class="p">(</span><span class="n">Ldv1t</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                 </span><span class="n">V2t</span><span class="p">(</span><span class="n">Ldv2t</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">X11</span><span class="p">(</span><span class="n">Ldx11</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                 </span><span class="n">X12</span><span class="p">(</span><span class="n">Ldx12</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">X21</span><span class="p">(</span><span class="n">Ldx21</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">X22</span><span class="p">(</span><span class="n">Ldx22</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!</span>
<span class="c">!  ===================================================================</span>
<span class="c">!</span>
<span class="c">!     .. Parameters ..</span>
<span class="w">      </span><span class="kt">DOUBLE PRECISION </span><span class="n">ONE</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="w">      </span><span class="k">PARAMETER</span><span class="w"> </span><span class="p">(</span><span class="n">ONE</span><span class="o">=</span><span class="mf">1.0D0</span><span class="p">,</span><span class="n">ZERO</span><span class="o">=</span><span class="mf">0.0D0</span><span class="p">)</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Local Scalars ..</span>
<span class="w">      </span><span class="kt">CHARACTER </span><span class="n">transt</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">signst</span><span class="w"></span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">childinfo</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ib11d</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ib11e</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ib12d</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ib12e</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ib21d</span><span class="w"> </span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">ib21e</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ib22d</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ib22e</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ibbcsd</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">iorbdb</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">iorglq</span><span class="w"> </span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">iorgqr</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">iphi</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">itaup1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">itaup2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">itauq1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">itauq2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">lbbcsdwork</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lbbcsdworkmin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lbbcsdworkopt</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lorbdbwork</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">lorbdbworkmin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lorbdbworkopt</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lorglqwork</span><span class="w"> </span><span class="p">,</span><span class="w">              </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">lorglqworkmin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lorglqworkopt</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lorgqrwork</span><span class="w"> </span><span class="p">,</span><span class="w">              </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">lorgqrworkmin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lorgqrworkopt</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lworkmin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lworkopt</span><span class="w"></span>
<span class="w">      </span><span class="kt">LOGICAL </span><span class="n">colmajor</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">defaultsigns</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lquery</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">wantu1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">wantu2</span><span class="w"> </span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">wantv1t</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">wantv2t</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. External Subroutines ..</span>
<span class="w">      </span><span class="k">EXTERNAL </span><span class="n">DBBCSD</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">DLACPY</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">DLAPMR</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">DLAPMT</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">DORBDB</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">DORGLQ</span><span class="w"> </span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">         </span><span class="n">DORGQR</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">XERBLA</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. External Functions ..</span>
<span class="w">      </span><span class="kt">LOGICAL </span><span class="n">LSAME</span><span class="w"></span>
<span class="w">      </span><span class="k">EXTERNAL </span><span class="n">LSAME</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Intrinsic Functions</span>
<span class="w">      </span><span class="k">INTRINSIC </span><span class="nb">INT</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nb">MAX</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nb">MIN</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Executable Statements ..</span>
<span class="c">!</span>
<span class="c">!     Test input arguments</span>
<span class="c">!</span>
<span class="w">      </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">wantu1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LSAME</span><span class="p">(</span><span class="n">Jobu1</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">wantu2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LSAME</span><span class="p">(</span><span class="n">Jobu2</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">wantv1t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LSAME</span><span class="p">(</span><span class="n">Jobv1t</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">wantv2t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LSAME</span><span class="p">(</span><span class="n">Jobv2t</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">colmajor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">LSAME</span><span class="p">(</span><span class="n">Trans</span><span class="p">,</span><span class="s1">&#39;T&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">defaultsigns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">LSAME</span><span class="p">(</span><span class="n">Signs</span><span class="p">,</span><span class="s1">&#39;O&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">lquery</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Lwork</span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">M</span><span class="o">&lt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">7</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">P</span><span class="o">&lt;</span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">P</span><span class="o">&gt;</span><span class="n">M</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">8</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Q</span><span class="o">&lt;</span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">Q</span><span class="o">&gt;</span><span class="n">M</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">9</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">colmajor</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">Ldx11</span><span class="o">&lt;</span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">P</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">11</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">colmajor</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">Ldx11</span><span class="o">&lt;</span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Q</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">11</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">colmajor</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">Ldx12</span><span class="o">&lt;</span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">P</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">13</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">colmajor</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">Ldx12</span><span class="o">&lt;</span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">Q</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">13</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">colmajor</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">Ldx21</span><span class="o">&lt;</span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">P</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">15</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">colmajor</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">Ldx21</span><span class="o">&lt;</span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Q</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">15</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">colmajor</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">Ldx22</span><span class="o">&lt;</span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">P</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">17</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">colmajor</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">Ldx22</span><span class="o">&lt;</span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">Q</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">17</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wantu1</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">Ldu1</span><span class="o">&lt;</span><span class="n">P</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">20</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wantu2</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">Ldu2</span><span class="o">&lt;</span><span class="n">M</span><span class="o">-</span><span class="n">P</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">22</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wantv1t</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">Ldv1t</span><span class="o">&lt;</span><span class="n">Q</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">24</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wantv2t</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">Ldv2t</span><span class="o">&lt;</span><span class="n">M</span><span class="o">-</span><span class="n">Q</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">26</span><span class="w"></span>
<span class="w">      </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Work with transpose if convenient</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Info</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">P</span><span class="p">)</span><span class="o">&lt;</span><span class="nb">MIN</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">Q</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">colmajor</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            </span><span class="n">transt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;T&#39;</span><span class="w"></span>
<span class="w">         </span><span class="k">ELSE</span>
<span class="k">            </span><span class="n">transt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span>
<span class="k">         IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">defaultsigns</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            </span><span class="n">signst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;O&#39;</span><span class="w"></span>
<span class="w">         </span><span class="k">ELSE</span>
<span class="k">            </span><span class="n">signst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;D&#39;</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span>
<span class="k">         CALL </span><span class="n">DORCSD</span><span class="p">(</span><span class="n">Jobv1t</span><span class="p">,</span><span class="n">Jobv2t</span><span class="p">,</span><span class="n">Jobu1</span><span class="p">,</span><span class="n">Jobu2</span><span class="p">,</span><span class="n">transt</span><span class="p">,</span><span class="n">signst</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">X11</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">               </span><span class="n">Ldx11</span><span class="p">,</span><span class="n">X21</span><span class="p">,</span><span class="n">Ldx21</span><span class="p">,</span><span class="n">X12</span><span class="p">,</span><span class="n">Ldx12</span><span class="p">,</span><span class="n">X22</span><span class="p">,</span><span class="n">Ldx22</span><span class="p">,</span><span class="n">Theta</span><span class="p">,</span><span class="n">V1t</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">               </span><span class="n">Ldv1t</span><span class="p">,</span><span class="n">V2t</span><span class="p">,</span><span class="n">Ldv2t</span><span class="p">,</span><span class="n">U1</span><span class="p">,</span><span class="n">Ldu1</span><span class="p">,</span><span class="n">U2</span><span class="p">,</span><span class="n">Ldu2</span><span class="p">,</span><span class="n">Work</span><span class="p">,</span><span class="n">Lwork</span><span class="p">,</span><span class="n">Iwork</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">               </span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">RETURN</span>
<span class="k">      ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Work with permutation [ 0 I; I 0 ] * X * [ 0 I; I 0 ] if</span>
<span class="c">!     convenient</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Info</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">M</span><span class="o">-</span><span class="n">Q</span><span class="o">&lt;</span><span class="n">Q</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">defaultsigns</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            </span><span class="n">signst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;O&#39;</span><span class="w"></span>
<span class="w">         </span><span class="k">ELSE</span>
<span class="k">            </span><span class="n">signst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;D&#39;</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span>
<span class="k">         CALL </span><span class="n">DORCSD</span><span class="p">(</span><span class="n">Jobu2</span><span class="p">,</span><span class="n">Jobu1</span><span class="p">,</span><span class="n">Jobv2t</span><span class="p">,</span><span class="n">Jobv1t</span><span class="p">,</span><span class="n">Trans</span><span class="p">,</span><span class="n">signst</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">P</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">Q</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">               </span><span class="n">X22</span><span class="p">,</span><span class="n">Ldx22</span><span class="p">,</span><span class="n">X21</span><span class="p">,</span><span class="n">Ldx21</span><span class="p">,</span><span class="n">X12</span><span class="p">,</span><span class="n">Ldx12</span><span class="p">,</span><span class="n">X11</span><span class="p">,</span><span class="n">Ldx11</span><span class="p">,</span><span class="n">Theta</span><span class="p">,</span><span class="n">U2</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">               </span><span class="n">Ldu2</span><span class="p">,</span><span class="n">U1</span><span class="p">,</span><span class="n">Ldu1</span><span class="p">,</span><span class="n">V2t</span><span class="p">,</span><span class="n">Ldv2t</span><span class="p">,</span><span class="n">V1t</span><span class="p">,</span><span class="n">Ldv1t</span><span class="p">,</span><span class="n">Work</span><span class="p">,</span><span class="n">Lwork</span><span class="p">,</span><span class="n">Iwork</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">               </span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">RETURN</span>
<span class="k">      ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Compute workspace</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Info</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="w">         </span><span class="n">iphi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="w">         </span><span class="n">itaup1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iphi</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">itaup2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itaup1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">P</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">itauq1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itaup2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">P</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">itauq2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itauq1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Q</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">iorgqr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itauq2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">Q</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">CALL </span><span class="n">DORGQR</span><span class="p">(</span><span class="n">M</span><span class="o">-</span><span class="n">Q</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">Q</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">Q</span><span class="p">,</span><span class="n">U1</span><span class="p">,</span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">Q</span><span class="p">),</span><span class="n">U1</span><span class="p">,</span><span class="n">Work</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">childinfo</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">lorgqrworkopt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">Work</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="n">lorgqrworkmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">Q</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">iorglq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itauq2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">Q</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">CALL </span><span class="n">DORGLQ</span><span class="p">(</span><span class="n">M</span><span class="o">-</span><span class="n">Q</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">Q</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">Q</span><span class="p">,</span><span class="n">U1</span><span class="p">,</span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">Q</span><span class="p">),</span><span class="n">U1</span><span class="p">,</span><span class="n">Work</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">childinfo</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">lorglqworkopt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">Work</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="n">lorglqworkmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">Q</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">iorbdb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itauq2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">Q</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">CALL </span><span class="n">DORBDB</span><span class="p">(</span><span class="n">Trans</span><span class="p">,</span><span class="n">Signs</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="n">X11</span><span class="p">,</span><span class="n">Ldx11</span><span class="p">,</span><span class="n">X12</span><span class="p">,</span><span class="n">Ldx12</span><span class="p">,</span><span class="n">X21</span><span class="p">,</span><span class="n">Ldx21</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">               </span><span class="n">X22</span><span class="p">,</span><span class="n">Ldx22</span><span class="p">,</span><span class="n">Theta</span><span class="p">,</span><span class="n">V1t</span><span class="p">,</span><span class="n">U1</span><span class="p">,</span><span class="n">U2</span><span class="p">,</span><span class="n">V1t</span><span class="p">,</span><span class="n">V2t</span><span class="p">,</span><span class="n">Work</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">               </span><span class="n">childinfo</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">lorbdbworkopt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">Work</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="n">lorbdbworkmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lorbdbworkopt</span><span class="w"></span>
<span class="w">         </span><span class="n">ib11d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itauq2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">Q</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">ib11e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ib11d</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Q</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">ib12d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ib11e</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">ib12e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ib12d</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Q</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">ib21d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ib12e</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">ib21e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ib21d</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Q</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">ib22d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ib21e</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">ib22e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ib22d</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Q</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">ibbcsd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ib22e</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">CALL </span><span class="n">DBBCSD</span><span class="p">(</span><span class="n">Jobu1</span><span class="p">,</span><span class="n">Jobu2</span><span class="p">,</span><span class="n">Jobv1t</span><span class="p">,</span><span class="n">Jobv2t</span><span class="p">,</span><span class="n">Trans</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="n">Theta</span><span class="p">,</span><span class="n">Theta</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">               </span><span class="n">U1</span><span class="p">,</span><span class="n">Ldu1</span><span class="p">,</span><span class="n">U2</span><span class="p">,</span><span class="n">Ldu2</span><span class="p">,</span><span class="n">V1t</span><span class="p">,</span><span class="n">Ldv1t</span><span class="p">,</span><span class="n">V2t</span><span class="p">,</span><span class="n">Ldv2t</span><span class="p">,</span><span class="n">U1</span><span class="p">,</span><span class="n">U1</span><span class="p">,</span><span class="n">U1</span><span class="p">,</span><span class="n">U1</span><span class="p">,</span><span class="n">U1</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">               </span><span class="n">U1</span><span class="p">,</span><span class="n">U1</span><span class="p">,</span><span class="n">U1</span><span class="p">,</span><span class="n">Work</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">childinfo</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">lbbcsdworkopt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">Work</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="n">lbbcsdworkmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lbbcsdworkopt</span><span class="w"></span>
<span class="w">         </span><span class="n">lworkopt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">iorgqr</span><span class="o">+</span><span class="n">lorgqrworkopt</span><span class="p">,</span><span class="n">iorglq</span><span class="o">+</span><span class="n">lorglqworkopt</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">              </span><span class="n">iorbdb</span><span class="o">+</span><span class="n">lorbdbworkopt</span><span class="p">,</span><span class="n">ibbcsd</span><span class="o">+</span><span class="n">lbbcsdworkopt</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="n">lworkmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">iorgqr</span><span class="o">+</span><span class="n">lorgqrworkmin</span><span class="p">,</span><span class="n">iorglq</span><span class="o">+</span><span class="n">lorglqworkmin</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">              </span><span class="n">iorbdb</span><span class="o">+</span><span class="n">lorbdbworkopt</span><span class="p">,</span><span class="n">ibbcsd</span><span class="o">+</span><span class="n">lbbcsdworkmin</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="n">Work</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">lworkopt</span><span class="p">,</span><span class="n">lworkmin</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Lwork</span><span class="o">&lt;</span><span class="n">lworkmin</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">lquery</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">22</span><span class="w"></span>
<span class="w">         </span><span class="k">ELSE</span>
<span class="k">            </span><span class="n">lorgqrwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Lwork</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">iorgqr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">lorglqwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Lwork</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">iorglq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">lorbdbwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Lwork</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">iorbdb</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">lbbcsdwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Lwork</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ibbcsd</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span>
<span class="k">      ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Abort if any illegal arguments</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Info</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         CALL </span><span class="n">XERBLA</span><span class="p">(</span><span class="s1">&#39;DORCSD&#39;</span><span class="p">,</span><span class="o">-</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">RETURN</span>
<span class="k">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">lquery</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         RETURN</span>
<span class="k">      ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Transform to bidiagonal block form</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">CALL </span><span class="n">DORBDB</span><span class="p">(</span><span class="n">Trans</span><span class="p">,</span><span class="n">Signs</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="n">X11</span><span class="p">,</span><span class="n">Ldx11</span><span class="p">,</span><span class="n">X12</span><span class="p">,</span><span class="n">Ldx12</span><span class="p">,</span><span class="n">X21</span><span class="p">,</span><span class="n">Ldx21</span><span class="p">,</span><span class="n">X22</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">            </span><span class="n">Ldx22</span><span class="p">,</span><span class="n">Theta</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">iphi</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup1</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup2</span><span class="p">),</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">            </span><span class="n">Work</span><span class="p">(</span><span class="n">itauq1</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq2</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">iorbdb</span><span class="p">),</span><span class="n">lorbdbwork</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">            </span><span class="n">childinfo</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Accumulate Householder reflectors</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">colmajor</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wantu1</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">P</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            CALL </span><span class="n">DLACPY</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="n">X11</span><span class="p">,</span><span class="n">Ldx11</span><span class="p">,</span><span class="n">U1</span><span class="p">,</span><span class="n">Ldu1</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">DORGQR</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="n">U1</span><span class="p">,</span><span class="n">Ldu1</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup1</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">iorgqr</span><span class="p">),</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">lorgqrwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span>
<span class="k">         IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wantu2</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">M</span><span class="o">&gt;</span><span class="n">P</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            CALL </span><span class="n">DLACPY</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="n">X21</span><span class="p">,</span><span class="n">Ldx21</span><span class="p">,</span><span class="n">U2</span><span class="p">,</span><span class="n">Ldu2</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">DORGQR</span><span class="p">(</span><span class="n">M</span><span class="o">-</span><span class="n">P</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="n">U2</span><span class="p">,</span><span class="n">Ldu2</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup2</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">iorgqr</span><span class="p">),</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">lorgqrwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span>
<span class="k">         IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wantv1t</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">Q</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            CALL </span><span class="n">DLACPY</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="n">Q</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">Q</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">X11</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">Ldx11</span><span class="p">,</span><span class="n">V1t</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">Ldv1t</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">V1t</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ONE</span><span class="w"></span>
<span class="w">            </span><span class="k">DO </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Q</span><span class="w"></span>
<span class="w">               </span><span class="n">V1t</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="w">               </span><span class="n">V1t</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDDO</span>
<span class="k">            CALL </span><span class="n">DORGLQ</span><span class="p">(</span><span class="n">Q</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">Q</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">Q</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">V1t</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">Ldv1t</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq1</span><span class="p">),</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">iorglq</span><span class="p">),</span><span class="n">lorglqwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span>
<span class="k">         IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wantv2t</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">M</span><span class="o">&gt;</span><span class="n">Q</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            CALL </span><span class="n">DLACPY</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">Q</span><span class="p">,</span><span class="n">X12</span><span class="p">,</span><span class="n">Ldx12</span><span class="p">,</span><span class="n">V2t</span><span class="p">,</span><span class="n">Ldv2t</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">M</span><span class="o">-</span><span class="n">P</span><span class="o">&gt;</span><span class="n">Q</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">CALL </span><span class="n">DLACPY</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">P</span><span class="o">-</span><span class="n">Q</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">P</span><span class="o">-</span><span class="n">Q</span><span class="p">,</span><span class="n">X22</span><span class="p">(</span><span class="n">Q</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">P</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">Ldx22</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                               </span><span class="n">V2t</span><span class="p">(</span><span class="n">P</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">P</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">Ldv2t</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">M</span><span class="o">&gt;</span><span class="n">Q</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">CALL </span><span class="n">DORGLQ</span><span class="p">(</span><span class="n">M</span><span class="o">-</span><span class="n">Q</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">Q</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">Q</span><span class="p">,</span><span class="n">V2t</span><span class="p">,</span><span class="n">Ldv2t</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq2</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                             </span><span class="n">Work</span><span class="p">(</span><span class="n">iorglq</span><span class="p">),</span><span class="n">lorglqwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span>
<span class="k">      ELSE</span>
<span class="k">         IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wantu1</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">P</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            CALL </span><span class="n">DLACPY</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">X11</span><span class="p">,</span><span class="n">Ldx11</span><span class="p">,</span><span class="n">U1</span><span class="p">,</span><span class="n">Ldu1</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">DORGLQ</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="n">U1</span><span class="p">,</span><span class="n">Ldu1</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup1</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">iorglq</span><span class="p">),</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">lorglqwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span>
<span class="k">         IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wantu2</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">M</span><span class="o">&gt;</span><span class="n">P</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            CALL </span><span class="n">DLACPY</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">P</span><span class="p">,</span><span class="n">X21</span><span class="p">,</span><span class="n">Ldx21</span><span class="p">,</span><span class="n">U2</span><span class="p">,</span><span class="n">Ldu2</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">DORGLQ</span><span class="p">(</span><span class="n">M</span><span class="o">-</span><span class="n">P</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="n">U2</span><span class="p">,</span><span class="n">Ldu2</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itaup2</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">iorglq</span><span class="p">),</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">lorglqwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span>
<span class="k">         IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wantv1t</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">Q</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            CALL </span><span class="n">DLACPY</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="n">Q</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">Q</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">X11</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">Ldx11</span><span class="p">,</span><span class="n">V1t</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">Ldv1t</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">V1t</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ONE</span><span class="w"></span>
<span class="w">            </span><span class="k">DO </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Q</span><span class="w"></span>
<span class="w">               </span><span class="n">V1t</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="w">               </span><span class="n">V1t</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDDO</span>
<span class="k">            CALL </span><span class="n">DORGQR</span><span class="p">(</span><span class="n">Q</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">Q</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">Q</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">V1t</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">Ldv1t</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq1</span><span class="p">),</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">iorgqr</span><span class="p">),</span><span class="n">lorgqrwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span>
<span class="k">         IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wantv2t</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">M</span><span class="o">&gt;</span><span class="n">Q</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            CALL </span><span class="n">DLACPY</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">Q</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">X12</span><span class="p">,</span><span class="n">Ldx12</span><span class="p">,</span><span class="n">V2t</span><span class="p">,</span><span class="n">Ldv2t</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">DLACPY</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">P</span><span class="o">-</span><span class="n">Q</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">P</span><span class="o">-</span><span class="n">Q</span><span class="p">,</span><span class="n">X22</span><span class="p">(</span><span class="n">P</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">Q</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">Ldx22</span><span class="p">,</span><span class="n">V2t</span><span class="p">(</span><span class="n">P</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">P</span><span class="o">+</span><span class="mi">1</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Ldv2t</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">DORGQR</span><span class="p">(</span><span class="n">M</span><span class="o">-</span><span class="n">Q</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">Q</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">Q</span><span class="p">,</span><span class="n">V2t</span><span class="p">,</span><span class="n">Ldv2t</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">itauq2</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">iorgqr</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">lorgqrwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span>
<span class="k">      ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Compute the CSD of the matrix in bidiagonal-block form</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">CALL </span><span class="n">DBBCSD</span><span class="p">(</span><span class="n">Jobu1</span><span class="p">,</span><span class="n">Jobu2</span><span class="p">,</span><span class="n">Jobv1t</span><span class="p">,</span><span class="n">Jobv2t</span><span class="p">,</span><span class="n">Trans</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="n">Theta</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">iphi</span><span class="p">)&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">            </span><span class="p">,</span><span class="n">U1</span><span class="p">,</span><span class="n">Ldu1</span><span class="p">,</span><span class="n">U2</span><span class="p">,</span><span class="n">Ldu2</span><span class="p">,</span><span class="n">V1t</span><span class="p">,</span><span class="n">Ldv1t</span><span class="p">,</span><span class="n">V2t</span><span class="p">,</span><span class="n">Ldv2t</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">ib11d</span><span class="p">),</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">            </span><span class="n">Work</span><span class="p">(</span><span class="n">ib11e</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">ib12d</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">ib12e</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">ib21d</span><span class="p">),</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">            </span><span class="n">Work</span><span class="p">(</span><span class="n">ib21e</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">ib22d</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">ib22e</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">ibbcsd</span><span class="p">),</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">            </span><span class="n">lbbcsdwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Permute rows and columns to place identity submatrices in top-</span>
<span class="c">!     left corner of (1,1)-block and/or bottom-right corner of (1,2)-</span>
<span class="c">!     block and/or bottom-right corner of (2,1)-block and/or top-left</span>
<span class="c">!     corner of (2,2)-block</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Q</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">wantu2</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Q</span><span class="w"></span>
<span class="w">            </span><span class="n">Iwork</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Q</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDDO</span>
<span class="k">         DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Q</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">P</span><span class="w"></span>
<span class="w">            </span><span class="n">Iwork</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Q</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDDO</span>
<span class="k">         IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">colmajor</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            CALL </span><span class="n">DLAPMT</span><span class="p">(.</span><span class="n">FALSE</span><span class="p">.,</span><span class="n">M</span><span class="o">-</span><span class="n">P</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">P</span><span class="p">,</span><span class="n">U2</span><span class="p">,</span><span class="n">Ldu2</span><span class="p">,</span><span class="n">Iwork</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">ELSE</span>
<span class="k">            CALL </span><span class="n">DLAPMR</span><span class="p">(.</span><span class="n">FALSE</span><span class="p">.,</span><span class="n">M</span><span class="o">-</span><span class="n">P</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">P</span><span class="p">,</span><span class="n">U2</span><span class="p">,</span><span class="n">Ldu2</span><span class="p">,</span><span class="n">Iwork</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span>
<span class="k">      ENDIF</span>
<span class="k">      IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">M</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">wantv2t</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">P</span><span class="w"></span>
<span class="w">            </span><span class="n">Iwork</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Q</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDDO</span>
<span class="k">         DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Q</span><span class="w"></span>
<span class="w">            </span><span class="n">Iwork</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">P</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDDO</span>
<span class="k">         IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">colmajor</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            CALL </span><span class="n">DLAPMT</span><span class="p">(.</span><span class="n">FALSE</span><span class="p">.,</span><span class="n">M</span><span class="o">-</span><span class="n">Q</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">Q</span><span class="p">,</span><span class="n">V2t</span><span class="p">,</span><span class="n">Ldv2t</span><span class="p">,</span><span class="n">Iwork</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">ELSE</span>
<span class="k">            CALL </span><span class="n">DLAPMR</span><span class="p">(.</span><span class="n">FALSE</span><span class="p">.,</span><span class="n">M</span><span class="o">-</span><span class="n">Q</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="n">Q</span><span class="p">,</span><span class="n">V2t</span><span class="p">,</span><span class="n">Ldv2t</span><span class="p">,</span><span class="n">Iwork</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span>
<span class="k">      ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!</span>
<span class="c">!     End DORCSD</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">END SUBROUTINE </span><span class="n">DORCSD</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              spag_lapack
 was developed by John S. Urban<br>              &copy; 2025 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2025-07-11 01:31 +0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>