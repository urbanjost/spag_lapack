<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="spag_lapack module">
    <meta name="author" content="John S. Urban" >
    <link rel="icon" href="../favicon.png">

    <title>CUNGTSQR_ROW &ndash; spag_lapack</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">spag_lapack </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>CUNGTSQR_ROW
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 0.0% of total for procedures.">70 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/cungtsqr_row.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/cungtsqr_row.f90.html'>cungtsqr_row.f90</a></li>
            <li class="breadcrumb-item active" aria-current="page">CUNGTSQR_ROW</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#vars-0"
         aria-expanded="false" aria-controls="vars-0">
         <h4 class="card-header bg-primary text-white">Variables</h4>
      </a>
      <div id="vars-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../proc/cungtsqr_row.html#variable-cone~123">CONE</a>
            <a class="list-group-item" href="../proc/cungtsqr_row.html#variable-czero~90">CZERO</a>
            <a class="list-group-item" href="../proc/cungtsqr_row.html#variable-dummy~11">dummy</a>
            <a class="list-group-item" href="../proc/cungtsqr_row.html#variable-ib~107">ib</a>
            <a class="list-group-item" href="../proc/cungtsqr_row.html#variable-ib_bottom~2">ib_bottom</a>
            <a class="list-group-item" href="../proc/cungtsqr_row.html#variable-imb~2">imb</a>
            <a class="list-group-item" href="../proc/cungtsqr_row.html#variable-itmp~6">itmp</a>
            <a class="list-group-item" href="../proc/cungtsqr_row.html#variable-jb_t~2">jb_t</a>
            <a class="list-group-item" href="../proc/cungtsqr_row.html#variable-kb~20">kb</a>
            <a class="list-group-item" href="../proc/cungtsqr_row.html#variable-kb_last~2">kb_last</a>
            <a class="list-group-item" href="../proc/cungtsqr_row.html#variable-knb~2">knb</a>
            <a class="list-group-item" href="../proc/cungtsqr_row.html#variable-lquery~345">lquery</a>
            <a class="list-group-item" href="../proc/cungtsqr_row.html#variable-lworkopt~25">lworkopt</a>
            <a class="list-group-item" href="../proc/cungtsqr_row.html#variable-m_plus_one~2">m_plus_one</a>
            <a class="list-group-item" href="../proc/cungtsqr_row.html#variable-mb1~2">mb1</a>
            <a class="list-group-item" href="../proc/cungtsqr_row.html#variable-mb2~2">mb2</a>
            <a class="list-group-item" href="../proc/cungtsqr_row.html#variable-nblocal~4">nblocal</a>
            <a class="list-group-item" href="../proc/cungtsqr_row.html#variable-num_all_row_blocks~5">num_all_row_blocks</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/cungtsqr_row.html#src">CUNGTSQR_ROW</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2> subroutine CUNGTSQR_ROW(M, N, Mb, Nb, A, Lda, T, Ldt, Work, Lwork, Info)  
</h2>
    

    <p>\brief \b CUNGTSQR_ROW
 \htmlonly
 Download CUNGTSQR_ROW + dependencies
 <a href="http://www.netlib.org/cgi-bin/netlibfiles.tgz?format=tgz&filename=/lapack/lapack_routine/cunrgtsqr_row.f">
 [TGZ]</a>
 <a href="http://www.netlib.org/cgi-bin/netlibfiles.zip?format=zip&filename=/lapack/lapack_routine/cunrgtsqr_row.f">
 [ZIP]</a>
 <a href="http://www.netlib.org/cgi-bin/netlibfiles.txt?format=txt&filename=/lapack/lapack_routine/cunrgtsqr_row.f">
 [TXT]</a>
 \endhtmlonly</p>
<p>\par Purpose:</p>
<p>\verbatim</p>
<p>CUNGTSQR_ROW generates an M-by-N complex matrix Q_out with
 orthonormal columns from the output of CLATSQR. These N orthonormal
 columns are the first N columns of a product of complex unitary
 matrices Q(k)_in of order M, which are returned by CLATSQR in
 a special format.</p>
<div class="codehilite"><pre><span></span><code>  Q_out = first_N_columns_of( Q(1)_in * Q(2)_in * ... * Q(k)_in ).
</code></pre></div>

<p>The input matrices Q(k)_in are stored in row and column blocks in A.
 See the documentation of CLATSQR for more details on the format of
 Q(k)_in, where each Q(k)_in is represented by block Householder
 transformations. This routine calls an auxiliary routine CLARFB_GETT,
 where the computation is performed on each individual block. The
 algorithm first sweeps NB-sized column blocks from the right to left
 starting in the bottom row block and continues to the top row block
 (hence _ROW in the routine name). This sweep is in reverse order of
 the order in which CLATSQR generates the output blocks.
 \endverbatim
 \param[in] M
 \verbatim
          M is INTEGER
          The number of rows of the matrix A.  M &gt;= 0.
 \endverbatim</p>
<p>\param[in] N
 \verbatim
          N is INTEGER
          The number of columns of the matrix A. M &gt;= N &gt;= 0.
 \endverbatim</p>
<p>\param[in] MB
 \verbatim
          MB is INTEGER
          The row block size used by CLATSQR to return
          arrays A and T. MB &gt; N.
          (Note that if MB &gt; M, then M is used instead of MB
          as the row block size).
 \endverbatim</p>
<p>\param[in] NB
 \verbatim
          NB is INTEGER
          The column block size used by CLATSQR to return
          arrays A and T. NB &gt;= 1.
          (Note that if NB &gt; N, then N is used instead of NB
          as the column block size).
 \endverbatim</p>
<p>\param[in,out] A
 \verbatim
          A is COMPLEX array, dimension (LDA,N)</p>
<div class="codehilite"><pre><span></span><code>      <span class="nv">On</span> <span class="nv">entry</span>:

         <span class="nv">The</span> <span class="nv">elements</span> <span class="nv">on</span> <span class="nv">and</span> <span class="nv">above</span> <span class="nv">the</span> <span class="nv">diagonal</span> <span class="nv">are</span> <span class="nv">not</span> <span class="nv">used</span> <span class="nv">as</span>
         <span class="nv">input</span>. <span class="nv">The</span> <span class="nv">elements</span> <span class="nv">below</span> <span class="nv">the</span> <span class="nv">diagonal</span> <span class="nv">represent</span> <span class="nv">the</span> <span class="nv">unit</span>
         <span class="nv">lower</span><span class="o">-</span><span class="nv">trapezoidal</span> <span class="nv">blocked</span> <span class="nv">matrix</span> <span class="nv">V</span> <span class="nv">computed</span> <span class="nv">by</span> <span class="nv">CLATSQR</span>
         <span class="nv">that</span> <span class="nv">defines</span> <span class="nv">the</span> <span class="nv">input</span> <span class="nv">matrices</span> <span class="nv">Q_in</span><span class="ss">(</span><span class="nv">k</span><span class="ss">)</span> <span class="ss">(</span><span class="nv">ones</span> <span class="nv">on</span> <span class="nv">the</span>
         <span class="nv">diagonal</span> <span class="nv">are</span> <span class="nv">not</span> <span class="nv">stored</span><span class="ss">)</span>. <span class="nv">See</span> <span class="nv">CLATSQR</span> <span class="k">for</span> <span class="nv">more</span> <span class="nv">details</span>.

      <span class="nv">On</span> <span class="k">exit</span>:

         <span class="nv">The</span> <span class="nv">array</span> <span class="nv">A</span> <span class="nv">contains</span> <span class="nv">an</span> <span class="nv">M</span><span class="o">-</span><span class="nv">by</span><span class="o">-</span><span class="nv">N</span> <span class="nv">orthonormal</span> <span class="nv">matrix</span> <span class="nv">Q_out</span>,
         <span class="nv">i</span>.<span class="nv">e</span> <span class="nv">the</span> <span class="nv">columns</span> <span class="nv">of</span> <span class="nv">A</span> <span class="nv">are</span> <span class="nv">orthogonal</span> <span class="nv">unit</span> <span class="nv">vectors</span>.
</code></pre></div>

<p>\endverbatim</p>
<p>\param[in] LDA
 \verbatim
          LDA is INTEGER
          The leading dimension of the array A.  LDA &gt;= max(1,M).
 \endverbatim</p>
<p>\param[in] T
 \verbatim
          T is COMPLEX array,
          dimension (LDT, N * NIRB)
          where NIRB = Number_of_input_row_blocks
                     = MAX( 1, CEIL((M-N)/(MB-N)) )
          Let NICB = Number_of_input_col_blocks
                   = CEIL(N/NB)</p>
<div class="codehilite"><pre><span></span><code>      <span class="nv">The</span> <span class="nv">upper</span><span class="o">-</span><span class="nv">triangular</span> <span class="nv">block</span> <span class="nv">reflectors</span> <span class="nv">used</span> <span class="nv">to</span> <span class="nv">define</span> <span class="nv">the</span>
      <span class="nv">input</span> <span class="nv">matrices</span> <span class="nv">Q_in</span><span class="ss">(</span><span class="nv">k</span><span class="ss">)</span>, <span class="nv">k</span><span class="o">=</span><span class="ss">(</span><span class="mi">1</span>:<span class="nv">NIRB</span><span class="o">*</span><span class="nv">NICB</span><span class="ss">)</span>. <span class="nv">The</span> <span class="nv">block</span>
      <span class="nv">reflectors</span> <span class="nv">are</span> <span class="nv">stored</span> <span class="nv">in</span> <span class="nv">compact</span> <span class="nv">form</span> <span class="nv">in</span> <span class="nv">NIRB</span> <span class="nv">block</span>
      <span class="nv">reflector</span> <span class="nv">sequences</span>. <span class="nv">Each</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">NIRB</span> <span class="nv">block</span> <span class="nv">reflector</span>
      <span class="nv">sequences</span> <span class="nv">is</span> <span class="nv">stored</span> <span class="nv">in</span> <span class="nv">a</span> <span class="nv">larger</span> <span class="nv">NB</span><span class="o">-</span><span class="nv">by</span><span class="o">-</span><span class="nv">N</span> <span class="nv">column</span> <span class="nv">block</span> <span class="nv">of</span> <span class="nv">T</span>
      <span class="nv">and</span> <span class="nv">consists</span> <span class="nv">of</span> <span class="nv">NICB</span> <span class="nv">smaller</span> <span class="nv">NB</span><span class="o">-</span><span class="nv">by</span><span class="o">-</span><span class="nv">NB</span> <span class="nv">upper</span><span class="o">-</span><span class="nv">triangular</span>
      <span class="nv">column</span> <span class="nv">blocks</span>. <span class="nv">See</span> <span class="nv">CLATSQR</span> <span class="k">for</span> <span class="nv">more</span> <span class="nv">details</span> <span class="nv">on</span> <span class="nv">the</span> <span class="nv">format</span>
      <span class="nv">of</span> <span class="nv">T</span>.
</code></pre></div>

<p>\endverbatim</p>
<p>\param[in] LDT
 \verbatim
          LDT is INTEGER
          The leading dimension of the array T.
          LDT &gt;= max(1,min(NB,N)).
 \endverbatim</p>
<p>\param[out] WORK
 \verbatim
          (workspace) COMPLEX array, dimension (MAX(1,LWORK))
          On exit, if INFO = 0, WORK(1) returns the optimal LWORK.
 \endverbatim</p>
<p>\param[in] LWORK
 \verbatim
          The dimension of the array WORK.
          LWORK &gt;= NBLOCAL * MAX(NBLOCAL,(N-NBLOCAL)),
          where NBLOCAL=MIN(NB,N).
          If LWORK = -1, then a workspace query is assumed.
          The routine only calculates the optimal size of the WORK
          array, returns this value as the first entry of the WORK
          array, and no error message related to LWORK is issued
          by XERBLA.
 \endverbatim</p>
<p>\param[out] INFO
 \verbatim
          INFO is INTEGER
          = 0:  successful exit
          &lt; 0:  if INFO = -i, the i-th argument had an illegal value
 \endverbatim</p>
<p>\author Univ. of Tennessee
 \author Univ. of California Berkeley
 \author Univ. of Colorado Denver
 \author NAG Ltd.
 \date November 2020
 \ingroup complexOTHERcomputational
 \par Contributors:</p>
<p>\verbatim</p>
<p>November 2020, Igor Kozachenko,
                Computer Science Division,
                University of California, Berkeley</p>
<p>\endverbatim</p>
<p>&ndash;CUNGTSQR_ROW191</p>
<p>&ndash; LAPACK computational routine (version 3.10.0) &ndash;
  &ndash; LAPACK is a software package provided by Univ. of Tennessee,    &ndash;
  &ndash; Univ. of California Berkeley, Univ. of Colorado Denver and NAG Ltd..&ndash;
     November 2020</p>
<div class="codehilite"><pre><span></span><code> .. Scalar Arguments ..
</code></pre></div>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-m~502"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>M</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-n~1358"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>N</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-mb~32"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Mb</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nb~64"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Nb</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-a~835"></span>
              complex
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>A</strong>(Lda,*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lda~805"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Lda</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-t~121"></span>
              complex
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>T</strong>(Ldt,*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldt~110"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ldt</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-work~805"></span>
              complex
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Work</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork~379"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Lwork</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-info~1061"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Info</strong></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    <br>


    <section>    
      <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-cone~123"></span>
              complex,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>CONE</strong></td>
<td> =</td>
                <td>(1.0E+0,0.0E+0)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-czero~90"></span>
              complex,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>CZERO</strong></td>
<td> =</td>
                <td>(0.0E+0,0.0E+0)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-dummy~11"></span>
              complex,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>dummy</strong>(1,1)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ib~107"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ib</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ib_bottom~2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ib_bottom</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-imb~2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>imb</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-itmp~6"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>itmp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jb_t~2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jb_t</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-kb~20"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>kb</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-kb_last~2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>kb_last</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-knb~2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>knb</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lquery~345"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lquery</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lworkopt~25"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lworkopt</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-m_plus_one~2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>m_plus_one</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-mb1~2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>mb1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-mb2~2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>mb2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nblocal~4"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nblocal</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-num_all_row_blocks~5"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>num_all_row_blocks</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">      </span><span class="k">SUBROUTINE </span><span class="n">CUNGTSQR_ROW</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Mb</span><span class="p">,</span><span class="n">Nb</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">Ldt</span><span class="p">,</span><span class="n">Work</span><span class="p">,</span><span class="n">Lwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">IMPLICIT NONE</span><span class="w"></span>
<span class="c">!*--CUNGTSQR_ROW191</span>
<span class="c">!</span>
<span class="c">!  -- LAPACK computational routine (version 3.10.0) --</span>
<span class="c">!  -- LAPACK is a software package provided by Univ. of Tennessee,    --</span>
<span class="c">!  -- Univ. of California Berkeley, Univ. of Colorado Denver and NAG Ltd..--</span>
<span class="c">!     November 2020</span>
<span class="c">!</span>
<span class="c">!     .. Scalar Arguments ..</span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">Info</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Lda</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Ldt</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Lwork</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Mb</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Nb</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Array Arguments ..</span>
<span class="w">      </span><span class="kt">COMPLEX </span><span class="n">A</span><span class="p">(</span><span class="n">Lda</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="p">(</span><span class="n">Ldt</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!</span>
<span class="c">!  =====================================================================</span>
<span class="c">!</span>
<span class="c">!     .. Parameters ..</span>
<span class="w">      </span><span class="kt">COMPLEX </span><span class="n">CONE</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">CZERO</span><span class="w"></span>
<span class="w">      </span><span class="k">PARAMETER</span><span class="w"> </span><span class="p">(</span><span class="n">CONE</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0E+0</span><span class="p">,</span><span class="mf">0.0E+0</span><span class="p">),</span><span class="n">CZERO</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0E+0</span><span class="p">,</span><span class="mf">0.0E+0</span><span class="p">))</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Local Scalars ..</span>
<span class="w">      </span><span class="kt">LOGICAL </span><span class="n">lquery</span><span class="w"></span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">nblocal</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">mb2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">m_plus_one</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">itmp</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ib_bottom</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lworkopt</span><span class="w"> </span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">num_all_row_blocks</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">jb_t</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ib</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">imb</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">kb</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">kb_last</span><span class="w"> </span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">knb</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">mb1</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Local Arrays ..</span>
<span class="w">      </span><span class="kt">COMPLEX </span><span class="n">dummy</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. External Subroutines ..</span>
<span class="w">      </span><span class="k">EXTERNAL </span><span class="n">CLARFB_GETT</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">CLASET</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">XERBLA</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Intrinsic Functions ..</span>
<span class="w">      </span><span class="k">INTRINSIC </span><span class="nb">CMPLX</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nb">MAX</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nb">MIN</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Executable Statements ..</span>
<span class="c">!</span>
<span class="c">!     Test the input parameters</span>
<span class="c">!</span>
<span class="w">      </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">lquery</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Lwork</span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">M</span><span class="o">&lt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">N</span><span class="o">&lt;</span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">M</span><span class="o">&lt;</span><span class="n">N</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Mb</span><span class="o">&lt;=</span><span class="n">N</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Nb</span><span class="o">&lt;</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Lda</span><span class="o">&lt;</span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">6</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Ldt</span><span class="o">&lt;</span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">MIN</span><span class="p">(</span><span class="n">Nb</span><span class="p">,</span><span class="n">N</span><span class="p">))</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">8</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Lwork</span><span class="o">&lt;</span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">lquery</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">10</span><span class="w"></span>
<span class="w">      </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="w">      </span><span class="n">nblocal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">Nb</span><span class="p">,</span><span class="n">N</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Determine the workspace size.</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Info</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">lworkopt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nblocal</span><span class="o">*</span><span class="nb">MAX</span><span class="p">(</span><span class="n">nblocal</span><span class="p">,(</span><span class="n">N</span><span class="o">-</span><span class="n">nblocal</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Handle error in the input parameters and handle the workspace query.</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Info</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         CALL </span><span class="n">XERBLA</span><span class="p">(</span><span class="s1">&#39;CUNGTSQR_ROW&#39;</span><span class="p">,</span><span class="o">-</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">RETURN</span>
<span class="k">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">lquery</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Work</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">CMPLX</span><span class="p">(</span><span class="n">lworkopt</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">RETURN</span>
<span class="k">      ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Quick return if possible</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Work</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">CMPLX</span><span class="p">(</span><span class="n">lworkopt</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">RETURN</span>
<span class="k">      ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     (0) Set the upper-triangular part of the matrix A to zero and</span>
<span class="c">!     its diagonal elements to one.</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">CALL </span><span class="n">CLASET</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">CONE</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     KB_LAST is the column index of the last column block reflector</span>
<span class="c">!     in the matrices T and V.</span>
<span class="c">!</span>
<span class="w">      </span><span class="n">kb_last</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">nblocal</span><span class="p">)</span><span class="o">*</span><span class="n">nblocal</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!</span>
<span class="c">!     (1) Bottom-up loop over row blocks of A, except the top row block.</span>
<span class="c">!     NOTE: If MB&gt;=M, then the loop is never executed.</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Mb</span><span class="o">&lt;</span><span class="n">M</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!        MB2 is the row blocking size for the row blocks before the</span>
<span class="c">!        first top row block in the matrix A. IB is the row index for</span>
<span class="c">!        the row blocks in the matrix A before the first top row block.</span>
<span class="c">!        IB_BOTTOM is the row index for the last bottom row block</span>
<span class="c">!        in the matrix A. JB_T is the column index of the corresponding</span>
<span class="c">!        column block in the matrix T.</span>
<span class="c">!</span>
<span class="c">!        Initialize variables.</span>
<span class="c">!</span>
<span class="c">!        NUM_ALL_ROW_BLOCKS is the number of row blocks in the matrix A</span>
<span class="c">!        including the first row block.</span>
<span class="c">!</span>
<span class="w">         </span><span class="n">mb2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Mb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">         </span><span class="n">m_plus_one</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="n">itmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">M</span><span class="o">-</span><span class="n">Mb</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">mb2</span><span class="w"></span>
<span class="w">         </span><span class="n">ib_bottom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itmp</span><span class="o">*</span><span class="n">mb2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Mb</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="n">num_all_row_blocks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="w">         </span><span class="n">jb_t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">num_all_row_blocks</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="c">!</span>
<span class="w">         </span><span class="k">DO </span><span class="n">ib</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ib_bottom</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Mb</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">mb2</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Determine the block size IMB for the current row block</span>
<span class="c">!           in the matrix A.</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">imb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">m_plus_one</span><span class="o">-</span><span class="n">ib</span><span class="p">,</span><span class="n">mb2</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Determine the column index JB_T for the current column block</span>
<span class="c">!           in the matrix T.</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">jb_t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jb_t</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Apply column blocks of H in the row block from right to left.</span>
<span class="c">!</span>
<span class="c">!           KB is the column index of the current column block reflector</span>
<span class="c">!           in the matrices T and V.</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">DO </span><span class="n">kb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kb_last</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">nblocal</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Determine the size of the current column block KNB in</span>
<span class="c">!              the matrices T and V.</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">knb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">nblocal</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="n">kb</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="w">               </span><span class="k">CALL </span><span class="n">CLARFB_GETT</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="n">imb</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="n">kb</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">knb</span><span class="p">,</span><span class="n">T</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">jb_t</span><span class="o">+</span><span class="n">kb</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">Ldt</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                          </span><span class="n">A</span><span class="p">(</span><span class="n">kb</span><span class="p">,</span><span class="n">kb</span><span class="p">),</span><span class="n">Lda</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span><span class="n">kb</span><span class="p">),</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">,</span><span class="n">knb</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">ENDDO</span><span class="w"></span>
<span class="c">!</span>
<span class="w">         </span><span class="k">ENDDO</span><span class="w"></span>
<span class="c">!</span>
<span class="w">      </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     (2) Top row block of A.</span>
<span class="c">!     NOTE: If MB&gt;=M, then we have only one row block of A of size M</span>
<span class="c">!     and we work on the entire matrix A.</span>
<span class="c">!</span>
<span class="w">      </span><span class="n">mb1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">Mb</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Apply column blocks of H in the top row block from right to left.</span>
<span class="c">!</span>
<span class="c">!     KB is the column index of the current block reflector in</span>
<span class="c">!     the matrices T and V.</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">DO </span><span class="n">kb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kb_last</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">nblocal</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!        Determine the size of the current column block KNB in</span>
<span class="c">!        the matrices T and V.</span>
<span class="c">!</span>
<span class="w">         </span><span class="n">knb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">nblocal</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="n">kb</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">mb1</span><span class="o">-</span><span class="n">kb</span><span class="o">-</span><span class="n">knb</span><span class="o">+</span><span class="mi">1</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           In SLARFB_GETT parameters, when M=0, then the matrix B</span>
<span class="c">!           does not exist, hence we need to pass a dummy array</span>
<span class="c">!           reference DUMMY(1,1) to B with LDDUMMY=1.</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">CLARFB_GETT</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="n">kb</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">knb</span><span class="p">,</span><span class="n">T</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">kb</span><span class="p">),</span><span class="n">Ldt</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="n">kb</span><span class="p">,</span><span class="n">kb</span><span class="p">),</span><span class="n">Lda</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                       </span><span class="n">dummy</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">Work</span><span class="p">,</span><span class="n">knb</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">ELSE</span>
<span class="k">            CALL </span><span class="n">CLARFB_GETT</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">mb1</span><span class="o">-</span><span class="n">kb</span><span class="o">-</span><span class="n">knb</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="n">kb</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">knb</span><span class="p">,</span><span class="n">T</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">kb</span><span class="p">),</span><span class="n">Ldt</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                       </span><span class="n">A</span><span class="p">(</span><span class="n">kb</span><span class="p">,</span><span class="n">kb</span><span class="p">),</span><span class="n">Lda</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="n">kb</span><span class="o">+</span><span class="n">knb</span><span class="p">,</span><span class="n">kb</span><span class="p">),</span><span class="n">Lda</span><span class="p">,</span><span class="n">Work</span><span class="p">,</span><span class="n">knb</span><span class="p">)</span><span class="w"></span>
<span class="w"> </span>
<span class="w">         </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="w">      </span><span class="k">ENDDO</span><span class="w"></span>
<span class="c">!</span>
<span class="w">      </span><span class="n">Work</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">CMPLX</span><span class="p">(</span><span class="n">lworkopt</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     End of CUNGTSQR_ROW</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">END SUBROUTINE </span><span class="n">CUNGTSQR_ROW</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              spag_lapack
 was developed by John S. Urban<br>              &copy; 2025 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2025-07-11 01:31 +0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>