<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="spag_lapack module">
    <meta name="author" content="John S. Urban" >
    <link rel="icon" href="../favicon.png">

    <title>DLARRE &ndash; spag_lapack</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">spag_lapack </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>DLARRE
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 0.1% of total for procedures.">327 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/dlarre.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/dlarre.f90.html'>dlarre.f90</a></li>
            <li class="breadcrumb-item active" aria-current="page">DLARRE</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#vars-0"
         aria-expanded="false" aria-controls="vars-0">
         <h4 class="card-header bg-primary text-white">Variables</h4>
      </a>
      <div id="vars-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../proc/dlarre.html#variable-allrng">ALLRNG</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-fac">FAC</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-four~2">FOUR</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-fourth">FOURTH</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-fudge">FUDGE</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-half~10">HALF</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-hndrd">HNDRD</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-indrng">INDRNG</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-maxgrowth">MAXGROWTH</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-maxtry">MAXTRY</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-one~167">ONE</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-pert">PERT</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-two~21">TWO</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-valrng">VALRNG</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-zero~152">ZERO</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-avgap~2">avgap</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-bsrtol">bsrtol</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-clwdth~2">clwdth</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-cnt~3">cnt</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-cnt1">cnt1</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-cnt2">cnt2</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-dmax">dmax</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-dpivot">dpivot</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-eabs">eabs</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-emax~3">emax</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-eold">eold</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-eps~43">eps</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-forceb">forceb</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-gl">gl</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-gu">gu</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-i~165">i</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-ibegin">ibegin</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-idum~3">idum</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-iend~2">iend</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-iinfo~42">iinfo</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-in~4">in</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-indl">indl</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-indu">indu</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-irange">irange</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-iseed">iseed</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-isleft">isleft</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-isrght">isrght</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-j~121">j</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-jblk">jblk</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-mb~4">mb</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-mm~4">mm</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-norep">norep</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-rtl">rtl</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-rtol">rtol</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-s1~2">s1</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-s2~2">s2</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-safmin~30">safmin</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-sgndef">sgndef</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-sigma~13">sigma</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-spdiam">spdiam</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-tau~4">tau</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-tmp~4">tmp</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-tmp1~5">tmp1</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-usedqd">usedqd</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-wbegin">wbegin</a>
            <a class="list-group-item" href="../proc/dlarre.html#variable-wend">wend</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/dlarre.html#src">DLARRE</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2> subroutine DLARRE(Range, N, Vl, Vu, Il, Iu, D, E, E2, Rtol1, Rtol2, Spltol, Nsplit, Isplit, M, W, Werr, Wgap, Iblock, Indexw, Gers, Pivmin, Work, Iwork, Info)  
</h2>
    

    <p>\brief \b DLARRE given the tridiagonal matrix T, sets small off-diagonal elements to zero and for each unreduced block Ti, finds base representations and eigenvalues.
 \htmlonly
 Download DLARRE + dependencies
 <a href="http://www.netlib.org/cgi-bin/netlibfiles.tgz?format=tgz&filename=/lapack/lapack_routine/dlarre.f">
 [TGZ]</a>
 <a href="http://www.netlib.org/cgi-bin/netlibfiles.zip?format=zip&filename=/lapack/lapack_routine/dlarre.f">
 [ZIP]</a>
 <a href="http://www.netlib.org/cgi-bin/netlibfiles.txt?format=txt&filename=/lapack/lapack_routine/dlarre.f">
 [TXT]</a>
 \endhtmlonly
 \par Purpose:</p>
<p>\verbatim</p>
<p>To find the desired eigenvalues of a given real symmetric
 tridiagonal matrix T, DLARRE sets any &ldquo;small&rdquo; off-diagonal
 elements to zero, and for each unreduced block T_i, it finds
 (a) a suitable shift at one end of the block&rsquo;s spectrum,
 (b) the base representation, T_i - sigma_i I = L_i D_i L_i^T, and
 (c) eigenvalues of each L_i D_i L_i^T.
 The representations and eigenvalues found are then used by
 DSTEMR to compute the eigenvectors of T.
 The accuracy varies depending on whether bisection is used to
 find a few eigenvalues or the dqds algorithm (subroutine DLASQ2) to
 conpute all and then discard any unwanted one.
 As an added benefit, DLARRE also outputs the n
 Gerschgorin intervals for the matrices L_i D_i L_i^T.
 \endverbatim
 \param[in] RANGE
 \verbatim
          RANGE is CHARACTER*1
          = &lsquo;A&rsquo;: (&ldquo;All&rdquo;)   all eigenvalues will be found.
          = &lsquo;V&rsquo;: (&ldquo;Value&rdquo;) all eigenvalues in the half-open interval
                           (VL, VU] will be found.
          = &lsquo;I&rsquo;: (&ldquo;Index&rdquo;) the IL-th through IU-th eigenvalues (of the
                           entire matrix) will be found.
 \endverbatim</p>
<p>\param[in] N
 \verbatim
          N is INTEGER
          The order of the matrix. N &gt; 0.
 \endverbatim</p>
<p>\param[in,out] VL
 \verbatim
          VL is DOUBLE PRECISION
          If RANGE=&rsquo;V&rsquo;, the lower bound for the eigenvalues.
          Eigenvalues less than or equal to VL, or greater than VU,
          will not be returned.  VL &lt; VU.
          If RANGE=&rsquo;I&rsquo; or =&rsquo;A&rsquo;, DLARRE computes bounds on the desired
          part of the spectrum.
 \endverbatim</p>
<p>\param[in,out] VU
 \verbatim
          VU is DOUBLE PRECISION
          If RANGE=&rsquo;V&rsquo;, the upper bound for the eigenvalues.
          Eigenvalues less than or equal to VL, or greater than VU,
          will not be returned.  VL &lt; VU.
          If RANGE=&rsquo;I&rsquo; or =&rsquo;A&rsquo;, DLARRE computes bounds on the desired
          part of the spectrum.
 \endverbatim</p>
<p>\param[in] IL
 \verbatim
          IL is INTEGER
          If RANGE=&rsquo;I&rsquo;, the index of the
          smallest eigenvalue to be returned.
          1 &lt;= IL &lt;= IU &lt;= N.
 \endverbatim</p>
<p>\param[in] IU
 \verbatim
          IU is INTEGER
          If RANGE=&rsquo;I&rsquo;, the index of the
          largest eigenvalue to be returned.
          1 &lt;= IL &lt;= IU &lt;= N.
 \endverbatim</p>
<p>\param[in,out] D
 \verbatim
          D is DOUBLE PRECISION array, dimension (N)
          On entry, the N diagonal elements of the tridiagonal
          matrix T.
          On exit, the N diagonal elements of the diagonal
          matrices D_i.
 \endverbatim</p>
<p>\param[in,out] E
 \verbatim
          E is DOUBLE PRECISION array, dimension (N)
          On entry, the first (N-1) entries contain the subdiagonal
          elements of the tridiagonal matrix T; E(N) need not be set.
          On exit, E contains the subdiagonal elements of the unit
          bidiagonal matrices L_i. The entries E( ISPLIT( I ) ),
          1 &lt;= I &lt;= NSPLIT, contain the base points sigma_i on output.
 \endverbatim</p>
<p>\param[in,out] E2
 \verbatim
          E2 is DOUBLE PRECISION array, dimension (N)
          On entry, the first (N-1) entries contain the SQUARES of the
          subdiagonal elements of the tridiagonal matrix T;
          E2(N) need not be set.
          On exit, the entries E2( ISPLIT( I ) ),
          1 &lt;= I &lt;= NSPLIT, have been set to zero
 \endverbatim</p>
<p>\param[in] RTOL1
 \verbatim
          RTOL1 is DOUBLE PRECISION
 \endverbatim</p>
<p>\param[in] RTOL2
 \verbatim
          RTOL2 is DOUBLE PRECISION
           Parameters for bisection.
           An interval [LEFT,RIGHT] has converged if
           RIGHT-LEFT &lt; MAX( RTOL1<em>GAP, RTOL2</em>MAX(|LEFT|,|RIGHT|) )
 \endverbatim</p>
<p>\param[in] SPLTOL
 \verbatim
          SPLTOL is DOUBLE PRECISION
          The threshold for splitting.
 \endverbatim</p>
<p>\param[out] NSPLIT
 \verbatim
          NSPLIT is INTEGER
          The number of blocks T splits into. 1 &lt;= NSPLIT &lt;= N.
 \endverbatim</p>
<p>\param[out] ISPLIT
 \verbatim
          ISPLIT is INTEGER array, dimension (N)
          The splitting points, at which T breaks up into blocks.
          The first block consists of rows/columns 1 to ISPLIT(1),
          the second of rows/columns ISPLIT(1)+1 through ISPLIT(2),
          etc., and the NSPLIT-th consists of rows/columns
          ISPLIT(NSPLIT-1)+1 through ISPLIT(NSPLIT)=N.
 \endverbatim</p>
<p>\param[out] M
 \verbatim
          M is INTEGER
          The total number of eigenvalues (of all L_i D_i L_i^T)
          found.
 \endverbatim</p>
<p>\param[out] W
 \verbatim
          W is DOUBLE PRECISION array, dimension (N)
          The first M elements contain the eigenvalues. The
          eigenvalues of each of the blocks, L_i D_i L_i^T, are
          sorted in ascending order ( DLARRE may use the
          remaining N-M elements as workspace).
 \endverbatim</p>
<p>\param[out] WERR
 \verbatim
          WERR is DOUBLE PRECISION array, dimension (N)
          The error bound on the corresponding eigenvalue in W.
 \endverbatim</p>
<p>\param[out] WGAP
 \verbatim
          WGAP is DOUBLE PRECISION array, dimension (N)
          The separation from the right neighbor eigenvalue in W.
          The gap is only with respect to the eigenvalues of the same block
          as each block has its own representation tree.
          Exception: at the right end of a block we store the left gap
 \endverbatim</p>
<p>\param[out] IBLOCK
 \verbatim
          IBLOCK is INTEGER array, dimension (N)
          The indices of the blocks (submatrices) associated with the
          corresponding eigenvalues in W; IBLOCK(i)=1 if eigenvalue
          W(i) belongs to the first block from the top, =2 if W(i)
          belongs to the second block, etc.
 \endverbatim</p>
<p>\param[out] INDEXW
 \verbatim
          INDEXW is INTEGER array, dimension (N)
          The indices of the eigenvalues within each block (submatrix);
          for example, INDEXW(i)= 10 and IBLOCK(i)=2 imply that the
          i-th eigenvalue W(i) is the 10-th eigenvalue in block 2
 \endverbatim</p>
<p>\param[out] GERS
 \verbatim
          GERS is DOUBLE PRECISION array, dimension (2<em>N)
          The N Gerschgorin intervals (the i-th Gerschgorin interval
          is (GERS(2</em>i-1), GERS(2*i)).
 \endverbatim</p>
<p>\param[out] PIVMIN
 \verbatim
          PIVMIN is DOUBLE PRECISION
          The minimum pivot in the Sturm sequence for T.
 \endverbatim</p>
<p>\param[out] WORK
 \verbatim
          WORK is DOUBLE PRECISION array, dimension (6*N)
          Workspace.
 \endverbatim</p>
<p>\param[out] IWORK
 \verbatim
          IWORK is INTEGER array, dimension (5*N)
          Workspace.
 \endverbatim</p>
<p>\param[out] INFO
 \verbatim
          INFO is INTEGER
          = 0:  successful exit
          &gt; 0:  A problem occurred in DLARRE.
          &lt; 0:  One of the called subroutines signaled an internal problem.
                Needs inspection of the corresponding parameter IINFO
                for further information.</p>
<div class="codehilite"><pre><span></span><code>      <span class="o">=-</span><span class="mi">1</span>:  <span class="nv">Problem</span> <span class="nv">in</span> <span class="nv">DLARRD</span>.
      <span class="o">=</span> <span class="mi">2</span>:  <span class="nv">No</span> <span class="nv">base</span> <span class="nv">representation</span> <span class="nv">could</span> <span class="nv">be</span> <span class="nv">found</span> <span class="nv">in</span> <span class="nv">MAXTRY</span> <span class="nv">iterations</span>.
            <span class="nv">Increasing</span> <span class="nv">MAXTRY</span> <span class="nv">and</span> <span class="nv">recompilation</span> <span class="nv">might</span> <span class="nv">be</span> <span class="nv">a</span> <span class="nv">remedy</span>.
      <span class="o">=-</span><span class="mi">3</span>:  <span class="nv">Problem</span> <span class="nv">in</span> <span class="nv">DLARRB</span> <span class="nv">when</span> <span class="nv">computing</span> <span class="nv">the</span> <span class="nv">refined</span> <span class="nv">root</span>
            <span class="nv">representation</span> <span class="k">for</span> <span class="nv">DLASQ2</span>.
      <span class="o">=-</span><span class="mi">4</span>:  <span class="nv">Problem</span> <span class="nv">in</span> <span class="nv">DLARRB</span> <span class="nv">when</span> <span class="nv">preforming</span> <span class="nv">bisection</span> <span class="nv">on</span> <span class="nv">the</span>
            <span class="nv">desired</span> <span class="nv">part</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">spectrum</span>.
      <span class="o">=-</span><span class="mi">5</span>:  <span class="nv">Problem</span> <span class="nv">in</span> <span class="nv">DLASQ2</span>.
      <span class="o">=-</span><span class="mi">6</span>:  <span class="nv">Problem</span> <span class="nv">in</span> <span class="nv">DLASQ2</span>.
</code></pre></div>

<p>\endverbatim
 \author Univ. of Tennessee
 \author Univ. of California Berkeley
 \author Univ. of Colorado Denver
 \author NAG Ltd.
 \date June 2016
 \ingroup OTHERauxiliary
 \par Further Details:</p>
<p>\verbatim</p>
<p>The base representations are required to suffer very little
  element growth and consequently define all their eigenvalues to
  high relative accuracy.
 \endverbatim
 \par Contributors:</p>
<div class="codehilite"><pre><span></span><code> Beresford Parlett, University of California, Berkeley, USA \n
 Jim Demmel, University of California, Berkeley, USA \n
 Inderjit Dhillon, University of Texas, Austin, USA \n
 Osni Marques, LBNL/NERSC, USA \n
 Christof Voemel, University of California, Berkeley, USA \n
</code></pre></div>

<p>&ndash;DLARRE308</p>
<p>&ndash; LAPACK auxiliary routine (version 3.8.0) &ndash;
  &ndash; LAPACK is a software package provided by Univ. of Tennessee,    &ndash;
  &ndash; Univ. of California Berkeley, Univ. of Colorado Denver and NAG Ltd..&ndash;
     June 2016</p>
<div class="codehilite"><pre><span></span><code> .. Scalar Arguments ..
</code></pre></div>

<p>*
     Loop over unreduced blocks</p>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-range~7"></span>
              character(len=1)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Range</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-n~238"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>N</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-vl~18"></span>
              double precision
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Vl</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-vu~7"></span>
              double precision
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Vu</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-il~7"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Il</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iu~7"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Iu</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-d~30"></span>
              double precision
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>D</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-e~20"></span>
              double precision
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>E</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-e2"></span>
              double precision
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>E2</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rtol1~2"></span>
              double precision
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Rtol1</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rtol2~2"></span>
              double precision
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Rtol2</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-spltol"></span>
              double precision
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Spltol</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nsplit"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Nsplit</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isplit"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Isplit</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-m~75"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>M</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-w~23"></span>
              double precision
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>W</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-werr~3"></span>
              double precision
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Werr</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wgap~3"></span>
              double precision
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Wgap</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iblock"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Iblock</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-indexw"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Indexw</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-gers"></span>
              double precision
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Gers</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-pivmin~3"></span>
              double precision
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Pivmin</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-work~146"></span>
              double precision
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Work</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iwork~34"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Iwork</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-info~197"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Info</strong></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    <br>


    <section>    
      <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-allrng"></span>
              integer,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>ALLRNG</strong></td>
<td> =</td>
                <td>1</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fac"></span>
              double precision,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>FAC</strong></td>
<td> =</td>
                <td>HALF</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-four~2"></span>
              double precision,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>FOUR</strong></td>
<td> =</td>
                <td>4.0D0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fourth"></span>
              double precision,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>FOURTH</strong></td>
<td> =</td>
                <td>ONE/FOUR</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fudge"></span>
              double precision,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>FUDGE</strong></td>
<td> =</td>
                <td>2.0D0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-half~10"></span>
              double precision,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>HALF</strong></td>
<td> =</td>
                <td>ONE/TWO</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-hndrd"></span>
              double precision,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>HNDRD</strong></td>
<td> =</td>
                <td>100.0D0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-indrng"></span>
              integer,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>INDRNG</strong></td>
<td> =</td>
                <td>2</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxgrowth"></span>
              double precision,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>MAXGROWTH</strong></td>
<td> =</td>
                <td>64.0D0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxtry"></span>
              integer,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>MAXTRY</strong></td>
<td> =</td>
                <td>6</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-one~167"></span>
              double precision,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>ONE</strong></td>
<td> =</td>
                <td>1.0D0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-pert"></span>
              double precision,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>PERT</strong></td>
<td> =</td>
                <td>8.0D0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-two~21"></span>
              double precision,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>TWO</strong></td>
<td> =</td>
                <td>2.0D0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-valrng"></span>
              integer,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>VALRNG</strong></td>
<td> =</td>
                <td>3</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-zero~152"></span>
              double precision,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>ZERO</strong></td>
<td> =</td>
                <td>0.0D0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-avgap~2"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>avgap</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-bsrtol"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>bsrtol</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-clwdth~2"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>clwdth</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-cnt~3"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>cnt</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-cnt1"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>cnt1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-cnt2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>cnt2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-dmax"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>dmax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-dpivot"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>dpivot</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-eabs"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>eabs</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-emax~3"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>emax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-eold"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>eold</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-eps~43"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>eps</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-forceb"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>forceb</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-gl"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>gl</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-gu"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>gu</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-i~165"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>i</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ibegin"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ibegin</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-idum~3"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>idum</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iend~2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iend</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iinfo~42"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iinfo</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-in~4"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>in</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-indl"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>indl</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-indu"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>indu</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-irange"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>irange</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iseed"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iseed</strong>(4)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isleft"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>isleft</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isrght"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>isrght</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-j~121"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>j</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jblk"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jblk</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-mb~4"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>mb</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-mm~4"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>mm</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-norep"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>norep</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rtl"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>rtl</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rtol"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>rtol</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s1~2"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>s1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s2~2"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>s2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-safmin~30"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>safmin</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sgndef"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>sgndef</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sigma~13"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>sigma</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-spdiam"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>spdiam</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-tau~4"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>tau</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-tmp~4"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>tmp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-tmp1~5"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>tmp1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-usedqd"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>usedqd</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wbegin"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wbegin</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wend"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wend</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">      </span><span class="k">SUBROUTINE </span><span class="n">DLARRE</span><span class="p">(</span><span class="nb">Range</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Vl</span><span class="p">,</span><span class="n">Vu</span><span class="p">,</span><span class="n">Il</span><span class="p">,</span><span class="n">Iu</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">E2</span><span class="p">,</span><span class="n">Rtol1</span><span class="p">,</span><span class="n">Rtol2</span><span class="p">,</span><span class="n">Spltol</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Nsplit</span><span class="p">,</span><span class="n">Isplit</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">W</span><span class="p">,</span><span class="n">Werr</span><span class="p">,</span><span class="n">Wgap</span><span class="p">,</span><span class="n">Iblock</span><span class="p">,</span><span class="n">Indexw</span><span class="p">,</span><span class="n">Gers</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Pivmin</span><span class="p">,</span><span class="n">Work</span><span class="p">,</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">IMPLICIT NONE</span><span class="w"></span>
<span class="c">!*--DLARRE308</span>
<span class="c">!</span>
<span class="c">!  -- LAPACK auxiliary routine (version 3.8.0) --</span>
<span class="c">!  -- LAPACK is a software package provided by Univ. of Tennessee,    --</span>
<span class="c">!  -- Univ. of California Berkeley, Univ. of Colorado Denver and NAG Ltd..--</span>
<span class="c">!     June 2016</span>
<span class="c">!</span>
<span class="c">!     .. Scalar Arguments ..</span>
<span class="w">      </span><span class="kt">CHARACTER </span><span class="nb">Range</span>
<span class="nb">      </span><span class="kt">INTEGER </span><span class="n">Il</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Info</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Iu</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Nsplit</span><span class="w"></span>
<span class="w">      </span><span class="kt">DOUBLE PRECISION </span><span class="n">Pivmin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Rtol1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Rtol2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Spltol</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Vl</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Vu</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Array Arguments ..</span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">Iblock</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Isplit</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Iwork</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Indexw</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="kt">DOUBLE PRECISION </span><span class="n">D</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">E</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">E2</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Gers</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">W</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Werr</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                 </span><span class="n">Wgap</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!</span>
<span class="c">!  =====================================================================</span>
<span class="c">!</span>
<span class="c">!     .. Parameters ..</span>
<span class="w">      </span><span class="kt">DOUBLE PRECISION </span><span class="n">FAC</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">FOUR</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">FOURTH</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">FUDGE</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">HALF</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">HNDRD</span><span class="w"> </span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                 </span><span class="n">MAXGROWTH</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ONE</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">PERT</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">TWO</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="w">      </span><span class="k">PARAMETER</span><span class="w"> </span><span class="p">(</span><span class="n">ZERO</span><span class="o">=</span><span class="mf">0.0D0</span><span class="p">,</span><span class="n">ONE</span><span class="o">=</span><span class="mf">1.0D0</span><span class="p">,</span><span class="n">TWO</span><span class="o">=</span><span class="mf">2.0D0</span><span class="p">,</span><span class="n">FOUR</span><span class="o">=</span><span class="mf">4.0D0</span><span class="p">,</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">           </span><span class="n">HNDRD</span><span class="o">=</span><span class="mi">10</span><span class="mf">0.0D0</span><span class="p">,</span><span class="n">PERT</span><span class="o">=</span><span class="mf">8.0D0</span><span class="p">,</span><span class="n">HALF</span><span class="o">=</span><span class="n">ONE</span><span class="o">/</span><span class="n">TWO</span><span class="p">,</span><span class="n">FOURTH</span><span class="o">=</span><span class="n">ONE</span><span class="o">/</span><span class="n">FOUR</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">           </span><span class="n">FAC</span><span class="o">=</span><span class="n">HALF</span><span class="p">,</span><span class="n">MAXGROWTH</span><span class="o">=</span><span class="mi">6</span><span class="mf">4.0D0</span><span class="p">,</span><span class="n">FUDGE</span><span class="o">=</span><span class="mf">2.0D0</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">MAXTRY</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ALLRNG</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">INDRNG</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">VALRNG</span><span class="w"></span>
<span class="w">      </span><span class="k">PARAMETER</span><span class="w"> </span><span class="p">(</span><span class="n">MAXTRY</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">ALLRNG</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">INDRNG</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">VALRNG</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Local Scalars ..</span>
<span class="w">      </span><span class="kt">LOGICAL </span><span class="n">forceb</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">norep</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">usedqd</span><span class="w"></span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">cnt</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">cnt1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">cnt2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ibegin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">idum</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">iend</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">iinfo</span><span class="w"> </span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">in</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">indl</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">indu</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">irange</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">jblk</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">mb</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">mm</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">wbegin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">wend</span><span class="w"></span>
<span class="w">      </span><span class="kt">DOUBLE PRECISION </span><span class="n">avgap</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">bsrtol</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">clwdth</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nb">dmax</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">dpivot</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">eabs</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                 </span><span class="n">emax</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">eold</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">eps</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">gl</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">gu</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">isleft</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">isrght</span><span class="w"> </span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                 </span><span class="n">rtl</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">rtol</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">s1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">s2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">safmin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">sgndef</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">sigma</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                 </span><span class="n">spdiam</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">tau</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">tmp</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">tmp1</span><span class="w"></span>
<span class="w"> </span>
<span class="w"> </span>
<span class="c">!     ..</span>
<span class="c">!     .. Local Arrays ..</span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">iseed</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. External Functions ..</span>
<span class="w">      </span><span class="kt">LOGICAL </span><span class="n">LSAME</span><span class="w"></span>
<span class="w">      </span><span class="kt">DOUBLE PRECISION </span><span class="n">DLAMCH</span><span class="w"></span>
<span class="w">      </span><span class="k">EXTERNAL </span><span class="n">DLAMCH</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">LSAME</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!     ..</span>
<span class="c">!     .. External Subroutines ..</span>
<span class="w">      </span><span class="k">EXTERNAL </span><span class="n">DCOPY</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">DLARNV</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">DLARRA</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">DLARRB</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">DLARRC</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">DLARRD</span><span class="w"> </span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">         </span><span class="n">DLASQ2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">DLARRK</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Intrinsic Functions ..</span>
<span class="w">      </span><span class="k">INTRINSIC </span><span class="nb">ABS</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nb">MAX</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nb">MIN</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!     ..</span>
<span class="c">!     .. Executable Statements ..</span>
<span class="c">!</span>
<span class="w"> </span>
<span class="w">      </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Quick return if possible</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">N</span><span class="o">&lt;=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">RETURN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Decode RANGE</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">LSAME</span><span class="p">(</span><span class="nb">Range</span><span class="p">,</span><span class="s1">&#39;A&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">irange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ALLRNG</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">LSAME</span><span class="p">(</span><span class="nb">Range</span><span class="p">,</span><span class="s1">&#39;V&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">irange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">VALRNG</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">LSAME</span><span class="p">(</span><span class="nb">Range</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">irange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">INDRNG</span><span class="w"></span>
<span class="w">      </span><span class="k">ENDIF</span>
<span class="k"> </span>
<span class="k">      </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!     Get machine constants</span>
<span class="w">      </span><span class="n">safmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DLAMCH</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">eps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DLAMCH</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!     Set parameters</span>
<span class="w">      </span><span class="n">rtl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">SQRT</span><span class="p">(</span><span class="n">eps</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">bsrtol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">SQRT</span><span class="p">(</span><span class="n">eps</span><span class="p">)</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!     Treat case of 1x1 matrix for quick return</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">N</span><span class="o">==</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">irange</span><span class="o">==</span><span class="n">ALLRNG</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w">                                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="p">((</span><span class="n">irange</span><span class="o">==</span><span class="n">VALRNG</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">&gt;</span><span class="n">Vl</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">&lt;=</span><span class="n">Vu</span><span class="p">))</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="p">((</span><span class="n">irange</span><span class="o">==</span><span class="n">INDRNG</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">Il</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">Iu</span><span class="o">==</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">W</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="c">!           The computation error of the eigenvalue is zero</span>
<span class="w">            </span><span class="n">Werr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="w">            </span><span class="n">Wgap</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="w">            </span><span class="n">Iblock</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">Indexw</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">Gers</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">Gers</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!        store the shift for the initial RRR, which is zero in this case</span>
<span class="w">         </span><span class="n">E</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="w">         </span><span class="k">RETURN</span>
<span class="k">      ENDIF</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!     General case: tridiagonal matrix of order &gt; 1</span>
<span class="c">!</span>
<span class="c">!     Init WERR, WGAP. Compute Gerschgorin intervals and spectral diameter.</span>
<span class="c">!     Compute maximum off-diagonal entry and pivmin.</span>
<span class="w">      </span><span class="n">gl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">gu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">eold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="w">      </span><span class="n">emax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="w">      </span><span class="n">E</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="w">      </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">         </span><span class="n">Werr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="w">         </span><span class="n">Wgap</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="w">         </span><span class="n">eabs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">eabs</span><span class="o">&gt;=</span><span class="n">emax</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">emax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eabs</span><span class="w"></span>
<span class="w">         </span><span class="n">tmp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eabs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">eold</span><span class="w"></span>
<span class="w">         </span><span class="n">Gers</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">tmp1</span><span class="w"></span>
<span class="w">         </span><span class="n">gl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">gl</span><span class="p">,</span><span class="n">Gers</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="n">Gers</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">tmp1</span><span class="w"></span>
<span class="w">         </span><span class="n">gu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">gu</span><span class="p">,</span><span class="n">Gers</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="n">eold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eabs</span><span class="w"></span>
<span class="w">      </span><span class="k">ENDDO</span><span class="w"></span>
<span class="c">!     The minimum pivot allowed in the Sturm sequence for T</span>
<span class="w">      </span><span class="n">Pivmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">safmin</span><span class="o">*</span><span class="nb">MAX</span><span class="p">(</span><span class="n">ONE</span><span class="p">,</span><span class="n">emax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="c">!     Compute spectral diameter. The Gerschgorin bounds give an</span>
<span class="c">!     estimate that is wrong by at most a factor of SQRT(2)</span>
<span class="w">      </span><span class="n">spdiam</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gu</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gl</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!     Compute splitting points</span>
<span class="w">      </span><span class="k">CALL </span><span class="n">DLARRA</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">E2</span><span class="p">,</span><span class="n">Spltol</span><span class="p">,</span><span class="n">spdiam</span><span class="p">,</span><span class="n">Nsplit</span><span class="p">,</span><span class="n">Isplit</span><span class="p">,</span><span class="n">iinfo</span><span class="p">)</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!     Can force use of bisection instead of faster DQDS.</span>
<span class="c">!     Option left in the code for future multisection work.</span>
<span class="w">      </span><span class="n">forceb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!     Initialize USEDQD, DQDS should be used for ALLRNG unless someone</span>
<span class="c">!     explicitly wants bisection.</span>
<span class="w">      </span><span class="n">usedqd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="n">irange</span><span class="o">==</span><span class="n">ALLRNG</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">forceb</span><span class="p">))</span><span class="w"></span>
<span class="w"> </span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">irange</span><span class="o">==</span><span class="n">ALLRNG</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">forceb</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!        Set interval [VL,VU] that contains all eigenvalues</span>
<span class="w">         </span><span class="n">Vl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gl</span><span class="w"></span>
<span class="w">         </span><span class="n">Vu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gu</span><span class="w"></span>
<span class="w">      </span><span class="k">ELSE</span><span class="w"></span>
<span class="c">!        We call DLARRD to find crude approximations to the eigenvalues</span>
<span class="c">!        in the desired range. In case IRANGE = INDRNG, we also obtain the</span>
<span class="c">!        interval (VL,VU] that contains all the wanted eigenvalues.</span>
<span class="c">!        An interval [LEFT,RIGHT] has converged if</span>
<span class="c">!        RIGHT-LEFT.LT.RTOL*MAX(ABS(LEFT),ABS(RIGHT))</span>
<span class="c">!        DLARRD needs a WORK of size 4*N, IWORK of size 3*N</span>
<span class="w">         </span><span class="k">CALL </span><span class="n">DLARRD</span><span class="p">(</span><span class="nb">Range</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Vl</span><span class="p">,</span><span class="n">Vu</span><span class="p">,</span><span class="n">Il</span><span class="p">,</span><span class="n">Iu</span><span class="p">,</span><span class="n">Gers</span><span class="p">,</span><span class="n">bsrtol</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">E2</span><span class="p">,</span><span class="n">Pivmin</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">               </span><span class="n">Nsplit</span><span class="p">,</span><span class="n">Isplit</span><span class="p">,</span><span class="n">mm</span><span class="p">,</span><span class="n">W</span><span class="p">,</span><span class="n">Werr</span><span class="p">,</span><span class="n">Vl</span><span class="p">,</span><span class="n">Vu</span><span class="p">,</span><span class="n">Iblock</span><span class="p">,</span><span class="n">Indexw</span><span class="p">,</span><span class="n">Work</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">               </span><span class="n">Iwork</span><span class="p">,</span><span class="n">iinfo</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iinfo</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="k">RETURN</span>
<span class="k">         ENDIF</span><span class="w"></span>
<span class="c">!        Make sure that the entries M+1 to N in W, WERR, IBLOCK, INDEXW are 0</span>
<span class="w">         </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">            </span><span class="n">W</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="w">            </span><span class="n">Werr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="w">            </span><span class="n">Iblock</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">            </span><span class="n">Indexw</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDDO</span>
<span class="k">      ENDIF</span><span class="w"></span>
<span class="w"> </span>
<span class="w"> </span>
<span class="c">!**</span>
<span class="c">!     Loop over unreduced blocks</span>
<span class="w">      </span><span class="n">ibegin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="n">wbegin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="k">DO </span><span class="n">jblk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Nsplit</span><span class="w"></span>
<span class="w">         </span><span class="n">iend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Isplit</span><span class="p">(</span><span class="n">jblk</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">in</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iend</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ibegin</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!        1 X 1 block</span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">in</span><span class="o">==</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">irange</span><span class="o">==</span><span class="n">ALLRNG</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w">                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">           </span><span class="p">((</span><span class="n">irange</span><span class="o">==</span><span class="n">VALRNG</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="n">ibegin</span><span class="p">)</span><span class="o">&gt;</span><span class="n">Vl</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">           </span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="n">ibegin</span><span class="p">)</span><span class="o">&lt;=</span><span class="n">Vu</span><span class="p">))</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w">                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">           </span><span class="p">((</span><span class="n">irange</span><span class="o">==</span><span class="n">INDRNG</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">Iblock</span><span class="p">(</span><span class="n">wbegin</span><span class="p">)</span><span class="o">==</span><span class="n">jblk</span><span class="p">))</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="n">W</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="n">ibegin</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">Werr</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="c">!              The gap for a single block doesn&#39;t matter for the later</span>
<span class="c">!              algorithm and is assigned an arbitrary large value</span>
<span class="w">               </span><span class="n">Wgap</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="w">               </span><span class="n">Iblock</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jblk</span><span class="w"></span>
<span class="w">               </span><span class="n">Indexw</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="n">wbegin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wbegin</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!           E( IEND ) holds the shift for the initial RRR</span>
<span class="w">            </span><span class="n">E</span><span class="p">(</span><span class="n">iend</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="w">            </span><span class="n">ibegin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iend</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="k">CYCLE</span>
<span class="k">         ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!        Blocks of size larger than 1x1</span>
<span class="c">!</span>
<span class="c">!        E( IEND ) will hold the shift for the initial RRR, for now set it =0</span>
<span class="w">         </span><span class="n">E</span><span class="p">(</span><span class="n">iend</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!        Find local outer bounds GL,GU for the block</span>
<span class="w">         </span><span class="n">gl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="n">ibegin</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">gu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="n">ibegin</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ibegin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">iend</span><span class="w"></span>
<span class="w">            </span><span class="n">gl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">Gers</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">gl</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">gu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">Gers</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">),</span><span class="n">gu</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDDO</span>
<span class="k">         </span><span class="n">spdiam</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gu</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gl</span><span class="w"></span>
<span class="w"> </span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.((</span><span class="n">irange</span><span class="o">==</span><span class="n">ALLRNG</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">forceb</span><span class="p">))</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!           Count the number of eigenvalues in the current block.</span>
<span class="w">            </span><span class="n">mb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">            </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wbegin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">mm</span><span class="w"></span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Iblock</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">/=</span><span class="n">jblk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">EXIT</span>
<span class="k">               </span><span class="n">mb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mb</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDDO</span>
<span class="k"> </span>
<span class="k">            IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">mb</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!              No eigenvalue in the current block lies in the desired range</span>
<span class="c">!              E( IEND ) holds the shift for the initial RRR</span>
<span class="w">               </span><span class="n">E</span><span class="p">(</span><span class="n">iend</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="w">               </span><span class="n">ibegin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iend</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="k">CYCLE</span>
<span class="k">            ELSE</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!              Decide whether dqds or bisection is more efficient</span>
<span class="w">               </span><span class="n">usedqd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="n">mb</span><span class="o">&gt;</span><span class="n">FAC</span><span class="o">*</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">forceb</span><span class="p">))</span><span class="w"></span>
<span class="w">               </span><span class="n">wend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wbegin</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">mb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="c">!              Calculate gaps for the current block</span>
<span class="c">!              In later stages, when representations for individual</span>
<span class="c">!              eigenvalues are different, we use SIGMA = E( IEND ).</span>
<span class="w">               </span><span class="n">sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="w">               </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wbegin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">wend</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                  </span><span class="n">Wgap</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">ZERO</span><span class="p">,</span><span class="n">W</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">Werr</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">W</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="n">Werr</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDDO</span>
<span class="k">               </span><span class="n">Wgap</span><span class="p">(</span><span class="n">wend</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">ZERO</span><span class="p">,</span><span class="n">Vu</span><span class="o">-</span><span class="n">sigma</span><span class="o">-</span><span class="p">(</span><span class="n">W</span><span class="p">(</span><span class="n">wend</span><span class="p">)</span><span class="o">+</span><span class="n">Werr</span><span class="p">(</span><span class="n">wend</span><span class="p">)))</span><span class="w"></span>
<span class="c">!              Find local index of the first and last desired evalue.</span>
<span class="w">               </span><span class="n">indl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Indexw</span><span class="p">(</span><span class="n">wbegin</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">indu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Indexw</span><span class="p">(</span><span class="n">wend</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span>
<span class="k">         ENDIF</span>
<span class="k">         IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">((</span><span class="n">irange</span><span class="o">==</span><span class="n">ALLRNG</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">forceb</span><span class="p">))</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">usedqd</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!           Case of DQDS</span>
<span class="c">!           Find approximations to the extremal eigenvalues of the block</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">DLARRK</span><span class="p">(</span><span class="n">in</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">gl</span><span class="p">,</span><span class="n">gu</span><span class="p">,</span><span class="n">D</span><span class="p">(</span><span class="n">ibegin</span><span class="p">),</span><span class="n">E2</span><span class="p">(</span><span class="n">ibegin</span><span class="p">),</span><span class="n">Pivmin</span><span class="p">,</span><span class="n">rtl</span><span class="p">,</span><span class="n">tmp</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">tmp1</span><span class="p">,</span><span class="n">iinfo</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iinfo</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="k">RETURN</span>
<span class="k">            ENDIF</span>
<span class="k">            </span><span class="n">isleft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">gl</span><span class="p">,</span><span class="n">tmp</span><span class="o">-</span><span class="n">tmp1</span><span class="o">-</span><span class="n">HNDRD</span><span class="o">*</span><span class="n">eps</span><span class="o">*</span><span class="nb">ABS</span><span class="p">(</span><span class="n">tmp</span><span class="o">-</span><span class="n">tmp1</span><span class="p">))</span><span class="w"></span>
<span class="w"> </span>
<span class="w">            </span><span class="k">CALL </span><span class="n">DLARRK</span><span class="p">(</span><span class="n">in</span><span class="p">,</span><span class="n">in</span><span class="p">,</span><span class="n">gl</span><span class="p">,</span><span class="n">gu</span><span class="p">,</span><span class="n">D</span><span class="p">(</span><span class="n">ibegin</span><span class="p">),</span><span class="n">E2</span><span class="p">(</span><span class="n">ibegin</span><span class="p">),</span><span class="n">Pivmin</span><span class="p">,</span><span class="n">rtl</span><span class="p">,</span><span class="n">tmp</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">tmp1</span><span class="p">,</span><span class="n">iinfo</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iinfo</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="k">RETURN</span>
<span class="k">            ENDIF</span>
<span class="k">            </span><span class="n">isrght</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">gu</span><span class="p">,</span><span class="n">tmp</span><span class="o">+</span><span class="n">tmp1</span><span class="o">+</span><span class="n">HNDRD</span><span class="o">*</span><span class="n">eps</span><span class="o">*</span><span class="nb">ABS</span><span class="p">(</span><span class="n">tmp</span><span class="o">+</span><span class="n">tmp1</span><span class="p">))</span><span class="w"></span>
<span class="c">!           Improve the estimate of the spectral diameter</span>
<span class="w">            </span><span class="n">spdiam</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isrght</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">isleft</span><span class="w"></span>
<span class="w">         </span><span class="k">ELSE</span><span class="w"></span>
<span class="c">!           Case of bisection</span>
<span class="c">!           Find approximations to the wanted extremal eigenvalues</span>
<span class="w">            </span><span class="n">isleft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">gl</span><span class="p">,</span><span class="n">W</span><span class="p">(</span><span class="n">wbegin</span><span class="p">)</span><span class="o">-</span><span class="n">Werr</span><span class="p">(</span><span class="n">wbegin</span><span class="p">)</span><span class="w">                      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">               </span><span class="o">-</span><span class="n">HNDRD</span><span class="o">*</span><span class="n">eps</span><span class="o">*</span><span class="nb">ABS</span><span class="p">(</span><span class="n">W</span><span class="p">(</span><span class="n">wbegin</span><span class="p">)</span><span class="o">-</span><span class="n">Werr</span><span class="p">(</span><span class="n">wbegin</span><span class="p">)))</span><span class="w"></span>
<span class="w">            </span><span class="n">isrght</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">gu</span><span class="p">,</span><span class="n">W</span><span class="p">(</span><span class="n">wend</span><span class="p">)</span><span class="o">+</span><span class="n">Werr</span><span class="p">(</span><span class="n">wend</span><span class="p">)</span><span class="w">                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">               </span><span class="o">+</span><span class="n">HNDRD</span><span class="o">*</span><span class="n">eps</span><span class="o">*</span><span class="nb">ABS</span><span class="p">(</span><span class="n">W</span><span class="p">(</span><span class="n">wend</span><span class="p">)</span><span class="o">+</span><span class="n">Werr</span><span class="p">(</span><span class="n">wend</span><span class="p">)))</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span><span class="w"></span>
<span class="w"> </span>
<span class="w"> </span>
<span class="c">!        Decide whether the base representation for the current block</span>
<span class="c">!        L_JBLK D_JBLK L_JBLK^T = T_JBLK - sigma_JBLK I</span>
<span class="c">!        should be on the left or the right end of the current block.</span>
<span class="c">!        The strategy is to shift to the end which is &quot;more populated&quot;</span>
<span class="c">!        Furthermore, decide whether to use DQDS for the computation of</span>
<span class="c">!        the eigenvalue approximations at the end of DLARRE or bisection.</span>
<span class="c">!        dqds is chosen if all eigenvalues are desired or the number of</span>
<span class="c">!        eigenvalues to be computed is large compared to the blocksize.</span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">irange</span><span class="o">==</span><span class="n">ALLRNG</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">forceb</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!           If all the eigenvalues have to be computed, we use dqd</span>
<span class="w">            </span><span class="n">usedqd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="c">!           INDL is the local index of the first eigenvalue to compute</span>
<span class="w">            </span><span class="n">indl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">indu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">in</span><span class="w"></span>
<span class="c">!           MB =  number of eigenvalues to compute</span>
<span class="w">            </span><span class="n">mb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">in</span><span class="w"></span>
<span class="w">            </span><span class="n">wend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wbegin</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">mb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="c">!           Define 1/4 and 3/4 points of the spectrum</span>
<span class="w">            </span><span class="n">s1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isleft</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">FOURTH</span><span class="o">*</span><span class="n">spdiam</span><span class="w"></span>
<span class="w">            </span><span class="n">s2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isrght</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">FOURTH</span><span class="o">*</span><span class="n">spdiam</span><span class="w"></span>
<span class="c">!           DLARRD has computed IBLOCK and INDEXW for each eigenvalue</span>
<span class="c">!           approximation.</span>
<span class="c">!           choose sigma</span>
<span class="w">         </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">usedqd</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            </span><span class="n">s1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isleft</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">FOURTH</span><span class="o">*</span><span class="n">spdiam</span><span class="w"></span>
<span class="w">            </span><span class="n">s2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isrght</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">FOURTH</span><span class="o">*</span><span class="n">spdiam</span><span class="w"></span>
<span class="w">         </span><span class="k">ELSE</span>
<span class="k">            </span><span class="n">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">isrght</span><span class="p">,</span><span class="n">Vu</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">isleft</span><span class="p">,</span><span class="n">Vl</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">s1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">isleft</span><span class="p">,</span><span class="n">Vl</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">FOURTH</span><span class="o">*</span><span class="n">tmp</span><span class="w"></span>
<span class="w">            </span><span class="n">s2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">isrght</span><span class="p">,</span><span class="n">Vu</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">FOURTH</span><span class="o">*</span><span class="n">tmp</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!        Compute the negcount at the 1/4 and 3/4 points</span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">mb</span><span class="o">&gt;</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">CALL </span><span class="n">DLARRC</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="n">in</span><span class="p">,</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">,</span><span class="n">D</span><span class="p">(</span><span class="n">ibegin</span><span class="p">),</span><span class="n">E</span><span class="p">(</span><span class="n">ibegin</span><span class="p">),</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                           </span><span class="n">Pivmin</span><span class="p">,</span><span class="n">cnt</span><span class="p">,</span><span class="n">cnt1</span><span class="p">,</span><span class="n">cnt2</span><span class="p">,</span><span class="n">iinfo</span><span class="p">)</span><span class="w"></span>
<span class="w"> </span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">mb</span><span class="o">==</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            </span><span class="n">sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gl</span><span class="w"></span>
<span class="w">            </span><span class="n">sgndef</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ONE</span><span class="w"></span>
<span class="w">         </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">cnt1</span><span class="o">-</span><span class="n">indl</span><span class="o">&gt;=</span><span class="n">indu</span><span class="o">-</span><span class="n">cnt2</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">irange</span><span class="o">==</span><span class="n">ALLRNG</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">forceb</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">isleft</span><span class="p">,</span><span class="n">gl</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">usedqd</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!              use Gerschgorin bound as shift to get pos def matrix</span>
<span class="c">!              for dqds</span>
<span class="w">               </span><span class="n">sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isleft</span><span class="w"></span>
<span class="w">            </span><span class="k">ELSE</span><span class="w"></span>
<span class="c">!              use approximation of the first desired eigenvalue of the</span>
<span class="c">!              block as shift</span>
<span class="w">               </span><span class="n">sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">isleft</span><span class="p">,</span><span class="n">Vl</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span>
<span class="k">            </span><span class="n">sgndef</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ONE</span><span class="w"></span>
<span class="w">         </span><span class="k">ELSE</span>
<span class="k">            IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">irange</span><span class="o">==</span><span class="n">ALLRNG</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">forceb</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">isrght</span><span class="p">,</span><span class="n">gu</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">usedqd</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!              use Gerschgorin bound as shift to get neg def matrix</span>
<span class="c">!              for dqds</span>
<span class="w">               </span><span class="n">sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isrght</span><span class="w"></span>
<span class="w">            </span><span class="k">ELSE</span><span class="w"></span>
<span class="c">!              use approximation of the first desired eigenvalue of the</span>
<span class="c">!              block as shift</span>
<span class="w">               </span><span class="n">sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">isrght</span><span class="p">,</span><span class="n">Vu</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span>
<span class="k">            </span><span class="n">sgndef</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">ONE</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span><span class="w"></span>
<span class="w"> </span>
<span class="w"> </span>
<span class="c">!        An initial SIGMA has been chosen that will be used for computing</span>
<span class="c">!        T - SIGMA I = L D L^T</span>
<span class="c">!        Define the increment TAU of the shift in case the initial shift</span>
<span class="c">!        needs to be refined to obtain a factorization with not too much</span>
<span class="c">!        element growth.</span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">usedqd</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!           The initial SIGMA was to the outer end of the spectrum</span>
<span class="c">!           the matrix is definite and we need not retreat.</span>
<span class="w">            </span><span class="n">tau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spdiam</span><span class="o">*</span><span class="n">eps</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">TWO</span><span class="o">*</span><span class="n">Pivmin</span><span class="w"></span>
<span class="w">            </span><span class="n">tau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span><span class="n">TWO</span><span class="o">*</span><span class="n">eps</span><span class="o">*</span><span class="nb">ABS</span><span class="p">(</span><span class="n">sigma</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">mb</span><span class="o">&gt;</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            </span><span class="n">clwdth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">W</span><span class="p">(</span><span class="n">wend</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Werr</span><span class="p">(</span><span class="n">wend</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">W</span><span class="p">(</span><span class="n">wbegin</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Werr</span><span class="p">(</span><span class="n">wbegin</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">avgap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">clwdth</span><span class="o">/</span><span class="nb">DBLE</span><span class="p">(</span><span class="n">wend</span><span class="o">-</span><span class="n">wbegin</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">sgndef</span><span class="o">==</span><span class="n">ONE</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">tau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HALF</span><span class="o">*</span><span class="nb">MAX</span><span class="p">(</span><span class="n">Wgap</span><span class="p">(</span><span class="n">wbegin</span><span class="p">),</span><span class="n">avgap</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">tau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span><span class="n">Werr</span><span class="p">(</span><span class="n">wbegin</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">ELSE</span>
<span class="k">               </span><span class="n">tau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HALF</span><span class="o">*</span><span class="nb">MAX</span><span class="p">(</span><span class="n">Wgap</span><span class="p">(</span><span class="n">wend</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">avgap</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">tau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span><span class="n">Werr</span><span class="p">(</span><span class="n">wend</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span>
<span class="k">         ELSE</span>
<span class="k">            </span><span class="n">tau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Werr</span><span class="p">(</span><span class="n">wbegin</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="w">         </span><span class="k">DO </span><span class="n">idum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">MAXTRY</span><span class="w"></span>
<span class="c">!           Compute L D L^T factorization of tridiagonal matrix T - sigma I.</span>
<span class="c">!           Store D in WORK(1:IN), L in WORK(IN+1:2*IN), and reciprocals of</span>
<span class="c">!           pivots in WORK(2*IN+1:3*IN)</span>
<span class="w">            </span><span class="n">dpivot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="n">ibegin</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sigma</span><span class="w"></span>
<span class="w">            </span><span class="n">Work</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dpivot</span><span class="w"></span>
<span class="w">            </span><span class="nb">dmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">Work</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ibegin</span><span class="w"></span>
<span class="w">            </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="n">Work</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">in</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ONE</span><span class="o">/</span><span class="n">Work</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">E</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">Work</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">in</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">Work</span><span class="p">(</span><span class="n">in</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tmp</span><span class="w"></span>
<span class="w">               </span><span class="n">dpivot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">sigma</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">tmp</span><span class="o">*</span><span class="n">E</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">Work</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dpivot</span><span class="w"></span>
<span class="w">               </span><span class="nb">dmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="nb">dmax</span><span class="p">,</span><span class="nb">ABS</span><span class="p">(</span><span class="n">dpivot</span><span class="p">))</span><span class="w"></span>
<span class="w">               </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDDO</span><span class="w"></span>
<span class="c">!           check for element growth</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">dmax</span><span class="o">&gt;</span><span class="n">MAXGROWTH</span><span class="o">*</span><span class="n">spdiam</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">norep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="w">            </span><span class="k">ELSE</span>
<span class="k">               </span><span class="n">norep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span>
<span class="k">            IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">usedqd</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">norep</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!              Ensure the definiteness of the representation</span>
<span class="c">!              All entries of D (of L D L^T) must have the same sign</span>
<span class="w">               </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"></span>
<span class="w">                  </span><span class="n">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sgndef</span><span class="o">*</span><span class="n">Work</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">tmp</span><span class="o">&lt;</span><span class="n">ZERO</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">norep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDDO</span>
<span class="k">            ENDIF</span><span class="w"></span>
<span class="c">!              an initial RRR is found</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.(</span><span class="n">norep</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">GOTO</span><span class="w"> </span><span class="mi">50</span><span class="w"></span>
<span class="c">!              Note that in the case of IRANGE=ALLRNG, we use the Gerschgorin</span>
<span class="c">!              shift which makes the matrix definite. So we should end up</span>
<span class="c">!              here really only in the case of IRANGE = VALRNG or INDRNG.</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">idum</span><span class="o">/=</span><span class="n">MAXTRY</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sigma</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sgndef</span><span class="o">*</span><span class="n">tau</span><span class="w"></span>
<span class="w">               </span><span class="n">tau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TWO</span><span class="o">*</span><span class="n">tau</span><span class="w"></span>
<span class="w">            </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">sgndef</span><span class="o">==</span><span class="n">ONE</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                    The fudged Gerschgorin shift should succeed</span>
<span class="w">               </span><span class="n">sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gl</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">FUDGE</span><span class="o">*</span><span class="n">spdiam</span><span class="o">*</span><span class="n">eps</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">FUDGE</span><span class="o">*</span><span class="n">TWO</span><span class="o">*</span><span class="n">Pivmin</span><span class="w"></span>
<span class="w">            </span><span class="k">ELSE</span>
<span class="k">               </span><span class="n">sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gu</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">FUDGE</span><span class="o">*</span><span class="n">spdiam</span><span class="o">*</span><span class="n">eps</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">FUDGE</span><span class="o">*</span><span class="n">TWO</span><span class="o">*</span><span class="n">Pivmin</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span>
<span class="k">         ENDDO</span><span class="w"></span>
<span class="c">!        if the program reaches this point, no base representation could be</span>
<span class="c">!        found in MAXTRY iterations.</span>
<span class="w">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="w">         </span><span class="k">RETURN</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!        At this point, we have found an initial base representation</span>
<span class="c">!        T - SIGMA I = L D L^T with not too much element growth.</span>
<span class="c">!        Store the shift.</span>
<span class="w"> </span><span class="mi">50</span><span class="w">      </span><span class="n">E</span><span class="p">(</span><span class="n">iend</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sigma</span><span class="w"></span>
<span class="c">!        Store D and L.</span>
<span class="w">         </span><span class="k">CALL </span><span class="n">DCOPY</span><span class="p">(</span><span class="n">in</span><span class="p">,</span><span class="n">Work</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">D</span><span class="p">(</span><span class="n">ibegin</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">CALL </span><span class="n">DCOPY</span><span class="p">(</span><span class="n">in</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">in</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">E</span><span class="p">(</span><span class="n">ibegin</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w"> </span>
<span class="w"> </span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">mb</span><span class="o">&gt;</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Perturb each entry of the base representation by a small</span>
<span class="c">!           (but random) relative amount to overcome difficulties with</span>
<span class="c">!           glued matrices.</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<span class="w">               </span><span class="n">iseed</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDDO</span>
<span class="k"> </span>
<span class="k">            CALL </span><span class="n">DLARNV</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">iseed</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">in</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="n">D</span><span class="p">(</span><span class="n">ibegin</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="n">ibegin</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ONE</span><span class="o">+</span><span class="n">eps</span><span class="o">*</span><span class="n">PERT</span><span class="o">*</span><span class="n">Work</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="w"></span>
<span class="w">               </span><span class="n">E</span><span class="p">(</span><span class="n">ibegin</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">E</span><span class="p">(</span><span class="n">ibegin</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ONE</span><span class="o">+</span><span class="n">eps</span><span class="o">*</span><span class="n">PERT</span><span class="o">*</span><span class="n">Work</span><span class="p">(</span><span class="n">in</span><span class="o">+</span><span class="n">i</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDDO</span>
<span class="k">            </span><span class="n">D</span><span class="p">(</span><span class="n">iend</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="n">iend</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ONE</span><span class="o">+</span><span class="n">eps</span><span class="o">*</span><span class="n">FOUR</span><span class="o">*</span><span class="n">Work</span><span class="p">(</span><span class="n">in</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">         </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!        Don&#39;t update the Gerschgorin intervals because keeping track</span>
<span class="c">!        of the updates would be too much work in DLARRV.</span>
<span class="c">!        We update W instead and use it to locate the proper Gerschgorin</span>
<span class="c">!        intervals.</span>
<span class="w"> </span>
<span class="c">!        Compute the required eigenvalues of L D L&#39; by bisection or dqds</span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">usedqd</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!           If DLARRD has been used, shift the eigenvalue approximations</span>
<span class="c">!           according to their representation. This is necessary for</span>
<span class="c">!           a uniform DLARRV since dqds computes eigenvalues of the</span>
<span class="c">!           shifted representation. In DLARRV, W will always hold the</span>
<span class="c">!           UNshifted eigenvalue approximation.</span>
<span class="w">            </span><span class="k">DO </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wbegin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">wend</span><span class="w"></span>
<span class="w">               </span><span class="n">W</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">W</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sigma</span><span class="w"></span>
<span class="w">               </span><span class="n">Werr</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Werr</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">W</span><span class="p">(</span><span class="n">j</span><span class="p">))</span><span class="o">*</span><span class="n">eps</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDDO</span><span class="w"></span>
<span class="c">!           call DLARRB to reduce eigenvalue error of the approximations</span>
<span class="c">!           from DLARRD</span>
<span class="w">            </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ibegin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">iend</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="n">Work</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">E</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDDO</span><span class="w"></span>
<span class="c">!           use bisection to find EV from INDL to INDU</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">DLARRB</span><span class="p">(</span><span class="n">in</span><span class="p">,</span><span class="n">D</span><span class="p">(</span><span class="n">ibegin</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">ibegin</span><span class="p">),</span><span class="n">indl</span><span class="p">,</span><span class="n">indu</span><span class="p">,</span><span class="n">Rtol1</span><span class="p">,</span><span class="n">Rtol2</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">indl</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">W</span><span class="p">(</span><span class="n">wbegin</span><span class="p">),</span><span class="n">Wgap</span><span class="p">(</span><span class="n">wbegin</span><span class="p">),</span><span class="n">Werr</span><span class="p">(</span><span class="n">wbegin</span><span class="p">),</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Pivmin</span><span class="p">,</span><span class="n">spdiam</span><span class="p">,</span><span class="n">in</span><span class="p">,</span><span class="n">iinfo</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iinfo</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span><span class="w"></span>
<span class="w">               </span><span class="k">RETURN</span>
<span class="k">            ENDIF</span><span class="w"></span>
<span class="c">!           DLARRB computes all gaps correctly except for the last one</span>
<span class="c">!           Record distance to VU/GU</span>
<span class="w">            </span><span class="n">Wgap</span><span class="p">(</span><span class="n">wend</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">ZERO</span><span class="p">,(</span><span class="n">Vu</span><span class="o">-</span><span class="n">sigma</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">W</span><span class="p">(</span><span class="n">wend</span><span class="p">)</span><span class="o">+</span><span class="n">Werr</span><span class="p">(</span><span class="n">wend</span><span class="p">)))</span><span class="w"></span>
<span class="w">            </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indl</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">indu</span><span class="w"></span>
<span class="w">               </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="n">Iblock</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jblk</span><span class="w"></span>
<span class="w">               </span><span class="n">Indexw</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDDO</span>
<span class="k">         ELSE</span><span class="w"></span>
<span class="c">!           Call dqds to get all eigs (and then possibly delete unwanted</span>
<span class="c">!           eigenvalues).</span>
<span class="c">!           Note that dqds finds the eigenvalues of the L D L^T representation</span>
<span class="c">!           of T to high relative accuracy. High relative accuracy</span>
<span class="c">!           might be lost when the shift of the RRR is subtracted to obtain</span>
<span class="c">!           the eigenvalues of T. However, T is not guaranteed to define its</span>
<span class="c">!           eigenvalues to high relative accuracy anyway.</span>
<span class="c">!           Set RTOL to the order of the tolerance used in DLASQ2</span>
<span class="c">!           This is an ESTIMATED error, the worst case bound is 4*N*EPS</span>
<span class="c">!           which is usually too large and requires unnecessary work to be</span>
<span class="c">!           done by bisection when computing the eigenvectors</span>
<span class="w">            </span><span class="n">rtol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">LOG</span><span class="p">(</span><span class="nb">DBLE</span><span class="p">(</span><span class="n">in</span><span class="p">))</span><span class="o">*</span><span class="n">FOUR</span><span class="o">*</span><span class="n">eps</span><span class="w"></span>
<span class="w">            </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ibegin</span><span class="w"></span>
<span class="w">            </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="n">Work</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="n">j</span><span class="p">))</span><span class="w"></span>
<span class="w">               </span><span class="n">Work</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">E</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">E</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">Work</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDDO</span>
<span class="k">            </span><span class="n">Work</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">in</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="n">iend</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="n">Work</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">DLASQ2</span><span class="p">(</span><span class="n">in</span><span class="p">,</span><span class="n">Work</span><span class="p">,</span><span class="n">iinfo</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iinfo</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!              If IINFO = -5 then an index is part of a tight cluster</span>
<span class="c">!              and should be changed. The index is in IWORK(1) and the</span>
<span class="c">!              gap is in WORK(N+1)</span>
<span class="w">               </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">5</span><span class="w"></span>
<span class="w">               </span><span class="k">RETURN</span>
<span class="k">            ELSE</span><span class="w"></span>
<span class="c">!              Test that all eigenvalues are positive as expected</span>
<span class="w">               </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"></span>
<span class="w">                  </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">&lt;</span><span class="n">ZERO</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                     </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">6</span><span class="w"></span>
<span class="w">                     </span><span class="k">RETURN</span>
<span class="k">                  ENDIF</span>
<span class="k">               ENDDO</span>
<span class="k">            ENDIF</span>
<span class="k">            IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">sgndef</span><span class="o">&gt;</span><span class="n">ZERO</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indl</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">indu</span><span class="w"></span>
<span class="w">                  </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                  </span><span class="n">W</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">in</span><span class="o">-</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">Iblock</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jblk</span><span class="w"></span>
<span class="w">                  </span><span class="n">Indexw</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDDO</span>
<span class="k">            ELSE</span>
<span class="k">               DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indl</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">indu</span><span class="w"></span>
<span class="w">                  </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                  </span><span class="n">W</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">Work</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">Iblock</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jblk</span><span class="w"></span>
<span class="w">                  </span><span class="n">Indexw</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDDO</span>
<span class="k">            ENDIF</span>
<span class="k"> </span>
<span class="k">            DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mb</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="c">!              the value of RTOL below should be the tolerance in DLASQ2</span>
<span class="w">               </span><span class="n">Werr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rtol</span><span class="o">*</span><span class="nb">ABS</span><span class="p">(</span><span class="n">W</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDDO</span>
<span class="k">            DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mb</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="c">!              compute the right gap between the intervals</span>
<span class="w">               </span><span class="n">Wgap</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">ZERO</span><span class="p">,</span><span class="n">W</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">Werr</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">W</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="n">Werr</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDDO</span>
<span class="k">            </span><span class="n">Wgap</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">ZERO</span><span class="p">,(</span><span class="n">Vu</span><span class="o">-</span><span class="n">sigma</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">W</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="o">+</span><span class="n">Werr</span><span class="p">(</span><span class="n">M</span><span class="p">)))</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!        proceed with next block</span>
<span class="w">         </span><span class="n">ibegin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iend</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="n">wbegin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wend</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="k">ENDDO</span><span class="w"></span>
<span class="c">!</span>
<span class="w"> </span>
<span class="c">!</span>
<span class="c">!     end of DLARRE</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">END SUBROUTINE </span><span class="n">DLARRE</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              spag_lapack
 was developed by John S. Urban<br>              &copy; 2025 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2025-07-11 01:31 +0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>