<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="spag_lapack module">
    <meta name="author" content="John S. Urban" >
    <link rel="icon" href="../favicon.png">

    <title>SLARRD &ndash; spag_lapack</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">spag_lapack </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>SLARRD
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 0.1% of total for procedures.">309 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/slarrd.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/slarrd.f90.html'>slarrd.f90</a></li>
            <li class="breadcrumb-item active" aria-current="page">SLARRD</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#vars-0"
         aria-expanded="false" aria-controls="vars-0">
         <h4 class="card-header bg-primary text-white">Variables</h4>
      </a>
      <div id="vars-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../proc/slarrd.html#variable-allrng~3">ALLRNG</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-fudge~4">FUDGE</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-half~32">HALF</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-indrng~3">INDRNG</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-one~396">ONE</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-two~49">TWO</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-valrng~3">VALRNG</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-zero~386">ZERO</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-atoli~3">atoli</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-eps~103">eps</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-gl~6">gl</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-gu~6">gu</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-i~419">i</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-ib~49">ib</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-ibegin~6">ibegin</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-idiscl~3">idiscl</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-idiscu~3">idiscu</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-idumma~3">idumma</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-ie~9">ie</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-iend~8">iend</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-iinfo~108">iinfo</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-im~7">im</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-in~13">in</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-ioff~4">ioff</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-iout~3">iout</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-irange~4">irange</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-itmax~7">itmax</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-itmp1~15">itmp1</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-itmp2~2">itmp2</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-iw~7">iw</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-iwoff~6">iwoff</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-j~318">j</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-jblk~7">jblk</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-jdisc~3">jdisc</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-je~5">je</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-jee~2">jee</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-nb~85">nb</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-ncnvrg~3">ncnvrg</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-nwl~3">nwl</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-nwu~3">nwu</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-rtoli~3">rtoli</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-tmp1~15">tmp1</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-tmp2~3">tmp2</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-tnorm~3">tnorm</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-toofew~3">toofew</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-uflow~2">uflow</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-wkill~3">wkill</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-wlu~3">wlu</a>
            <a class="list-group-item" href="../proc/slarrd.html#variable-wul~3">wul</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/slarrd.html#src">SLARRD</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2> subroutine SLARRD(Range, Order, N, Vl, Vu, Il, Iu, Gers, Reltol, D, E, E2, Pivmin, Nsplit, Isplit, M, W, Werr, Wl, Wu, Iblock, Indexw, Work, Iwork, Info)  
</h2>
    

    <p>\brief \b SLARRD computes the eigenvalues of a symmetric tridiagonal matrix to suitable accuracy.
 \htmlonly
 Download SLARRD + dependencies
 <a href="http://www.netlib.org/cgi-bin/netlibfiles.tgz?format=tgz&filename=/lapack/lapack_routine/slarrd.f">
 [TGZ]</a>
 <a href="http://www.netlib.org/cgi-bin/netlibfiles.zip?format=zip&filename=/lapack/lapack_routine/slarrd.f">
 [ZIP]</a>
 <a href="http://www.netlib.org/cgi-bin/netlibfiles.txt?format=txt&filename=/lapack/lapack_routine/slarrd.f">
 [TXT]</a>
 \endhtmlonly
 \par Purpose:</p>
<p>\verbatim</p>
<p>SLARRD computes the eigenvalues of a symmetric tridiagonal
 matrix T to suitable accuracy. This is an auxiliary code to be
 called from SSTEMR.
 The user may ask for all eigenvalues, all eigenvalues
 in the half-open interval (VL, VU], or the IL-th through IU-th
 eigenvalues.</p>
<p>To avoid overflow, the matrix must be scaled so that its
 largest element is no greater than overflow<strong>(1/2) * underflow</strong>(1/4) in absolute value, and for greatest
 accuracy, it should not be much smaller than that.</p>
<p>See W. Kahan &ldquo;Accurate Eigenvalues of a Symmetric Tridiagonal
 Matrix&rdquo;, Report CS41, Computer Science Dept., Stanford
 University, July 21, 1966.
 \endverbatim
 \param[in] RANGE
 \verbatim
          RANGE is CHARACTER*1
          = &lsquo;A&rsquo;: (&ldquo;All&rdquo;)   all eigenvalues will be found.
          = &lsquo;V&rsquo;: (&ldquo;Value&rdquo;) all eigenvalues in the half-open interval
                           (VL, VU] will be found.
          = &lsquo;I&rsquo;: (&ldquo;Index&rdquo;) the IL-th through IU-th eigenvalues (of the
                           entire matrix) will be found.
 \endverbatim</p>
<p>\param[in] ORDER
 \verbatim
          ORDER is CHARACTER*1
          = &lsquo;B&rsquo;: (&ldquo;By Block&rdquo;) the eigenvalues will be grouped by
                              split-off block (see IBLOCK, ISPLIT) and
                              ordered from smallest to largest within
                              the block.
          = &lsquo;E&rsquo;: (&ldquo;Entire matrix&rdquo;)
                              the eigenvalues for the entire matrix
                              will be ordered from smallest to
                              largest.
 \endverbatim</p>
<p>\param[in] N
 \verbatim
          N is INTEGER
          The order of the tridiagonal matrix T.  N &gt;= 0.
 \endverbatim</p>
<p>\param[in] VL
 \verbatim
          VL is REAL
          If RANGE=&rsquo;V&rsquo;, the lower bound of the interval to
          be searched for eigenvalues.  Eigenvalues less than or equal
          to VL, or greater than VU, will not be returned.  VL &lt; VU.
          Not referenced if RANGE = &lsquo;A&rsquo; or &lsquo;I&rsquo;.
 \endverbatim</p>
<p>\param[in] VU
 \verbatim
          VU is REAL
          If RANGE=&rsquo;V&rsquo;, the upper bound of the interval to
          be searched for eigenvalues.  Eigenvalues less than or equal
          to VL, or greater than VU, will not be returned.  VL &lt; VU.
          Not referenced if RANGE = &lsquo;A&rsquo; or &lsquo;I&rsquo;.
 \endverbatim</p>
<p>\param[in] IL
 \verbatim
          IL is INTEGER
          If RANGE=&rsquo;I&rsquo;, the index of the
          smallest eigenvalue to be returned.
          1 &lt;= IL &lt;= IU &lt;= N, if N &gt; 0; IL = 1 and IU = 0 if N = 0.
          Not referenced if RANGE = &lsquo;A&rsquo; or &lsquo;V&rsquo;.
 \endverbatim</p>
<p>\param[in] IU
 \verbatim
          IU is INTEGER
          If RANGE=&rsquo;I&rsquo;, the index of the
          largest eigenvalue to be returned.
          1 &lt;= IL &lt;= IU &lt;= N, if N &gt; 0; IL = 1 and IU = 0 if N = 0.
          Not referenced if RANGE = &lsquo;A&rsquo; or &lsquo;V&rsquo;.
 \endverbatim</p>
<p>\param[in] GERS
 \verbatim
          GERS is REAL array, dimension (2<em>N)
          The N Gerschgorin intervals (the i-th Gerschgorin interval
          is (GERS(2</em>i-1), GERS(2*i)).
 \endverbatim</p>
<p>\param[in] RELTOL
 \verbatim
          RELTOL is REAL
          The minimum relative width of an interval.  When an interval
          is narrower than RELTOL times the larger (in
          magnitude) endpoint, then it is considered to be
          sufficiently small, i.e., converged.  Note: this should
          always be at least radix*machine epsilon.
 \endverbatim</p>
<p>\param[in] D
 \verbatim
          D is REAL array, dimension (N)
          The n diagonal elements of the tridiagonal matrix T.
 \endverbatim</p>
<p>\param[in] E
 \verbatim
          E is REAL array, dimension (N-1)
          The (n-1) off-diagonal elements of the tridiagonal matrix T.
 \endverbatim</p>
<p>\param[in] E2
 \verbatim
          E2 is REAL array, dimension (N-1)
          The (n-1) squared off-diagonal elements of the tridiagonal matrix T.
 \endverbatim</p>
<p>\param[in] PIVMIN
 \verbatim
          PIVMIN is REAL
          The minimum pivot allowed in the Sturm sequence for T.
 \endverbatim</p>
<p>\param[in] NSPLIT
 \verbatim
          NSPLIT is INTEGER
          The number of diagonal blocks in the matrix T.
          1 &lt;= NSPLIT &lt;= N.
 \endverbatim</p>
<p>\param[in] ISPLIT
 \verbatim
          ISPLIT is INTEGER array, dimension (N)
          The splitting points, at which T breaks up into submatrices.
          The first submatrix consists of rows/columns 1 to ISPLIT(1),
          the second of rows/columns ISPLIT(1)+1 through ISPLIT(2),
          etc., and the NSPLIT-th consists of rows/columns
          ISPLIT(NSPLIT-1)+1 through ISPLIT(NSPLIT)=N.
          (Only the first NSPLIT elements will actually be used, but
          since the user cannot know a priori what value NSPLIT will
          have, N words must be reserved for ISPLIT.)
 \endverbatim</p>
<p>\param[out] M
 \verbatim
          M is INTEGER
          The actual number of eigenvalues found. 0 &lt;= M &lt;= N.
          (See also the description of INFO=2,3.)
 \endverbatim</p>
<p>\param[out] W
 \verbatim
          W is REAL array, dimension (N)
          On exit, the first M elements of W will contain the
          eigenvalue approximations. SLARRD computes an interval
          I_j = (a_j, b_j] that includes eigenvalue j. The eigenvalue
          approximation is given as the interval midpoint
          W(j)= ( a_j + b_j)/2. The corresponding error is bounded by
          WERR(j) = abs( a_j - b_j)/2
 \endverbatim</p>
<p>\param[out] WERR
 \verbatim
          WERR is REAL array, dimension (N)
          The error bound on the corresponding eigenvalue approximation
          in W.
 \endverbatim</p>
<p>\param[out] WL
 \verbatim
          WL is REAL
 \endverbatim</p>
<p>\param[out] WU
 \verbatim
          WU is REAL
          The interval (WL, WU] contains all the wanted eigenvalues.
          If RANGE=&rsquo;V&rsquo;, then WL=VL and WU=VU.
          If RANGE=&rsquo;A&rsquo;, then WL and WU are the global Gerschgorin bounds
                        on the spectrum.
          If RANGE=&rsquo;I&rsquo;, then WL and WU are computed by SLAEBZ from the
                        index range specified.
 \endverbatim</p>
<p>\param[out] IBLOCK
 \verbatim
          IBLOCK is INTEGER array, dimension (N)
          At each row/column j where E(j) is zero or small, the
          matrix T is considered to split into a block diagonal
          matrix.  On exit, if INFO = 0, IBLOCK(i) specifies to which
          block (from 1 to the number of blocks) the eigenvalue W(i)
          belongs.  (SLARRD may use the remaining N-M elements as
          workspace.)
 \endverbatim</p>
<p>\param[out] INDEXW
 \verbatim
          INDEXW is INTEGER array, dimension (N)
          The indices of the eigenvalues within each block (submatrix);
          for example, INDEXW(i)= j and IBLOCK(i)=k imply that the
          i-th eigenvalue W(i) is the j-th eigenvalue in block k.
 \endverbatim</p>
<p>\param[out] WORK
 \verbatim
          WORK is REAL array, dimension (4*N)
 \endverbatim</p>
<p>\param[out] IWORK
 \verbatim
          IWORK is INTEGER array, dimension (3*N)
 \endverbatim</p>
<p>\param[out] INFO
 \verbatim
          INFO is INTEGER
          = 0:  successful exit
          &lt; 0:  if INFO = -i, the i-th argument had an illegal value
          &gt; 0:  some or all of the eigenvalues failed to converge or
                were not computed:
                =1 or 3: Bisection failed to converge for some
                        eigenvalues; these eigenvalues are flagged by a
                        negative block number.  The effect is that the
                        eigenvalues may not be as accurate as the
                        absolute and relative tolerances.  This is
                        generally caused by unexpectedly inaccurate
                        arithmetic.
                =2 or 3: RANGE=&rsquo;I&rsquo; only: Not all of the eigenvalues
                        IL:IU were found.
                        Effect: M &lt; IU+1-IL
                        Cause:  non-monotonic arithmetic, causing the
                                Sturm sequence to be non-monotonic.
                        Cure:   recalculate, using RANGE=&rsquo;A&rsquo;, and pick
                                out eigenvalues IL:IU.  In some cases,
                                increasing the PARAMETER &ldquo;FUDGE&rdquo; may
                                make things work.
                = 4:    RANGE=&rsquo;I&rsquo;, and the Gershgorin interval
                        initially used was too small.  No eigenvalues
                        were computed.
                        Probable cause: your machine has sloppy
                                        floating-point arithmetic.
                        Cure: Increase the PARAMETER &ldquo;FUDGE&rdquo;,
                              recompile, and try again.
 \endverbatim
 \par Internal Parameters:</p>
<p>\verbatim
  FUDGE   REAL, default = 2
          A &ldquo;fudge factor&rdquo; to widen the Gershgorin intervals.  Ideally,
          a value of 1 should work, but on machines with sloppy
          arithmetic, this needs to be larger.  The default for
          publicly released versions should be large enough to handle
          the worst machine around.  Note that this has no effect
          on accuracy of the solution.
 \endverbatim</p>
<p>\par Contributors:</p>
<div class="codehilite"><pre><span></span><code> W. Kahan, University of California, Berkeley, USA \n
 Beresford Parlett, University of California, Berkeley, USA \n
 Jim Demmel, University of California, Berkeley, USA \n
 Inderjit Dhillon, University of Texas, Austin, USA \n
 Osni Marques, LBNL/NERSC, USA \n
 Christof Voemel, University of California, Berkeley, USA \n
</code></pre></div>

<p>\author Univ. of Tennessee
 \author Univ. of California Berkeley
 \author Univ. of Colorado Denver
 \author NAG Ltd.
 \date June 2016
 \ingroup OTHERauxiliary
&ndash;SLARRD332</p>
<p>&ndash; LAPACK auxiliary routine (version 3.7.1) &ndash;
  &ndash; LAPACK is a software package provided by Univ. of Tennessee,    &ndash;
  &ndash; Univ. of California Berkeley, Univ. of Colorado Denver and NAG Ltd..&ndash;
     June 2016</p>
<div class="codehilite"><pre><span></span><code> <span class="p">..</span> <span class="n">Scalar</span> <span class="n">Arguments</span> <span class="p">..</span>
       <span class="mi">2</span><span class="n">x2</span> <span class="n">block</span>
        <span class="n">DISC</span> <span class="o">=</span> <span class="n">SQRT</span><span class="p">(</span> <span class="p">(</span><span class="n">HALF</span><span class="o">*</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="n">IBEGIN</span><span class="p">)</span><span class="o">-</span><span class="n">D</span><span class="p">(</span><span class="n">IEND</span><span class="p">)))</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">E</span><span class="p">(</span><span class="n">IBEGIN</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span>
        <span class="n">TMP1</span> <span class="o">=</span> <span class="n">HALF</span><span class="o">*</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="n">IBEGIN</span><span class="p">)</span><span class="o">+</span><span class="n">D</span><span class="p">(</span><span class="n">IEND</span><span class="p">))</span>
        <span class="n">L1</span> <span class="o">=</span> <span class="n">TMP1</span> <span class="o">-</span> <span class="n">DISC</span>
        <span class="kr">IF</span><span class="p">(</span> <span class="n">WL</span><span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">L1</span><span class="o">-</span><span class="n">PIVMIN</span> <span class="p">)</span>
 <span class="o">$</span>         <span class="n">NWL</span> <span class="o">=</span> <span class="n">NWL</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="kr">IF</span><span class="p">(</span> <span class="n">WU</span><span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">L1</span><span class="o">-</span><span class="n">PIVMIN</span> <span class="p">)</span>
 <span class="o">$</span>         <span class="n">NWU</span> <span class="o">=</span> <span class="n">NWU</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="kr">IF</span><span class="p">(</span> <span class="n">IRANGE</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">ALLRNG</span> <span class="p">.</span><span class="kr">OR</span><span class="p">.</span> <span class="p">(</span> <span class="n">WL</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span><span class="n">L1</span><span class="o">-</span><span class="n">PIVMIN</span> <span class="p">.</span><span class="n">AND</span><span class="p">.</span> <span class="n">WU</span><span class="p">.</span><span class="n">GE</span><span class="p">.</span>
 <span class="o">$</span>          <span class="n">L1</span><span class="o">-</span><span class="n">PIVMIN</span> <span class="p">)</span> <span class="p">)</span> <span class="kr">THEN</span>
           <span class="n">M</span> <span class="o">=</span> <span class="n">M</span> <span class="o">+</span> <span class="mi">1</span>
           <span class="n">W</span><span class="p">(</span> <span class="n">M</span> <span class="p">)</span> <span class="o">=</span> <span class="n">L1</span>
          <span class="n">The</span> <span class="n">uncertainty</span> <span class="n">of</span> <span class="n">eigenvalues</span> <span class="n">of</span> <span class="n">a</span> <span class="mi">2</span><span class="n">x2</span> <span class="n">matrix</span> <span class="n">is</span> <span class="n">very</span> <span class="n">small</span>
           <span class="n">WERR</span><span class="p">(</span> <span class="n">M</span> <span class="p">)</span> <span class="o">=</span> <span class="n">EPS</span> <span class="o">*</span> <span class="kr">ABS</span><span class="p">(</span> <span class="n">W</span><span class="p">(</span> <span class="n">M</span> <span class="p">)</span> <span class="p">)</span> <span class="o">*</span> <span class="n">TWO</span>
           <span class="n">IBLOCK</span><span class="p">(</span> <span class="n">M</span> <span class="p">)</span> <span class="o">=</span> <span class="n">JBLK</span>
           <span class="n">INDEXW</span><span class="p">(</span> <span class="n">M</span> <span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">ENDIF</span>
        <span class="n">L2</span> <span class="o">=</span> <span class="n">TMP1</span> <span class="o">+</span> <span class="n">DISC</span>
        <span class="kr">IF</span><span class="p">(</span> <span class="n">WL</span><span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">L2</span><span class="o">-</span><span class="n">PIVMIN</span> <span class="p">)</span>
 <span class="o">$</span>         <span class="n">NWL</span> <span class="o">=</span> <span class="n">NWL</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="kr">IF</span><span class="p">(</span> <span class="n">WU</span><span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">L2</span><span class="o">-</span><span class="n">PIVMIN</span> <span class="p">)</span>
 <span class="o">$</span>         <span class="n">NWU</span> <span class="o">=</span> <span class="n">NWU</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="kr">IF</span><span class="p">(</span> <span class="n">IRANGE</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">ALLRNG</span> <span class="p">.</span><span class="kr">OR</span><span class="p">.</span> <span class="p">(</span> <span class="n">WL</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span><span class="n">L2</span><span class="o">-</span><span class="n">PIVMIN</span> <span class="p">.</span><span class="n">AND</span><span class="p">.</span> <span class="n">WU</span><span class="p">.</span><span class="n">GE</span><span class="p">.</span>
 <span class="o">$</span>          <span class="n">L2</span><span class="o">-</span><span class="n">PIVMIN</span> <span class="p">)</span> <span class="p">)</span> <span class="kr">THEN</span>
           <span class="n">M</span> <span class="o">=</span> <span class="n">M</span> <span class="o">+</span> <span class="mi">1</span>
           <span class="n">W</span><span class="p">(</span> <span class="n">M</span> <span class="p">)</span> <span class="o">=</span> <span class="n">L2</span>
          <span class="n">The</span> <span class="n">uncertainty</span> <span class="n">of</span> <span class="n">eigenvalues</span> <span class="n">of</span> <span class="n">a</span> <span class="mi">2</span><span class="n">x2</span> <span class="n">matrix</span> <span class="n">is</span> <span class="n">very</span> <span class="n">small</span>
           <span class="n">WERR</span><span class="p">(</span> <span class="n">M</span> <span class="p">)</span> <span class="o">=</span> <span class="n">EPS</span> <span class="o">*</span> <span class="kr">ABS</span><span class="p">(</span> <span class="n">W</span><span class="p">(</span> <span class="n">M</span> <span class="p">)</span> <span class="p">)</span> <span class="o">*</span> <span class="n">TWO</span>
           <span class="n">IBLOCK</span><span class="p">(</span> <span class="n">M</span> <span class="p">)</span> <span class="o">=</span> <span class="n">JBLK</span>
           <span class="n">INDEXW</span><span class="p">(</span> <span class="n">M</span> <span class="p">)</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">ENDIF</span>
</code></pre></div>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-range~18"></span>
              character(len=1)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Range</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-order~3"></span>
              character(len=1)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Order</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-n~589"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>N</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-vl~40"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Vl</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-vu~20"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Vu</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-il~18"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Il</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iu~18"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Iu</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-gers~5"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Gers</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-reltol~2"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Reltol</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-d~90"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>D</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-e~59"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>E</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-e2~4"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>E2</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-pivmin~7"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Pivmin</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nsplit~5"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Nsplit</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isplit~9"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Isplit</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-m~210"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>M</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-w~61"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>W</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-werr~7"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Werr</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wl~2"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Wl</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wu~2"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Wu</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iblock~8"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Iblock</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-indexw~5"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Indexw</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-work~343"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Work</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iwork~82"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Iwork</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-info~469"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Info</strong></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    <br>


    <section>    
      <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-allrng~3"></span>
              integer,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>ALLRNG</strong></td>
<td> =</td>
                <td>1</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fudge~4"></span>
              real,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>FUDGE</strong></td>
<td> =</td>
                <td>TWO</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-half~32"></span>
              real,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>HALF</strong></td>
<td> =</td>
                <td>ONE/TWO</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-indrng~3"></span>
              integer,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>INDRNG</strong></td>
<td> =</td>
                <td>3</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-one~396"></span>
              real,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>ONE</strong></td>
<td> =</td>
                <td>1.0E0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-two~49"></span>
              real,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>TWO</strong></td>
<td> =</td>
                <td>2.0E0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-valrng~3"></span>
              integer,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>VALRNG</strong></td>
<td> =</td>
                <td>2</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-zero~386"></span>
              real,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>ZERO</strong></td>
<td> =</td>
                <td>0.0E0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-atoli~3"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>atoli</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-eps~103"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>eps</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-gl~6"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>gl</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-gu~6"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>gu</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-i~419"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>i</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ib~49"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ib</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ibegin~6"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ibegin</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-idiscl~3"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>idiscl</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-idiscu~3"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>idiscu</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-idumma~3"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>idumma</strong>(1)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ie~9"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ie</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iend~8"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iend</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iinfo~108"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iinfo</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-im~7"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>im</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-in~13"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>in</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ioff~4"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ioff</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iout~3"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iout</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-irange~4"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>irange</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-itmax~7"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>itmax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-itmp1~15"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>itmp1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-itmp2~2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>itmp2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iw~7"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iw</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iwoff~6"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iwoff</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-j~318"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>j</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jblk~7"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jblk</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jdisc~3"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jdisc</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-je~5"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>je</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jee~2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jee</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nb~85"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nb</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ncnvrg~3"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ncnvrg</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nwl~3"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nwl</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nwu~3"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nwu</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rtoli~3"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>rtoli</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-tmp1~15"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>tmp1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-tmp2~3"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>tmp2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-tnorm~3"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>tnorm</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-toofew~3"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>toofew</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-uflow~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>uflow</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wkill~3"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wkill</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wlu~3"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wlu</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wul~3"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wul</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">      </span><span class="k">SUBROUTINE </span><span class="n">SLARRD</span><span class="p">(</span><span class="nb">Range</span><span class="p">,</span><span class="n">Order</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Vl</span><span class="p">,</span><span class="n">Vu</span><span class="p">,</span><span class="n">Il</span><span class="p">,</span><span class="n">Iu</span><span class="p">,</span><span class="n">Gers</span><span class="p">,</span><span class="n">Reltol</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">E2</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Pivmin</span><span class="p">,</span><span class="n">Nsplit</span><span class="p">,</span><span class="n">Isplit</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">W</span><span class="p">,</span><span class="n">Werr</span><span class="p">,</span><span class="n">Wl</span><span class="p">,</span><span class="n">Wu</span><span class="p">,</span><span class="n">Iblock</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Indexw</span><span class="p">,</span><span class="n">Work</span><span class="p">,</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">IMPLICIT NONE</span><span class="w"></span>
<span class="c">!*--SLARRD332</span>
<span class="c">!</span>
<span class="c">!  -- LAPACK auxiliary routine (version 3.7.1) --</span>
<span class="c">!  -- LAPACK is a software package provided by Univ. of Tennessee,    --</span>
<span class="c">!  -- Univ. of California Berkeley, Univ. of Colorado Denver and NAG Ltd..--</span>
<span class="c">!     June 2016</span>
<span class="c">!</span>
<span class="c">!     .. Scalar Arguments ..</span>
<span class="w">      </span><span class="kt">CHARACTER </span><span class="n">Order</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nb">Range</span>
<span class="nb">      </span><span class="kt">INTEGER </span><span class="n">Il</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Info</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Iu</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Nsplit</span><span class="w"></span>
<span class="w">      </span><span class="kt">REAL </span><span class="n">Pivmin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Reltol</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Vl</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Vu</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Wl</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Wu</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Array Arguments ..</span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">Iblock</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Indexw</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Isplit</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Iwork</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="kt">REAL </span><span class="n">D</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">E</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">E2</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Gers</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">W</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Werr</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!</span>
<span class="c">!  =====================================================================</span>
<span class="c">!</span>
<span class="c">!     .. Parameters ..</span>
<span class="w">      </span><span class="kt">REAL </span><span class="n">ZERO</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ONE</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">TWO</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">HALF</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">FUDGE</span><span class="w"></span>
<span class="w">      </span><span class="k">PARAMETER</span><span class="w"> </span><span class="p">(</span><span class="n">ZERO</span><span class="o">=</span><span class="mf">0.0E0</span><span class="p">,</span><span class="n">ONE</span><span class="o">=</span><span class="mf">1.0E0</span><span class="p">,</span><span class="n">TWO</span><span class="o">=</span><span class="mf">2.0E0</span><span class="p">,</span><span class="n">HALF</span><span class="o">=</span><span class="n">ONE</span><span class="o">/</span><span class="n">TWO</span><span class="p">,</span><span class="n">FUDGE</span><span class="o">=</span><span class="n">TWO</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">ALLRNG</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">VALRNG</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">INDRNG</span><span class="w"></span>
<span class="w">      </span><span class="k">PARAMETER</span><span class="w"> </span><span class="p">(</span><span class="n">ALLRNG</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">VALRNG</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">INDRNG</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Local Scalars ..</span>
<span class="w">      </span><span class="kt">LOGICAL </span><span class="n">ncnvrg</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">toofew</span><span class="w"></span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">i</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ib</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ibegin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">idiscl</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">idiscu</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">iend</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">iinfo</span><span class="w"> </span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">im</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ioff</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">iout</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">irange</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">itmax</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">itmp1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">itmp2</span><span class="w"> </span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">iw</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">iwoff</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">jblk</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">jdisc</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">je</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">jee</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">nwl</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">nwu</span><span class="w"></span>
<span class="w">      </span><span class="kt">REAL </span><span class="n">atoli</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">eps</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">gl</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">gu</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">rtoli</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">tmp1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">tmp2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">tnorm</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">uflow</span><span class="w"> </span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">     </span><span class="n">wkill</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">wlu</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">wul</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!     ..</span>
<span class="c">!     .. Local Arrays ..</span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">idumma</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. External Functions ..</span>
<span class="w">      </span><span class="kt">LOGICAL </span><span class="n">LSAME</span><span class="w"></span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">ILAENV</span><span class="w"></span>
<span class="w">      </span><span class="kt">REAL </span><span class="n">SLAMCH</span><span class="w"></span>
<span class="w">      </span><span class="k">EXTERNAL </span><span class="n">LSAME</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ILAENV</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">SLAMCH</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. External Subroutines ..</span>
<span class="w">      </span><span class="k">EXTERNAL </span><span class="n">SLAEBZ</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Intrinsic Functions ..</span>
<span class="w">      </span><span class="k">INTRINSIC </span><span class="nb">ABS</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nb">LOG</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nb">MAX</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nb">MIN</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Executable Statements ..</span>
<span class="c">!</span>
<span class="w">      </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Quick return if possible</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">N</span><span class="o">&lt;=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">RETURN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Decode RANGE</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">LSAME</span><span class="p">(</span><span class="nb">Range</span><span class="p">,</span><span class="s1">&#39;A&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">irange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ALLRNG</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">LSAME</span><span class="p">(</span><span class="nb">Range</span><span class="p">,</span><span class="s1">&#39;V&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">irange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">VALRNG</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">LSAME</span><span class="p">(</span><span class="nb">Range</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">irange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">INDRNG</span><span class="w"></span>
<span class="w">      </span><span class="k">ELSE</span>
<span class="k">         </span><span class="n">irange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Check for Errors</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">irange</span><span class="o">&lt;=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.(</span><span class="n">LSAME</span><span class="p">(</span><span class="n">Order</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">LSAME</span><span class="p">(</span><span class="n">Order</span><span class="p">,</span><span class="s1">&#39;E&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">N</span><span class="o">&lt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">irange</span><span class="o">==</span><span class="n">VALRNG</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Vl</span><span class="o">&gt;=</span><span class="n">Vu</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">5</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">irange</span><span class="o">==</span><span class="n">INDRNG</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">Il</span><span class="o">&lt;</span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">Il</span><span class="o">&gt;</span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">))</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">6</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">irange</span><span class="o">==</span><span class="n">INDRNG</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">Iu</span><span class="o">&lt;</span><span class="nb">MIN</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Il</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">Iu</span><span class="o">&gt;</span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">7</span><span class="w"></span>
<span class="w">      </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Info</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">RETURN</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!     Initialize error flags</span>
<span class="w">      </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">ncnvrg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<span class="w">      </span><span class="n">toofew</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!     Quick return if possible</span>
<span class="w">      </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">N</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">RETURN</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!     Simplification:</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">irange</span><span class="o">==</span><span class="n">INDRNG</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">Il</span><span class="o">==</span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">Iu</span><span class="o">==</span><span class="n">N</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">irange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!     Get machine constants</span>
<span class="w">      </span><span class="n">eps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SLAMCH</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">uflow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SLAMCH</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w"> </span>
<span class="w"> </span>
<span class="c">!     Special Case when N=1</span>
<span class="c">!     Treat case of 1x1 matrix for quick return</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">N</span><span class="o">==</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">irange</span><span class="o">==</span><span class="n">ALLRNG</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w">                                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="p">((</span><span class="n">irange</span><span class="o">==</span><span class="n">VALRNG</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">&gt;</span><span class="n">Vl</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">&lt;=</span><span class="n">Vu</span><span class="p">))</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="p">((</span><span class="n">irange</span><span class="o">==</span><span class="n">INDRNG</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">Il</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">Iu</span><span class="o">==</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">W</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="c">!           The computation error of the eigenvalue is zero</span>
<span class="w">            </span><span class="n">Werr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="w">            </span><span class="n">Iblock</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">Indexw</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span>
<span class="k">         RETURN</span>
<span class="k">      ENDIF</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!     NB is the minimum vector length for vector bisection, or 0</span>
<span class="c">!     if only scalar is to be done.</span>
<span class="w">      </span><span class="n">nb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ILAENV</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;SSTEBZ&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nb</span><span class="o">&lt;=</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">nb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!     Find global spectral radius</span>
<span class="w">      </span><span class="n">gl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">gu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">         </span><span class="n">gl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">gl</span><span class="p">,</span><span class="n">Gers</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="n">gu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">gu</span><span class="p">,</span><span class="n">Gers</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">ENDDO</span><span class="w"></span>
<span class="c">!     Compute global Gerschgorin bounds and spectral diameter</span>
<span class="w">      </span><span class="n">tnorm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">gl</span><span class="p">),</span><span class="nb">ABS</span><span class="p">(</span><span class="n">gu</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="n">gl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gl</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">FUDGE</span><span class="o">*</span><span class="n">tnorm</span><span class="o">*</span><span class="n">eps</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">FUDGE</span><span class="o">*</span><span class="n">TWO</span><span class="o">*</span><span class="n">Pivmin</span><span class="w"></span>
<span class="w">      </span><span class="n">gu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gu</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">FUDGE</span><span class="o">*</span><span class="n">tnorm</span><span class="o">*</span><span class="n">eps</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">FUDGE</span><span class="o">*</span><span class="n">TWO</span><span class="o">*</span><span class="n">Pivmin</span><span class="w"></span>
<span class="c">!     [JAN/28/2009] remove the line below since SPDIAM variable not use</span>
<span class="c">!     SPDIAM = GU - GL</span>
<span class="c">!     Input arguments for SLAEBZ:</span>
<span class="c">!     The relative tolerance.  An interval (a,b] lies within</span>
<span class="c">!     &quot;relative tolerance&quot; if  b-a &lt; RELTOL*max(|a|,|b|),</span>
<span class="w">      </span><span class="n">rtoli</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Reltol</span><span class="w"></span>
<span class="c">!     Set the absolute tolerance for interval convergence to zero to force</span>
<span class="c">!     interval convergence based on relative size of the interval.</span>
<span class="c">!     This is dangerous because intervals might not converge when RELTOL is</span>
<span class="c">!     small. But at least a very small number should be selected so that for</span>
<span class="c">!     strongly graded matrices, the code can get relatively accurate</span>
<span class="c">!     eigenvalues.</span>
<span class="w">      </span><span class="n">atoli</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FUDGE</span><span class="o">*</span><span class="n">TWO</span><span class="o">*</span><span class="n">uflow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">FUDGE</span><span class="o">*</span><span class="n">TWO</span><span class="o">*</span><span class="n">Pivmin</span><span class="w"></span>
<span class="w"> </span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">irange</span><span class="o">==</span><span class="n">INDRNG</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!        RANGE=&#39;I&#39;: Compute an interval containing eigenvalues</span>
<span class="c">!        IL through IU. The initial interval [GL,GU] from the global</span>
<span class="c">!        Gerschgorin bounds GL and GU is refined by SLAEBZ.</span>
<span class="w">         </span><span class="n">itmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">((</span><span class="nb">LOG</span><span class="p">(</span><span class="n">tnorm</span><span class="o">+</span><span class="n">Pivmin</span><span class="p">)</span><span class="o">-</span><span class="nb">LOG</span><span class="p">(</span><span class="n">Pivmin</span><span class="p">))</span><span class="o">/</span><span class="nb">LOG</span><span class="p">(</span><span class="n">TWO</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="w">         </span><span class="n">Work</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gl</span><span class="w"></span>
<span class="w">         </span><span class="n">Work</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gl</span><span class="w"></span>
<span class="w">         </span><span class="n">Work</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gu</span><span class="w"></span>
<span class="w">         </span><span class="n">Work</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gu</span><span class="w"></span>
<span class="w">         </span><span class="n">Work</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gl</span><span class="w"></span>
<span class="w">         </span><span class="n">Work</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gu</span><span class="w"></span>
<span class="w">         </span><span class="n">Iwork</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="n">Iwork</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="n">Iwork</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="n">Iwork</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="n">Iwork</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Il</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="n">Iwork</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Iu</span><span class="w"></span>
<span class="c">!</span>
<span class="w">         </span><span class="k">CALL </span><span class="n">SLAEBZ</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">itmax</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">nb</span><span class="p">,</span><span class="n">atoli</span><span class="p">,</span><span class="n">rtoli</span><span class="p">,</span><span class="n">Pivmin</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">E2</span><span class="p">,</span><span class="n">Iwork</span><span class="p">(</span><span class="mi">5</span><span class="p">)&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">               </span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">5</span><span class="p">),</span><span class="n">iout</span><span class="p">,</span><span class="n">Iwork</span><span class="p">,</span><span class="n">W</span><span class="p">,</span><span class="n">Iblock</span><span class="p">,</span><span class="n">iinfo</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iinfo</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iinfo</span><span class="w"></span>
<span class="w">            </span><span class="k">RETURN</span>
<span class="k">         ENDIF</span><span class="w"></span>
<span class="c">!        On exit, output intervals may not be ordered by ascending negcount</span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Iwork</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">==</span><span class="n">Iu</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            </span><span class="n">Wl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">wlu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">nwl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Iwork</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">Wu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">wul</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">nwu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Iwork</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">ELSE</span>
<span class="k">            </span><span class="n">Wl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">wlu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">nwl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Iwork</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">Wu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">wul</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">nwu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Iwork</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!        On exit, the interval [WL, WLU] contains a value with negcount NWL,</span>
<span class="c">!        and [WUL, WU] contains a value with negcount NWU.</span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nwl</span><span class="o">&lt;</span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">nwl</span><span class="o">&gt;=</span><span class="n">N</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">nwu</span><span class="o">&lt;</span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">nwu</span><span class="o">&gt;</span><span class="n">N</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<span class="w">            </span><span class="k">RETURN</span>
<span class="k">         ENDIF</span>
<span class="k"> </span>
<span class="k">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">irange</span><span class="o">==</span><span class="n">VALRNG</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Wl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Vl</span><span class="w"></span>
<span class="w">         </span><span class="n">Wu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Vu</span><span class="w"></span>
<span class="w"> </span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">irange</span><span class="o">==</span><span class="n">ALLRNG</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Wl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gl</span><span class="w"></span>
<span class="w">         </span><span class="n">Wu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gu</span><span class="w"></span>
<span class="w">      </span><span class="k">ENDIF</span><span class="w"></span>
<span class="w"> </span>
<span class="w"> </span>
<span class="w"> </span>
<span class="c">!     Find Eigenvalues -- Loop Over blocks and recompute NWL and NWU.</span>
<span class="c">!     NWL accumulates the number of eigenvalues .le. WL,</span>
<span class="c">!     NWU accumulates the number of eigenvalues .le. WU</span>
<span class="w">      </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">iend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">nwl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">nwu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="c">!</span>
<span class="w">      </span><span class="k">DO </span><span class="n">jblk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Nsplit</span><span class="w"></span>
<span class="w">         </span><span class="n">ioff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iend</span><span class="w"></span>
<span class="w">         </span><span class="n">ibegin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ioff</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="n">iend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Isplit</span><span class="p">(</span><span class="n">jblk</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">in</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iend</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ioff</span><span class="w"></span>
<span class="c">!</span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">in</span><span class="o">==</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!           1x1 block</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Wl</span><span class="o">&gt;=</span><span class="n">D</span><span class="p">(</span><span class="n">ibegin</span><span class="p">)</span><span class="o">-</span><span class="n">Pivmin</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">nwl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nwl</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Wu</span><span class="o">&gt;=</span><span class="n">D</span><span class="p">(</span><span class="n">ibegin</span><span class="p">)</span><span class="o">-</span><span class="n">Pivmin</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">nwu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nwu</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">irange</span><span class="o">==</span><span class="n">ALLRNG</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w">                                    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">           </span><span class="p">(</span><span class="n">Wl</span><span class="o">&lt;</span><span class="n">D</span><span class="p">(</span><span class="n">ibegin</span><span class="p">)</span><span class="o">-</span><span class="n">Pivmin</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">Wu</span><span class="o">&gt;=</span><span class="n">D</span><span class="p">(</span><span class="n">ibegin</span><span class="p">)</span><span class="o">-</span><span class="n">Pivmin</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="n">W</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="n">ibegin</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">Werr</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="c">!              The gap for a single block doesn&#39;t matter for the later</span>
<span class="c">!              algorithm and is assigned an arbitrary large value</span>
<span class="w">               </span><span class="n">Iblock</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jblk</span><span class="w"></span>
<span class="w">               </span><span class="n">Indexw</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!        Disabled 2x2 case because of a failure on the following matrix</span>
<span class="c">!        RANGE = &#39;I&#39;, IL = IU = 4</span>
<span class="c">!          Original Tridiagonal, d = [</span>
<span class="c">!           -0.150102010615740E+00</span>
<span class="c">!           -0.849897989384260E+00</span>
<span class="c">!           -0.128208148052635E-15</span>
<span class="c">!            0.128257718286320E-15</span>
<span class="c">!          ];</span>
<span class="c">!          e = [</span>
<span class="c">!           -0.357171383266986E+00</span>
<span class="c">!           -0.180411241501588E-15</span>
<span class="c">!           -0.175152352710251E-15</span>
<span class="c">!          ];</span>
<span class="c">!</span>
<span class="c">!         ELSE IF( IN.EQ.2 ) THEN</span>
<span class="c">!*           2x2 block</span>
<span class="c">!            DISC = SQRT( (HALF*(D(IBEGIN)-D(IEND)))**2 + E(IBEGIN)**2 )</span>
<span class="c">!            TMP1 = HALF*(D(IBEGIN)+D(IEND))</span>
<span class="c">!            L1 = TMP1 - DISC</span>
<span class="c">!            IF( WL.GE. L1-PIVMIN )</span>
<span class="c">!     $         NWL = NWL + 1</span>
<span class="c">!            IF( WU.GE. L1-PIVMIN )</span>
<span class="c">!     $         NWU = NWU + 1</span>
<span class="c">!            IF( IRANGE.EQ.ALLRNG .OR. ( WL.LT.L1-PIVMIN .AND. WU.GE.</span>
<span class="c">!     $          L1-PIVMIN ) ) THEN</span>
<span class="c">!               M = M + 1</span>
<span class="c">!               W( M ) = L1</span>
<span class="c">!*              The uncertainty of eigenvalues of a 2x2 matrix is very small</span>
<span class="c">!               WERR( M ) = EPS * ABS( W( M ) ) * TWO</span>
<span class="c">!               IBLOCK( M ) = JBLK</span>
<span class="c">!               INDEXW( M ) = 1</span>
<span class="c">!            ENDIF</span>
<span class="c">!            L2 = TMP1 + DISC</span>
<span class="c">!            IF( WL.GE. L2-PIVMIN )</span>
<span class="c">!     $         NWL = NWL + 1</span>
<span class="c">!            IF( WU.GE. L2-PIVMIN )</span>
<span class="c">!     $         NWU = NWU + 1</span>
<span class="c">!            IF( IRANGE.EQ.ALLRNG .OR. ( WL.LT.L2-PIVMIN .AND. WU.GE.</span>
<span class="c">!     $          L2-PIVMIN ) ) THEN</span>
<span class="c">!               M = M + 1</span>
<span class="c">!               W( M ) = L2</span>
<span class="c">!*              The uncertainty of eigenvalues of a 2x2 matrix is very small</span>
<span class="c">!               WERR( M ) = EPS * ABS( W( M ) ) * TWO</span>
<span class="c">!               IBLOCK( M ) = JBLK</span>
<span class="c">!               INDEXW( M ) = 2</span>
<span class="c">!            ENDIF</span>
<span class="w">         </span><span class="k">ELSE</span><span class="w"></span>
<span class="c">!           General Case - block of size IN &gt;= 2</span>
<span class="c">!           Compute local Gerschgorin interval and use it as the initial</span>
<span class="c">!           interval for SLAEBZ</span>
<span class="w">            </span><span class="n">gu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="n">ibegin</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">gl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="n">ibegin</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">tmp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="w"> </span>
<span class="w">            </span><span class="k">DO </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ibegin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">iend</span><span class="w"></span>
<span class="w">               </span><span class="n">gl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">gl</span><span class="p">,</span><span class="n">Gers</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="w">               </span><span class="n">gu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">gu</span><span class="p">,</span><span class="n">Gers</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDDO</span><span class="w"></span>
<span class="c">!           [JAN/28/2009]</span>
<span class="c">!           change SPDIAM by TNORM in lines 2 and 3 thereafter</span>
<span class="c">!           line 1: remove computation of SPDIAM (not useful anymore)</span>
<span class="c">!           SPDIAM = GU - GL</span>
<span class="c">!           GL = GL - FUDGE*SPDIAM*EPS*IN - FUDGE*PIVMIN</span>
<span class="c">!           GU = GU + FUDGE*SPDIAM*EPS*IN + FUDGE*PIVMIN</span>
<span class="w">            </span><span class="n">gl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gl</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">FUDGE</span><span class="o">*</span><span class="n">tnorm</span><span class="o">*</span><span class="n">eps</span><span class="o">*</span><span class="n">in</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">FUDGE</span><span class="o">*</span><span class="n">Pivmin</span><span class="w"></span>
<span class="w">            </span><span class="n">gu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gu</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">FUDGE</span><span class="o">*</span><span class="n">tnorm</span><span class="o">*</span><span class="n">eps</span><span class="o">*</span><span class="n">in</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">FUDGE</span><span class="o">*</span><span class="n">Pivmin</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">irange</span><span class="o">&gt;</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">gu</span><span class="o">&lt;</span><span class="n">Wl</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                 the local block contains none of the wanted eigenvalues</span>
<span class="w">                  </span><span class="n">nwl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nwl</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">in</span><span class="w"></span>
<span class="w">                  </span><span class="n">nwu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nwu</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">in</span><span class="w"></span>
<span class="w">                  </span><span class="k">CYCLE</span>
<span class="k">               ENDIF</span><span class="w"></span>
<span class="c">!              refine search interval if possible, only range (WL,WU] matters</span>
<span class="w">               </span><span class="n">gl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">gl</span><span class="p">,</span><span class="n">Wl</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">gu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">gu</span><span class="p">,</span><span class="n">Wu</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">gl</span><span class="o">&gt;=</span><span class="n">gu</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">CYCLE</span>
<span class="k">            ENDIF</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!           Find negcount of initial interval boundaries GL and GU</span>
<span class="w">            </span><span class="n">Work</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gl</span><span class="w"></span>
<span class="w">            </span><span class="n">Work</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="n">in</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gu</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SLAEBZ</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">in</span><span class="p">,</span><span class="n">in</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">nb</span><span class="p">,</span><span class="n">atoli</span><span class="p">,</span><span class="n">rtoli</span><span class="p">,</span><span class="n">Pivmin</span><span class="p">,</span><span class="n">D</span><span class="p">(</span><span class="n">ibegin</span><span class="p">),</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">E</span><span class="p">(</span><span class="n">ibegin</span><span class="p">),</span><span class="n">E2</span><span class="p">(</span><span class="n">ibegin</span><span class="p">),</span><span class="n">idumma</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">in</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">im</span><span class="p">,</span><span class="n">Iwork</span><span class="p">,</span><span class="n">W</span><span class="p">(</span><span class="n">M</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">Iblock</span><span class="p">(</span><span class="n">M</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">iinfo</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iinfo</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iinfo</span><span class="w"></span>
<span class="w">               </span><span class="k">RETURN</span>
<span class="k">            ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="n">nwl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nwl</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Iwork</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">nwu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nwu</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Iwork</span><span class="p">(</span><span class="n">in</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">iwoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Iwork</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!           Compute Eigenvalues</span>
<span class="w">            </span><span class="n">itmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">((</span><span class="nb">LOG</span><span class="p">(</span><span class="n">gu</span><span class="o">-</span><span class="n">gl</span><span class="o">+</span><span class="n">Pivmin</span><span class="p">)</span><span class="o">-</span><span class="nb">LOG</span><span class="p">(</span><span class="n">Pivmin</span><span class="p">))</span><span class="o">/</span><span class="nb">LOG</span><span class="p">(</span><span class="n">TWO</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SLAEBZ</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">itmax</span><span class="p">,</span><span class="n">in</span><span class="p">,</span><span class="n">in</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">nb</span><span class="p">,</span><span class="n">atoli</span><span class="p">,</span><span class="n">rtoli</span><span class="p">,</span><span class="n">Pivmin</span><span class="p">,</span><span class="n">D</span><span class="p">(</span><span class="n">ibegin</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">E</span><span class="p">(</span><span class="n">ibegin</span><span class="p">),</span><span class="n">E2</span><span class="p">(</span><span class="n">ibegin</span><span class="p">),</span><span class="n">idumma</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Work</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">in</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">iout</span><span class="p">,</span><span class="n">Iwork</span><span class="p">,</span><span class="n">W</span><span class="p">(</span><span class="n">M</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">Iblock</span><span class="p">(</span><span class="n">M</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">iinfo</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iinfo</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iinfo</span><span class="w"></span>
<span class="w">               </span><span class="k">RETURN</span>
<span class="k">            ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Copy eigenvalues into W and IBLOCK</span>
<span class="c">!           Use -JBLK for block number for unconverged eigenvalues.</span>
<span class="c">!           Loop over the number of output intervals from SLAEBZ</span>
<span class="w">            </span><span class="k">DO </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">iout</span><span class="w"></span>
<span class="c">!              eigenvalue approximation is middle point of interval</span>
<span class="w">               </span><span class="n">tmp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HALF</span><span class="o">*</span><span class="p">(</span><span class="n">Work</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="n">N</span><span class="p">)</span><span class="o">+</span><span class="n">Work</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="n">in</span><span class="o">+</span><span class="n">N</span><span class="p">))</span><span class="w"></span>
<span class="c">!              semi length of error interval</span>
<span class="w">               </span><span class="n">tmp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HALF</span><span class="o">*</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Work</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="n">N</span><span class="p">)</span><span class="o">-</span><span class="n">Work</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="n">in</span><span class="o">+</span><span class="n">N</span><span class="p">))</span><span class="w"></span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">&gt;</span><span class="n">iout</span><span class="o">-</span><span class="n">iinfo</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                 Flag non-convergence.</span>
<span class="w">                  </span><span class="n">ncnvrg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="w">                  </span><span class="n">ib</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">jblk</span><span class="w"></span>
<span class="w">               </span><span class="k">ELSE</span>
<span class="k">                  </span><span class="n">ib</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jblk</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span>
<span class="k">               DO </span><span class="n">je</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Iwork</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">iwoff</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Iwork</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">iwoff</span><span class="w"></span>
<span class="w">                  </span><span class="n">W</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tmp1</span><span class="w"></span>
<span class="w">                  </span><span class="n">Werr</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tmp2</span><span class="w"></span>
<span class="w">                  </span><span class="n">Indexw</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">je</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">iwoff</span><span class="w"></span>
<span class="w">                  </span><span class="n">Iblock</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ib</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDDO</span>
<span class="k">            ENDDO</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">im</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span>
<span class="k">      ENDDO</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!     If RANGE=&#39;I&#39;, then (WL,WU) contains eigenvalues NWL+1,...,NWU</span>
<span class="c">!     If NWL+1 &lt; IL or NWU &gt; IU, discard extra eigenvalues.</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">irange</span><span class="o">==</span><span class="n">INDRNG</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">idiscl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Il</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">nwl</span><span class="w"></span>
<span class="w">         </span><span class="n">idiscu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nwu</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Iu</span><span class="w"></span>
<span class="c">!</span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">idiscl</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            </span><span class="n">im</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">            </span><span class="k">DO </span><span class="n">je</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="c">!              Remove some of the smallest eigenvalues from the left so that</span>
<span class="c">!              at the end IDISCL =0. Move all eigenvalues up to the left.</span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">W</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="o">&lt;=</span><span class="n">wlu</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">idiscl</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                  </span><span class="n">idiscl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">idiscl</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="k">ELSE</span>
<span class="k">                  </span><span class="n">im</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">im</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                  </span><span class="n">W</span><span class="p">(</span><span class="n">im</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">W</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">Werr</span><span class="p">(</span><span class="n">im</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Werr</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">Indexw</span><span class="p">(</span><span class="n">im</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Indexw</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">Iblock</span><span class="p">(</span><span class="n">im</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Iblock</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span>
<span class="k">            ENDDO</span>
<span class="k">            </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">im</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span>
<span class="k">         IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">idiscu</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!           Remove some of the largest eigenvalues from the right so that</span>
<span class="c">!           at the end IDISCU =0. Move all eigenvalues up to the left.</span>
<span class="w">            </span><span class="n">im</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="k">DO </span><span class="n">je</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">W</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="o">&gt;=</span><span class="n">wul</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">idiscu</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                  </span><span class="n">idiscu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">idiscu</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="k">ELSE</span>
<span class="k">                  </span><span class="n">im</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">im</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                  </span><span class="n">W</span><span class="p">(</span><span class="n">im</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">W</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">Werr</span><span class="p">(</span><span class="n">im</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Werr</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">Indexw</span><span class="p">(</span><span class="n">im</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Indexw</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">Iblock</span><span class="p">(</span><span class="n">im</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Iblock</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span>
<span class="k">            ENDDO</span>
<span class="k">            </span><span class="n">jee</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">            </span><span class="k">DO </span><span class="n">je</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">im</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">               </span><span class="n">jee</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jee</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="n">W</span><span class="p">(</span><span class="n">jee</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">W</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">Werr</span><span class="p">(</span><span class="n">jee</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Werr</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">Indexw</span><span class="p">(</span><span class="n">jee</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Indexw</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">Iblock</span><span class="p">(</span><span class="n">jee</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Iblock</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDDO</span>
<span class="k">            </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">im</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span>
<span class="k"> </span>
<span class="k">         IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">idiscl</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">idiscu</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!           Code to deal with effects of bad arithmetic. (If N(w) is</span>
<span class="c">!           monotone non-decreasing, this should never happen.)</span>
<span class="c">!           Some low eigenvalues to be discarded are not in (WL,WLU],</span>
<span class="c">!           or high eigenvalues to be discarded are not in (WUL,WU]</span>
<span class="c">!           so just kill off the smallest IDISCL/largest IDISCU</span>
<span class="c">!           eigenvalues, by marking the corresponding IBLOCK = 0</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">idiscl</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">wkill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Wu</span><span class="w"></span>
<span class="w">               </span><span class="k">DO </span><span class="n">jdisc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">idiscl</span><span class="w"></span>
<span class="w">                  </span><span class="n">iw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">                  </span><span class="k">DO </span><span class="n">je</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">                     </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Iblock</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">W</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="o">&lt;</span><span class="n">wkill</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">iw</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">)&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                    </span><span class="k">THEN</span>
<span class="k">                        </span><span class="n">iw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">je</span><span class="w"></span>
<span class="w">                        </span><span class="n">wkill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">W</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="k">ENDIF</span>
<span class="k">                  ENDDO</span>
<span class="k">                  </span><span class="n">Iblock</span><span class="p">(</span><span class="n">iw</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDDO</span>
<span class="k">            ENDIF</span>
<span class="k">            IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">idiscu</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">wkill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Wl</span><span class="w"></span>
<span class="w">               </span><span class="k">DO </span><span class="n">jdisc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">idiscu</span><span class="w"></span>
<span class="w">                  </span><span class="n">iw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">                  </span><span class="k">DO </span><span class="n">je</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">                     </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Iblock</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">W</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="o">&gt;=</span><span class="n">wkill</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">iw</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                    </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                        </span><span class="n">iw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">je</span><span class="w"></span>
<span class="w">                        </span><span class="n">wkill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">W</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="k">ENDIF</span>
<span class="k">                  ENDDO</span>
<span class="k">                  </span><span class="n">Iblock</span><span class="p">(</span><span class="n">iw</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDDO</span>
<span class="k">            ENDIF</span><span class="w"></span>
<span class="c">!           Now erase all eigenvalues with IBLOCK set to zero</span>
<span class="w">            </span><span class="n">im</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">            </span><span class="k">DO </span><span class="n">je</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Iblock</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                  </span><span class="n">im</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">im</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                  </span><span class="n">W</span><span class="p">(</span><span class="n">im</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">W</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">Werr</span><span class="p">(</span><span class="n">im</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Werr</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">Indexw</span><span class="p">(</span><span class="n">im</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Indexw</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">Iblock</span><span class="p">(</span><span class="n">im</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Iblock</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span>
<span class="k">            ENDDO</span>
<span class="k">            </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">im</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span>
<span class="k">         IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">idiscl</span><span class="o">&lt;</span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">idiscu</span><span class="o">&lt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">toofew</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="w">      </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">irange</span><span class="o">==</span><span class="n">ALLRNG</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">M</span><span class="o">/=</span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w">                             </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">     </span><span class="p">(</span><span class="n">irange</span><span class="o">==</span><span class="n">INDRNG</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">M</span><span class="o">/=</span><span class="n">Iu</span><span class="o">-</span><span class="n">Il</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">toofew</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!     If ORDER=&#39;B&#39;, do nothing the eigenvalues are already sorted by</span>
<span class="c">!        block.</span>
<span class="c">!     If ORDER=&#39;E&#39;, sort the eigenvalues from smallest to largest</span>
<span class="w"> </span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">LSAME</span><span class="p">(</span><span class="n">Order</span><span class="p">,</span><span class="s1">&#39;E&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">Nsplit</span><span class="o">&gt;</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         DO </span><span class="n">je</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">ie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">            </span><span class="n">tmp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">W</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">DO </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">je</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">W</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">&lt;</span><span class="n">tmp1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                  </span><span class="n">ie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="w"></span>
<span class="w">                  </span><span class="n">tmp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">W</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span>
<span class="k">            ENDDO</span>
<span class="k">            IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ie</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">tmp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Werr</span><span class="p">(</span><span class="n">ie</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">itmp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Iblock</span><span class="p">(</span><span class="n">ie</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">itmp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Indexw</span><span class="p">(</span><span class="n">ie</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">W</span><span class="p">(</span><span class="n">ie</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">W</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">Werr</span><span class="p">(</span><span class="n">ie</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Werr</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">Iblock</span><span class="p">(</span><span class="n">ie</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Iblock</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">Indexw</span><span class="p">(</span><span class="n">ie</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Indexw</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">W</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tmp1</span><span class="w"></span>
<span class="w">               </span><span class="n">Werr</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tmp2</span><span class="w"></span>
<span class="w">               </span><span class="n">Iblock</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itmp1</span><span class="w"></span>
<span class="w">               </span><span class="n">Indexw</span><span class="p">(</span><span class="n">je</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itmp2</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span>
<span class="k">         ENDDO</span>
<span class="k">      ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="w">      </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ncnvrg</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Info</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">toofew</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Info</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     End of SLARRD</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">END SUBROUTINE </span><span class="n">SLARRD</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              spag_lapack
 was developed by John S. Urban<br>              &copy; 2025 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2025-07-11 01:31 +0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>