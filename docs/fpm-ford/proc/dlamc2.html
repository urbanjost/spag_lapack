<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="spag_lapack module">
    <meta name="author" content="John S. Urban" >
    <link rel="icon" href="../favicon.png">

    <title>DLAMC2 &ndash; spag_lapack</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">spag_lapack </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>DLAMC2
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 0.0% of total for procedures.">106 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/dlamchf77.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/dlamchf77.f90.html'>dlamchf77.f90</a></li>
            <li class="breadcrumb-item active" aria-current="page">DLAMC2</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#vars-0"
         aria-expanded="false" aria-controls="vars-0">
         <h4 class="card-header bg-primary text-white">Variables</h4>
      </a>
      <div id="vars-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../proc/dlamc2.html#variable-a~3">a</a>
            <a class="list-group-item" href="../proc/dlamc2.html#variable-b~4">b</a>
            <a class="list-group-item" href="../proc/dlamc2.html#variable-c~24">c</a>
            <a class="list-group-item" href="../proc/dlamc2.html#variable-first~3">first</a>
            <a class="list-group-item" href="../proc/dlamc2.html#variable-gnmin">gnmin</a>
            <a class="list-group-item" href="../proc/dlamc2.html#variable-gpmin">gpmin</a>
            <a class="list-group-item" href="../proc/dlamc2.html#variable-half">half</a>
            <a class="list-group-item" href="../proc/dlamc2.html#variable-i~693">i</a>
            <a class="list-group-item" href="../proc/dlamc2.html#variable-ieee~3">ieee</a>
            <a class="list-group-item" href="../proc/dlamc2.html#variable-iwarn">iwarn</a>
            <a class="list-group-item" href="../proc/dlamc2.html#variable-lbeta~2">lbeta</a>
            <a class="list-group-item" href="../proc/dlamc2.html#variable-lemax">lemax</a>
            <a class="list-group-item" href="../proc/dlamc2.html#variable-lemin">lemin</a>
            <a class="list-group-item" href="../proc/dlamc2.html#variable-leps">leps</a>
            <a class="list-group-item" href="../proc/dlamc2.html#variable-lieee1~2">lieee1</a>
            <a class="list-group-item" href="../proc/dlamc2.html#variable-lrmax">lrmax</a>
            <a class="list-group-item" href="../proc/dlamc2.html#variable-lrmin">lrmin</a>
            <a class="list-group-item" href="../proc/dlamc2.html#variable-lrnd~3">lrnd</a>
            <a class="list-group-item" href="../proc/dlamc2.html#variable-lt~4">lt</a>
            <a class="list-group-item" href="../proc/dlamc2.html#variable-ngnmin">ngnmin</a>
            <a class="list-group-item" href="../proc/dlamc2.html#variable-ngpmin">ngpmin</a>
            <a class="list-group-item" href="../proc/dlamc2.html#variable-one~4">one</a>
            <a class="list-group-item" href="../proc/dlamc2.html#variable-rbase">rbase</a>
            <a class="list-group-item" href="../proc/dlamc2.html#variable-sixth">sixth</a>
            <a class="list-group-item" href="../proc/dlamc2.html#variable-small~24">small</a>
            <a class="list-group-item" href="../proc/dlamc2.html#variable-third">third</a>
            <a class="list-group-item" href="../proc/dlamc2.html#variable-two~3">two</a>
            <a class="list-group-item" href="../proc/dlamc2.html#variable-zero~3">zero</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/dlamc2.html#src">DLAMC2</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2> subroutine DLAMC2(Beta, T, Rnd, Eps, Emin, Rmin, Emax, Rmax)  
</h2>
    

    <p>\brief \b DLAMC2
 \details
 \b Purpose:
 \verbatim
 DLAMC2 determines the machine parameters specified in its argument
 list.
 \endverbatim
 \author LAPACK is a software package provided by Univ. of Tennessee, Univ. of California Berkeley, Univ. of Colorado Denver and NAG Ltd..
 \date April 2012
 \ingroup auxOTHERauxiliary</p>
<p>\param[out] BETA
 \verbatim
          The base of the machine.
 \endverbatim</p>
<p>\param[out] T
 \verbatim
          The number of ( BETA ) digits in the mantissa.
 \endverbatim</p>
<p>\param[out] RND
 \verbatim
          Specifies whether proper rounding  ( RND = .TRUE. )  or
          chopping  ( RND = .FALSE. )  occurs in addition. This may not
          be a reliable guide to the way in which the machine performs
          its arithmetic.
 \endverbatim</p>
<p>\param[out] EPS
 \verbatim
          The smallest positive number such that
             fl( 1.0 - EPS ) .LT. 1.0,
          where fl denotes the computed value.
 \endverbatim</p>
<p>\param[out] EMIN
 \verbatim
          The minimum exponent before (gradual) underflow occurs.
 \endverbatim</p>
<p>\param[out] RMIN
 \verbatim
          The smallest normalized number for the machine, given by
          BASE**( EMIN - 1 ), where  BASE  is the floating point value
          of BETA.
 \endverbatim</p>
<p>\param[out] EMAX
 \verbatim
          The maximum exponent before overflow occurs.
 \endverbatim</p>
<p>\param[out] RMAX
 \verbatim
          The largest positive number for the machine, given by
          BASE**EMAX * ( 1 - EPS ), where  BASE  is the floating point
          value of BETA.
 \endverbatim</p>
<p>\details \b Further \b Details
 \verbatim</p>
<p>The computation of  EPS  is based on a routine PARANOIA by
  W. Kahan of the University of California at Berkeley.
 \endverbatim
&ndash;DLAMC2431</p>
<p>&ndash; LAPACK auxiliary routine (version 3.7.0) &ndash;
     Univ. of Tennessee, Univ. of California Berkeley and NAG Ltd..
     November 2010</p>
<div class="codehilite"><pre><span></span><code> .. Scalar Arguments ..
</code></pre></div>

<p>*
 Comment out this if block if EMIN is ok
*</p>
<div class="codehilite"><pre><span></span><code>    <span class="nv">Assume</span> <span class="nv">IEEE</span> <span class="nv">arithmetic</span> <span class="k">if</span> <span class="nv">we</span> <span class="nv">found</span> <span class="nv">denormalised</span>  <span class="nv">numbers</span> <span class="nv">above</span>,
    <span class="nv">or</span> <span class="k">if</span> <span class="nv">arithmetic</span> <span class="nv">seems</span> <span class="nv">to</span> <span class="nv">round</span> <span class="nv">in</span> <span class="nv">the</span>  <span class="nv">IEEE</span> <span class="nv">style</span>,  <span class="nv">determined</span>
    <span class="nv">in</span> <span class="nv">routine</span> <span class="nv">DLAMC1</span>. <span class="nv">A</span> <span class="nv">true</span> <span class="nv">IEEE</span> <span class="nv">machine</span> <span class="nv">should</span> <span class="nv">have</span> <span class="nv">both</span>  <span class="nv">things</span>
    <span class="nv">true</span><span class="c1">; however, faulty machines may have one or the other.</span>
</code></pre></div>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-beta~62"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Beta</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-t~84"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>T</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rnd~2"></span>
              logical
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Rnd</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-eps~5"></span>
              double precision
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Eps</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-emin"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Emin</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rmin"></span>
              double precision
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Rmin</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-emax"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Emax</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rmax"></span>
              double precision
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Rmax</strong></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    <br>


    <section>    
      <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-a~3"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>a</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-b~4"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>b</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-c~24"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>c</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-first~3"></span>
              logical,
            </td>
              <td>public,</td>
            <td>
              save
            </td>
            <td>::</td>
            <td><strong>first</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-gnmin"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>gnmin</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-gpmin"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>gpmin</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-half"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>half</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-i~693"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>i</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ieee~3"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ieee</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iwarn"></span>
              logical,
            </td>
              <td>public,</td>
            <td>
              save
            </td>
            <td>::</td>
            <td><strong>iwarn</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lbeta~2"></span>
              integer,
            </td>
              <td>public,</td>
            <td>
              save
            </td>
            <td>::</td>
            <td><strong>lbeta</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lemax"></span>
              integer,
            </td>
              <td>public,</td>
            <td>
              save
            </td>
            <td>::</td>
            <td><strong>lemax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lemin"></span>
              integer,
            </td>
              <td>public,</td>
            <td>
              save
            </td>
            <td>::</td>
            <td><strong>lemin</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-leps"></span>
              double precision,
            </td>
              <td>public,</td>
            <td>
              save
            </td>
            <td>::</td>
            <td><strong>leps</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lieee1~2"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lieee1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lrmax"></span>
              double precision,
            </td>
              <td>public,</td>
            <td>
              save
            </td>
            <td>::</td>
            <td><strong>lrmax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lrmin"></span>
              double precision,
            </td>
              <td>public,</td>
            <td>
              save
            </td>
            <td>::</td>
            <td><strong>lrmin</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lrnd~3"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lrnd</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lt~4"></span>
              integer,
            </td>
              <td>public,</td>
            <td>
              save
            </td>
            <td>::</td>
            <td><strong>lt</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ngnmin"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ngnmin</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ngpmin"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ngpmin</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-one~4"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>one</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rbase"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>rbase</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sixth"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>sixth</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-small~24"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>small</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-third"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>third</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-two~3"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>two</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-zero~3"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>zero</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">      </span><span class="k">SUBROUTINE </span><span class="n">DLAMC2</span><span class="p">(</span><span class="n">Beta</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">Rnd</span><span class="p">,</span><span class="n">Eps</span><span class="p">,</span><span class="n">Emin</span><span class="p">,</span><span class="n">Rmin</span><span class="p">,</span><span class="n">Emax</span><span class="p">,</span><span class="n">Rmax</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">IMPLICIT NONE</span><span class="w"></span>
<span class="c">!*--DLAMC2431</span>
<span class="c">!</span>
<span class="c">!  -- LAPACK auxiliary routine (version 3.7.0) --</span>
<span class="c">!     Univ. of Tennessee, Univ. of California Berkeley and NAG Ltd..</span>
<span class="c">!     November 2010</span>
<span class="c">!</span>
<span class="c">!     .. Scalar Arguments ..</span>
<span class="w">      </span><span class="kt">LOGICAL </span><span class="n">Rnd</span><span class="w"></span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">Beta</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Emax</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Emin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="w"></span>
<span class="w">      </span><span class="kt">DOUBLE PRECISION </span><span class="n">Eps</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Rmax</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Rmin</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">! =====================================================================</span>
<span class="c">!</span>
<span class="c">!     .. Local Scalars ..</span>
<span class="w">      </span><span class="kt">LOGICAL </span><span class="n">first</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ieee</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">iwarn</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lieee1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lrnd</span><span class="w"></span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">gnmin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">gpmin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lbeta</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lemax</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lemin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lt</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ngnmin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">ngpmin</span><span class="w"></span>
<span class="w">      </span><span class="kt">DOUBLE PRECISION </span><span class="n">a</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">half</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">leps</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lrmax</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lrmin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                 </span><span class="n">rbase</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">sixth</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">small</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">third</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">zero</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. External Functions ..</span>
<span class="w">      </span><span class="kt">DOUBLE PRECISION </span><span class="n">DLAMC3</span><span class="w"></span>
<span class="w">      </span><span class="k">EXTERNAL </span><span class="n">DLAMC3</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. External Subroutines ..</span>
<span class="w">      </span><span class="k">EXTERNAL </span><span class="n">DLAMC1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">DLAMC4</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">DLAMC5</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Intrinsic Functions ..</span>
<span class="w">      </span><span class="k">INTRINSIC </span><span class="nb">ABS</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nb">MAX</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nb">MIN</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Save statement ..</span>
<span class="w">      </span><span class="k">SAVE </span><span class="n">first</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">iwarn</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lbeta</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lemax</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lemin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">leps</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lrmax</span><span class="w"> </span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">   </span><span class="n">lrmin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lt</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Data statements ..</span>
<span class="w">      </span><span class="k">DATA </span><span class="n">first</span><span class="o">/</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="o">/</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">iwarn</span><span class="o">/</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="o">/</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Executable Statements ..</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">zero</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">         </span><span class="n">one</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="n">two</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!        LBETA, LT, LRND, LEPS, LEMIN and LRMIN  are the local values of</span>
<span class="c">!        BETA, T, RND, EPS, EMIN and RMIN.</span>
<span class="c">!</span>
<span class="c">!        Throughout this routine  we use the function  DLAMC3  to ensure</span>
<span class="c">!        that relevant values are stored  and not held in registers,  or</span>
<span class="c">!        are not affected by optimizers.</span>
<span class="c">!</span>
<span class="c">!        DLAMC1 returns the parameters  LBETA, LT, LRND and LIEEE1.</span>
<span class="c">!</span>
<span class="w">         </span><span class="k">CALL </span><span class="n">DLAMC1</span><span class="p">(</span><span class="n">lbeta</span><span class="p">,</span><span class="n">lt</span><span class="p">,</span><span class="n">lrnd</span><span class="p">,</span><span class="n">lieee1</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!        Start to find EPS.</span>
<span class="c">!</span>
<span class="w">         </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lbeta</span><span class="w"></span>
<span class="w">         </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">lt</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">leps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!        Try some tricks to see whether or not this is the correct  EPS.</span>
<span class="c">!</span>
<span class="w">         </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">two</span><span class="o">/</span><span class="mi">3</span><span class="w"></span>
<span class="w">         </span><span class="n">half</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span><span class="o">/</span><span class="mi">2</span><span class="w"></span>
<span class="w">         </span><span class="n">sixth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DLAMC3</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="o">-</span><span class="n">half</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">third</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DLAMC3</span><span class="p">(</span><span class="n">sixth</span><span class="p">,</span><span class="n">sixth</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DLAMC3</span><span class="p">(</span><span class="n">third</span><span class="p">,</span><span class="o">-</span><span class="n">half</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DLAMC3</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">sixth</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">b</span><span class="o">&lt;</span><span class="n">leps</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">leps</span><span class="w"></span>
<span class="c">!</span>
<span class="w">         </span><span class="n">leps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">DO</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!+       WHILE( ( LEPS.GT.B ).AND.( B.GT.ZERO ) )LOOP</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">leps</span><span class="o">&gt;</span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">b</span><span class="o">&gt;</span><span class="n">zero</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">leps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="w"></span>
<span class="w">               </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DLAMC3</span><span class="p">(</span><span class="n">half</span><span class="o">*</span><span class="n">leps</span><span class="p">,(</span><span class="n">two</span><span class="o">**</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">leps</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="w"></span>
<span class="w">               </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DLAMC3</span><span class="p">(</span><span class="n">half</span><span class="p">,</span><span class="o">-</span><span class="n">c</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DLAMC3</span><span class="p">(</span><span class="n">half</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DLAMC3</span><span class="p">(</span><span class="n">half</span><span class="p">,</span><span class="o">-</span><span class="n">b</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DLAMC3</span><span class="p">(</span><span class="n">half</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CYCLE</span>
<span class="k">            ENDIF</span><span class="w"></span>
<span class="c">!+       END WHILE</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">a</span><span class="o">&lt;</span><span class="n">leps</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">leps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!        Computation of EPS complete.</span>
<span class="c">!</span>
<span class="c">!        Now find  EMIN.  Let A = + or - 1, and + or - (1 + BASE**(-3)).</span>
<span class="c">!        Keep dividing  A by BETA until (gradual) underflow occurs. This</span>
<span class="c">!        is detected when we cannot recover the previous A.</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">rbase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span><span class="o">/</span><span class="n">lbeta</span><span class="w"></span>
<span class="w">            </span><span class="n">small</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span><span class="w"></span>
<span class="w">            </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="w">               </span><span class="n">small</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DLAMC3</span><span class="p">(</span><span class="n">small</span><span class="o">*</span><span class="n">rbase</span><span class="p">,</span><span class="n">zero</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDDO</span>
<span class="k">            </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DLAMC3</span><span class="p">(</span><span class="n">one</span><span class="p">,</span><span class="n">small</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">DLAMC4</span><span class="p">(</span><span class="n">ngpmin</span><span class="p">,</span><span class="n">one</span><span class="p">,</span><span class="n">lbeta</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">DLAMC4</span><span class="p">(</span><span class="n">ngnmin</span><span class="p">,</span><span class="o">-</span><span class="n">one</span><span class="p">,</span><span class="n">lbeta</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">DLAMC4</span><span class="p">(</span><span class="n">gpmin</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">lbeta</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">DLAMC4</span><span class="p">(</span><span class="n">gnmin</span><span class="p">,</span><span class="o">-</span><span class="n">a</span><span class="p">,</span><span class="n">lbeta</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">ieee</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">ngpmin</span><span class="o">==</span><span class="n">ngnmin</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">gpmin</span><span class="o">==</span><span class="n">gnmin</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ngpmin</span><span class="o">==</span><span class="n">gpmin</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                  </span><span class="n">lemin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ngpmin</span><span class="w"></span>
<span class="c">!            ( Non twos-complement machines, no gradual underflow;</span>
<span class="c">!              e.g.,  VAX )</span>
<span class="w">               </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">gpmin</span><span class="o">-</span><span class="n">ngpmin</span><span class="p">)</span><span class="o">==</span><span class="mi">3</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                  </span><span class="n">lemin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ngpmin</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lt</span><span class="w"></span>
<span class="w">                  </span><span class="n">ieee</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="c">!            ( Non twos-complement machines, with gradual underflow;</span>
<span class="c">!              e.g., IEEE standard followers )</span>
<span class="w">               </span><span class="k">ELSE</span>
<span class="k">                  </span><span class="n">lemin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">ngpmin</span><span class="p">,</span><span class="n">gpmin</span><span class="p">)</span><span class="w"></span>
<span class="c">!            ( A guess; no known machine )</span>
<span class="w">                  </span><span class="n">iwarn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">ngpmin</span><span class="o">==</span><span class="n">gpmin</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">ngnmin</span><span class="o">==</span><span class="n">gnmin</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">ngpmin</span><span class="o">-</span><span class="n">ngnmin</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                  </span><span class="n">lemin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">ngpmin</span><span class="p">,</span><span class="n">ngnmin</span><span class="p">)</span><span class="w"></span>
<span class="c">!            ( Twos-complement machines, no gradual underflow;</span>
<span class="c">!              e.g., CYBER 205 )</span>
<span class="w">               </span><span class="k">ELSE</span>
<span class="k">                  </span><span class="n">lemin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">ngpmin</span><span class="p">,</span><span class="n">ngnmin</span><span class="p">)</span><span class="w"></span>
<span class="c">!            ( A guess; no known machine )</span>
<span class="w">                  </span><span class="n">iwarn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">ngpmin</span><span class="o">-</span><span class="n">ngnmin</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">gpmin</span><span class="o">==</span><span class="n">gnmin</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">gpmin</span><span class="o">-</span><span class="nb">MIN</span><span class="p">(</span><span class="n">ngpmin</span><span class="p">,</span><span class="n">ngnmin</span><span class="p">))</span><span class="o">==</span><span class="mi">3</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                  </span><span class="n">lemin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">ngpmin</span><span class="p">,</span><span class="n">ngnmin</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lt</span><span class="w"></span>
<span class="c">!            ( Twos-complement machines with gradual underflow;</span>
<span class="c">!              no known machine )</span>
<span class="w">               </span><span class="k">ELSE</span>
<span class="k">                  </span><span class="n">lemin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">ngpmin</span><span class="p">,</span><span class="n">ngnmin</span><span class="p">)</span><span class="w"></span>
<span class="c">!            ( A guess; no known machine )</span>
<span class="w">                  </span><span class="n">iwarn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">ELSE</span>
<span class="k">               </span><span class="n">lemin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">ngpmin</span><span class="p">,</span><span class="n">ngnmin</span><span class="p">,</span><span class="n">gpmin</span><span class="p">,</span><span class="n">gnmin</span><span class="p">)</span><span class="w"></span>
<span class="c">!         ( A guess; no known machine )</span>
<span class="w">               </span><span class="n">iwarn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span>
<span class="k">            </span><span class="n">first</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<span class="c">!**</span>
<span class="c">! Comment out this if block if EMIN is ok</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iwarn</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">first</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="w">               </span><span class="k">WRITE</span><span class="w"> </span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="n">FMT</span><span class="o">=</span><span class="mi">99001</span><span class="p">)</span><span class="w"> </span><span class="n">lemin</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!**</span>
<span class="c">!</span>
<span class="c">!        Assume IEEE arithmetic if we found denormalised  numbers above,</span>
<span class="c">!        or if arithmetic seems to round in the  IEEE style,  determined</span>
<span class="c">!        in routine DLAMC1. A true IEEE machine should have both  things</span>
<span class="c">!        true; however, faulty machines may have one or the other.</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">ieee</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ieee</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">lieee1</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!        Compute  RMIN by successive division by  BETA. We could compute</span>
<span class="c">!        RMIN as BASE**( EMIN - 1 ),  but some machines underflow during</span>
<span class="c">!        this computation.</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">lrmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">lemin</span><span class="w"></span>
<span class="w">               </span><span class="n">lrmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DLAMC3</span><span class="p">(</span><span class="n">lrmin</span><span class="o">*</span><span class="n">rbase</span><span class="p">,</span><span class="n">zero</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDDO</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!        Finally, call DLAMC5 to compute EMAX and RMAX.</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">DLAMC5</span><span class="p">(</span><span class="n">lbeta</span><span class="p">,</span><span class="n">lt</span><span class="p">,</span><span class="n">lemin</span><span class="p">,</span><span class="n">ieee</span><span class="p">,</span><span class="n">lemax</span><span class="p">,</span><span class="n">lrmax</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">EXIT</span>
<span class="k">         ENDDO</span>
<span class="k">      ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="w">      </span><span class="n">Beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lbeta</span><span class="w"></span>
<span class="w">      </span><span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lt</span><span class="w"></span>
<span class="w">      </span><span class="n">Rnd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lrnd</span><span class="w"></span>
<span class="w">      </span><span class="n">Eps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">leps</span><span class="w"></span>
<span class="w">      </span><span class="n">Emin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lemin</span><span class="w"></span>
<span class="w">      </span><span class="n">Rmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lrmin</span><span class="w"></span>
<span class="w">      </span><span class="n">Emax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lemax</span><span class="w"></span>
<span class="w">      </span><span class="n">Rmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lrmax</span><span class="w"></span>
<span class="c">!</span>
<span class="w">      </span><span class="k">RETURN</span><span class="w"></span>
<span class="c">!</span>
<span class="mi">99001</span><span class="w"> </span><span class="k">FORMAT</span><span class="w"> </span><span class="p">(</span><span class="o">//</span><span class="s1">&#39; WARNING. The value EMIN may be incorrect:-&#39;</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="s1">&#39;  EMIN = &#39;</span><span class="p">,</span><span class="n">I8</span><span class="p">,</span><span class="w">                                           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="o">/</span><span class="s1">&#39; If, after inspection, the value EMIN looks&#39;</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="s1">&#39; acceptable please comment out &#39;</span><span class="p">,</span><span class="w">                        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="o">/</span><span class="s1">&#39; the IF block as marked within the code of routine&#39;</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="s1">&#39; DLAMC2,&#39;</span><span class="p">,</span><span class="o">/</span><span class="s1">&#39; otherwise supply EMIN explicitly.&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     End of DLAMC2</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">END SUBROUTINE </span><span class="n">DLAMC2</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              spag_lapack
 was developed by John S. Urban<br>              &copy; 2025 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2025-07-11 01:31 +0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>