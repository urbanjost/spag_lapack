<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="spag_lapack module">
    <meta name="author" content="John S. Urban" >
    <link rel="icon" href="../favicon.png">

    <title>SLARRV &ndash; spag_lapack</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">spag_lapack </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>SLARRV
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 0.1% of total for procedures.">358 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/slarrv.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/slarrv.f90.html'>slarrv.f90</a></li>
            <li class="breadcrumb-item active" aria-current="page">SLARRV</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#vars-0"
         aria-expanded="false" aria-controls="vars-0">
         <h4 class="card-header bg-primary text-white">Variables</h4>
      </a>
      <div id="vars-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../proc/slarrv.html#variable-four~3">FOUR</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-half~16">HALF</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-maxitr~3">MAXITR</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-one~238">ONE</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-three~8">THREE</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-two~27">TWO</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-zero~219">ZERO</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-bstres">bstres</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-bstw">bstw</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-done~4">done</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-eps~59">eps</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-eskip">eskip</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-fudge">fudge</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-gap~2">gap</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-gaptol">gaptol</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-gl~2">gl</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-gu~2">gu</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-i~247">i</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-ibegin~2">ibegin</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-idone">idone</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-iend~3">iend</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-ii~20">ii</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-iindc1">iindc1</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-iindc2">iindc2</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-iindr">iindr</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-iindwk">iindwk</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-iinfo~69">iinfo</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-im~2">im</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-in~6">in</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-indeig~5">indeig</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-indld">indld</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-indlld">indlld</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-indwrk~15">indwrk</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-isupmn">isupmn</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-isupmx">isupmx</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-iter~6">iter</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-itmp1~5">itmp1</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-j~180">j</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-jblk~4">jblk</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-k~88">k</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-lambda">lambda</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-left~14">left</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-lgap~2">lgap</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-mingma">mingma</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-miniwsize">miniwsize</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-minwsize">minwsize</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-nclus">nclus</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-ndepth">ndepth</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-needbs">needbs</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-negcnt~2">negcnt</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-newcls">newcls</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-newfst">newfst</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-newftt">newftt</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-newlst">newlst</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-newsiz">newsiz</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-nrminv">nrminv</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-offset">offset</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-oldcls">oldcls</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-oldfst">oldfst</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-oldien">oldien</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-oldlst">oldlst</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-oldncl">oldncl</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-p~9">p</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-parity">parity</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-q~4">q</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-resid">resid</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-rgap~2">rgap</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-right~8">right</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-rqcorr">rqcorr</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-rqtol">rqtol</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-savgap">savgap</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-sgndef~2">sgndef</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-sigma~15">sigma</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-spdiam~2">spdiam</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-ssigma">ssigma</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-stp2ii">stp2ii</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-tau~5">tau</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-tmp~7">tmp</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-tol~11">tol</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-tryrqc">tryrqc</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-usedbs">usedbs</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-usedrq">usedrq</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-wbegin~2">wbegin</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-wend~2">wend</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-windex">windex</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-windmn">windmn</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-windpl">windpl</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-zfrom">zfrom</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-zto">zto</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-ztz">ztz</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-zusedl">zusedl</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-zusedu">zusedu</a>
            <a class="list-group-item" href="../proc/slarrv.html#variable-zusedw">zusedw</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/slarrv.html#src">SLARRV</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2> subroutine SLARRV(N, Vl, Vu, D, L, Pivmin, Isplit, M, Dol, Dou, Minrgp, Rtol1, Rtol2, W, Werr, Wgap, Iblock, Indexw, Gers, Z, Ldz, Isuppz, Work, Iwork, Info)  
</h2>
    

    <p>\brief \b SLARRV computes the eigenvectors of the tridiagonal matrix T = L D LT given L, D and the eigenvalues of L D LT.
 \htmlonly
 Download SLARRV + dependencies
 <a href="http://www.netlib.org/cgi-bin/netlibfiles.tgz?format=tgz&filename=/lapack/lapack_routine/slarrv.f">
 [TGZ]</a>
 <a href="http://www.netlib.org/cgi-bin/netlibfiles.zip?format=zip&filename=/lapack/lapack_routine/slarrv.f">
 [ZIP]</a>
 <a href="http://www.netlib.org/cgi-bin/netlibfiles.txt?format=txt&filename=/lapack/lapack_routine/slarrv.f">
 [TXT]</a>
 \endhtmlonly
 \par Purpose:</p>
<p>\verbatim</p>
<p>SLARRV computes the eigenvectors of the tridiagonal matrix
 T = L D L<strong>T given L, D and APPROXIMATIONS to the eigenvalues of L D L</strong>T.
 The input eigenvalues should have been computed by SLARRE.
 \endverbatim
 \param[in] N
 \verbatim
          N is INTEGER
          The order of the matrix.  N &gt;= 0.
 \endverbatim</p>
<p>\param[in] VL
 \verbatim
          VL is REAL
          Lower bound of the interval that contains the desired
          eigenvalues. VL &lt; VU. Needed to compute gaps on the left or right
          end of the extremal eigenvalues in the desired RANGE.
 \endverbatim</p>
<p>\param[in] VU
 \verbatim
          VU is REAL
          Upper bound of the interval that contains the desired
          eigenvalues. VL &lt; VU.
          Note: VU is currently not used by this implementation of SLARRV, VU is
          passed to SLARRV because it could be used compute gaps on the right end
          of the extremal eigenvalues. However, with not much initial accuracy in
          LAMBDA and VU, the formula can lead to an overestimation of the right gap
          and thus to inadequately early RQI &lsquo;convergence&rsquo;. This is currently
          prevented this by forcing a small right gap. And so it turns out that VU
          is currently not used by this implementation of SLARRV.
 \endverbatim</p>
<p>\param[in,out] D
 \verbatim
          D is REAL array, dimension (N)
          On entry, the N diagonal elements of the diagonal matrix D.
          On exit, D may be overwritten.
 \endverbatim</p>
<p>\param[in,out] L
 \verbatim
          L is REAL array, dimension (N)
          On entry, the (N-1) subdiagonal elements of the unit
          bidiagonal matrix L are in elements 1 to N-1 of L
          (if the matrix is not split.) At the end of each block
          is stored the corresponding shift as given by SLARRE.
          On exit, L is overwritten.
 \endverbatim</p>
<p>\param[in] PIVMIN
 \verbatim
          PIVMIN is REAL
          The minimum pivot allowed in the Sturm sequence.
 \endverbatim</p>
<p>\param[in] ISPLIT
 \verbatim
          ISPLIT is INTEGER array, dimension (N)
          The splitting points, at which T breaks up into blocks.
          The first block consists of rows/columns 1 to
          ISPLIT( 1 ), the second of rows/columns ISPLIT( 1 )+1
          through ISPLIT( 2 ), etc.
 \endverbatim</p>
<p>\param[in] M
 \verbatim
          M is INTEGER
          The total number of input eigenvalues.  0 &lt;= M &lt;= N.
 \endverbatim</p>
<p>\param[in] DOL
 \verbatim
          DOL is INTEGER
 \endverbatim</p>
<p>\param[in] DOU
 \verbatim
          DOU is INTEGER
          If the user wants to compute only selected eigenvectors from all
          the eigenvalues supplied, he can specify an index range DOL:DOU.
          Or else the setting DOL=1, DOU=M should be applied.
          Note that DOL and DOU refer to the order in which the eigenvalues
          are stored in W.
          If the user wants to compute only selected eigenpairs, then
          the columns DOL-1 to DOU+1 of the eigenvector space Z contain the
          computed eigenvectors. All other columns of Z are set to zero.
 \endverbatim</p>
<p>\param[in] MINRGP
 \verbatim
          MINRGP is REAL
 \endverbatim</p>
<p>\param[in] RTOL1
 \verbatim
          RTOL1 is REAL
 \endverbatim</p>
<p>\param[in] RTOL2
 \verbatim
          RTOL2 is REAL
           Parameters for bisection.
           An interval [LEFT,RIGHT] has converged if
           RIGHT-LEFT &lt; MAX( RTOL1<em>GAP, RTOL2</em>MAX(|LEFT|,|RIGHT|) )
 \endverbatim</p>
<p>\param[in,out] W
 \verbatim
          W is REAL array, dimension (N)
          The first M elements of W contain the APPROXIMATE eigenvalues for
          which eigenvectors are to be computed.  The eigenvalues
          should be grouped by split-off block and ordered from
          smallest to largest within the block ( The output array
          W from SLARRE is expected here ). Furthermore, they are with
          respect to the shift of the corresponding root representation
          for their block. On exit, W holds the eigenvalues of the
          UNshifted matrix.
 \endverbatim</p>
<p>\param[in,out] WERR
 \verbatim
          WERR is REAL array, dimension (N)
          The first M elements contain the semiwidth of the uncertainty
          interval of the corresponding eigenvalue in W
 \endverbatim</p>
<p>\param[in,out] WGAP
 \verbatim
          WGAP is REAL array, dimension (N)
          The separation from the right neighbor eigenvalue in W.
 \endverbatim</p>
<p>\param[in] IBLOCK
 \verbatim
          IBLOCK is INTEGER array, dimension (N)
          The indices of the blocks (submatrices) associated with the
          corresponding eigenvalues in W; IBLOCK(i)=1 if eigenvalue
          W(i) belongs to the first block from the top, =2 if W(i)
          belongs to the second block, etc.
 \endverbatim</p>
<p>\param[in] INDEXW
 \verbatim
          INDEXW is INTEGER array, dimension (N)
          The indices of the eigenvalues within each block (submatrix);
          for example, INDEXW(i)= 10 and IBLOCK(i)=2 imply that the
          i-th eigenvalue W(i) is the 10-th eigenvalue in the second block.
 \endverbatim</p>
<p>\param[in] GERS
 \verbatim
          GERS is REAL array, dimension (2<em>N)
          The N Gerschgorin intervals (the i-th Gerschgorin interval
          is (GERS(2</em>i-1), GERS(2*i)). The Gerschgorin intervals should
          be computed from the original UNshifted matrix.
 \endverbatim</p>
<p>\param[out] Z
 \verbatim
          Z is REAL array, dimension (LDZ, max(1,M) )
          If INFO = 0, the first M columns of Z contain the
          orthonormal eigenvectors of the matrix T
          corresponding to the input eigenvalues, with the i-th
          column of Z holding the eigenvector associated with W(i).
          Note: the user must ensure that at least max(1,M) columns are
          supplied in the array Z.
 \endverbatim</p>
<p>\param[in] LDZ
 \verbatim
          LDZ is INTEGER
          The leading dimension of the array Z.  LDZ &gt;= 1, and if
          JOBZ = &lsquo;V&rsquo;, LDZ &gt;= max(1,N).
 \endverbatim</p>
<p>\param[out] ISUPPZ
 \verbatim
          ISUPPZ is INTEGER array, dimension ( 2<em>max(1,M) )
          The support of the eigenvectors in Z, i.e., the indices
          indicating the nonzero elements in Z. The I-th eigenvector
          is nonzero only in elements ISUPPZ( 2</em>I-1 ) through
          ISUPPZ( 2*I ).
 \endverbatim</p>
<p>\param[out] WORK
 \verbatim
          WORK is REAL array, dimension (12*N)
 \endverbatim</p>
<p>\param[out] IWORK
 \verbatim
          IWORK is INTEGER array, dimension (7*N)
 \endverbatim</p>
<p>\param[out] INFO
 \verbatim
          INFO is INTEGER
          = 0:  successful exit</p>
<div class="codehilite"><pre><span></span><code><span class="w">      </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span><span class="w">  </span><span class="n">A</span><span class="w"> </span><span class="n">problem</span><span class="w"> </span><span class="n">occurred</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">SLARRV</span><span class="o">.</span><span class="w"></span>
<span class="w">      </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span><span class="w">  </span><span class="n">One</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="n">subroutines</span><span class="w"> </span><span class="n">signaled</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">internal</span><span class="w"> </span><span class="n">problem</span><span class="o">.</span><span class="w"></span>
<span class="w">            </span><span class="n">Needs</span><span class="w"> </span><span class="n">inspection</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">corresponding</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">IINFO</span><span class="w"></span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">further</span><span class="w"> </span><span class="n">information</span><span class="o">.</span><span class="w"></span>

<span class="w">      </span><span class="o">=-</span><span class="mi">1</span><span class="p">:</span><span class="w">  </span><span class="n">Problem</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">SLARRB</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">refining</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">child</span><span class="s1">&#39;s eigenvalues.</span>
<span class="w">      </span><span class="o">=-</span><span class="mi">2</span><span class="p">:</span><span class="w">  </span><span class="n">Problem</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">SLARRF</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">computing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">RRR</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">child</span><span class="o">.</span><span class="w"></span>
<span class="w">            </span><span class="n">When</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">child</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">inside</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">tight</span><span class="w"> </span><span class="n">cluster</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">difficult</span><span class="w"></span>
<span class="w">            </span><span class="n">to</span><span class="w"> </span><span class="n">find</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">RRR</span><span class="o">.</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="n">partial</span><span class="w"> </span><span class="n">remedy</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="s1">&#39;s point of</span>
<span class="w">            </span><span class="n">view</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">MINRGP</span><span class="w"> </span><span class="n">smaller</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">recompile</span><span class="o">.</span><span class="w"></span>
<span class="w">            </span><span class="n">However</span><span class="p">,</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">orthogonality</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">computed</span><span class="w"> </span><span class="n">vectors</span><span class="w"> </span><span class="k">is</span><span class="w"></span>
<span class="w">            </span><span class="n">proportional</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="n">MINRGP</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">aware</span><span class="w"> </span><span class="n">that</span><span class="w"></span>
<span class="w">            </span><span class="n">he</span><span class="w"> </span><span class="n">might</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">trading</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">precision</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">he</span><span class="w"> </span><span class="n">decreases</span><span class="w"> </span><span class="n">MINRGP</span><span class="o">.</span><span class="w"></span>
<span class="w">      </span><span class="o">=-</span><span class="mi">3</span><span class="p">:</span><span class="w">  </span><span class="n">Problem</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">SLARRB</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">refining</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">eigenvalue</span><span class="w"></span>
<span class="w">            </span><span class="n">after</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Rayleigh</span><span class="w"> </span><span class="n">correction</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">rejected</span><span class="o">.</span><span class="w"></span>
<span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">:</span><span class="w">  </span><span class="n">The</span><span class="w"> </span><span class="n">Rayleigh</span><span class="w"> </span><span class="n">Quotient</span><span class="w"> </span><span class="n">Iteration</span><span class="w"> </span><span class="n">failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">converge</span><span class="w"> </span><span class="n">to</span><span class="w"></span>
<span class="w">            </span><span class="n">full</span><span class="w"> </span><span class="n">accuracy</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">MAXITR</span><span class="w"> </span><span class="n">steps</span><span class="o">.</span><span class="w"></span>
</code></pre></div>

<p>\endverbatim
 \author Univ. of Tennessee
 \author Univ. of California Berkeley
 \author Univ. of Colorado Denver
 \author NAG Ltd.
 \date June 2016
 \ingroup realOTHERauxiliary
 \par Contributors:</p>
<p>Beresford Parlett, University of California, Berkeley, USA \n
 Jim Demmel, University of California, Berkeley, USA \n
 Inderjit Dhillon, University of Texas, Austin, USA \n
 Osni Marques, LBNL/NERSC, USA \n
 Christof Voemel, University of California, Berkeley, USA
&ndash;SLARRV294</p>
<p>&ndash; LAPACK auxiliary routine (version 3.8.0) &ndash;
  &ndash; LAPACK is a software package provided by Univ. of Tennessee,    &ndash;
  &ndash; Univ. of California Berkeley, Univ. of Colorado Denver and NAG Ltd..&ndash;
     June 2016</p>
<div class="codehilite"><pre><span></span><code> .. Scalar Arguments ..
</code></pre></div>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-n~352"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>N</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-vl~23"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Vl</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-vu~8"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Vu</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-d~54"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>D</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-l~13"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>L</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-pivmin~4"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Pivmin</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isplit~4"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Isplit</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-m~124"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>M</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-dol"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Dol</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-dou"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Dou</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-minrgp"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Minrgp</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rtol1~3"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Rtol1</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rtol2~3"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Rtol2</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-w~33"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>W</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-werr~4"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Werr</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wgap~4"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Wgap</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iblock~4"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Iblock</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-indexw~2"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Indexw</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-gers~2"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Gers</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-z~45"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Z</strong>(Ldz,*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldz~34"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ldz</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isuppz~3"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Isuppz</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-work~212"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Work</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iwork~46"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Iwork</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-info~286"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Info</strong></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    <br>


    <section>    
      <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-four~3"></span>
              real,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>FOUR</strong></td>
<td> =</td>
                <td>4.0E0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-half~16"></span>
              real,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>HALF</strong></td>
<td> =</td>
                <td>0.5E0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxitr~3"></span>
              integer,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>MAXITR</strong></td>
<td> =</td>
                <td>10</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-one~238"></span>
              real,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>ONE</strong></td>
<td> =</td>
                <td>1.0E0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-three~8"></span>
              real,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>THREE</strong></td>
<td> =</td>
                <td>3.0E0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-two~27"></span>
              real,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>TWO</strong></td>
<td> =</td>
                <td>2.0E0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-zero~219"></span>
              real,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>ZERO</strong></td>
<td> =</td>
                <td>0.0E0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-bstres"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>bstres</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-bstw"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>bstw</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-done~4"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>done</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-eps~59"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>eps</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-eskip"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>eskip</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fudge"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>fudge</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-gap~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>gap</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-gaptol"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>gaptol</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-gl~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>gl</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-gu~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>gu</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-i~247"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>i</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ibegin~2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ibegin</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-idone"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>idone</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iend~3"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iend</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ii~20"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ii</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iindc1"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iindc1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iindc2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iindc2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iindr"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iindr</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iindwk"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iindwk</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iinfo~69"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iinfo</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-im~2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>im</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-in~6"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>in</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-indeig~5"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>indeig</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-indld"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>indld</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-indlld"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>indlld</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-indwrk~15"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>indwrk</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isupmn"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>isupmn</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isupmx"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>isupmx</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iter~6"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iter</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-itmp1~5"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>itmp1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-j~180"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>j</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jblk~4"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jblk</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-k~88"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>k</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lambda"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lambda</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-left~14"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>left</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lgap~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lgap</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-mingma"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>mingma</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-miniwsize"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>miniwsize</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-minwsize"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>minwsize</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nclus"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nclus</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ndepth"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ndepth</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-needbs"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>needbs</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-negcnt~2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>negcnt</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-newcls"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>newcls</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-newfst"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>newfst</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-newftt"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>newftt</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-newlst"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>newlst</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-newsiz"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>newsiz</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nrminv"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nrminv</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-offset"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>offset</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-oldcls"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>oldcls</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-oldfst"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>oldfst</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-oldien"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>oldien</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-oldlst"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>oldlst</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-oldncl"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>oldncl</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-p~9"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>p</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-parity"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>parity</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-q~4"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>q</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-resid"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>resid</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rgap~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>rgap</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-right~8"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>right</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rqcorr"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>rqcorr</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rqtol"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>rqtol</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-savgap"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>savgap</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sgndef~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>sgndef</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sigma~15"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>sigma</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-spdiam~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>spdiam</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ssigma"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ssigma</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-stp2ii"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>stp2ii</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-tau~5"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>tau</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-tmp~7"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>tmp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-tol~11"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>tol</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-tryrqc"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>tryrqc</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-usedbs"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>usedbs</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-usedrq"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>usedrq</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wbegin~2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wbegin</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wend~2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wend</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-windex"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>windex</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-windmn"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>windmn</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-windpl"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>windpl</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-zfrom"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>zfrom</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-zto"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>zto</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ztz"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ztz</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-zusedl"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>zusedl</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-zusedu"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>zusedu</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-zusedw"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>zusedw</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">      </span><span class="k">SUBROUTINE </span><span class="n">SLARRV</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Vl</span><span class="p">,</span><span class="n">Vu</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">Pivmin</span><span class="p">,</span><span class="n">Isplit</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">Dol</span><span class="p">,</span><span class="n">Dou</span><span class="p">,</span><span class="n">Minrgp</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Rtol1</span><span class="p">,</span><span class="n">Rtol2</span><span class="p">,</span><span class="n">W</span><span class="p">,</span><span class="n">Werr</span><span class="p">,</span><span class="n">Wgap</span><span class="p">,</span><span class="n">Iblock</span><span class="p">,</span><span class="n">Indexw</span><span class="p">,</span><span class="n">Gers</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Ldz</span><span class="p">,</span><span class="n">Isuppz</span><span class="p">,</span><span class="n">Work</span><span class="p">,</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">IMPLICIT NONE</span><span class="w"></span>
<span class="c">!*--SLARRV294</span>
<span class="c">!</span>
<span class="c">!  -- LAPACK auxiliary routine (version 3.8.0) --</span>
<span class="c">!  -- LAPACK is a software package provided by Univ. of Tennessee,    --</span>
<span class="c">!  -- Univ. of California Berkeley, Univ. of Colorado Denver and NAG Ltd..--</span>
<span class="c">!     June 2016</span>
<span class="c">!</span>
<span class="c">!     .. Scalar Arguments ..</span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">Dol</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Dou</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Info</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Ldz</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">      </span><span class="kt">REAL </span><span class="n">Minrgp</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Pivmin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Rtol1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Rtol2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Vl</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Vu</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Array Arguments ..</span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">Iblock</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Indexw</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Isplit</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Isuppz</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Iwork</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="kt">REAL </span><span class="n">D</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Gers</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">W</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Werr</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Wgap</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="kt">REAL </span><span class="n">Z</span><span class="p">(</span><span class="n">Ldz</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!</span>
<span class="c">!  =====================================================================</span>
<span class="c">!</span>
<span class="c">!     .. Parameters ..</span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">MAXITR</span><span class="w"></span>
<span class="w">      </span><span class="k">PARAMETER</span><span class="w"> </span><span class="p">(</span><span class="n">MAXITR</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="kt">REAL </span><span class="n">ZERO</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ONE</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">TWO</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">THREE</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">FOUR</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">HALF</span><span class="w"></span>
<span class="w">      </span><span class="k">PARAMETER</span><span class="w"> </span><span class="p">(</span><span class="n">ZERO</span><span class="o">=</span><span class="mf">0.0E0</span><span class="p">,</span><span class="n">ONE</span><span class="o">=</span><span class="mf">1.0E0</span><span class="p">,</span><span class="n">TWO</span><span class="o">=</span><span class="mf">2.0E0</span><span class="p">,</span><span class="n">THREE</span><span class="o">=</span><span class="mf">3.0E0</span><span class="p">,</span><span class="n">FOUR</span><span class="o">=</span><span class="mf">4.0E0</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">           </span><span class="n">HALF</span><span class="o">=</span><span class="mf">0.5E0</span><span class="p">)</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Local Scalars ..</span>
<span class="w">      </span><span class="kt">LOGICAL </span><span class="n">eskip</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">needbs</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">stp2ii</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">tryrqc</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">usedbs</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">usedrq</span><span class="w"></span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">done</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ibegin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">idone</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">iend</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ii</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">iindc1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">iindc2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">iindr</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">iindwk</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">iinfo</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">im</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">indeig</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">indld</span><span class="w"> </span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">indlld</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">indwrk</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">isupmn</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">isupmx</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">itmp1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">jblk</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">miniwsize</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">minwsize</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">nclus</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ndepth</span><span class="w"> </span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">negcnt</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">newcls</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">newfst</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">newftt</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">newlst</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">newsiz</span><span class="w"> </span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">offset</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">oldcls</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">oldfst</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">oldien</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">oldlst</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">oldncl</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="nb">parity</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">wbegin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">wend</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">windex</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">windmn</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">windpl</span><span class="w"> </span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">zfrom</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">zto</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">zusedl</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">zusedu</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">zusedw</span><span class="w"></span>
<span class="w">      </span><span class="kt">REAL </span><span class="n">bstres</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">bstw</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">eps</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">fudge</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">gap</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">gaptol</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">gl</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">gu</span><span class="w"> </span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">     </span><span class="n">lambda</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">left</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lgap</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">mingma</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">nrminv</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">resid</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">rgap</span><span class="w"> </span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">     </span><span class="n">right</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">rqcorr</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">rqtol</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">savgap</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">sgndef</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">sigma</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">spdiam</span><span class="w"> </span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">     </span><span class="n">ssigma</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">tau</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">tmp</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">tol</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ztz</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. External Functions ..</span>
<span class="w">      </span><span class="kt">REAL </span><span class="n">SLAMCH</span><span class="w"></span>
<span class="w">      </span><span class="k">EXTERNAL </span><span class="n">SLAMCH</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. External Subroutines ..</span>
<span class="w">      </span><span class="k">EXTERNAL </span><span class="n">SCOPY</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">SLAR1V</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">SLARRB</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">SLARRF</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">SLASET</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">SSCAL</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Intrinsic Functions ..</span>
<span class="w">      </span><span class="k">INTRINSIC </span><span class="nb">ABS</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="kt">REAL</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nb">MAX</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nb">MIN</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Executable Statements ..</span>
<span class="c">!     ..</span>
<span class="w"> </span>
<span class="w">      </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Quick return if possible</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">N</span><span class="o">&lt;=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">RETURN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     The first N entries of WORK are reserved for the eigenvalues</span>
<span class="w">      </span><span class="n">indld</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="n">indlld</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="n">indwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="n">minwsize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">12</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w"> </span>
<span class="w">      </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">minwsize</span><span class="w"></span>
<span class="w">         </span><span class="n">Work</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="w">      </span><span class="k">ENDDO</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!     IWORK(IINDR+1:IINDR+N) hold the twist indices R for the</span>
<span class="c">!     factorization used to compute the FP vector</span>
<span class="w">      </span><span class="n">iindr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="c">!     IWORK(IINDC1+1:IINC2+N) are used to store the clusters of the current</span>
<span class="c">!     layer and the one above.</span>
<span class="w">      </span><span class="n">iindc1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">      </span><span class="n">iindc2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">      </span><span class="n">iindwk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w"> </span>
<span class="w">      </span><span class="n">miniwsize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="o">*</span><span class="n">N</span><span class="w"></span>
<span class="w">      </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">miniwsize</span><span class="w"></span>
<span class="w">         </span><span class="n">Iwork</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="k">ENDDO</span>
<span class="k"> </span>
<span class="k">      </span><span class="n">zusedl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="c">!        Set lower bound for use of Z</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Dol</span><span class="o">&gt;</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">zusedl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Dol</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="n">zusedu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="c">!        Set lower bound for use of Z</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Dou</span><span class="o">&lt;</span><span class="n">M</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">zusedu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Dou</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="c">!     The width of the part of Z that is used</span>
<span class="w">      </span><span class="n">zusedw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zusedu</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">zusedl</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w"> </span>
<span class="w"> </span>
<span class="w">      </span><span class="k">CALL </span><span class="n">SLASET</span><span class="p">(</span><span class="s1">&#39;Full&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">zusedw</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">zusedl</span><span class="p">),</span><span class="n">Ldz</span><span class="p">)</span><span class="w"></span>
<span class="w"> </span>
<span class="w">      </span><span class="n">eps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SLAMCH</span><span class="p">(</span><span class="s1">&#39;Precision&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">rqtol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TWO</span><span class="o">*</span><span class="n">eps</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Set expert flags for standard code.</span>
<span class="w">      </span><span class="n">tryrqc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="w"> </span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">Dol</span><span class="o">/=</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">Dou</span><span class="o">/=</span><span class="n">M</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!        Only selected eigenpairs are computed. Since the other evalues</span>
<span class="c">!        are not refined by RQ iteration, bisection has to compute to full</span>
<span class="c">!        accuracy.</span>
<span class="w">         </span><span class="n">Rtol1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FOUR</span><span class="o">*</span><span class="n">eps</span><span class="w"></span>
<span class="w">         </span><span class="n">Rtol2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FOUR</span><span class="o">*</span><span class="n">eps</span><span class="w"></span>
<span class="w">      </span><span class="k">ENDIF</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!     The entries WBEGIN:WEND in W, WERR, WGAP correspond to the</span>
<span class="c">!     desired eigenvalues. The support of the nonzero eigenvector</span>
<span class="c">!     entries is contained in the interval IBEGIN:IEND.</span>
<span class="c">!     Remark that if k eigenpairs are desired, then the eigenvectors</span>
<span class="c">!     are stored in k contiguous columns of Z.</span>
<span class="w"> </span>
<span class="c">!     DONE is the number of eigenvectors already computed</span>
<span class="w">      </span><span class="n">done</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">ibegin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="n">wbegin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="k">DO </span><span class="n">jblk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Iblock</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">iend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Isplit</span><span class="p">(</span><span class="n">jblk</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">L</span><span class="p">(</span><span class="n">iend</span><span class="p">)</span><span class="w"></span>
<span class="c">!        Find the eigenvectors of the submatrix indexed IBEGIN</span>
<span class="c">!        through IEND.</span>
<span class="w">         </span><span class="n">wend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wbegin</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">DO</span>
<span class="k">            IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wend</span><span class="o">&lt;</span><span class="n">M</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Iblock</span><span class="p">(</span><span class="n">wend</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">==</span><span class="n">jblk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                  </span><span class="n">wend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wend</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                  </span><span class="k">CYCLE</span>
<span class="k">               ENDIF</span>
<span class="k">            ENDIF</span>
<span class="k">            IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wend</span><span class="o">&lt;</span><span class="n">wbegin</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">ibegin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iend</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="k">GOTO</span><span class="w"> </span><span class="mi">100</span><span class="w"></span>
<span class="w">            </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">wend</span><span class="o">&lt;</span><span class="n">Dol</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">wbegin</span><span class="o">&gt;</span><span class="n">Dou</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">ibegin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iend</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="n">wbegin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wend</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="k">GOTO</span><span class="w"> </span><span class="mi">100</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!        Find local spectral diameter of the block</span>
<span class="w">            </span><span class="n">gl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Gers</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">ibegin</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">gu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Gers</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">ibegin</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ibegin</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">iend</span><span class="w"></span>
<span class="w">               </span><span class="n">gl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">Gers</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">gl</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">gu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">Gers</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">),</span><span class="n">gu</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDDO</span>
<span class="k">            </span><span class="n">spdiam</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gu</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gl</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!        OLDIEN is the last index of the previous block</span>
<span class="w">            </span><span class="n">oldien</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ibegin</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="c">!        Calculate the size of the current block</span>
<span class="w">            </span><span class="n">in</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iend</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ibegin</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="c">!        The number of eigenvalues in the current block</span>
<span class="w">            </span><span class="n">im</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wend</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">wbegin</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!        This is for a 1x1 block</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ibegin</span><span class="o">==</span><span class="n">iend</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">done</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">done</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="n">Z</span><span class="p">(</span><span class="n">ibegin</span><span class="p">,</span><span class="n">wbegin</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ONE</span><span class="w"></span>
<span class="w">               </span><span class="n">Isuppz</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">wbegin</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ibegin</span><span class="w"></span>
<span class="w">               </span><span class="n">Isuppz</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">wbegin</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ibegin</span><span class="w"></span>
<span class="w">               </span><span class="n">W</span><span class="p">(</span><span class="n">wbegin</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">W</span><span class="p">(</span><span class="n">wbegin</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sigma</span><span class="w"></span>
<span class="w">               </span><span class="n">Work</span><span class="p">(</span><span class="n">wbegin</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">W</span><span class="p">(</span><span class="n">wbegin</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">ibegin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iend</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="n">wbegin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wbegin</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="k">GOTO</span><span class="w"> </span><span class="mi">100</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!        The desired (shifted) eigenvalues are stored in W(WBEGIN:WEND)</span>
<span class="c">!        Note that these can be approximations, in this case, the corresp.</span>
<span class="c">!        entries of WERR give the size of the uncertainty interval.</span>
<span class="c">!        The eigenvalue approximations will be refined when necessary as</span>
<span class="c">!        high relative accuracy is required for the computation of the</span>
<span class="c">!        corresponding eigenvectors.</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SCOPY</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="n">W</span><span class="p">(</span><span class="n">wbegin</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">wbegin</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!        We store in W the eigenvalue approximations w.r.t. the original</span>
<span class="c">!        matrix T.</span>
<span class="w">            </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">im</span><span class="w"></span>
<span class="w">               </span><span class="n">W</span><span class="p">(</span><span class="n">wbegin</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">W</span><span class="p">(</span><span class="n">wbegin</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sigma</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDDO</span><span class="w"></span>
<span class="w"> </span>
<span class="w"> </span>
<span class="c">!        NDEPTH is the current depth of the representation tree</span>
<span class="w">            </span><span class="n">ndepth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="c">!        PARITY is either 1 or 0</span>
<span class="w">            </span><span class="nb">parity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="c">!        NCLUS is the number of clusters for the next level of the</span>
<span class="c">!        representation tree, we start with NCLUS = 1 for the root</span>
<span class="w">            </span><span class="n">nclus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">Iwork</span><span class="p">(</span><span class="n">iindc1</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">Iwork</span><span class="p">(</span><span class="n">iindc1</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">im</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!        IDONE is the number of eigenvectors already computed in the current</span>
<span class="c">!        block</span>
<span class="w">            </span><span class="n">idone</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">            </span><span class="k">EXIT</span>
<span class="k">         ENDDO</span>
<span class="k">         DO</span><span class="w"></span>
<span class="c">!        loop while( IDONE.LT.IM )</span>
<span class="c">!        generate the representation tree for the current block and</span>
<span class="c">!        compute the eigenvectors</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">idone</span><span class="o">&lt;</span><span class="n">im</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!           This is a crude protection against infinitely deep trees</span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ndepth</span><span class="o">&gt;</span><span class="n">M</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                  </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="w"></span>
<span class="w">                  </span><span class="k">RETURN</span>
<span class="k">               ENDIF</span><span class="w"></span>
<span class="c">!           breadth first processing of the current level of the representation</span>
<span class="c">!           tree: OLDNCL = number of clusters on current level</span>
<span class="w">               </span><span class="n">oldncl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nclus</span><span class="w"></span>
<span class="c">!           reset NCLUS to count the number of child clusters</span>
<span class="w">               </span><span class="n">nclus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="c">!</span>
<span class="w">               </span><span class="nb">parity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">parity</span>
<span class="nb">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">parity</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                  </span><span class="n">oldcls</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iindc1</span><span class="w"></span>
<span class="w">                  </span><span class="n">newcls</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iindc2</span><span class="w"></span>
<span class="w">               </span><span class="k">ELSE</span>
<span class="k">                  </span><span class="n">oldcls</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iindc2</span><span class="w"></span>
<span class="w">                  </span><span class="n">newcls</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iindc1</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!           Process the clusters on the current level</span>
<span class="w">               </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">oldncl</span><span class="w"></span>
<span class="w">                  </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">oldcls</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="w"></span>
<span class="c">!              OLDFST, OLDLST = first, last index of current cluster.</span>
<span class="c">!                               cluster indices start with 1 and are relative</span>
<span class="c">!                               to WBEGIN when accessing W, WGAP, WERR, Z</span>
<span class="w">                  </span><span class="n">oldfst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Iwork</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">oldlst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Iwork</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ndepth</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                 Retrieve relatively robust representation (RRR) of cluster</span>
<span class="c">!                 that has been computed at the previous level</span>
<span class="c">!                 The RRR is stored in Z and overwritten once the eigenvectors</span>
<span class="c">!                 have been computed or when the cluster is refined</span>
<span class="w"> </span>
<span class="w">                     </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">Dol</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">Dou</span><span class="o">==</span><span class="n">M</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                    Get representation from location of the leftmost evalue</span>
<span class="c">!                    of the cluster</span>
<span class="w">                        </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wbegin</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">oldfst</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                     </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wbegin</span><span class="o">+</span><span class="n">oldfst</span><span class="o">-</span><span class="mi">1</span><span class="o">&lt;</span><span class="n">Dol</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                       Get representation from the left end of Z array</span>
<span class="w">                        </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Dol</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                     </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wbegin</span><span class="o">+</span><span class="n">oldfst</span><span class="o">-</span><span class="mi">1</span><span class="o">&gt;</span><span class="n">Dou</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                       Get representation from the right end of Z array</span>
<span class="w">                        </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Dou</span><span class="w"></span>
<span class="w">                     </span><span class="k">ELSE</span>
<span class="k">                        </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wbegin</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">oldfst</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                     </span><span class="k">ENDIF</span>
<span class="k">                     CALL </span><span class="n">SCOPY</span><span class="p">(</span><span class="n">in</span><span class="p">,</span><span class="n">Z</span><span class="p">(</span><span class="n">ibegin</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">D</span><span class="p">(</span><span class="n">ibegin</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="k">CALL </span><span class="n">SCOPY</span><span class="p">(</span><span class="n">in</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">Z</span><span class="p">(</span><span class="n">ibegin</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">L</span><span class="p">(</span><span class="n">ibegin</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="n">sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Z</span><span class="p">(</span><span class="n">iend</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!                 Set the corresponding entries in Z to zero</span>
<span class="w">                     </span><span class="k">CALL </span><span class="n">SLASET</span><span class="p">(</span><span class="s1">&#39;Full&#39;</span><span class="p">,</span><span class="n">in</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">ZERO</span><span class="p">,</span><span class="n">Z</span><span class="p">(</span><span class="n">ibegin</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="n">Ldz</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">ENDIF</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!              Compute DL and DLL of current RRR</span>
<span class="w">                  </span><span class="k">DO </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ibegin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">iend</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                     </span><span class="n">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">L</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="n">Work</span><span class="p">(</span><span class="n">indld</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tmp</span><span class="w"></span>
<span class="w">                     </span><span class="n">Work</span><span class="p">(</span><span class="n">indlld</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tmp</span><span class="o">*</span><span class="n">L</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">ENDDO</span>
<span class="k"> </span>
<span class="k">                  IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ndepth</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                 P and Q are index of the first and last eigenvalue to compute</span>
<span class="c">!                 within the current block</span>
<span class="w">                     </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Indexw</span><span class="p">(</span><span class="n">wbegin</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">oldfst</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Indexw</span><span class="p">(</span><span class="n">wbegin</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">oldlst</span><span class="p">)</span><span class="w"></span>
<span class="c">!                 Offset for the arrays WORK, WGAP and WERR, i.e., the P-OFFSET</span>
<span class="c">!                 through the Q-OFFSET elements of these arrays are to be used.</span>
<span class="c">!                  OFFSET = P-OLDFST</span>
<span class="w">                     </span><span class="n">offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Indexw</span><span class="p">(</span><span class="n">wbegin</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="c">!                 perform limited bisection (if necessary) to get approximate</span>
<span class="c">!                 eigenvalues to the precision needed.</span>
<span class="w">                     </span><span class="k">CALL </span><span class="n">SLARRB</span><span class="p">(</span><span class="n">in</span><span class="p">,</span><span class="n">D</span><span class="p">(</span><span class="n">ibegin</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">indlld</span><span class="o">+</span><span class="n">ibegin</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                           </span><span class="n">Rtol1</span><span class="p">,</span><span class="n">Rtol2</span><span class="p">,</span><span class="n">offset</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">wbegin</span><span class="p">),</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                           </span><span class="n">Wgap</span><span class="p">(</span><span class="n">wbegin</span><span class="p">),</span><span class="n">Werr</span><span class="p">(</span><span class="n">wbegin</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">indwrk</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                           </span><span class="n">Iwork</span><span class="p">(</span><span class="n">iindwk</span><span class="p">),</span><span class="n">Pivmin</span><span class="p">,</span><span class="n">spdiam</span><span class="p">,</span><span class="n">in</span><span class="p">,</span><span class="n">iinfo</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iinfo</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                        </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="w">                        </span><span class="k">RETURN</span>
<span class="k">                     ENDIF</span><span class="w"></span>
<span class="c">!                 We also recompute the extremal gaps. W holds all eigenvalues</span>
<span class="c">!                 of the unshifted matrix and must be used for computation</span>
<span class="c">!                 of WGAP, the entries of WORK might stem from RRRs with</span>
<span class="c">!                 different shifts. The gaps from WBEGIN-1+OLDFST to</span>
<span class="c">!                 WBEGIN-1+OLDLST are correctly computed in SLARRB.</span>
<span class="c">!                 However, we only allow the gaps to become greater since</span>
<span class="c">!                 this is what should happen when we decrease WERR</span>
<span class="w">                     </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">oldfst</span><span class="o">&gt;</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">Wgap</span><span class="p">(</span><span class="n">wbegin</span><span class="o">+</span><span class="n">oldfst</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="w">              </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                    </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">Wgap</span><span class="p">(</span><span class="n">wbegin</span><span class="o">+</span><span class="n">oldfst</span><span class="o">-</span><span class="mi">2</span><span class="p">),</span><span class="n">W</span><span class="p">(</span><span class="n">wbegin</span><span class="o">+</span><span class="n">oldfst</span><span class="o">-</span><span class="mi">1</span><span class="p">)&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                    </span><span class="o">-</span><span class="n">Werr</span><span class="p">(</span><span class="n">wbegin</span><span class="o">+</span><span class="n">oldfst</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">W</span><span class="p">(</span><span class="n">wbegin</span><span class="o">+</span><span class="n">oldfst</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                    </span><span class="o">-</span><span class="n">Werr</span><span class="p">(</span><span class="n">wbegin</span><span class="o">+</span><span class="n">oldfst</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span><span class="w"></span>
<span class="w">                     </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wbegin</span><span class="o">+</span><span class="n">oldlst</span><span class="o">-</span><span class="mi">1</span><span class="o">&lt;</span><span class="n">wend</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">Wgap</span><span class="p">(</span><span class="n">wbegin</span><span class="o">+</span><span class="n">oldlst</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                    </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">Wgap</span><span class="p">(</span><span class="n">wbegin</span><span class="o">+</span><span class="n">oldlst</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">W</span><span class="p">(</span><span class="n">wbegin</span><span class="o">+</span><span class="n">oldlst</span><span class="p">)</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                    </span><span class="o">-</span><span class="n">Werr</span><span class="p">(</span><span class="n">wbegin</span><span class="o">+</span><span class="n">oldlst</span><span class="p">)</span><span class="o">-</span><span class="n">W</span><span class="p">(</span><span class="n">wbegin</span><span class="o">+</span><span class="n">oldlst</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                    </span><span class="o">-</span><span class="n">Werr</span><span class="p">(</span><span class="n">wbegin</span><span class="o">+</span><span class="n">oldlst</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!                 Each time the eigenvalues in WORK get refined, we store</span>
<span class="c">!                 the newly found approximation with all shifts applied in W</span>
<span class="w">                     </span><span class="k">DO </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">oldfst</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">oldlst</span><span class="w"></span>
<span class="w">                        </span><span class="n">W</span><span class="p">(</span><span class="n">wbegin</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">wbegin</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sigma</span><span class="w"></span>
<span class="w">                     </span><span class="k">ENDDO</span>
<span class="k">                  ENDIF</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!              Process the current node.</span>
<span class="w">                  </span><span class="n">newfst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">oldfst</span><span class="w"></span>
<span class="w">                  </span><span class="k">DO </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">oldfst</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">oldlst</span><span class="w"></span>
<span class="w">                     </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">==</span><span class="n">oldlst</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                    we are at the right end of the cluster, this is also the</span>
<span class="c">!                    boundary of the child cluster</span>
<span class="w">                        </span><span class="n">newlst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="w"></span>
<span class="w">                     </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Wgap</span><span class="p">(</span><span class="n">wbegin</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w">                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                        </span><span class="o">&gt;=</span><span class="n">Minrgp</span><span class="o">*</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Work</span><span class="p">(</span><span class="n">wbegin</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                    the right relative gap is big enough, the child cluster</span>
<span class="c">!                    (NEWFST,..,NEWLST) is well separated from the following</span>
<span class="w">                        </span><span class="n">newlst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="w"></span>
<span class="w">                     </span><span class="k">ELSE</span><span class="w"></span>
<span class="c">!                    inside a child cluster, the relative gap is not</span>
<span class="c">!                    big enough.</span>
<span class="w">                        </span><span class="k">CYCLE</span>
<span class="k">                     ENDIF</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!                 Compute size of child cluster found</span>
<span class="w">                     </span><span class="n">newsiz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newlst</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">newfst</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!                 NEWFTT is the place in Z where the new RRR or the computed</span>
<span class="c">!                 eigenvector is to be stored</span>
<span class="w">                     </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">Dol</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">Dou</span><span class="o">==</span><span class="n">M</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                    Store representation at location of the leftmost evalue</span>
<span class="c">!                    of the cluster</span>
<span class="w">                        </span><span class="n">newftt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wbegin</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">newfst</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                     </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wbegin</span><span class="o">+</span><span class="n">newfst</span><span class="o">-</span><span class="mi">1</span><span class="o">&lt;</span><span class="n">Dol</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                       Store representation at the left end of Z array</span>
<span class="w">                        </span><span class="n">newftt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Dol</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                     </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wbegin</span><span class="o">+</span><span class="n">newfst</span><span class="o">-</span><span class="mi">1</span><span class="o">&gt;</span><span class="n">Dou</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                       Store representation at the right end of Z array</span>
<span class="w">                        </span><span class="n">newftt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Dou</span><span class="w"></span>
<span class="w">                     </span><span class="k">ELSE</span>
<span class="k">                        </span><span class="n">newftt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wbegin</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">newfst</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                     </span><span class="k">ENDIF</span>
<span class="k"> </span>
<span class="k">                     IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">newsiz</span><span class="o">&gt;</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                    Current child is not a singleton but a cluster.</span>
<span class="c">!                    Compute and store new representation of child.</span>
<span class="c">!</span>
<span class="c">!</span>
<span class="c">!                    Compute left and right cluster gap.</span>
<span class="c">!</span>
<span class="c">!                    LGAP and RGAP are not computed from WORK because</span>
<span class="c">!                    the eigenvalue approximations may stem from RRRs</span>
<span class="c">!                    different shifts. However, W hold all eigenvalues</span>
<span class="c">!                    of the unshifted matrix. Still, the entries in WGAP</span>
<span class="c">!                    have to be computed from WORK since the entries</span>
<span class="c">!                    in W might be of the same order so that gaps are not</span>
<span class="c">!                    exhibited correctly for very close eigenvalues.</span>
<span class="w">                        </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">newfst</span><span class="o">==</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                           </span><span class="n">lgap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">ZERO</span><span class="p">,</span><span class="n">W</span><span class="p">(</span><span class="n">wbegin</span><span class="p">)</span><span class="o">-</span><span class="n">Werr</span><span class="p">(</span><span class="n">wbegin</span><span class="p">)</span><span class="o">-</span><span class="n">Vl</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="k">ELSE</span>
<span class="k">                           </span><span class="n">lgap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Wgap</span><span class="p">(</span><span class="n">wbegin</span><span class="o">+</span><span class="n">newfst</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="k">ENDIF</span>
<span class="k">                        </span><span class="n">rgap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Wgap</span><span class="p">(</span><span class="n">wbegin</span><span class="o">+</span><span class="n">newlst</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                    Compute left- and rightmost eigenvalue of child</span>
<span class="c">!                    to high precision in order to shift as close</span>
<span class="c">!                    as possible and obtain as large relative gaps</span>
<span class="c">!                    as possible</span>
<span class="c">!</span>
<span class="w">                        </span><span class="k">DO </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="w">                           </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">k</span><span class="o">==</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                              </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Indexw</span><span class="p">(</span><span class="n">wbegin</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">newfst</span><span class="p">)</span><span class="w"></span>
<span class="w">                           </span><span class="k">ELSE</span>
<span class="k">                              </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Indexw</span><span class="p">(</span><span class="n">wbegin</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">newlst</span><span class="p">)</span><span class="w"></span>
<span class="w">                           </span><span class="k">ENDIF</span>
<span class="k">                           </span><span class="n">offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Indexw</span><span class="p">(</span><span class="n">wbegin</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                           </span><span class="k">CALL </span><span class="n">SLARRB</span><span class="p">(</span><span class="n">in</span><span class="p">,</span><span class="n">D</span><span class="p">(</span><span class="n">ibegin</span><span class="p">),</span><span class="w">                    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                                 </span><span class="n">Work</span><span class="p">(</span><span class="n">indlld</span><span class="o">+</span><span class="n">ibegin</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">p</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">rqtol</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                                 </span><span class="n">rqtol</span><span class="p">,</span><span class="n">offset</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">wbegin</span><span class="p">),</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                                 </span><span class="n">Wgap</span><span class="p">(</span><span class="n">wbegin</span><span class="p">),</span><span class="n">Werr</span><span class="p">(</span><span class="n">wbegin</span><span class="p">),</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                                 </span><span class="n">Work</span><span class="p">(</span><span class="n">indwrk</span><span class="p">),</span><span class="n">Iwork</span><span class="p">(</span><span class="n">iindwk</span><span class="p">),</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                                 </span><span class="n">Pivmin</span><span class="p">,</span><span class="n">spdiam</span><span class="p">,</span><span class="n">in</span><span class="p">,</span><span class="n">iinfo</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="k">ENDDO</span><span class="w"></span>
<span class="c">!</span>
<span class="w">                        </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">wbegin</span><span class="o">+</span><span class="n">newlst</span><span class="o">-</span><span class="mi">1</span><span class="o">&lt;</span><span class="n">Dol</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w">                 </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                       </span><span class="p">(</span><span class="n">wbegin</span><span class="o">+</span><span class="n">newfst</span><span class="o">-</span><span class="mi">1</span><span class="o">&gt;</span><span class="n">Dou</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                       if the cluster contains no desired eigenvalues</span>
<span class="c">!                       skip the computation of that branch of the rep. tree</span>
<span class="c">!</span>
<span class="c">!                       We could skip before the refinement of the extremal</span>
<span class="c">!                       eigenvalues of the child, but then the representation</span>
<span class="c">!                       tree could be different from the one when nothing is</span>
<span class="c">!                       skipped. For this reason we skip at this place.</span>
<span class="w">                           </span><span class="n">idone</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">idone</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">newlst</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">newfst</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                           </span><span class="k">GOTO</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<span class="w">                        </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                    Compute RRR of child cluster.</span>
<span class="c">!                    Note that the new RRR is stored in Z</span>
<span class="c">!</span>
<span class="c">!                    SLARRF needs LWORK = 2*N</span>
<span class="w">                        </span><span class="k">CALL </span><span class="n">SLARRF</span><span class="p">(</span><span class="n">in</span><span class="p">,</span><span class="n">D</span><span class="p">(</span><span class="n">ibegin</span><span class="p">),</span><span class="n">L</span><span class="p">(</span><span class="n">ibegin</span><span class="p">),</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                              </span><span class="n">Work</span><span class="p">(</span><span class="n">indld</span><span class="o">+</span><span class="n">ibegin</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">newfst</span><span class="p">,</span><span class="n">newlst</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                              </span><span class="n">Work</span><span class="p">(</span><span class="n">wbegin</span><span class="p">),</span><span class="n">Wgap</span><span class="p">(</span><span class="n">wbegin</span><span class="p">),</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                              </span><span class="n">Werr</span><span class="p">(</span><span class="n">wbegin</span><span class="p">),</span><span class="n">spdiam</span><span class="p">,</span><span class="n">lgap</span><span class="p">,</span><span class="n">rgap</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                              </span><span class="n">Pivmin</span><span class="p">,</span><span class="n">tau</span><span class="p">,</span><span class="n">Z</span><span class="p">(</span><span class="n">ibegin</span><span class="p">,</span><span class="n">newftt</span><span class="p">),</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                              </span><span class="n">Z</span><span class="p">(</span><span class="n">ibegin</span><span class="p">,</span><span class="n">newftt</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">indwrk</span><span class="p">),</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                              </span><span class="n">iinfo</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iinfo</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                       a new RRR for the cluster was found by SLARRF</span>
<span class="c">!                       update shift and store it</span>
<span class="w">                           </span><span class="n">ssigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sigma</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">tau</span><span class="w"></span>
<span class="w">                           </span><span class="n">Z</span><span class="p">(</span><span class="n">iend</span><span class="p">,</span><span class="n">newftt</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ssigma</span><span class="w"></span>
<span class="c">!                       WORK() are the midpoints and WERR() the semi-width</span>
<span class="c">!                       Note that the entries in W are unchanged.</span>
<span class="w">                           </span><span class="k">DO </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newfst</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">newlst</span><span class="w"></span>
<span class="w">                              </span><span class="n">fudge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">THREE</span><span class="o">*</span><span class="n">eps</span><span class="o">*</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Work</span><span class="p">(</span><span class="n">wbegin</span><span class="o">+</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="w">                              </span><span class="n">Work</span><span class="p">(</span><span class="n">wbegin</span><span class="o">+</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">wbegin</span><span class="o">+</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">tau</span><span class="w"></span>
<span class="w">                              </span><span class="n">fudge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fudge</span><span class="w"> </span><span class="o">+</span><span class="w">                           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                                </span><span class="n">FOUR</span><span class="o">*</span><span class="n">eps</span><span class="o">*</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Work</span><span class="p">(</span><span class="n">wbegin</span><span class="o">+</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!                          Fudge errors</span>
<span class="w">                              </span><span class="n">Werr</span><span class="p">(</span><span class="n">wbegin</span><span class="o">+</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Werr</span><span class="p">(</span><span class="n">wbegin</span><span class="o">+</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="n">fudge</span><span class="w"></span>
<span class="c">!                          Gaps are not fudged. Provided that WERR is small</span>
<span class="c">!                          when eigenvalues are close, a zero gap indicates</span>
<span class="c">!                          that a new representation is needed for resolving</span>
<span class="c">!                          the cluster. A fudge could lead to a wrong decision</span>
<span class="c">!                          of judging eigenvalues &#39;separated&#39; which in</span>
<span class="c">!                          reality are not. This could have a negative impact</span>
<span class="c">!                          on the orthogonality of the computed eigenvectors.</span>
<span class="w">                           </span><span class="k">ENDDO</span>
<span class="k"> </span>
<span class="k">                           </span><span class="n">nclus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nclus</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                           </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newcls</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">nclus</span><span class="w"></span>
<span class="w">                           </span><span class="n">Iwork</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newfst</span><span class="w"></span>
<span class="w">                           </span><span class="n">Iwork</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newlst</span><span class="w"></span>
<span class="w">                        </span><span class="k">ELSE</span>
<span class="k">                           </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="w"></span>
<span class="w">                           </span><span class="k">RETURN</span>
<span class="k">                        ENDIF</span>
<span class="k">                     ELSE</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                    Compute eigenvector of singleton</span>
<span class="c">!</span>
<span class="w">                        </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="c">!</span>
<span class="w">                        </span><span class="n">tol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FOUR</span><span class="o">*</span><span class="nb">LOG</span><span class="p">(</span><span class="kt">REAL</span><span class="p">(</span><span class="n">in</span><span class="p">))</span><span class="o">*</span><span class="n">eps</span><span class="w"></span>
<span class="c">!</span>
<span class="w">                        </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newfst</span><span class="w"></span>
<span class="w">                        </span><span class="n">windex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wbegin</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                        </span><span class="n">windmn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">windex</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="n">windpl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">windex</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="n">lambda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">windex</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="n">done</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">done</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="c">!                    Check if eigenvector computation is to be skipped</span>
<span class="w">                        </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">windex</span><span class="o">&lt;</span><span class="n">Dol</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">windex</span><span class="o">&gt;</span><span class="n">Dou</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                           </span><span class="n">eskip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="w">                           </span><span class="k">GOTO</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="w">                        </span><span class="k">ELSE</span>
<span class="k">                           </span><span class="n">eskip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<span class="w">                        </span><span class="k">ENDIF</span>
<span class="k">                        </span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">windex</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Werr</span><span class="p">(</span><span class="n">windex</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">windex</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Werr</span><span class="p">(</span><span class="n">windex</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="n">indeig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Indexw</span><span class="p">(</span><span class="n">windex</span><span class="p">)</span><span class="w"></span>
<span class="c">!                    Note that since we compute the eigenpairs for a child,</span>
<span class="c">!                    all eigenvalue approximations are w.r.t the same shift.</span>
<span class="c">!                    In this case, the entries in WORK should be used for</span>
<span class="c">!                    computing the gaps since they exhibit even very small</span>
<span class="c">!                    differences in the eigenvalues, as opposed to the</span>
<span class="c">!                    entries in W which might &quot;look&quot; the same.</span>
<span class="w"> </span>
<span class="w">                        </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">k</span><span class="o">==</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                       In the case RANGE=&#39;I&#39; and with not much initial</span>
<span class="c">!                       accuracy in LAMBDA and VL, the formula</span>
<span class="c">!                       LGAP = MAX( ZERO, (SIGMA - VL) + LAMBDA )</span>
<span class="c">!                       can lead to an overestimation of the left gap and</span>
<span class="c">!                       thus to inadequately early RQI &#39;convergence&#39;.</span>
<span class="c">!                       Prevent this by forcing a small left gap.</span>
<span class="w">                           </span><span class="n">lgap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eps</span><span class="o">*</span><span class="nb">MAX</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">left</span><span class="p">),</span><span class="nb">ABS</span><span class="p">(</span><span class="n">right</span><span class="p">))</span><span class="w"></span>
<span class="w">                        </span><span class="k">ELSE</span>
<span class="k">                           </span><span class="n">lgap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Wgap</span><span class="p">(</span><span class="n">windmn</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="k">ENDIF</span>
<span class="k">                        IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">k</span><span class="o">==</span><span class="n">im</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                       In the case RANGE=&#39;I&#39; and with not much initial</span>
<span class="c">!                       accuracy in LAMBDA and VU, the formula</span>
<span class="c">!                       can lead to an overestimation of the right gap and</span>
<span class="c">!                       thus to inadequately early RQI &#39;convergence&#39;.</span>
<span class="c">!                       Prevent this by forcing a small right gap.</span>
<span class="w">                           </span><span class="n">rgap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eps</span><span class="o">*</span><span class="nb">MAX</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">left</span><span class="p">),</span><span class="nb">ABS</span><span class="p">(</span><span class="n">right</span><span class="p">))</span><span class="w"></span>
<span class="w">                        </span><span class="k">ELSE</span>
<span class="k">                           </span><span class="n">rgap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Wgap</span><span class="p">(</span><span class="n">windex</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="k">ENDIF</span>
<span class="k">                        </span><span class="n">gap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">lgap</span><span class="p">,</span><span class="n">rgap</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="o">==</span><span class="n">im</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                       The eigenvector support can become wrong</span>
<span class="c">!                       because significant entries could be cut off due to a</span>
<span class="c">!                       large GAPTOL parameter in LAR1V. Prevent this.</span>
<span class="w">                           </span><span class="n">gaptol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="w">                        </span><span class="k">ELSE</span>
<span class="k">                           </span><span class="n">gaptol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gap</span><span class="o">*</span><span class="n">eps</span><span class="w"></span>
<span class="w">                        </span><span class="k">ENDIF</span>
<span class="k">                        </span><span class="n">isupmn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">in</span><span class="w"></span>
<span class="w">                        </span><span class="n">isupmx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="c">!                    Update WGAP so that it holds the minimum gap</span>
<span class="c">!                    to the left or the right. This is crucial in the</span>
<span class="c">!                    case where bisection is used to ensure that the</span>
<span class="c">!                    eigenvalue is refined up to the required precision.</span>
<span class="c">!                    The correct value is restored afterwards.</span>
<span class="w">                        </span><span class="n">savgap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Wgap</span><span class="p">(</span><span class="n">windex</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="n">Wgap</span><span class="p">(</span><span class="n">windex</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gap</span><span class="w"></span>
<span class="c">!                    We want to use the Rayleigh Quotient Correction</span>
<span class="c">!                    as often as possible since it converges quadratically</span>
<span class="c">!                    when we are close enough to the desired eigenvalue.</span>
<span class="c">!                    However, the Rayleigh Quotient can have the wrong sign</span>
<span class="c">!                    and lead us away from the desired eigenvalue. In this</span>
<span class="c">!                    case, the best we can do is to use bisection.</span>
<span class="w">                        </span><span class="n">usedbs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<span class="w">                        </span><span class="n">usedrq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<span class="c">!                    Bisection is initially turned off unless it is forced</span>
<span class="w">                        </span><span class="n">needbs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">tryrqc</span><span class="w"></span>
<span class="w">                        </span><span class="k">DO</span><span class="w"></span>
<span class="c">!                    Check if bisection should be used to refine eigenvalue</span>
<span class="w">                           </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">needbs</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                       Take the bisection as new iterate</span>
<span class="w">                              </span><span class="n">usedbs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="w">                              </span><span class="n">itmp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Iwork</span><span class="p">(</span><span class="n">iindr</span><span class="o">+</span><span class="n">windex</span><span class="p">)</span><span class="w"></span>
<span class="w">                              </span><span class="n">offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Indexw</span><span class="p">(</span><span class="n">wbegin</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                              </span><span class="k">CALL </span><span class="n">SLARRB</span><span class="p">(</span><span class="n">in</span><span class="p">,</span><span class="n">D</span><span class="p">(</span><span class="n">ibegin</span><span class="p">),</span><span class="w">                 </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                           </span><span class="n">Work</span><span class="p">(</span><span class="n">indlld</span><span class="o">+</span><span class="n">ibegin</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">indeig</span><span class="p">,</span><span class="n">indeig</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                           </span><span class="n">ZERO</span><span class="p">,</span><span class="n">TWO</span><span class="o">*</span><span class="n">eps</span><span class="p">,</span><span class="n">offset</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">wbegin</span><span class="p">),</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                           </span><span class="n">Wgap</span><span class="p">(</span><span class="n">wbegin</span><span class="p">),</span><span class="n">Werr</span><span class="p">(</span><span class="n">wbegin</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">indwrk</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                           </span><span class="n">Iwork</span><span class="p">(</span><span class="n">iindwk</span><span class="p">),</span><span class="n">Pivmin</span><span class="p">,</span><span class="n">spdiam</span><span class="p">,</span><span class="n">itmp1</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                           </span><span class="n">iinfo</span><span class="p">)</span><span class="w"></span>
<span class="w">                              </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iinfo</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                                 </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span><span class="w"></span>
<span class="w">                                 </span><span class="k">RETURN</span>
<span class="k">                              ENDIF</span>
<span class="k">                              </span><span class="n">lambda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">windex</span><span class="p">)</span><span class="w"></span>
<span class="c">!                       Reset twist index from inaccurate LAMBDA to</span>
<span class="c">!                       force computation of true MINGMA</span>
<span class="w">                              </span><span class="n">Iwork</span><span class="p">(</span><span class="n">iindr</span><span class="o">+</span><span class="n">windex</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">                           </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!                    Given LAMBDA, compute the eigenvector.</span>
<span class="w">                           </span><span class="k">CALL </span><span class="n">SLAR1V</span><span class="p">(</span><span class="n">in</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">in</span><span class="p">,</span><span class="n">lambda</span><span class="p">,</span><span class="n">D</span><span class="p">(</span><span class="n">ibegin</span><span class="p">),</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                                 </span><span class="n">L</span><span class="p">(</span><span class="n">ibegin</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">indld</span><span class="o">+</span><span class="n">ibegin</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                                 </span><span class="n">Work</span><span class="p">(</span><span class="n">indlld</span><span class="o">+</span><span class="n">ibegin</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">Pivmin</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                                 </span><span class="n">gaptol</span><span class="p">,</span><span class="n">Z</span><span class="p">(</span><span class="n">ibegin</span><span class="p">,</span><span class="n">windex</span><span class="p">),</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                                 </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">usedbs</span><span class="p">,</span><span class="n">negcnt</span><span class="p">,</span><span class="n">ztz</span><span class="p">,</span><span class="n">mingma</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                                 </span><span class="n">Iwork</span><span class="p">(</span><span class="n">iindr</span><span class="o">+</span><span class="n">windex</span><span class="p">),</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                                 </span><span class="n">Isuppz</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">windex</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">nrminv</span><span class="p">,</span><span class="n">resid</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                                 </span><span class="n">rqcorr</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">indwrk</span><span class="p">))</span><span class="w"></span>
<span class="w">                           </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iter</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                              </span><span class="n">bstres</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resid</span><span class="w"></span>
<span class="w">                              </span><span class="n">bstw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lambda</span><span class="w"></span>
<span class="w">                           </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">resid</span><span class="o">&lt;</span><span class="n">bstres</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                              </span><span class="n">bstres</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resid</span><span class="w"></span>
<span class="w">                              </span><span class="n">bstw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lambda</span><span class="w"></span>
<span class="w">                           </span><span class="k">ENDIF</span>
<span class="k">                           </span><span class="n">isupmn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">isupmn</span><span class="p">,</span><span class="n">Isuppz</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">windex</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="w">                           </span><span class="n">isupmx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">isupmx</span><span class="p">,</span><span class="n">Isuppz</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">windex</span><span class="p">))</span><span class="w"></span>
<span class="w">                           </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w"> </span>
<span class="c">!                    sin alpha &lt;= |resid|/gap</span>
<span class="c">!                    Note that both the residual and the gap are</span>
<span class="c">!                    proportional to the matrix, so ||T|| doesn&#39;t play</span>
<span class="c">!                    a role in the quotient</span>
<span class="w"> </span>
<span class="c">!</span>
<span class="c">!                    Convergence test for Rayleigh-Quotient iteration</span>
<span class="c">!                    (omitted when Bisection has been used)</span>
<span class="c">!</span>
<span class="w">                           </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">resid</span><span class="o">&gt;</span><span class="n">tol</span><span class="o">*</span><span class="n">gap</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">rqcorr</span><span class="p">)</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                          </span><span class="o">&gt;</span><span class="n">rqtol</span><span class="o">*</span><span class="nb">ABS</span><span class="p">(</span><span class="n">lambda</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">usedbs</span><span class="w"> </span><span class="p">)</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                          </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                       We need to check that the RQCORR update doesn&#39;t</span>
<span class="c">!                       move the eigenvalue away from the desired one and</span>
<span class="c">!                       towards a neighbor. -&gt; protection with bisection</span>
<span class="w">                              </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">indeig</span><span class="o">&lt;=</span><span class="n">negcnt</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                          The wanted eigenvalue lies to the left</span>
<span class="w">                                 </span><span class="n">sgndef</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">ONE</span><span class="w"></span>
<span class="w">                              </span><span class="k">ELSE</span><span class="w"></span>
<span class="c">!                          The wanted eigenvalue lies to the right</span>
<span class="w">                                 </span><span class="n">sgndef</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ONE</span><span class="w"></span>
<span class="w">                              </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!                       We only use the RQCORR if it improves the</span>
<span class="c">!                       the iterate reasonably.</span>
<span class="w">                              </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">rqcorr</span><span class="o">*</span><span class="n">sgndef</span><span class="o">&gt;=</span><span class="n">ZERO</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                             </span><span class="p">(</span><span class="n">lambda</span><span class="o">+</span><span class="n">rqcorr</span><span class="o">&lt;=</span><span class="n">right</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                             </span><span class="p">(</span><span class="n">lambda</span><span class="o">+</span><span class="n">rqcorr</span><span class="o">&gt;=</span><span class="n">left</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                                 </span><span class="n">usedrq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="c">!                          Store new midpoint of bisection interval in WORK</span>
<span class="w">                                 </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">sgndef</span><span class="o">==</span><span class="n">ONE</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                             The current LAMBDA is on the left of the true</span>
<span class="c">!                             eigenvalue</span>
<span class="w">                                    </span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lambda</span><span class="w"></span>
<span class="c">!                             We prefer to assume that the error estimate</span>
<span class="c">!                             is correct. We could make the interval not</span>
<span class="c">!                             as a bracket but to be modified if the RQCORR</span>
<span class="c">!                             chooses to. In this case, the RIGHT side should</span>
<span class="c">!                             be modified as follows:</span>
<span class="c">!                              RIGHT = MAX(RIGHT, LAMBDA + RQCORR)</span>
<span class="w">                                 </span><span class="k">ELSE</span><span class="w"></span>
<span class="c">!                             The current LAMBDA is on the right of the true</span>
<span class="c">!                             eigenvalue</span>
<span class="w">                                    </span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lambda</span><span class="w"></span>
<span class="c">!                             See comment about assuming the error estimate is</span>
<span class="c">!                             correct above.</span>
<span class="c">!                              LEFT = MIN(LEFT, LAMBDA + RQCORR)</span>
<span class="w">                                 </span><span class="k">ENDIF</span>
<span class="k">                                 </span><span class="n">Work</span><span class="p">(</span><span class="n">windex</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HALF</span><span class="o">*</span><span class="p">(</span><span class="n">right</span><span class="o">+</span><span class="n">left</span><span class="p">)</span><span class="w"></span>
<span class="c">!                          Take RQCORR since it has the correct sign and</span>
<span class="c">!                          improves the iterate reasonably</span>
<span class="w">                                 </span><span class="n">lambda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lambda</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rqcorr</span><span class="w"></span>
<span class="c">!                          Update width of error interval</span>
<span class="w">                                 </span><span class="n">Werr</span><span class="p">(</span><span class="n">windex</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HALF</span><span class="o">*</span><span class="p">(</span><span class="n">right</span><span class="o">-</span><span class="n">left</span><span class="p">)</span><span class="w"></span>
<span class="w">                              </span><span class="k">ELSE</span>
<span class="k">                                 </span><span class="n">needbs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="w">                              </span><span class="k">ENDIF</span>
<span class="k">                              IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">right</span><span class="o">-</span><span class="n">left</span><span class="o">&lt;</span><span class="n">rqtol</span><span class="o">*</span><span class="nb">ABS</span><span class="p">(</span><span class="n">lambda</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!                             The eigenvalue is computed to bisection accuracy</span>
<span class="c">!                             compute eigenvector and stop</span>
<span class="w">                                 </span><span class="n">usedbs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="w">                                 </span><span class="k">CYCLE</span>
<span class="k">                              </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iter</span><span class="o">&lt;</span><span class="n">MAXITR</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                                 CYCLE</span>
<span class="k">                              </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iter</span><span class="o">==</span><span class="n">MAXITR</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                                 </span><span class="n">needbs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="w">                                 </span><span class="k">CYCLE</span>
<span class="k">                              ELSE</span>
<span class="k">                                 </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w"></span>
<span class="w">                                 </span><span class="k">RETURN</span>
<span class="k">                              ENDIF</span>
<span class="k">                           ELSE</span>
<span class="k">                              </span><span class="n">stp2ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<span class="w">                              </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">usedrq</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">usedbs</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                             </span><span class="n">bstres</span><span class="o">&lt;=</span><span class="n">resid</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                                 </span><span class="n">lambda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bstw</span><span class="w"></span>
<span class="w">                                 </span><span class="n">stp2ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="w">                              </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!                          improve error angle by second step</span>
<span class="w">                              </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">stp2ii</span><span class="w"> </span><span class="p">)</span><span class="w">                             </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                             </span><span class="k">CALL </span><span class="n">SLAR1V</span><span class="p">(</span><span class="n">in</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">in</span><span class="p">,</span><span class="n">lambda</span><span class="p">,</span><span class="n">D</span><span class="p">(</span><span class="n">ibegin</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                             </span><span class="n">L</span><span class="p">(</span><span class="n">ibegin</span><span class="p">),</span><span class="n">Work</span><span class="p">(</span><span class="n">indld</span><span class="o">+</span><span class="n">ibegin</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                             </span><span class="n">Work</span><span class="p">(</span><span class="n">indlld</span><span class="o">+</span><span class="n">ibegin</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">Pivmin</span><span class="p">,</span><span class="n">gaptol</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                             </span><span class="n">Z</span><span class="p">(</span><span class="n">ibegin</span><span class="p">,</span><span class="n">windex</span><span class="p">),.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">usedbs</span><span class="p">,</span><span class="n">negcnt</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                             </span><span class="n">ztz</span><span class="p">,</span><span class="n">mingma</span><span class="p">,</span><span class="n">Iwork</span><span class="p">(</span><span class="n">iindr</span><span class="o">+</span><span class="n">windex</span><span class="p">),</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                             </span><span class="n">Isuppz</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">windex</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">nrminv</span><span class="p">,</span><span class="n">resid</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                             </span><span class="n">rqcorr</span><span class="p">,</span><span class="n">Work</span><span class="p">(</span><span class="n">indwrk</span><span class="p">))</span><span class="w"></span>
<span class="w">                              </span><span class="n">Work</span><span class="p">(</span><span class="n">windex</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lambda</span><span class="w"></span>
<span class="w">                           </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                    Compute FP-vector support w.r.t. whole matrix</span>
<span class="c">!</span>
<span class="w">                           </span><span class="n">Isuppz</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">windex</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Isuppz</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">windex</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                        </span><span class="o">+</span><span class="w"> </span><span class="n">oldien</span><span class="w"></span>
<span class="w">                           </span><span class="n">Isuppz</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">windex</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Isuppz</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">windex</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">oldien</span><span class="w"></span>
<span class="w">                           </span><span class="n">zfrom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Isuppz</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">windex</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                           </span><span class="n">zto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Isuppz</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">windex</span><span class="p">)</span><span class="w"></span>
<span class="w">                           </span><span class="n">isupmn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isupmn</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">oldien</span><span class="w"></span>
<span class="w">                           </span><span class="n">isupmx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isupmx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">oldien</span><span class="w"></span>
<span class="c">!                    Ensure vector is ok if support in the RQI has changed</span>
<span class="w">                           </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">isupmn</span><span class="o">&lt;</span><span class="n">zfrom</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                              DO </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isupmn</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">zfrom</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                                 </span><span class="n">Z</span><span class="p">(</span><span class="n">ii</span><span class="p">,</span><span class="n">windex</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="w">                              </span><span class="k">ENDDO</span>
<span class="k">                           ENDIF</span>
<span class="k">                           IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">isupmx</span><span class="o">&gt;</span><span class="n">zto</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                              DO </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zto</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">isupmx</span><span class="w"></span>
<span class="w">                                 </span><span class="n">Z</span><span class="p">(</span><span class="n">ii</span><span class="p">,</span><span class="n">windex</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="w">                              </span><span class="k">ENDDO</span>
<span class="k">                           ENDIF</span>
<span class="k">                           CALL </span><span class="n">SSCAL</span><span class="p">(</span><span class="n">zto</span><span class="o">-</span><span class="n">zfrom</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">nrminv</span><span class="p">,</span><span class="n">Z</span><span class="p">(</span><span class="n">zfrom</span><span class="p">,</span><span class="n">windex</span><span class="p">)&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                                </span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                           </span><span class="k">EXIT</span>
<span class="k">                        ENDDO</span><span class="w"></span>
<span class="c">!                    Update W</span>
<span class="w"> </span><span class="mi">2</span><span class="w">                      </span><span class="n">W</span><span class="p">(</span><span class="n">windex</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lambda</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sigma</span><span class="w"></span>
<span class="c">!                    Recompute the gaps on the left and right</span>
<span class="c">!                    But only allow them to become larger and not</span>
<span class="c">!                    smaller (which can only happen through &quot;bad&quot;</span>
<span class="c">!                    cancellation and doesn&#39;t reflect the theory</span>
<span class="c">!                    where the initial gaps are underestimated due</span>
<span class="c">!                    to WERR being too crude.)</span>
<span class="w">                        </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">eskip</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                           IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">k</span><span class="o">&gt;</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">Wgap</span><span class="p">(</span><span class="n">windmn</span><span class="p">)</span><span class="w">                      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                          </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">Wgap</span><span class="p">(</span><span class="n">windmn</span><span class="p">),</span><span class="n">W</span><span class="p">(</span><span class="n">windex</span><span class="p">)</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                          </span><span class="o">-</span><span class="n">Werr</span><span class="p">(</span><span class="n">windex</span><span class="p">)</span><span class="o">-</span><span class="n">W</span><span class="p">(</span><span class="n">windmn</span><span class="p">)</span><span class="o">-</span><span class="n">Werr</span><span class="p">(</span><span class="n">windmn</span><span class="p">))</span><span class="w"></span>
<span class="w">                           </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">windex</span><span class="o">&lt;</span><span class="n">wend</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">Wgap</span><span class="p">(</span><span class="n">windex</span><span class="p">)</span><span class="w">              </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                          </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">savgap</span><span class="p">,</span><span class="n">W</span><span class="p">(</span><span class="n">windpl</span><span class="p">)</span><span class="o">-</span><span class="n">Werr</span><span class="p">(</span><span class="n">windpl</span><span class="p">)</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                          </span><span class="o">-</span><span class="n">W</span><span class="p">(</span><span class="n">windex</span><span class="p">)</span><span class="o">-</span><span class="n">Werr</span><span class="p">(</span><span class="n">windex</span><span class="p">))</span><span class="w"></span>
<span class="w">                        </span><span class="k">ENDIF</span>
<span class="k">                        </span><span class="n">idone</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">idone</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                     </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!                 here ends the code for the current child</span>
<span class="c">!</span>
<span class="c">!                 Proceed to any remaining child nodes</span>
<span class="w"> </span><span class="mi">4</span><span class="w">                   </span><span class="n">newfst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                  </span><span class="k">ENDDO</span>
<span class="k">               ENDDO</span>
<span class="k">               </span><span class="n">ndepth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ndepth</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="k">CYCLE</span>
<span class="k">            ENDIF</span>
<span class="k">            </span><span class="n">ibegin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iend</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">wbegin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wend</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="k">EXIT</span>
<span class="k">         ENDDO</span>
<span class="k"> </span><span class="mi">100</span><span class="w">  </span><span class="k">ENDDO</span><span class="w"></span>
<span class="c">!</span>
<span class="w"> </span>
<span class="c">!</span>
<span class="c">!     End of SLARRV</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">END SUBROUTINE </span><span class="n">SLARRV</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              spag_lapack
 was developed by John S. Urban<br>              &copy; 2025 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2025-07-11 01:31 +0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>