<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="spag_lapack module">
    <meta name="author" content="John S. Urban" >
    <link rel="icon" href="../favicon.png">

    <title>CLAED7 &ndash; spag_lapack</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">spag_lapack </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>CLAED7
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 0.0% of total for procedures.">62 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/claed7.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/claed7.f90.html'>claed7.f90</a></li>
            <li class="breadcrumb-item active" aria-current="page">CLAED7</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#vars-0"
         aria-expanded="false" aria-controls="vars-0">
         <h4 class="card-header bg-primary text-white">Variables</h4>
      </a>
      <div id="vars-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../proc/claed7.html#variable-coltyp">coltyp</a>
            <a class="list-group-item" href="../proc/claed7.html#variable-curr">curr</a>
            <a class="list-group-item" href="../proc/claed7.html#variable-i~54">i</a>
            <a class="list-group-item" href="../proc/claed7.html#variable-idlmda">idlmda</a>
            <a class="list-group-item" href="../proc/claed7.html#variable-indx">indx</a>
            <a class="list-group-item" href="../proc/claed7.html#variable-indxc">indxc</a>
            <a class="list-group-item" href="../proc/claed7.html#variable-indxp">indxp</a>
            <a class="list-group-item" href="../proc/claed7.html#variable-iq">iq</a>
            <a class="list-group-item" href="../proc/claed7.html#variable-iw">iw</a>
            <a class="list-group-item" href="../proc/claed7.html#variable-iz">iz</a>
            <a class="list-group-item" href="../proc/claed7.html#variable-k~25">k</a>
            <a class="list-group-item" href="../proc/claed7.html#variable-n1~5">n1</a>
            <a class="list-group-item" href="../proc/claed7.html#variable-n2~4">n2</a>
            <a class="list-group-item" href="../proc/claed7.html#variable-ptr">ptr</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/claed7.html#src">CLAED7</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2> subroutine CLAED7(N, Cutpnt, Qsiz, Tlvls, Curlvl, Curpbm, D, Q, Ldq, Rho, Indxq, Qstore, Qptr, Prmptr, Perm, Givptr, Givcol, Givnum, Work, Rwork, Iwork, Info)  
</h2>
    

    <p>\brief \b CLAED7 used by sstedc. Computes the updated eigensystem of a diagonal matrix after modification by a rank-one symmetric matrix. Used when the original matrix is dense.
 \htmlonly
 Download CLAED7 + dependencies
 <a href="http://www.netlib.org/cgi-bin/netlibfiles.tgz?format=tgz&filename=/lapack/lapack_routine/claed7.f">
 [TGZ]</a>
 <a href="http://www.netlib.org/cgi-bin/netlibfiles.zip?format=zip&filename=/lapack/lapack_routine/claed7.f">
 [ZIP]</a>
 <a href="http://www.netlib.org/cgi-bin/netlibfiles.txt?format=txt&filename=/lapack/lapack_routine/claed7.f">
 [TXT]</a>
 \endhtmlonly
 \par Purpose:</p>
<p>\verbatim</p>
<p>CLAED7 computes the updated eigensystem of a diagonal
 matrix after modification by a rank-one symmetric matrix. This
 routine is used only for the eigenproblem which requires all
 eigenvalues and optionally eigenvectors of a dense or banded
 Hermitian matrix that has been reduced to tridiagonal form.</p>
<p>T = Q(in) ( D(in) + RHO * Z<em>Z</em><em>H ) Q</em><em>H(in) = Q(out) * D(out) * Q</em>*H(out)</p>
<p>where Z = Q**Hu, u is a vector of length N with ones in the
   CUTPNT and CUTPNT + 1 th elements and zeros elsewhere.</p>
<div class="codehilite"><pre><span></span><code><span class="nv">The</span> <span class="nv">eigenvectors</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">original</span> <span class="nv">matrix</span> <span class="nv">are</span> <span class="nv">stored</span> <span class="nv">in</span> <span class="nv">Q</span>, <span class="nv">and</span> <span class="nv">the</span>
<span class="nv">eigenvalues</span> <span class="nv">are</span> <span class="nv">in</span> <span class="nv">D</span>.  <span class="nv">The</span> <span class="nv">algorithm</span> <span class="nv">consists</span> <span class="nv">of</span> <span class="nv">three</span> <span class="nv">stages</span>:

   <span class="nv">The</span> <span class="nv">first</span> <span class="nv">stage</span> <span class="nv">consists</span> <span class="nv">of</span> <span class="nv">deflating</span> <span class="nv">the</span> <span class="nv">size</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">problem</span>
   <span class="nv">when</span> <span class="nv">there</span> <span class="nv">are</span> <span class="nv">multiple</span> <span class="nv">eigenvalues</span> <span class="nv">or</span> <span class="k">if</span> <span class="nv">there</span> <span class="nv">is</span> <span class="nv">a</span> <span class="nv">zero</span> <span class="nv">in</span>
   <span class="nv">the</span> <span class="nv">Z</span> <span class="nv">vector</span>.  <span class="k">For</span> <span class="nv">each</span> <span class="nv">such</span> <span class="nv">occurrence</span> <span class="nv">the</span> <span class="nv">dimension</span> <span class="nv">of</span> <span class="nv">the</span>
   <span class="nv">secular</span> <span class="nv">equation</span> <span class="nv">problem</span> <span class="nv">is</span> <span class="nv">reduced</span> <span class="nv">by</span> <span class="nv">one</span>.  <span class="nv">This</span> <span class="nv">stage</span> <span class="nv">is</span>
   <span class="nv">performed</span> <span class="nv">by</span> <span class="nv">the</span> <span class="nv">routine</span> <span class="nv">SLAED2</span>.

   <span class="nv">The</span> <span class="nv">second</span> <span class="nv">stage</span> <span class="nv">consists</span> <span class="nv">of</span> <span class="nv">calculating</span> <span class="nv">the</span> <span class="nv">updated</span>
   <span class="nv">eigenvalues</span>. <span class="nv">This</span> <span class="nv">is</span> <span class="nv">done</span> <span class="nv">by</span> <span class="nv">finding</span> <span class="nv">the</span> <span class="nv">roots</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">secular</span>
   <span class="nv">equation</span> <span class="nv">via</span> <span class="nv">the</span> <span class="nv">routine</span> <span class="nv">SLAED4</span> <span class="ss">(</span><span class="nv">as</span> <span class="nv">called</span> <span class="nv">by</span> <span class="nv">SLAED3</span><span class="ss">)</span>.
   <span class="nv">This</span> <span class="nv">routine</span> <span class="nv">also</span> <span class="nv">calculates</span> <span class="nv">the</span> <span class="nv">eigenvectors</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">current</span>
   <span class="nv">problem</span>.

   <span class="nv">The</span> <span class="nv">final</span> <span class="nv">stage</span> <span class="nv">consists</span> <span class="nv">of</span> <span class="nv">computing</span> <span class="nv">the</span> <span class="nv">updated</span> <span class="nv">eigenvectors</span>
   <span class="nv">directly</span> <span class="nv">using</span> <span class="nv">the</span> <span class="nv">updated</span> <span class="nv">eigenvalues</span>.  <span class="nv">The</span> <span class="nv">eigenvectors</span> <span class="k">for</span>
   <span class="nv">the</span> <span class="nv">current</span> <span class="nv">problem</span> <span class="nv">are</span> <span class="nv">multiplied</span> <span class="nv">with</span> <span class="nv">the</span> <span class="nv">eigenvectors</span> <span class="nv">from</span>
   <span class="nv">the</span> <span class="nv">overall</span> <span class="nv">problem</span>.
</code></pre></div>

<p>\endverbatim
 \param[in] N
 \verbatim
          N is INTEGER
         The dimension of the symmetric tridiagonal matrix.  N &gt;= 0.
 \endverbatim</p>
<p>\param[in] CUTPNT
 \verbatim
          CUTPNT is INTEGER
         Contains the location of the last eigenvalue in the leading
         sub-matrix.  min(1,N) &lt;= CUTPNT &lt;= N.
 \endverbatim</p>
<p>\param[in] QSIZ
 \verbatim
          QSIZ is INTEGER
         The dimension of the unitary matrix used to reduce
         the full matrix to tridiagonal form.  QSIZ &gt;= N.
 \endverbatim</p>
<p>\param[in] TLVLS
 \verbatim
          TLVLS is INTEGER
         The total number of merging levels in the overall divide and
         conquer tree.
 \endverbatim</p>
<p>\param[in] CURLVL
 \verbatim
          CURLVL is INTEGER
         The current level in the overall merge routine,
         0 &lt;= curlvl &lt;= tlvls.
 \endverbatim</p>
<p>\param[in] CURPBM
 \verbatim
          CURPBM is INTEGER
         The current problem in the current level in the overall
         merge routine (counting from upper left to lower right).
 \endverbatim</p>
<p>\param[in,out] D
 \verbatim
          D is REAL array, dimension (N)
         On entry, the eigenvalues of the rank-1-perturbed matrix.
         On exit, the eigenvalues of the repaired matrix.
 \endverbatim</p>
<p>\param[in,out] Q
 \verbatim
          Q is COMPLEX array, dimension (LDQ,N)
         On entry, the eigenvectors of the rank-1-perturbed matrix.
         On exit, the eigenvectors of the repaired tridiagonal matrix.
 \endverbatim</p>
<p>\param[in] LDQ
 \verbatim
          LDQ is INTEGER
         The leading dimension of the array Q.  LDQ &gt;= max(1,N).
 \endverbatim</p>
<p>\param[in] RHO
 \verbatim
          RHO is REAL
         Contains the subdiagonal element used to create the rank-1
         modification.
 \endverbatim</p>
<p>\param[out] INDXQ
 \verbatim
          INDXQ is INTEGER array, dimension (N)
         This contains the permutation which will reintegrate the
         subproblem just solved back into sorted order,
         ie. D( INDXQ( I = 1, N ) ) will be in ascending order.
 \endverbatim</p>
<p>\param[out] IWORK
 \verbatim
          IWORK is INTEGER array, dimension (4*N)
 \endverbatim</p>
<p>\param[out] RWORK
 \verbatim
          RWORK is REAL array,
                                 dimension (3<em>N+2</em>QSIZ*N)
 \endverbatim</p>
<p>\param[out] WORK
 \verbatim
          WORK is COMPLEX array, dimension (QSIZ*N)
 \endverbatim</p>
<p>\param[in,out] QSTORE
 \verbatim
          QSTORE is REAL array, dimension (N**2+1)
         Stores eigenvectors of submatrices encountered during
         divide and conquer, packed together. QPTR points to
         beginning of the submatrices.
 \endverbatim</p>
<p>\param[in,out] QPTR
 \verbatim
          QPTR is INTEGER array, dimension (N+2)
         List of indices pointing to beginning of submatrices stored
         in QSTORE. The submatrices are numbered starting at the
         bottom left of the divide and conquer tree, from left to
         right and bottom to top.
 \endverbatim</p>
<p>\param[in] PRMPTR
 \verbatim
          PRMPTR is INTEGER array, dimension (N lg N)
         Contains a list of pointers which indicate where in PERM a
         level&rsquo;s permutation is stored.  PRMPTR(i+1) - PRMPTR(i)
         indicates the size of the permutation and also the size of
         the full, non-deflated problem.
 \endverbatim</p>
<p>\param[in] PERM
 \verbatim
          PERM is INTEGER array, dimension (N lg N)
         Contains the permutations (from deflation and sorting) to be
         applied to each eigenblock.
 \endverbatim</p>
<p>\param[in] GIVPTR
 \verbatim
          GIVPTR is INTEGER array, dimension (N lg N)
         Contains a list of pointers which indicate where in GIVCOL a
         level&rsquo;s Givens rotations are stored.  GIVPTR(i+1) - GIVPTR(i)
         indicates the number of Givens rotations.
 \endverbatim</p>
<p>\param[in] GIVCOL
 \verbatim
          GIVCOL is INTEGER array, dimension (2, N lg N)
         Each pair of numbers indicates a pair of columns to take place
         in a Givens rotation.
 \endverbatim</p>
<p>\param[in] GIVNUM
 \verbatim
          GIVNUM is REAL array, dimension (2, N lg N)
         Each number indicates the S value to be used in the
         corresponding Givens rotation.
 \endverbatim</p>
<p>\param[out] INFO
 \verbatim
          INFO is INTEGER
          = 0:  successful exit.
          &lt; 0:  if INFO = -i, the i-th argument had an illegal value.
          &gt; 0:  if INFO = 1, an eigenvalue did not converge
 \endverbatim
 \author Univ. of Tennessee
 \author Univ. of California Berkeley
 \author Univ. of Colorado Denver
 \author NAG Ltd.
 \date June 2016
 \ingroup complexOTHERcomputational
&ndash;CLAED7252</p>
<p>&ndash; LAPACK computational routine (version 3.7.0) &ndash;
  &ndash; LAPACK is a software package provided by Univ. of Tennessee,    &ndash;
  &ndash; Univ. of California Berkeley, Univ. of Colorado Denver and NAG Ltd..&ndash;
     June 2016</p>
<div class="codehilite"><pre><span></span><code> .. Scalar Arguments ..
</code></pre></div>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-n~80"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>N</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-cutpnt"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Cutpnt</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-qsiz"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Qsiz</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-tlvls"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Tlvls</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-curlvl"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Curlvl</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-curpbm"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Curpbm</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-d~12"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>D</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-q~5"></span>
              complex
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Q</strong>(Ldq,*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldq~4"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ldq</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rho"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Rho</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-indxq"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Indxq</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-qstore"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Qstore</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-qptr"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Qptr</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-prmptr"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Prmptr</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-perm"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Perm</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-givptr"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Givptr</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-givcol"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Givcol</strong>(2,*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-givnum"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Givnum</strong>(2,*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-work~50"></span>
              complex
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Work</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rwork~14"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Rwork</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iwork~12"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Iwork</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-info~69"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Info</strong></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    <br>


    <section>    
      <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-coltyp"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>coltyp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-curr"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>curr</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-i~54"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>i</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-idlmda"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>idlmda</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-indx"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>indx</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-indxc"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>indxc</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-indxp"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>indxp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iq"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iq</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iw"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iw</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iz"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iz</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-k~25"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>k</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-n1~5"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>n1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-n2~4"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>n2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ptr"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ptr</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">      </span><span class="k">SUBROUTINE </span><span class="n">CLAED7</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Cutpnt</span><span class="p">,</span><span class="n">Qsiz</span><span class="p">,</span><span class="n">Tlvls</span><span class="p">,</span><span class="n">Curlvl</span><span class="p">,</span><span class="n">Curpbm</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="n">Ldq</span><span class="p">,</span><span class="n">Rho</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Indxq</span><span class="p">,</span><span class="n">Qstore</span><span class="p">,</span><span class="n">Qptr</span><span class="p">,</span><span class="n">Prmptr</span><span class="p">,</span><span class="n">Perm</span><span class="p">,</span><span class="n">Givptr</span><span class="p">,</span><span class="n">Givcol</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Givnum</span><span class="p">,</span><span class="n">Work</span><span class="p">,</span><span class="n">Rwork</span><span class="p">,</span><span class="n">Iwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">IMPLICIT NONE</span><span class="w"></span>
<span class="c">!*--CLAED7252</span>
<span class="c">!</span>
<span class="c">!  -- LAPACK computational routine (version 3.7.0) --</span>
<span class="c">!  -- LAPACK is a software package provided by Univ. of Tennessee,    --</span>
<span class="c">!  -- Univ. of California Berkeley, Univ. of Colorado Denver and NAG Ltd..--</span>
<span class="c">!     June 2016</span>
<span class="c">!</span>
<span class="c">!     .. Scalar Arguments ..</span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">Curlvl</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Curpbm</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Cutpnt</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Info</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Ldq</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Qsiz</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Tlvls</span><span class="w"></span>
<span class="w">      </span><span class="kt">REAL </span><span class="n">Rho</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Array Arguments ..</span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">Givcol</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Givptr</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Indxq</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Iwork</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Perm</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">Prmptr</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Qptr</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="kt">REAL </span><span class="n">D</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Givnum</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Qstore</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Rwork</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="kt">COMPLEX </span><span class="n">Q</span><span class="p">(</span><span class="n">Ldq</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!</span>
<span class="c">!  =====================================================================</span>
<span class="c">!</span>
<span class="c">!     .. Local Scalars ..</span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">coltyp</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">curr</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">idlmda</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">indx</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">indxc</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">indxp</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">iq</span><span class="w"> </span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">iw</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">iz</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">n1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">n2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ptr</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. External Subroutines ..</span>
<span class="w">      </span><span class="k">EXTERNAL </span><span class="n">CLACRM</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">CLAED8</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">SLAED9</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">SLAEDA</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">SLAMRG</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">XERBLA</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Intrinsic Functions ..</span>
<span class="w">      </span><span class="k">INTRINSIC </span><span class="nb">MAX</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nb">MIN</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Executable Statements ..</span>
<span class="c">!</span>
<span class="c">!     Test the input parameters.</span>
<span class="c">!</span>
<span class="w">      </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     IF( ICOMPQ.LT.0 .OR. ICOMPQ.GT.1 ) THEN</span>
<span class="c">!        INFO = -1</span>
<span class="c">!     ELSE IF( N.LT.0 ) THEN</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">N</span><span class="o">&lt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">)</span><span class="o">&gt;</span><span class="n">Cutpnt</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">N</span><span class="o">&lt;</span><span class="n">Cutpnt</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Qsiz</span><span class="o">&lt;</span><span class="n">N</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Ldq</span><span class="o">&lt;</span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">9</span><span class="w"></span>
<span class="w">      </span><span class="k">ENDIF</span>
<span class="k">      IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Info</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         CALL </span><span class="n">XERBLA</span><span class="p">(</span><span class="s1">&#39;CLAED7&#39;</span><span class="p">,</span><span class="o">-</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">RETURN</span>
<span class="k">      ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Quick return if possible</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">N</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">RETURN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     The following values are for bookkeeping purposes only.  They are</span>
<span class="c">!     integer pointers which indicate the portion of the workspace</span>
<span class="c">!     used by a particular array in SLAED2 and SLAED3.</span>
<span class="c">!</span>
<span class="w">      </span><span class="n">iz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="n">idlmda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iz</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">      </span><span class="n">iw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">idlmda</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">      </span><span class="n">iq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iw</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="c">!</span>
<span class="w">      </span><span class="n">indx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="n">indxc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">      </span><span class="n">coltyp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indxc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">      </span><span class="n">indxp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coltyp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Form the z-vector which consists of the last row of Q_1 and the</span>
<span class="c">!     first row of Q_2.</span>
<span class="c">!</span>
<span class="w">      </span><span class="n">ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="o">**</span><span class="n">Tlvls</span><span class="w"></span>
<span class="w">      </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Curlvl</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="n">ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ptr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">Tlvls</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">ENDDO</span>
<span class="k">      </span><span class="n">curr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ptr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Curpbm</span><span class="w"></span>
<span class="w">      </span><span class="k">CALL </span><span class="n">SLAEDA</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Tlvls</span><span class="p">,</span><span class="n">Curlvl</span><span class="p">,</span><span class="n">Curpbm</span><span class="p">,</span><span class="n">Prmptr</span><span class="p">,</span><span class="n">Perm</span><span class="p">,</span><span class="n">Givptr</span><span class="p">,</span><span class="n">Givcol</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">            </span><span class="n">Givnum</span><span class="p">,</span><span class="n">Qstore</span><span class="p">,</span><span class="n">Qptr</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iz</span><span class="p">),</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iz</span><span class="o">+</span><span class="n">N</span><span class="p">),</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     When solving the final problem, we no longer need the stored data,</span>
<span class="c">!     so we will overwrite the data from this level onto the previously</span>
<span class="c">!     used storage space.</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Curlvl</span><span class="o">==</span><span class="n">Tlvls</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Qptr</span><span class="p">(</span><span class="n">curr</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="n">Prmptr</span><span class="p">(</span><span class="n">curr</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="n">Givptr</span><span class="p">(</span><span class="n">curr</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Sort and Deflate eigenvalues.</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">CALL </span><span class="n">CLAED8</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Qsiz</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="n">Ldq</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">Rho</span><span class="p">,</span><span class="n">Cutpnt</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iz</span><span class="p">),</span><span class="n">Rwork</span><span class="p">(</span><span class="n">idlmda</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">            </span><span class="n">Work</span><span class="p">,</span><span class="n">Qsiz</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iw</span><span class="p">),</span><span class="n">Iwork</span><span class="p">(</span><span class="n">indxp</span><span class="p">),</span><span class="n">Iwork</span><span class="p">(</span><span class="n">indx</span><span class="p">),</span><span class="n">Indxq</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">            </span><span class="n">Perm</span><span class="p">(</span><span class="n">Prmptr</span><span class="p">(</span><span class="n">curr</span><span class="p">)),</span><span class="n">Givptr</span><span class="p">(</span><span class="n">curr</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w">                    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">            </span><span class="n">Givcol</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Givptr</span><span class="p">(</span><span class="n">curr</span><span class="p">)),</span><span class="n">Givnum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Givptr</span><span class="p">(</span><span class="n">curr</span><span class="p">)),</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">Prmptr</span><span class="p">(</span><span class="n">curr</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Prmptr</span><span class="p">(</span><span class="n">curr</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">      </span><span class="n">Givptr</span><span class="p">(</span><span class="n">curr</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Givptr</span><span class="p">(</span><span class="n">curr</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Givptr</span><span class="p">(</span><span class="n">curr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Solve Secular Equation.</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">k</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         CALL </span><span class="n">SLAED9</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iq</span><span class="p">),</span><span class="n">k</span><span class="p">,</span><span class="n">Rho</span><span class="p">,</span><span class="n">Rwork</span><span class="p">(</span><span class="n">idlmda</span><span class="p">),</span><span class="n">Rwork</span><span class="p">(</span><span class="n">iw</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">               </span><span class="n">Qstore</span><span class="p">(</span><span class="n">Qptr</span><span class="p">(</span><span class="n">curr</span><span class="p">)),</span><span class="n">k</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">CALL </span><span class="n">CLACRM</span><span class="p">(</span><span class="n">Qsiz</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">Work</span><span class="p">,</span><span class="n">Qsiz</span><span class="p">,</span><span class="n">Qstore</span><span class="p">(</span><span class="n">Qptr</span><span class="p">(</span><span class="n">curr</span><span class="p">)),</span><span class="n">k</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="n">Ldq</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">               </span><span class="n">Rwork</span><span class="p">(</span><span class="n">iq</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="n">Qptr</span><span class="p">(</span><span class="n">curr</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Qptr</span><span class="p">(</span><span class="n">curr</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="o">**</span><span class="mi">2</span><span class="w"></span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Info</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">RETURN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Prepare the INDXQ sorting premutation.</span>
<span class="c">!</span>
<span class="w">         </span><span class="n">n1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"></span>
<span class="w">         </span><span class="n">n2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">k</span><span class="w"></span>
<span class="w">         </span><span class="k">CALL </span><span class="n">SLAMRG</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">n2</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">Indxq</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">ELSE</span>
<span class="k">         </span><span class="n">Qptr</span><span class="p">(</span><span class="n">curr</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Qptr</span><span class="p">(</span><span class="n">curr</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">DO </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">            </span><span class="n">Indxq</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDDO</span>
<span class="k">      ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!</span>
<span class="c">!     End of CLAED7</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">END SUBROUTINE </span><span class="n">CLAED7</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              spag_lapack
 was developed by John S. Urban<br>              &copy; 2025 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2025-07-11 01:31 +0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>