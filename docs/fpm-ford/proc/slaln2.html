<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="spag_lapack module">
    <meta name="author" content="John S. Urban" >
    <link rel="icon" href="../favicon.png">

    <title>SLALN2 &ndash; spag_lapack</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">spag_lapack </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>SLALN2
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 0.1% of total for procedures.">251 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/slaln2.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/slaln2.f90.html'>slaln2.f90</a></li>
            <li class="breadcrumb-item active" aria-current="page">SLALN2</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#vars-0"
         aria-expanded="false" aria-controls="vars-0">
         <h4 class="card-header bg-primary text-white">Variables</h4>
      </a>
      <div id="vars-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../proc/slaln2.html#variable-one~918">ONE</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-two~109">TWO</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-zero~873">ZERO</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-bbnd~2">bbnd</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-bi1~2">bi1</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-bi2~2">bi2</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-bignum~189">bignum</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-bnorm~17">bnorm</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-br1~2">br1</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-br2~2">br2</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-ci~5">ci</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-ci21~2">ci21</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-ci22~2">ci22</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-civ~2">civ</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-cmax~4">cmax</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-cnorm~2">cnorm</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-cr~4">cr</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-cr21~2">cr21</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-cr22~2">cr22</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-crv~2">crv</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-csi~2">csi</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-csr~5">csr</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-cswap">cswap</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-icmax~2">icmax</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-ipivot~2">ipivot</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-j~773">j</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-li21~2">li21</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-lr21~2">lr21</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-rswap~2">rswap</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-smini~2">smini</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-smlnum~222">smlnum</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-temp~182">temp</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-u22abs~2">u22abs</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-ui11~2">ui11</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-ui11r~2">ui11r</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-ui12~2">ui12</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-ui12s~2">ui12s</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-ui22~2">ui22</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-ur11~2">ur11</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-ur11r~2">ur11r</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-ur12~2">ur12</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-ur12s~2">ur12s</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-ur22~2">ur22</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-xi1~2">xi1</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-xi2~2">xi2</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-xr1~2">xr1</a>
            <a class="list-group-item" href="../proc/slaln2.html#variable-xr2~2">xr2</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/slaln2.html#src">SLALN2</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2> subroutine SLALN2(Ltrans, Na, Nw, Smin, Ca, A, Lda, D1, D2, B, Ldb, Wr, Wi, X, Ldx, Scale, Xnorm, Info)  
</h2>
    

    <p>\brief \b SLALN2 solves a 1-by-1 or 2-by-2 linear system of equations of the specified form.
 \htmlonly
 Download SLALN2 + dependencies
 <a href="http://www.netlib.org/cgi-bin/netlibfiles.tgz?format=tgz&filename=/lapack/lapack_routine/slaln2.f">
 [TGZ]</a>
 <a href="http://www.netlib.org/cgi-bin/netlibfiles.zip?format=zip&filename=/lapack/lapack_routine/slaln2.f">
 [ZIP]</a>
 <a href="http://www.netlib.org/cgi-bin/netlibfiles.txt?format=txt&filename=/lapack/lapack_routine/slaln2.f">
 [TXT]</a>
 \endhtmlonly
 \par Purpose:</p>
<p>\verbatim</p>
<p>SLALN2 solves a system of the form  (ca A - w D ) X = s B
 or (ca A<strong>T - w D) X = s B   with possible scaling (&ldquo;s&rdquo;) and
 perturbation of A.  (A</strong>T means A-transpose.)</p>
<p>A is an NA x NA real matrix, ca is a real scalar, D is an NA x NA
 real diagonal matrix, w is a real or complex value, and X and B are
 NA x 1 matrices &ndash; real if w is real, complex if w is complex.  NA
 may be 1 or 2.</p>
<p>If w is complex, X and B are represented as NA x 2 matrices,
 the first column of each being the real part and the second
 being the imaginary part.</p>
<p>&ldquo;s&rdquo; is a scaling factor (&lt;= 1), computed by SLALN2, which is
 so chosen that X can be computed without overflow.  X is further
 scaled if necessary to assure that norm(ca A - w D)*norm(X) is less
 than overflow.</p>
<p>If both singular values of (ca A - w D) are less than SMIN,
 SMIN<em>identity will be used instead of (ca A - w D).  If only one
 singular value is less than SMIN, one element of (ca A - w D) will be
 perturbed enough to make the smallest singular value roughly SMIN.
 If both singular values are at least SMIN, (ca A - w D) will not be
 perturbed.  In any case, the perturbation will be at most some small
 multiple of max( SMIN, ulp</em>norm(ca A - w D) ).  The singular values
 are computed by infinity-norm approximations, and thus will only be
 correct to a factor of 2 or so.</p>
<p>Note: all input quantities are assumed to be smaller than overflow
 by a reasonable factor.  (See BIGNUM.)
 \endverbatim
 \param[in] LTRANS
 \verbatim
          LTRANS is LOGICAL
          =.TRUE.:  A-transpose will be used.
          =.FALSE.: A will be used (not transposed.)
 \endverbatim</p>
<p>\param[in] NA
 \verbatim
          NA is INTEGER
          The size of the matrix A.  It may (only) be 1 or 2.
 \endverbatim</p>
<p>\param[in] NW
 \verbatim
          NW is INTEGER
          1 if &ldquo;w&rdquo; is real, 2 if &ldquo;w&rdquo; is complex.  It may only be 1
          or 2.
 \endverbatim</p>
<p>\param[in] SMIN
 \verbatim
          SMIN is REAL
          The desired lower bound on the singular values of A.  This
          should be a safe distance away from underflow or overflow,
          say, between (underflow/machine precision) and  (machine
          precision * overflow ).  (See BIGNUM and ULP.)
 \endverbatim</p>
<p>\param[in] CA
 \verbatim
          CA is REAL
          The coefficient c, which A is multiplied by.
 \endverbatim</p>
<p>\param[in] A
 \verbatim
          A is REAL array, dimension (LDA,NA)
          The NA x NA matrix A.
 \endverbatim</p>
<p>\param[in] LDA
 \verbatim
          LDA is INTEGER
          The leading dimension of A.  It must be at least NA.
 \endverbatim</p>
<p>\param[in] D1
 \verbatim
          D1 is REAL
          The 1,1 element in the diagonal matrix D.
 \endverbatim</p>
<p>\param[in] D2
 \verbatim
          D2 is REAL
          The 2,2 element in the diagonal matrix D.  Not used if NA=1.
 \endverbatim</p>
<p>\param[in] B
 \verbatim
          B is REAL array, dimension (LDB,NW)
          The NA x NW matrix B (right-hand side).  If NW=2 (&ldquo;w&rdquo; is
          complex), column 1 contains the real part of B and column 2
          contains the imaginary part.
 \endverbatim</p>
<p>\param[in] LDB
 \verbatim
          LDB is INTEGER
          The leading dimension of B.  It must be at least NA.
 \endverbatim</p>
<p>\param[in] WR
 \verbatim
          WR is REAL
          The real part of the scalar &ldquo;w&rdquo;.
 \endverbatim</p>
<p>\param[in] WI
 \verbatim
          WI is REAL
          The imaginary part of the scalar &ldquo;w&rdquo;.  Not used if NW=1.
 \endverbatim</p>
<p>\param[out] X
 \verbatim
          X is REAL array, dimension (LDX,NW)
          The NA x NW matrix X (unknowns), as computed by SLALN2.
          If NW=2 (&ldquo;w&rdquo; is complex), on exit, column 1 will contain
          the real part of X and column 2 will contain the imaginary
          part.
 \endverbatim</p>
<p>\param[in] LDX
 \verbatim
          LDX is INTEGER
          The leading dimension of X.  It must be at least NA.
 \endverbatim</p>
<p>\param[out] SCALE
 \verbatim
          SCALE is REAL
          The scale factor that B must be multiplied by to insure
          that overflow does not occur when computing X.  Thus,
          (ca A - w D) X  will be SCALE*B, not B (ignoring
          perturbations of A.)  It will be at most 1.
 \endverbatim</p>
<p>\param[out] XNORM
 \verbatim
          XNORM is REAL
          The infinity-norm of X, when X is regarded as an NA x NW
          real matrix.
 \endverbatim</p>
<p>\param[out] INFO
 \verbatim
          INFO is INTEGER
          An error flag.  It will be set to zero if no error occurs,
          a negative number if an argument is in error, or a positive
          number if  ca A - w D  had to be perturbed.
          The possible values are:
          = 0: No error occurred, and (ca A - w D) did not have to be
                 perturbed.
          = 1: (ca A - w D) had to be perturbed to make its smallest
               (or only) singular value greater than SMIN.
          NOTE: In the interests of speed, this routine does not
                check the inputs for errors.
 \endverbatim
 \author Univ. of Tennessee
 \author Univ. of California Berkeley
 \author Univ. of Colorado Denver
 \author NAG Ltd.
 \date December 2016
 \ingroup realOTHERauxiliary
&ndash;SLALN2222</p>
<p>&ndash; LAPACK auxiliary routine (version 3.7.0) &ndash;
  &ndash; LAPACK is a software package provided by Univ. of Tennessee,    &ndash;
  &ndash; Univ. of California Berkeley, Univ. of Colorado Denver and NAG Ltd..&ndash;
     December 2016</p>
<div class="codehilite"><pre><span></span><code> .. Scalar Arguments ..
</code></pre></div>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-ltrans~2"></span>
              logical
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ltrans</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-na~2"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Na</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nw~7"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Nw</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-smin~2"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Smin</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ca~6"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ca</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-a~843"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>A</strong>(Lda,*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lda~811"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Lda</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-d1~2"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>D1</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-d2~2"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>D2</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-b~400"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>B</strong>(Ldb,*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldb~385"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ldb</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wr~17"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Wr</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wi~18"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Wi</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-x~241"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>X</strong>(Ldx,*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldx~114"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ldx</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-scale~41"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Scale</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xnorm~2"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Xnorm</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-info~1066"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Info</strong></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    <br>


    <section>    
      <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-one~918"></span>
              real,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>ONE</strong></td>
<td> =</td>
                <td>1.0E0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-two~109"></span>
              real,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>TWO</strong></td>
<td> =</td>
                <td>2.0E0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-zero~873"></span>
              real,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>ZERO</strong></td>
<td> =</td>
                <td>0.0E0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-bbnd~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>bbnd</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-bi1~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>bi1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-bi2~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>bi2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-bignum~189"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>bignum</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-bnorm~17"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>bnorm</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-br1~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>br1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-br2~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>br2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ci~5"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ci</strong>(2,2)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ci21~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ci21</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ci22~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ci22</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-civ~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>civ</strong>(4)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-cmax~4"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>cmax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-cnorm~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>cnorm</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-cr~4"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>cr</strong>(2,2)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-cr21~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>cr21</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-cr22~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>cr22</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-crv~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>crv</strong>(4)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-csi~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>csi</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-csr~5"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>csr</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-cswap"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>cswap</strong>(4)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icmax~2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icmax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ipivot~2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ipivot</strong>(4,4)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-j~773"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>j</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-li21~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>li21</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lr21~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lr21</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rswap~2"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>rswap</strong>(4)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-smini~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>smini</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-smlnum~222"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>smlnum</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-temp~182"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>temp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-u22abs~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>u22abs</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ui11~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ui11</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ui11r~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ui11r</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ui12~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ui12</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ui12s~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ui12s</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ui22~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ui22</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ur11~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ur11</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ur11r~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ur11r</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ur12~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ur12</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ur12s~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ur12s</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ur22~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ur22</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xi1~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>xi1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xi2~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>xi2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xr1~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>xr1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xr2~2"></span>
              real,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>xr2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">      </span><span class="k">SUBROUTINE </span><span class="n">SLALN2</span><span class="p">(</span><span class="n">Ltrans</span><span class="p">,</span><span class="n">Na</span><span class="p">,</span><span class="n">Nw</span><span class="p">,</span><span class="n">Smin</span><span class="p">,</span><span class="n">Ca</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Lda</span><span class="p">,</span><span class="n">D1</span><span class="p">,</span><span class="n">D2</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">Ldb</span><span class="p">,</span><span class="n">Wr</span><span class="p">,</span><span class="n">Wi</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Ldx</span><span class="p">,</span><span class="nb">Scale</span><span class="p">,</span><span class="n">Xnorm</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">IMPLICIT NONE</span><span class="w"></span>
<span class="c">!*--SLALN2222</span>
<span class="c">!</span>
<span class="c">!  -- LAPACK auxiliary routine (version 3.7.0) --</span>
<span class="c">!  -- LAPACK is a software package provided by Univ. of Tennessee,    --</span>
<span class="c">!  -- Univ. of California Berkeley, Univ. of Colorado Denver and NAG Ltd..--</span>
<span class="c">!     December 2016</span>
<span class="c">!</span>
<span class="c">!     .. Scalar Arguments ..</span>
<span class="w">      </span><span class="kt">LOGICAL </span><span class="n">Ltrans</span><span class="w"></span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">Info</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Lda</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Ldb</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Ldx</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Na</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Nw</span><span class="w"></span>
<span class="w">      </span><span class="kt">REAL </span><span class="n">Ca</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">D1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">D2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nb">Scale</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Smin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Wi</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Wr</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Xnorm</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Array Arguments ..</span>
<span class="w">      </span><span class="kt">REAL </span><span class="n">A</span><span class="p">(</span><span class="n">Lda</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="n">Ldb</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">Ldx</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!</span>
<span class="c">! =====================================================================</span>
<span class="c">!</span>
<span class="c">!     .. Parameters ..</span>
<span class="w">      </span><span class="kt">REAL </span><span class="n">ZERO</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ONE</span><span class="w"></span>
<span class="w">      </span><span class="k">PARAMETER</span><span class="w"> </span><span class="p">(</span><span class="n">ZERO</span><span class="o">=</span><span class="mf">0.0E0</span><span class="p">,</span><span class="n">ONE</span><span class="o">=</span><span class="mf">1.0E0</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="kt">REAL </span><span class="n">TWO</span><span class="w"></span>
<span class="w">      </span><span class="k">PARAMETER</span><span class="w"> </span><span class="p">(</span><span class="n">TWO</span><span class="o">=</span><span class="mf">2.0E0</span><span class="p">)</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Local Scalars ..</span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">icmax</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"></span>
<span class="w">      </span><span class="kt">REAL </span><span class="n">bbnd</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">bi1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">bi2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">bignum</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">bnorm</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">br1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">br2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ci21</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ci22</span><span class="w"> </span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">     </span><span class="n">cmax</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">cnorm</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">cr21</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">cr22</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">csi</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">csr</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">li21</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lr21</span><span class="w"> </span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">     </span><span class="n">smini</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">smlnum</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">u22abs</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ui11</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ui11r</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ui12</span><span class="w"> </span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">     </span><span class="n">ui12s</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ui22</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ur11</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ur11r</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ur12</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ur12s</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ur22</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">xi1</span><span class="w"> </span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">     </span><span class="n">xi2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">xr1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">xr2</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Local Arrays ..</span>
<span class="w">      </span><span class="kt">LOGICAL </span><span class="n">cswap</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">rswap</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">ipivot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="kt">REAL </span><span class="n">ci</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">civ</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">cr</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">crv</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. External Functions ..</span>
<span class="w">      </span><span class="kt">REAL </span><span class="n">SLAMCH</span><span class="w"></span>
<span class="w">      </span><span class="k">EXTERNAL </span><span class="n">SLAMCH</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. External Subroutines ..</span>
<span class="w">      </span><span class="k">EXTERNAL </span><span class="n">SLADIV</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Intrinsic Functions ..</span>
<span class="w">      </span><span class="k">INTRINSIC </span><span class="nb">ABS</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nb">MAX</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Equivalences ..</span>
<span class="w">      </span><span class="k">EQUIVALENCE</span><span class="w"> </span><span class="p">(</span><span class="n">ci</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">civ</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">EQUIVALENCE</span><span class="w"> </span><span class="p">(</span><span class="n">cr</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">crv</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Data statements ..</span>
<span class="w">      </span><span class="k">DATA </span><span class="n">cswap</span><span class="o">/</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="o">/</span><span class="w"></span>
<span class="w">      </span><span class="k">DATA </span><span class="n">rswap</span><span class="o">/</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="o">/</span><span class="w"></span>
<span class="w">      </span><span class="k">DATA </span><span class="n">ipivot</span><span class="o">/</span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">     </span><span class="mi">3</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Executable Statements ..</span>
<span class="c">!</span>
<span class="c">!     Compute BIGNUM</span>
<span class="c">!</span>
<span class="w">      </span><span class="n">smlnum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TWO</span><span class="o">*</span><span class="n">SLAMCH</span><span class="p">(</span><span class="s1">&#39;Safe minimum&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">bignum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ONE</span><span class="o">/</span><span class="n">smlnum</span><span class="w"></span>
<span class="w">      </span><span class="n">smini</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">Smin</span><span class="p">,</span><span class="n">smlnum</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Don&#39;t check for input errors</span>
<span class="c">!</span>
<span class="w">      </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Standard Initializations</span>
<span class="c">!</span>
<span class="w">      </span><span class="nb">Scale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ONE</span><span class="w"></span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Na</span><span class="o">/=</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!        2x2 System</span>
<span class="c">!</span>
<span class="c">!        Compute the real part of  C = ca A - w D  (or  ca A**T - w D )</span>
<span class="c">!</span>
<span class="w">         </span><span class="n">cr</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ca</span><span class="o">*</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Wr</span><span class="o">*</span><span class="n">D1</span><span class="w"></span>
<span class="w">         </span><span class="n">cr</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ca</span><span class="o">*</span><span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Wr</span><span class="o">*</span><span class="n">D2</span><span class="w"></span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Ltrans</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            </span><span class="n">cr</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ca</span><span class="o">*</span><span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">cr</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ca</span><span class="o">*</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">ELSE</span>
<span class="k">            </span><span class="n">cr</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ca</span><span class="o">*</span><span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">cr</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ca</span><span class="o">*</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Nw</span><span class="o">==</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Real 2x2 system  (w is real)</span>
<span class="c">!</span>
<span class="c">!           Find the largest element in C</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">cmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="w">            </span><span class="n">icmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">DO </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">crv</span><span class="p">(</span><span class="n">j</span><span class="p">))</span><span class="o">&gt;</span><span class="n">cmax</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                  </span><span class="n">cmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">crv</span><span class="p">(</span><span class="n">j</span><span class="p">))</span><span class="w"></span>
<span class="w">                  </span><span class="n">icmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span>
<span class="k">            ENDDO</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           If norm(C) &lt; SMINI, use SMINI*identity.</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">cmax</span><span class="o">&lt;</span><span class="n">smini</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">bnorm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span><span class="nb">ABS</span><span class="p">(</span><span class="n">B</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span><span class="w"></span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">smini</span><span class="o">&lt;</span><span class="n">ONE</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">bnorm</span><span class="o">&gt;</span><span class="n">ONE</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                  IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">bnorm</span><span class="o">&gt;</span><span class="n">bignum</span><span class="o">*</span><span class="n">smini</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="nb">Scale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ONE</span><span class="o">/</span><span class="n">bnorm</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span>
<span class="k">               </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Scale</span><span class="o">/</span><span class="n">smini</span><span class="w"></span>
<span class="w">               </span><span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="o">*</span><span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">X</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="o">*</span><span class="n">B</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">Xnorm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="o">*</span><span class="n">bnorm</span><span class="w"></span>
<span class="w">               </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="k">RETURN</span>
<span class="k">            ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Gaussian elimination with complete pivoting.</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">ur11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">crv</span><span class="p">(</span><span class="n">icmax</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">cr21</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">crv</span><span class="p">(</span><span class="n">ipivot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">icmax</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="n">ur12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">crv</span><span class="p">(</span><span class="n">ipivot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">icmax</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="n">cr22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">crv</span><span class="p">(</span><span class="n">ipivot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">icmax</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="n">ur11r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ONE</span><span class="o">/</span><span class="n">ur11</span><span class="w"></span>
<span class="w">            </span><span class="n">lr21</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ur11r</span><span class="o">*</span><span class="n">cr21</span><span class="w"></span>
<span class="w">            </span><span class="n">ur22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cr22</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ur12</span><span class="o">*</span><span class="n">lr21</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           If smaller pivot &lt; SMINI, use SMINI</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">ur22</span><span class="p">)</span><span class="o">&lt;</span><span class="n">smini</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">ur22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smini</span><span class="w"></span>
<span class="w">               </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span>
<span class="k">            IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">rswap</span><span class="p">(</span><span class="n">icmax</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">br1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">br2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">ELSE</span>
<span class="k">               </span><span class="n">br1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">br2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span>
<span class="k">            </span><span class="n">br2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">br2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">lr21</span><span class="o">*</span><span class="n">br1</span><span class="w"></span>
<span class="w">            </span><span class="n">bbnd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">br1</span><span class="o">*</span><span class="p">(</span><span class="n">ur22</span><span class="o">*</span><span class="n">ur11r</span><span class="p">)),</span><span class="nb">ABS</span><span class="p">(</span><span class="n">br2</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">bbnd</span><span class="o">&gt;</span><span class="n">ONE</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">ur22</span><span class="p">)</span><span class="o">&lt;</span><span class="n">ONE</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">bbnd</span><span class="o">&gt;=</span><span class="n">bignum</span><span class="o">*</span><span class="nb">ABS</span><span class="p">(</span><span class="n">ur22</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="nb">Scale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ONE</span><span class="o">/</span><span class="n">bbnd</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="n">xr2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">br2</span><span class="o">*</span><span class="nb">Scale</span><span class="p">)</span><span class="o">/</span><span class="n">ur22</span><span class="w"></span>
<span class="w">            </span><span class="n">xr1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nb">Scale</span><span class="o">*</span><span class="n">br1</span><span class="p">)</span><span class="o">*</span><span class="n">ur11r</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">xr2</span><span class="o">*</span><span class="p">(</span><span class="n">ur11r</span><span class="o">*</span><span class="n">ur12</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">cswap</span><span class="p">(</span><span class="n">icmax</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xr2</span><span class="w"></span>
<span class="w">               </span><span class="n">X</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xr1</span><span class="w"></span>
<span class="w">            </span><span class="k">ELSE</span>
<span class="k">               </span><span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xr1</span><span class="w"></span>
<span class="w">               </span><span class="n">X</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xr2</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span>
<span class="k">            </span><span class="n">Xnorm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">xr1</span><span class="p">),</span><span class="nb">ABS</span><span class="p">(</span><span class="n">xr2</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Further scaling if  norm(A) norm(X) &gt; overflow</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Xnorm</span><span class="o">&gt;</span><span class="n">ONE</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">cmax</span><span class="o">&gt;</span><span class="n">ONE</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Xnorm</span><span class="o">&gt;</span><span class="n">bignum</span><span class="o">/</span><span class="n">cmax</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                  </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cmax</span><span class="o">/</span><span class="n">bignum</span><span class="w"></span>
<span class="w">                  </span><span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="o">*</span><span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">X</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="o">*</span><span class="n">X</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">Xnorm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="o">*</span><span class="n">Xnorm</span><span class="w"></span>
<span class="w">                  </span><span class="nb">Scale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="o">*</span><span class="nb">Scale</span>
<span class="nb">               </span><span class="k">ENDIF</span>
<span class="k">            ENDIF</span>
<span class="k">         ELSE</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Complex 2x2 system  (w is complex)</span>
<span class="c">!</span>
<span class="c">!           Find the largest element in C</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">ci</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">Wi</span><span class="o">*</span><span class="n">D1</span><span class="w"></span>
<span class="w">            </span><span class="n">ci</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="w">            </span><span class="n">ci</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="w">            </span><span class="n">ci</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">Wi</span><span class="o">*</span><span class="n">D2</span><span class="w"></span>
<span class="w">            </span><span class="n">cmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="w">            </span><span class="n">icmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">DO </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">crv</span><span class="p">(</span><span class="n">j</span><span class="p">))</span><span class="o">+</span><span class="nb">ABS</span><span class="p">(</span><span class="n">civ</span><span class="p">(</span><span class="n">j</span><span class="p">))</span><span class="o">&gt;</span><span class="n">cmax</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                  </span><span class="n">cmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">crv</span><span class="p">(</span><span class="n">j</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">civ</span><span class="p">(</span><span class="n">j</span><span class="p">))</span><span class="w"></span>
<span class="w">                  </span><span class="n">icmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span>
<span class="k">            ENDDO</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           If norm(C) &lt; SMINI, use SMINI*identity.</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">cmax</span><span class="o">&lt;</span><span class="n">smini</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">bnorm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="nb">ABS</span><span class="p">(</span><span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="nb">ABS</span><span class="p">(</span><span class="n">B</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                 </span><span class="o">+</span><span class="nb">ABS</span><span class="p">(</span><span class="n">B</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span><span class="w"></span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">smini</span><span class="o">&lt;</span><span class="n">ONE</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">bnorm</span><span class="o">&gt;</span><span class="n">ONE</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                  IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">bnorm</span><span class="o">&gt;</span><span class="n">bignum</span><span class="o">*</span><span class="n">smini</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="nb">Scale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ONE</span><span class="o">/</span><span class="n">bnorm</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span>
<span class="k">               </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Scale</span><span class="o">/</span><span class="n">smini</span><span class="w"></span>
<span class="w">               </span><span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="o">*</span><span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">X</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="o">*</span><span class="n">B</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="o">*</span><span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">X</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="o">*</span><span class="n">B</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">Xnorm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="o">*</span><span class="n">bnorm</span><span class="w"></span>
<span class="w">               </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="k">RETURN</span>
<span class="k">            ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Gaussian elimination with complete pivoting.</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">ur11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">crv</span><span class="p">(</span><span class="n">icmax</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">ui11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">civ</span><span class="p">(</span><span class="n">icmax</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">cr21</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">crv</span><span class="p">(</span><span class="n">ipivot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">icmax</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="n">ci21</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">civ</span><span class="p">(</span><span class="n">ipivot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">icmax</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="n">ur12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">crv</span><span class="p">(</span><span class="n">ipivot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">icmax</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="n">ui12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">civ</span><span class="p">(</span><span class="n">ipivot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">icmax</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="n">cr22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">crv</span><span class="p">(</span><span class="n">ipivot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">icmax</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="n">ci22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">civ</span><span class="p">(</span><span class="n">ipivot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">icmax</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">icmax</span><span class="o">==</span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">icmax</span><span class="o">==</span><span class="mi">4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Code when off-diagonals of pivoted C are real</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">ur11</span><span class="p">)</span><span class="o">&gt;</span><span class="nb">ABS</span><span class="p">(</span><span class="n">ui11</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                  </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ui11</span><span class="o">/</span><span class="n">ur11</span><span class="w"></span>
<span class="w">                  </span><span class="n">ur11r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ONE</span><span class="o">/</span><span class="p">(</span><span class="n">ur11</span><span class="o">*</span><span class="p">(</span><span class="n">ONE</span><span class="o">+</span><span class="n">temp</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="w"></span>
<span class="w">                  </span><span class="n">ui11r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">temp</span><span class="o">*</span><span class="n">ur11r</span><span class="w"></span>
<span class="w">               </span><span class="k">ELSE</span>
<span class="k">                  </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ur11</span><span class="o">/</span><span class="n">ui11</span><span class="w"></span>
<span class="w">                  </span><span class="n">ui11r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">ONE</span><span class="o">/</span><span class="p">(</span><span class="n">ui11</span><span class="o">*</span><span class="p">(</span><span class="n">ONE</span><span class="o">+</span><span class="n">temp</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="w"></span>
<span class="w">                  </span><span class="n">ur11r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">temp</span><span class="o">*</span><span class="n">ui11r</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span>
<span class="k">               </span><span class="n">lr21</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cr21</span><span class="o">*</span><span class="n">ur11r</span><span class="w"></span>
<span class="w">               </span><span class="n">li21</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cr21</span><span class="o">*</span><span class="n">ui11r</span><span class="w"></span>
<span class="w">               </span><span class="n">ur12s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ur12</span><span class="o">*</span><span class="n">ur11r</span><span class="w"></span>
<span class="w">               </span><span class="n">ui12s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ur12</span><span class="o">*</span><span class="n">ui11r</span><span class="w"></span>
<span class="w">               </span><span class="n">ur22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cr22</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ur12</span><span class="o">*</span><span class="n">lr21</span><span class="w"></span>
<span class="w">               </span><span class="n">ui22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ci22</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ur12</span><span class="o">*</span><span class="n">li21</span><span class="w"></span>
<span class="w">            </span><span class="k">ELSE</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Code when diagonals of pivoted C are real</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">ur11r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ONE</span><span class="o">/</span><span class="n">ur11</span><span class="w"></span>
<span class="w">               </span><span class="n">ui11r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="w">               </span><span class="n">lr21</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cr21</span><span class="o">*</span><span class="n">ur11r</span><span class="w"></span>
<span class="w">               </span><span class="n">li21</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ci21</span><span class="o">*</span><span class="n">ur11r</span><span class="w"></span>
<span class="w">               </span><span class="n">ur12s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ur12</span><span class="o">*</span><span class="n">ur11r</span><span class="w"></span>
<span class="w">               </span><span class="n">ui12s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ui12</span><span class="o">*</span><span class="n">ur11r</span><span class="w"></span>
<span class="w">               </span><span class="n">ur22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cr22</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ur12</span><span class="o">*</span><span class="n">lr21</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ui12</span><span class="o">*</span><span class="n">li21</span><span class="w"></span>
<span class="w">               </span><span class="n">ui22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">ur12</span><span class="o">*</span><span class="n">li21</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ui12</span><span class="o">*</span><span class="n">lr21</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span>
<span class="k">            </span><span class="n">u22abs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">ur22</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">ui22</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           If smaller pivot &lt; SMINI, use SMINI</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">u22abs</span><span class="o">&lt;</span><span class="n">smini</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">ur22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smini</span><span class="w"></span>
<span class="w">               </span><span class="n">ui22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="w">               </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span>
<span class="k">            IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">rswap</span><span class="p">(</span><span class="n">icmax</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">br2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">br1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">bi2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">bi1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">ELSE</span>
<span class="k">               </span><span class="n">br1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">br2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">bi1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">bi2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span>
<span class="k">            </span><span class="n">br2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">br2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">lr21</span><span class="o">*</span><span class="n">br1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">li21</span><span class="o">*</span><span class="n">bi1</span><span class="w"></span>
<span class="w">            </span><span class="n">bi2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bi2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">li21</span><span class="o">*</span><span class="n">br1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">lr21</span><span class="o">*</span><span class="n">bi1</span><span class="w"></span>
<span class="w">            </span><span class="n">bbnd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">br1</span><span class="p">)</span><span class="o">+</span><span class="nb">ABS</span><span class="p">(</span><span class="n">bi1</span><span class="p">))</span><span class="w">                              </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">             </span><span class="o">*</span><span class="p">(</span><span class="n">u22abs</span><span class="o">*</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">ur11r</span><span class="p">)</span><span class="o">+</span><span class="nb">ABS</span><span class="p">(</span><span class="n">ui11r</span><span class="p">))),</span><span class="nb">ABS</span><span class="p">(</span><span class="n">br2</span><span class="p">)</span><span class="o">+</span><span class="nb">ABS</span><span class="p">(</span><span class="n">bi2</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">bbnd</span><span class="o">&gt;</span><span class="n">ONE</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">u22abs</span><span class="o">&lt;</span><span class="n">ONE</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">bbnd</span><span class="o">&gt;=</span><span class="n">bignum</span><span class="o">*</span><span class="n">u22abs</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                  </span><span class="nb">Scale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ONE</span><span class="o">/</span><span class="n">bbnd</span><span class="w"></span>
<span class="w">                  </span><span class="n">br1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Scale</span><span class="o">*</span><span class="n">br1</span><span class="w"></span>
<span class="w">                  </span><span class="n">bi1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Scale</span><span class="o">*</span><span class="n">bi1</span><span class="w"></span>
<span class="w">                  </span><span class="n">br2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Scale</span><span class="o">*</span><span class="n">br2</span><span class="w"></span>
<span class="w">                  </span><span class="n">bi2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Scale</span><span class="o">*</span><span class="n">bi2</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span>
<span class="k">            ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">CALL </span><span class="n">SLADIV</span><span class="p">(</span><span class="n">br2</span><span class="p">,</span><span class="n">bi2</span><span class="p">,</span><span class="n">ur22</span><span class="p">,</span><span class="n">ui22</span><span class="p">,</span><span class="n">xr2</span><span class="p">,</span><span class="n">xi2</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">xr1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ur11r</span><span class="o">*</span><span class="n">br1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ui11r</span><span class="o">*</span><span class="n">bi1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ur12s</span><span class="o">*</span><span class="n">xr2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ui12s</span><span class="o">*</span><span class="n">xi2</span><span class="w"></span>
<span class="w">            </span><span class="n">xi1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ui11r</span><span class="o">*</span><span class="n">br1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ur11r</span><span class="o">*</span><span class="n">bi1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ui12s</span><span class="o">*</span><span class="n">xr2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ur12s</span><span class="o">*</span><span class="n">xi2</span><span class="w"></span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">cswap</span><span class="p">(</span><span class="n">icmax</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xr2</span><span class="w"></span>
<span class="w">               </span><span class="n">X</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xr1</span><span class="w"></span>
<span class="w">               </span><span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xi2</span><span class="w"></span>
<span class="w">               </span><span class="n">X</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xi1</span><span class="w"></span>
<span class="w">            </span><span class="k">ELSE</span>
<span class="k">               </span><span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xr1</span><span class="w"></span>
<span class="w">               </span><span class="n">X</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xr2</span><span class="w"></span>
<span class="w">               </span><span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xi1</span><span class="w"></span>
<span class="w">               </span><span class="n">X</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xi2</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span>
<span class="k">            </span><span class="n">Xnorm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">xr1</span><span class="p">)</span><span class="o">+</span><span class="nb">ABS</span><span class="p">(</span><span class="n">xi1</span><span class="p">),</span><span class="nb">ABS</span><span class="p">(</span><span class="n">xr2</span><span class="p">)</span><span class="o">+</span><span class="nb">ABS</span><span class="p">(</span><span class="n">xi2</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Further scaling if  norm(A) norm(X) &gt; overflow</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Xnorm</span><span class="o">&gt;</span><span class="n">ONE</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">cmax</span><span class="o">&gt;</span><span class="n">ONE</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Xnorm</span><span class="o">&gt;</span><span class="n">bignum</span><span class="o">/</span><span class="n">cmax</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                  </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cmax</span><span class="o">/</span><span class="n">bignum</span><span class="w"></span>
<span class="w">                  </span><span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="o">*</span><span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">X</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="o">*</span><span class="n">X</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="o">*</span><span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">X</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="o">*</span><span class="n">X</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">Xnorm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="o">*</span><span class="n">Xnorm</span><span class="w"></span>
<span class="w">                  </span><span class="nb">Scale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="o">*</span><span class="nb">Scale</span>
<span class="nb">               </span><span class="k">ENDIF</span>
<span class="k">            ENDIF</span>
<span class="k">         ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!        1 x 1  (i.e., scalar) system   C X = B</span>
<span class="c">!</span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Nw</span><span class="o">==</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Real 1x1 system.</span>
<span class="c">!</span>
<span class="c">!           C = ca A - w D</span>
<span class="c">!</span>
<span class="w">         </span><span class="n">csr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ca</span><span class="o">*</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Wr</span><span class="o">*</span><span class="n">D1</span><span class="w"></span>
<span class="w">         </span><span class="n">cnorm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">csr</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           If | C | &lt; SMINI, use C = SMINI</span>
<span class="c">!</span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">cnorm</span><span class="o">&lt;</span><span class="n">smini</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            </span><span class="n">csr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smini</span><span class="w"></span>
<span class="w">            </span><span class="n">cnorm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smini</span><span class="w"></span>
<span class="w">            </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Check scaling for  X = B / C</span>
<span class="c">!</span>
<span class="w">         </span><span class="n">bnorm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">cnorm</span><span class="o">&lt;</span><span class="n">ONE</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">bnorm</span><span class="o">&gt;</span><span class="n">ONE</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">bnorm</span><span class="o">&gt;</span><span class="n">bignum</span><span class="o">*</span><span class="n">cnorm</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="nb">Scale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ONE</span><span class="o">/</span><span class="n">bnorm</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Compute X</span>
<span class="c">!</span>
<span class="w">         </span><span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nb">Scale</span><span class="p">)</span><span class="o">/</span><span class="n">csr</span><span class="w"></span>
<span class="w">         </span><span class="n">Xnorm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">ELSE</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Complex 1x1 system (w is complex)</span>
<span class="c">!</span>
<span class="c">!           C = ca A - w D</span>
<span class="c">!</span>
<span class="w">         </span><span class="n">csr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ca</span><span class="o">*</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Wr</span><span class="o">*</span><span class="n">D1</span><span class="w"></span>
<span class="w">         </span><span class="n">csi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">Wi</span><span class="o">*</span><span class="n">D1</span><span class="w"></span>
<span class="w">         </span><span class="n">cnorm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">csr</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">csi</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           If | C | &lt; SMINI, use C = SMINI</span>
<span class="c">!</span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">cnorm</span><span class="o">&lt;</span><span class="n">smini</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            </span><span class="n">csr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smini</span><span class="w"></span>
<span class="w">            </span><span class="n">csi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZERO</span><span class="w"></span>
<span class="w">            </span><span class="n">cnorm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smini</span><span class="w"></span>
<span class="w">            </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Check scaling for  X = B / C</span>
<span class="c">!</span>
<span class="w">         </span><span class="n">bnorm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">cnorm</span><span class="o">&lt;</span><span class="n">ONE</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">bnorm</span><span class="o">&gt;</span><span class="n">ONE</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">bnorm</span><span class="o">&gt;</span><span class="n">bignum</span><span class="o">*</span><span class="n">cnorm</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="nb">Scale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ONE</span><span class="o">/</span><span class="n">bnorm</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Compute X</span>
<span class="c">!</span>
<span class="w">         </span><span class="k">CALL </span><span class="n">SLADIV</span><span class="p">(</span><span class="nb">Scale</span><span class="o">*</span><span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="nb">Scale</span><span class="o">*</span><span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">csr</span><span class="p">,</span><span class="n">csi</span><span class="p">,</span><span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="n">Xnorm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="w">      </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!</span>
<span class="c">!     End of SLALN2</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">END SUBROUTINE </span><span class="n">SLALN2</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              spag_lapack
 was developed by John S. Urban<br>              &copy; 2025 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2025-07-11 01:31 +0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>