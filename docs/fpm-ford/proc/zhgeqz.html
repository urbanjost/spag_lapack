<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="spag_lapack module">
    <meta name="author" content="John S. Urban" >
    <link rel="icon" href="../favicon.png">

    <title>ZHGEQZ &ndash; spag_lapack</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">spag_lapack </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>ZHGEQZ
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 0.1% of total for procedures.">351 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/zhgeqz.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/zhgeqz.f90.html'>zhgeqz.f90</a></li>
            <li class="breadcrumb-item active" aria-current="page">ZHGEQZ</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#vars-0"
         aria-expanded="false" aria-controls="vars-0">
         <h4 class="card-header bg-primary text-white">Variables</h4>
      </a>
      <div id="vars-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-abs1~6">ABS1</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-cone~49">CONE</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-czero~35">CZERO</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-half~24">HALF</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-one~307">ONE</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-zero~292">ZERO</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-abi12">abi12</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-abi22~2">abi22</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-absb~2">absb</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-ad11">ad11</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-ad12">ad12</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-ad21">ad21</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-ad22">ad22</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-anorm~22">anorm</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-ascale~5">ascale</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-atol">atol</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-bnorm~7">bnorm</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-bscale~5">bscale</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-btol">btol</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-c~11">c</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-ctemp~6">ctemp</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-ctemp2">ctemp2</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-ctemp3">ctemp3</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-eshift">eshift</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-icompq~3">icompq</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-icompz~5">icompz</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-ifirst">ifirst</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-ifrstm">ifrstm</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-iiter~2">iiter</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-ilast">ilast</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-ilastm">ilastm</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-ilazr2">ilazr2</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-ilazro">ilazro</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-ilq~3">ilq</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-ilschr">ilschr</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-ilz~3">ilz</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-in~9">in</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-ischur">ischur</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-istart">istart</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-j~243">j</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-jc~13">jc</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-jch">jch</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-jiter">jiter</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-jr~10">jr</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-lquery~132">lquery</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-maxit~4">maxit</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-s~35">s</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-safmin~48">safmin</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-shift~5">shift</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-signbc">signbc</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-temp~63">temp</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-temp2~11">temp2</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-tempr">tempr</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-u12">u12</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-ulp~12">ulp</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-x~10">x</a>
            <a class="list-group-item" href="../proc/zhgeqz.html#variable-y~2">y</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/zhgeqz.html#src">ZHGEQZ</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2> subroutine ZHGEQZ(Job, Compq, Compz, N, Ilo, Ihi, H, Ldh, T, Ldt, Alpha, Beta, Q, Ldq, Z, Ldz, Work, Lwork, Rwork, Info)  
</h2>
    

    <p>\brief \b ZHGEQZ
 \htmlonly
 Download ZHGEQZ + dependencies
 <a href="http://www.netlib.org/cgi-bin/netlibfiles.tgz?format=tgz&filename=/lapack/lapack_routine/zhgeqz.f">
 [TGZ]</a>
 <a href="http://www.netlib.org/cgi-bin/netlibfiles.zip?format=zip&filename=/lapack/lapack_routine/zhgeqz.f">
 [ZIP]</a>
 <a href="http://www.netlib.org/cgi-bin/netlibfiles.txt?format=txt&filename=/lapack/lapack_routine/zhgeqz.f">
 [TXT]</a>
 \endhtmlonly
 \par Purpose:</p>
<p>\verbatim</p>
<p>ZHGEQZ computes the eigenvalues of a complex matrix pair (H,T),
 where H is an upper Hessenberg matrix and T is upper triangular,
 using the single-shift QZ method.
 Matrix pairs of this type are produced by the reduction to
 generalized upper Hessenberg form of a complex matrix pair (A,B):</p>
<div class="codehilite"><pre><span></span><code>A = Q1*H*Z1**H,  B = Q1*T*Z1**H,
</code></pre></div>

<p>as computed by ZGGHRD.</p>
<p>If JOB=&rsquo;S&rsquo;, then the Hessenberg-triangular pair (H,T) is
 also reduced to generalized Schur form,</p>
<div class="codehilite"><pre><span></span><code>H = Q*S*Z**H,  T = Q*P*Z**H,
</code></pre></div>

<p>where Q and Z are unitary matrices and S and P are upper triangular.</p>
<p>Optionally, the unitary matrix Q from the generalized Schur
 factorization may be postmultiplied into an input matrix Q1, and the
 unitary matrix Z may be postmultiplied into an input matrix Z1.
 If Q1 and Z1 are the unitary matrices from ZGGHRD that reduced
 the matrix pair (A,B) to generalized Hessenberg form, then the output
 matrices Q1<em>Q and Z1</em>Z are the unitary factors from the generalized
 Schur factorization of (A,B):</p>
<div class="codehilite"><pre><span></span><code>A = (Q1*Q)*S*(Z1*Z)**H,  B = (Q1*Q)*P*(Z1*Z)**H.
</code></pre></div>

<p>To avoid overflow, eigenvalues of the matrix pair (H,T)
 (equivalently, of (A,B)) are computed as a pair of complex values
 (alpha,beta).  If beta is nonzero, lambda = alpha / beta is an
 eigenvalue of the generalized nonsymmetric eigenvalue problem (GNEP)
    A<em>x = lambda</em>B<em>x
 and if alpha is nonzero, mu = beta / alpha is an eigenvalue of the
 alternate form of the GNEP
    mu</em>A<em>y = B</em>y.
 The values of alpha and beta for the i-th eigenvalue can be read
 directly from the generalized Schur form:  alpha = S(i,i),
 beta = P(i,i).</p>
<p>Ref: C.B. Moler &amp; G.W. Stewart, &ldquo;An Algorithm for Generalized Matrix
      Eigenvalue Problems&rdquo;, SIAM J. Numer. Anal., 10(1973),
      pp. 241&ndash;256.
 \endverbatim
 \param[in] JOB
 \verbatim
          JOB is CHARACTER*1
          = &lsquo;E&rsquo;: Compute eigenvalues only;
          = &lsquo;S&rsquo;: Computer eigenvalues and the Schur form.
 \endverbatim</p>
<p>\param[in] COMPQ
 \verbatim
          COMPQ is CHARACTER<em>1
          = &lsquo;N&rsquo;: Left Schur vectors (Q) are not computed;
          = &lsquo;I&rsquo;: Q is initialized to the unit matrix and the matrix Q
                 of left Schur vectors of (H,T) is returned;
          = &lsquo;V&rsquo;: Q must contain a unitary matrix Q1 on entry and
                 the product Q1</em>Q is returned.
 \endverbatim</p>
<p>\param[in] COMPZ
 \verbatim
          COMPZ is CHARACTER<em>1
          = &lsquo;N&rsquo;: Right Schur vectors (Z) are not computed;
          = &lsquo;I&rsquo;: Q is initialized to the unit matrix and the matrix Z
                 of right Schur vectors of (H,T) is returned;
          = &lsquo;V&rsquo;: Z must contain a unitary matrix Z1 on entry and
                 the product Z1</em>Z is returned.
 \endverbatim</p>
<p>\param[in] N
 \verbatim
          N is INTEGER
          The order of the matrices H, T, Q, and Z.  N &gt;= 0.
 \endverbatim</p>
<p>\param[in] ILO
 \verbatim
          ILO is INTEGER
 \endverbatim</p>
<p>\param[in] IHI
 \verbatim
          IHI is INTEGER
          ILO and IHI mark the rows and columns of H which are in
          Hessenberg form.  It is assumed that A is already upper
          triangular in rows and columns 1:ILO-1 and IHI+1:N.
          If N &gt; 0, 1 &lt;= ILO &lt;= IHI &lt;= N; if N = 0, ILO=1 and IHI=0.
 \endverbatim</p>
<p>\param[in,out] H
 \verbatim
          H is COMPLEX*16 array, dimension (LDH, N)
          On entry, the N-by-N upper Hessenberg matrix H.
          On exit, if JOB = &lsquo;S&rsquo;, H contains the upper triangular
          matrix S from the generalized Schur factorization.
          If JOB = &lsquo;E&rsquo;, the diagonal of H matches that of S, but
          the rest of H is unspecified.
 \endverbatim</p>
<p>\param[in] LDH
 \verbatim
          LDH is INTEGER
          The leading dimension of the array H.  LDH &gt;= max( 1, N ).
 \endverbatim</p>
<p>\param[in,out] T
 \verbatim
          T is COMPLEX*16 array, dimension (LDT, N)
          On entry, the N-by-N upper triangular matrix T.
          On exit, if JOB = &lsquo;S&rsquo;, T contains the upper triangular
          matrix P from the generalized Schur factorization.
          If JOB = &lsquo;E&rsquo;, the diagonal of T matches that of P, but
          the rest of T is unspecified.
 \endverbatim</p>
<p>\param[in] LDT
 \verbatim
          LDT is INTEGER
          The leading dimension of the array T.  LDT &gt;= max( 1, N ).
 \endverbatim</p>
<p>\param[out] ALPHA
 \verbatim
          ALPHA is COMPLEX*16 array, dimension (N)
          The complex scalars alpha that define the eigenvalues of
          GNEP.  ALPHA(i) = S(i,i) in the generalized Schur
          factorization.
 \endverbatim</p>
<p>\param[out] BETA
 \verbatim
          BETA is COMPLEX*16 array, dimension (N)
          The real non-negative scalars beta that define the
          eigenvalues of GNEP.  BETA(i) = P(i,i) in the generalized
          Schur factorization.</p>
<div class="codehilite"><pre><span></span><code>      Together, the quantities alpha = ALPHA(j) and beta = BETA(j)
      represent the j-th eigenvalue of the matrix pair (A,B), in
      one of the forms lambda = alpha/beta or mu = beta/alpha.
      Since either lambda or mu may overflow, they should not,
      in general, be computed.
</code></pre></div>

<p>\endverbatim</p>
<p>\param[in,out] Q
 \verbatim
          Q is COMPLEX*16 array, dimension (LDQ, N)
          On entry, if COMPQ = &lsquo;V&rsquo;, the unitary matrix Q1 used in the
          reduction of (A,B) to generalized Hessenberg form.
          On exit, if COMPQ = &lsquo;I&rsquo;, the unitary matrix of left Schur
          vectors of (H,T), and if COMPQ = &lsquo;V&rsquo;, the unitary matrix of
          left Schur vectors of (A,B).
          Not referenced if COMPQ = &lsquo;N&rsquo;.
 \endverbatim</p>
<p>\param[in] LDQ
 \verbatim
          LDQ is INTEGER
          The leading dimension of the array Q.  LDQ &gt;= 1.
          If COMPQ=&rsquo;V&rsquo; or &lsquo;I&rsquo;, then LDQ &gt;= N.
 \endverbatim</p>
<p>\param[in,out] Z
 \verbatim
          Z is COMPLEX*16 array, dimension (LDZ, N)
          On entry, if COMPZ = &lsquo;V&rsquo;, the unitary matrix Z1 used in the
          reduction of (A,B) to generalized Hessenberg form.
          On exit, if COMPZ = &lsquo;I&rsquo;, the unitary matrix of right Schur
          vectors of (H,T), and if COMPZ = &lsquo;V&rsquo;, the unitary matrix of
          right Schur vectors of (A,B).
          Not referenced if COMPZ = &lsquo;N&rsquo;.
 \endverbatim</p>
<p>\param[in] LDZ
 \verbatim
          LDZ is INTEGER
          The leading dimension of the array Z.  LDZ &gt;= 1.
          If COMPZ=&rsquo;V&rsquo; or &lsquo;I&rsquo;, then LDZ &gt;= N.
 \endverbatim</p>
<p>\param[out] WORK
 \verbatim
          WORK is COMPLEX*16 array, dimension (MAX(1,LWORK))
          On exit, if INFO &gt;= 0, WORK(1) returns the optimal LWORK.
 \endverbatim</p>
<p>\param[in] LWORK
 \verbatim
          LWORK is INTEGER
          The dimension of the array WORK.  LWORK &gt;= max(1,N).</p>
<div class="codehilite"><pre><span></span><code>      <span class="k">If</span> <span class="nv">LWORK</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>, <span class="k">then</span> <span class="nv">a</span> <span class="nv">workspace</span> <span class="nv">query</span> <span class="nv">is</span> <span class="nv">assumed</span><span class="c1">; the routine</span>
      <span class="nv">only</span> <span class="nv">calculates</span> <span class="nv">the</span> <span class="nv">optimal</span> <span class="nv">size</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">WORK</span> <span class="nv">array</span>, <span class="nv">returns</span>
      <span class="nv">this</span> <span class="nv">value</span> <span class="nv">as</span> <span class="nv">the</span> <span class="nv">first</span> <span class="nv">entry</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">WORK</span> <span class="nv">array</span>, <span class="nv">and</span> <span class="nv">no</span> <span class="nv">error</span>
      <span class="nv">message</span> <span class="nv">related</span> <span class="nv">to</span> <span class="nv">LWORK</span> <span class="nv">is</span> <span class="nv">issued</span> <span class="nv">by</span> <span class="nv">XERBLA</span>.
</code></pre></div>

<p>\endverbatim</p>
<p>\param[out] RWORK
 \verbatim
          RWORK is DOUBLE PRECISION array, dimension (N)
 \endverbatim</p>
<p>\param[out] INFO
 \verbatim
          INFO is INTEGER
          = 0: successful exit
          &lt; 0: if INFO = -i, the i-th argument had an illegal value
          = 1,&hellip;,N: the QZ iteration did not converge.  (H,T) is not
                     in Schur form, but ALPHA(i) and BETA(i),
                     i=INFO+1,&hellip;,N should be correct.
          = N+1,&hellip;,2*N: the shift calculation failed.  (H,T) is not
                     in Schur form, but ALPHA(i) and BETA(i),
                     i=INFO-N+1,&hellip;,N should be correct.
 \endverbatim
 \author Univ. of Tennessee
 \author Univ. of California Berkeley
 \author Univ. of Colorado Denver
 \author NAG Ltd.
 \date April 2012
 \ingroup complex16GEcomputational
 \par Further Details:</p>
<p>\verbatim</p>
<p>We assume that complex ABS works as long as its value is less than
  overflow.
 \endverbatim</p>
<p>&ndash;ZHGEQZ287</p>
<p>&ndash; LAPACK computational routine (version 3.7.0) &ndash;
  &ndash; LAPACK is a software package provided by Univ. of Tennessee,    &ndash;
  &ndash; Univ. of California Berkeley, Univ. of Colorado Denver and NAG Ltd..&ndash;
     April 2012</p>
<div class="codehilite"><pre><span></span><code> .. Scalar Arguments ..
</code></pre></div>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-job~8"></span>
              character(len=1)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Job</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-compq~5"></span>
              character(len=1)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Compq</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-compz~6"></span>
              character(len=1)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Compz</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-n~463"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>N</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ilo~18"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ilo</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ihi~18"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ihi</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-h~11"></span>
              complex(kind=16)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>H</strong>(Ldh,*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldh~11"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ldh</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-t~45"></span>
              complex(kind=16)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>T</strong>(Ldt,*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldt~40"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ldt</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-alpha~30"></span>
              complex(kind=16)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Alpha</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-beta~25"></span>
              complex(kind=16)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Beta</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-q~29"></span>
              complex(kind=16)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Q</strong>(Ldq,*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldq~18"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ldq</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-z~60"></span>
              complex(kind=16)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Z</strong>(Ldz,*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ldz~47"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ldz</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-work~275"></span>
              complex(kind=16)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Work</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwork~144"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Lwork</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rwork~68"></span>
              double precision
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Rwork</strong>(*)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-info~374"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Info</strong></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    <br>


    <section>    
      <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-abs1~6"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ABS1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-cone~49"></span>
              complex(kind=16),
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>CONE</strong></td>
<td> =</td>
                <td>(1.0D+0,0.0D+0)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-czero~35"></span>
              complex(kind=16),
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>CZERO</strong></td>
<td> =</td>
                <td>(0.0D+0,0.0D+0)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-half~24"></span>
              double precision,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>HALF</strong></td>
<td> =</td>
                <td>0.5D+0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-one~307"></span>
              double precision,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>ONE</strong></td>
<td> =</td>
                <td>1.0D+0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-zero~292"></span>
              double precision,
            </td>
              <td>public,</td>
            <td>
              parameter
            </td>
            <td>::</td>
            <td><strong>ZERO</strong></td>
<td> =</td>
                <td>0.0D+0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-abi12"></span>
              complex(kind=16),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>abi12</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-abi22~2"></span>
              complex(kind=16),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>abi22</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-absb~2"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>absb</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ad11"></span>
              complex(kind=16),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ad11</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ad12"></span>
              complex(kind=16),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ad12</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ad21"></span>
              complex(kind=16),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ad21</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ad22"></span>
              complex(kind=16),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ad22</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-anorm~22"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>anorm</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ascale~5"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ascale</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-atol"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>atol</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-bnorm~7"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>bnorm</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-bscale~5"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>bscale</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-btol"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>btol</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-c~11"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>c</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ctemp~6"></span>
              complex(kind=16),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ctemp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ctemp2"></span>
              complex(kind=16),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ctemp2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ctemp3"></span>
              complex(kind=16),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ctemp3</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-eshift"></span>
              complex(kind=16),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>eshift</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icompq~3"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icompq</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icompz~5"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icompz</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ifirst"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ifirst</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ifrstm"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ifrstm</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iiter~2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iiter</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ilast"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ilast</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ilastm"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ilastm</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ilazr2"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ilazr2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ilazro"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ilazro</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ilq~3"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ilq</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ilschr"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ilschr</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ilz~3"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ilz</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-in~9"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>in</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ischur"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ischur</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-istart"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>istart</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-j~243"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>j</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jc~13"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jc</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jch"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jch</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jiter"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jiter</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jr~10"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jr</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lquery~132"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lquery</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxit~4"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxit</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s~35"></span>
              complex(kind=16),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>s</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-safmin~48"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>safmin</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-shift~5"></span>
              complex(kind=16),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>shift</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-signbc"></span>
              complex(kind=16),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>signbc</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-temp~63"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>temp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-temp2~11"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>temp2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-tempr"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>tempr</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-u12"></span>
              complex(kind=16),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>u12</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ulp~12"></span>
              double precision,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ulp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-x~10"></span>
              complex(kind=16),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>x</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-y~2"></span>
              complex(kind=16),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>y</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">      </span><span class="k">SUBROUTINE </span><span class="n">ZHGEQZ</span><span class="p">(</span><span class="n">Job</span><span class="p">,</span><span class="n">Compq</span><span class="p">,</span><span class="n">Compz</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">Ilo</span><span class="p">,</span><span class="n">Ihi</span><span class="p">,</span><span class="n">H</span><span class="p">,</span><span class="n">Ldh</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">Ldt</span><span class="p">,</span><span class="n">Alpha</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="n">Beta</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="n">Ldq</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">Ldz</span><span class="p">,</span><span class="n">Work</span><span class="p">,</span><span class="n">Lwork</span><span class="p">,</span><span class="n">Rwork</span><span class="p">,</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">IMPLICIT NONE</span><span class="w"></span>
<span class="c">!*--ZHGEQZ287</span>
<span class="c">!</span>
<span class="c">!  -- LAPACK computational routine (version 3.7.0) --</span>
<span class="c">!  -- LAPACK is a software package provided by Univ. of Tennessee,    --</span>
<span class="c">!  -- Univ. of California Berkeley, Univ. of Colorado Denver and NAG Ltd..--</span>
<span class="c">!     April 2012</span>
<span class="c">!</span>
<span class="c">!     .. Scalar Arguments ..</span>
<span class="w">      </span><span class="kt">CHARACTER </span><span class="n">Compq</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Compz</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Job</span><span class="w"></span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">Ihi</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Ilo</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Info</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Ldh</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Ldq</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Ldt</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Ldz</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Lwork</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Array Arguments ..</span>
<span class="w">      </span><span class="kt">DOUBLE PRECISION </span><span class="n">Rwork</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="kt">COMPLEX</span><span class="o">*</span><span class="mi">16</span><span class="w"> </span><span class="n">Alpha</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Beta</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">H</span><span class="p">(</span><span class="n">Ldh</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Q</span><span class="p">(</span><span class="n">Ldq</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="p">(</span><span class="n">Ldt</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">           </span><span class="n">Work</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Z</span><span class="p">(</span><span class="n">Ldz</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!</span>
<span class="c">!  =====================================================================</span>
<span class="c">!</span>
<span class="c">!     .. Parameters ..</span>
<span class="w">      </span><span class="kt">COMPLEX</span><span class="o">*</span><span class="mi">16</span><span class="w"> </span><span class="n">CZERO</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">CONE</span><span class="w"></span>
<span class="w">      </span><span class="k">PARAMETER</span><span class="w"> </span><span class="p">(</span><span class="n">CZERO</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0D+0</span><span class="p">,</span><span class="mf">0.0D+0</span><span class="p">),</span><span class="n">CONE</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0D+0</span><span class="p">,</span><span class="mf">0.0D+0</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="kt">DOUBLE PRECISION </span><span class="n">ZERO</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ONE</span><span class="w"></span>
<span class="w">      </span><span class="k">PARAMETER</span><span class="w"> </span><span class="p">(</span><span class="n">ZERO</span><span class="o">=</span><span class="mf">0.0D+0</span><span class="p">,</span><span class="n">ONE</span><span class="o">=</span><span class="mf">1.0D+0</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="kt">DOUBLE PRECISION </span><span class="n">HALF</span><span class="w"></span>
<span class="w">      </span><span class="k">PARAMETER</span><span class="w"> </span><span class="p">(</span><span class="n">HALF</span><span class="o">=</span><span class="mf">0.5D+0</span><span class="p">)</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Local Scalars ..</span>
<span class="w">      </span><span class="kt">LOGICAL </span><span class="n">ilazr2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ilazro</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ilq</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ilschr</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ilz</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lquery</span><span class="w"></span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">icompq</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">icompz</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ifirst</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ifrstm</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">iiter</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">ilastm</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ischur</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">istart</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">jc</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">jiter</span><span class="w"> </span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">        </span><span class="n">jr</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">maxit</span><span class="w"></span>
<span class="w">      </span><span class="kt">DOUBLE PRECISION </span><span class="n">absb</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">anorm</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ascale</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">atol</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">bnorm</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">bscale</span><span class="w"> </span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                 </span><span class="n">btol</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">safmin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">temp2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">tempr</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ulp</span><span class="w"></span>
<span class="w">      </span><span class="kt">COMPLEX</span><span class="o">*</span><span class="mi">16</span><span class="w"> </span><span class="n">abi22</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ad11</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ad12</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ad21</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ad22</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ctemp</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ctemp2</span><span class="w"> </span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">           </span><span class="n">ctemp3</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">eshift</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">shift</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">signbc</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">u12</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">           </span><span class="n">abi12</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. External Functions ..</span>
<span class="w">      </span><span class="kt">COMPLEX</span><span class="o">*</span><span class="mi">16</span><span class="w"> </span><span class="n">ZLADIV</span><span class="w"></span>
<span class="w">      </span><span class="kt">LOGICAL </span><span class="n">LSAME</span><span class="w"></span>
<span class="w">      </span><span class="kt">DOUBLE PRECISION </span><span class="n">DLAMCH</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ZLANHS</span><span class="w"></span>
<span class="w">      </span><span class="k">EXTERNAL </span><span class="n">ZLADIV</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">LSAME</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">DLAMCH</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ZLANHS</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. External Subroutines ..</span>
<span class="w">      </span><span class="k">EXTERNAL </span><span class="n">XERBLA</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ZLARTG</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ZLASET</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ZROT</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ZSCAL</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Intrinsic Functions ..</span>
<span class="w">      </span><span class="k">INTRINSIC </span><span class="nb">ABS</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nb">DBLE</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">DCMPLX</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">DCONJG</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">DIMAG</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nb">MAX</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nb">MIN</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nb">SQRT</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Statement Functions ..</span>
<span class="w">      </span><span class="kt">DOUBLE PRECISION </span><span class="n">ABS1</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Statement Function definitions ..</span>
<span class="w">      </span><span class="n">ABS1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="nb">DBLE</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">DIMAG</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="w"></span>
<span class="c">!     ..</span>
<span class="c">!     .. Executable Statements ..</span>
<span class="c">!</span>
<span class="c">!     Decode JOB, COMPQ, COMPZ</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">LSAME</span><span class="p">(</span><span class="n">Job</span><span class="p">,</span><span class="s1">&#39;E&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">ilschr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<span class="w">         </span><span class="n">ischur</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">LSAME</span><span class="p">(</span><span class="n">Job</span><span class="p">,</span><span class="s1">&#39;S&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">ilschr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="w">         </span><span class="n">ischur</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="w">      </span><span class="k">ELSE</span>
<span class="k">         </span><span class="n">ilschr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="w">         </span><span class="n">ischur</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">LSAME</span><span class="p">(</span><span class="n">Compq</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">ilq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<span class="w">         </span><span class="n">icompq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">LSAME</span><span class="p">(</span><span class="n">Compq</span><span class="p">,</span><span class="s1">&#39;V&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">ilq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="w">         </span><span class="n">icompq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">LSAME</span><span class="p">(</span><span class="n">Compq</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">ilq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="w">         </span><span class="n">icompq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="w">      </span><span class="k">ELSE</span>
<span class="k">         </span><span class="n">ilq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="w">         </span><span class="n">icompq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">LSAME</span><span class="p">(</span><span class="n">Compz</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">ilz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<span class="w">         </span><span class="n">icompz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">LSAME</span><span class="p">(</span><span class="n">Compz</span><span class="p">,</span><span class="s1">&#39;V&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">ilz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="w">         </span><span class="n">icompz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">LSAME</span><span class="p">(</span><span class="n">Compz</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">ilz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="w">         </span><span class="n">icompz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="w">      </span><span class="k">ELSE</span>
<span class="k">         </span><span class="n">ilz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="w">         </span><span class="n">icompz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Check Argument Values</span>
<span class="c">!</span>
<span class="w">      </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">Work</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">lquery</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Lwork</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ischur</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">icompq</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">icompz</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">N</span><span class="o">&lt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Ilo</span><span class="o">&lt;</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">5</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Ihi</span><span class="o">&gt;</span><span class="n">N</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">Ihi</span><span class="o">&lt;</span><span class="n">Ilo</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">6</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Ldh</span><span class="o">&lt;</span><span class="n">N</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">8</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Ldt</span><span class="o">&lt;</span><span class="n">N</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">10</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Ldq</span><span class="o">&lt;</span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">ilq</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">Ldq</span><span class="o">&lt;</span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">14</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Ldz</span><span class="o">&lt;</span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">ilz</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">Ldz</span><span class="o">&lt;</span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">16</span><span class="w"></span>
<span class="w">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Lwork</span><span class="o">&lt;</span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">lquery</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">18</span><span class="w"></span>
<span class="w">      </span><span class="k">ENDIF</span>
<span class="k">      IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Info</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         CALL </span><span class="n">XERBLA</span><span class="p">(</span><span class="s1">&#39;ZHGEQZ&#39;</span><span class="p">,</span><span class="o">-</span><span class="n">Info</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">RETURN</span>
<span class="k">      </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">lquery</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         RETURN</span>
<span class="k">      ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Quick return if possible</span>
<span class="c">!</span>
<span class="c">!     WORK( 1 ) = CMPLX( 1 )</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">N</span><span class="o">&lt;=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">         </span><span class="n">Work</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DCMPLX</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">RETURN</span>
<span class="k">      ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Initialize Q and Z</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">icompq</span><span class="o">==</span><span class="mi">3</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">CALL </span><span class="n">ZLASET</span><span class="p">(</span><span class="s1">&#39;Full&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">CONE</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="n">Ldq</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">icompz</span><span class="o">==</span><span class="mi">3</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">CALL </span><span class="n">ZLASET</span><span class="p">(</span><span class="s1">&#39;Full&#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">CZERO</span><span class="p">,</span><span class="n">CONE</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">Ldz</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Machine Constants</span>
<span class="c">!</span>
<span class="w">      </span><span class="n">in</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ihi</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Ilo</span><span class="w"></span>
<span class="w">      </span><span class="n">safmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DLAMCH</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">ulp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DLAMCH</span><span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">)</span><span class="o">*</span><span class="n">DLAMCH</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">anorm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZLANHS</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">in</span><span class="p">,</span><span class="n">H</span><span class="p">(</span><span class="n">Ilo</span><span class="p">,</span><span class="n">Ilo</span><span class="p">),</span><span class="n">Ldh</span><span class="p">,</span><span class="n">Rwork</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">bnorm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ZLANHS</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="n">in</span><span class="p">,</span><span class="n">T</span><span class="p">(</span><span class="n">Ilo</span><span class="p">,</span><span class="n">Ilo</span><span class="p">),</span><span class="n">Ldt</span><span class="p">,</span><span class="n">Rwork</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">atol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">safmin</span><span class="p">,</span><span class="n">ulp</span><span class="o">*</span><span class="n">anorm</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">btol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">safmin</span><span class="p">,</span><span class="n">ulp</span><span class="o">*</span><span class="n">bnorm</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">ascale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ONE</span><span class="o">/</span><span class="nb">MAX</span><span class="p">(</span><span class="n">safmin</span><span class="p">,</span><span class="n">anorm</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">bscale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ONE</span><span class="o">/</span><span class="nb">MAX</span><span class="p">(</span><span class="n">safmin</span><span class="p">,</span><span class="n">bnorm</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!</span>
<span class="c">!     Set Eigenvalues IHI+1:N</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">DO </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ihi</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">         </span><span class="n">absb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">T</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">absb</span><span class="o">&gt;</span><span class="n">safmin</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            </span><span class="n">signbc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DCONJG</span><span class="p">(</span><span class="n">T</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="n">absb</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">T</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">absb</span><span class="w"></span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ilschr</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               CALL </span><span class="n">ZSCAL</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">signbc</span><span class="p">,</span><span class="n">T</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">ZSCAL</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">signbc</span><span class="p">,</span><span class="n">H</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">ELSE</span>
<span class="k">               CALL </span><span class="n">ZSCAL</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">signbc</span><span class="p">,</span><span class="n">H</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span>
<span class="k">            IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ilz</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">CALL </span><span class="n">ZSCAL</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">signbc</span><span class="p">,</span><span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">ELSE</span>
<span class="k">            </span><span class="n">T</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CZERO</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span>
<span class="k">         </span><span class="n">Alpha</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">H</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">Beta</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">T</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">ENDDO</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     If IHI &lt; ILO, skip QZ steps</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Ihi</span><span class="o">&gt;=</span><span class="n">Ilo</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     MAIN QZ ITERATION LOOP</span>
<span class="c">!</span>
<span class="c">!     Initialize dynamic indices</span>
<span class="c">!</span>
<span class="c">!     Eigenvalues ILAST+1:N have been found.</span>
<span class="c">!        Column operations modify rows IFRSTM:whatever</span>
<span class="c">!        Row operations modify columns whatever:ILASTM</span>
<span class="c">!</span>
<span class="c">!     If only eigenvalues are being computed, then</span>
<span class="c">!        IFRSTM is the row of the last splitting row above row ILAST;</span>
<span class="c">!        this is always at least ILO.</span>
<span class="c">!     IITER counts iterations since the last eigenvalue was found,</span>
<span class="c">!        to tell when to use an extraordinary shift.</span>
<span class="c">!     MAXIT is the maximum number of QZ sweeps allowed.</span>
<span class="c">!</span>
<span class="w">         </span><span class="n">ilast</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ihi</span><span class="w"></span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ilschr</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            </span><span class="n">ifrstm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">ilastm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">         </span><span class="k">ELSE</span>
<span class="k">            </span><span class="n">ifrstm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ilo</span><span class="w"></span>
<span class="w">            </span><span class="n">ilastm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ihi</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span>
<span class="k">         </span><span class="n">iiter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">         </span><span class="n">eshift</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CZERO</span><span class="w"></span>
<span class="w">         </span><span class="n">maxit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">30</span><span class="o">*</span><span class="p">(</span><span class="n">Ihi</span><span class="o">-</span><span class="n">Ilo</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="w">         </span><span class="k">DO </span><span class="n">jiter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">maxit</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!        Check for too many iterations.</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">jiter</span><span class="o">&gt;</span><span class="n">maxit</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">EXIT</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!        Split the matrix if possible.</span>
<span class="c">!</span>
<span class="c">!        Two tests:</span>
<span class="c">!           1: H(j,j-1)=0  or  j=ILO</span>
<span class="c">!           2: T(j,j)=0</span>
<span class="c">!</span>
<span class="c">!        Special case: j=ILAST</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="o">==</span><span class="n">Ilo</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">GOTO</span><span class="w"> </span><span class="mi">40</span><span class="w"></span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ABS1</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="n">ilast</span><span class="p">,</span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="w">                                 </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">           </span><span class="o">&lt;=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">safmin</span><span class="p">,</span><span class="n">ulp</span><span class="o">*</span><span class="p">(</span><span class="n">ABS1</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="n">ilast</span><span class="p">,</span><span class="n">ilast</span><span class="p">))</span><span class="w">                 </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">           </span><span class="o">+</span><span class="n">ABS1</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="p">))))</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">H</span><span class="p">(</span><span class="n">ilast</span><span class="p">,</span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CZERO</span><span class="w"></span>
<span class="w">               </span><span class="k">GOTO</span><span class="w"> </span><span class="mi">40</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">T</span><span class="p">(</span><span class="n">ilast</span><span class="p">,</span><span class="n">ilast</span><span class="p">))</span><span class="w">                                    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">           </span><span class="o">&lt;=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">safmin</span><span class="p">,</span><span class="n">ulp</span><span class="o">*</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">T</span><span class="p">(</span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ilast</span><span class="p">))</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">           </span><span class="o">+</span><span class="nb">ABS</span><span class="p">(</span><span class="n">T</span><span class="p">(</span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="p">))))</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">T</span><span class="p">(</span><span class="n">ilast</span><span class="p">,</span><span class="n">ilast</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CZERO</span><span class="w"></span>
<span class="w">               </span><span class="k">GOTO</span><span class="w"> </span><span class="mi">20</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!        General case: j&lt;ILAST</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">DO </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Ilo</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Test 1: for H(j,j-1)=0 or j=ILO</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">==</span><span class="n">Ilo</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                  </span><span class="n">ilazro</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="w">               </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ABS1</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="w">                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="o">&lt;=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">safmin</span><span class="p">,</span><span class="n">ulp</span><span class="o">*</span><span class="p">(</span><span class="n">ABS1</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">))</span><span class="o">+</span><span class="n">ABS1</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)))&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                  </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                  </span><span class="n">H</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CZERO</span><span class="w"></span>
<span class="w">                  </span><span class="n">ilazro</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="w">               </span><span class="k">ELSE</span>
<span class="k">                  </span><span class="n">ilazro</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Test 2: for T(j,j)=0</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">T</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">&gt;</span><span class="n">Ilo</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">T</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">))</span><span class="w"></span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">T</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">))</span><span class="o">&lt;</span><span class="nb">MAX</span><span class="p">(</span><span class="n">safmin</span><span class="p">,</span><span class="n">ulp</span><span class="o">*</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                  </span><span class="n">T</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CZERO</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Test 1a: Check for 2 consecutive small subdiagonals in A</span>
<span class="c">!</span>
<span class="w">                  </span><span class="n">ilazr2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<span class="w">                  </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">ilazro</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                     IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ABS1</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">ascale</span><span class="o">*</span><span class="n">ABS1</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">)))</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                    </span><span class="o">&lt;=</span><span class="n">ABS1</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">ascale</span><span class="o">*</span><span class="n">atol</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">ilazr2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="w">                  </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              If both tests pass (1 &amp; 2), i.e., the leading diagonal</span>
<span class="c">!              element of B in the block is zero, split a 1x1 block off</span>
<span class="c">!              at the top. (I.e., at the J-th row/column) The leading</span>
<span class="c">!              diagonal element of the remainder can also be zero, so</span>
<span class="c">!              this may have to be done repeatedly.</span>
<span class="c">!</span>
<span class="w">                  </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ilazro</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">ilazr2</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                     DO </span><span class="n">jch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                        </span><span class="n">ctemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">H</span><span class="p">(</span><span class="n">jch</span><span class="p">,</span><span class="n">jch</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="k">CALL </span><span class="n">ZLARTG</span><span class="p">(</span><span class="n">ctemp</span><span class="p">,</span><span class="n">H</span><span class="p">(</span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jch</span><span class="p">),</span><span class="n">c</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">H</span><span class="p">(</span><span class="n">jch</span><span class="p">,</span><span class="n">jch</span><span class="p">))</span><span class="w"></span>
<span class="w">                        </span><span class="n">H</span><span class="p">(</span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jch</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CZERO</span><span class="w"></span>
<span class="w">                        </span><span class="k">CALL </span><span class="n">ZROT</span><span class="p">(</span><span class="n">ilastm</span><span class="o">-</span><span class="n">jch</span><span class="p">,</span><span class="n">H</span><span class="p">(</span><span class="n">jch</span><span class="p">,</span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">Ldh</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                            </span><span class="n">H</span><span class="p">(</span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">Ldh</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">s</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="k">CALL </span><span class="n">ZROT</span><span class="p">(</span><span class="n">ilastm</span><span class="o">-</span><span class="n">jch</span><span class="p">,</span><span class="n">T</span><span class="p">(</span><span class="n">jch</span><span class="p">,</span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">Ldt</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                            </span><span class="n">T</span><span class="p">(</span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">Ldt</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">s</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ilq</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">CALL </span><span class="n">ZROT</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Q</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">jch</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">Q</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                       </span><span class="n">c</span><span class="p">,</span><span class="n">DCONJG</span><span class="p">(</span><span class="n">s</span><span class="p">))</span><span class="w"></span>
<span class="w">                        </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ilazr2</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">H</span><span class="p">(</span><span class="n">jch</span><span class="p">,</span><span class="n">jch</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">H</span><span class="p">(</span><span class="n">jch</span><span class="p">,</span><span class="n">jch</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">c</span><span class="w"></span>
<span class="w">                        </span><span class="n">ilazr2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<span class="w">                        </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ABS1</span><span class="p">(</span><span class="n">T</span><span class="p">(</span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">&gt;=</span><span class="n">btol</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                           IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="o">&gt;=</span><span class="n">ilast</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">GOTO</span><span class="w"> </span><span class="mi">40</span><span class="w"></span>
<span class="w">                           </span><span class="n">ifirst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jch</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                           </span><span class="k">GOTO</span><span class="w"> </span><span class="mi">60</span><span class="w"></span>
<span class="w">                        </span><span class="k">ENDIF</span>
<span class="k">                        </span><span class="n">T</span><span class="p">(</span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CZERO</span><span class="w"></span>
<span class="w">                     </span><span class="k">ENDDO</span>
<span class="k">                  ELSE</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!                 Only test 2 passed -- chase the zero to T(ILAST,ILAST)</span>
<span class="c">!                 Then process as in the case T(ILAST,ILAST)=0</span>
<span class="c">!</span>
<span class="w">                     </span><span class="k">DO </span><span class="n">jch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                        </span><span class="n">ctemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">T</span><span class="p">(</span><span class="n">jch</span><span class="p">,</span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="k">CALL </span><span class="n">ZLARTG</span><span class="p">(</span><span class="n">ctemp</span><span class="p">,</span><span class="n">T</span><span class="p">(</span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">c</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                              </span><span class="n">T</span><span class="p">(</span><span class="n">jch</span><span class="p">,</span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="w">                        </span><span class="n">T</span><span class="p">(</span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CZERO</span><span class="w"></span>
<span class="w">                        </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">jch</span><span class="o">&lt;</span><span class="n">ilastm</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w">                             </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                       </span><span class="k">CALL </span><span class="n">ZROT</span><span class="p">(</span><span class="n">ilastm</span><span class="o">-</span><span class="n">jch</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">T</span><span class="p">(</span><span class="n">jch</span><span class="p">,</span><span class="n">jch</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span><span class="n">Ldt</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                       </span><span class="n">T</span><span class="p">(</span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jch</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span><span class="n">Ldt</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">s</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="k">CALL </span><span class="n">ZROT</span><span class="p">(</span><span class="n">ilastm</span><span class="o">-</span><span class="n">jch</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">H</span><span class="p">(</span><span class="n">jch</span><span class="p">,</span><span class="n">jch</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">Ldh</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                            </span><span class="n">H</span><span class="p">(</span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jch</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">Ldh</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">s</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ilq</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">CALL </span><span class="n">ZROT</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Q</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">jch</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">Q</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                       </span><span class="n">c</span><span class="p">,</span><span class="n">DCONJG</span><span class="p">(</span><span class="n">s</span><span class="p">))</span><span class="w"></span>
<span class="w">                        </span><span class="n">ctemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">H</span><span class="p">(</span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jch</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="k">CALL </span><span class="n">ZLARTG</span><span class="p">(</span><span class="n">ctemp</span><span class="p">,</span><span class="n">H</span><span class="p">(</span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jch</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">c</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                              </span><span class="n">H</span><span class="p">(</span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jch</span><span class="p">))</span><span class="w"></span>
<span class="w">                        </span><span class="n">H</span><span class="p">(</span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jch</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CZERO</span><span class="w"></span>
<span class="w">                        </span><span class="k">CALL </span><span class="n">ZROT</span><span class="p">(</span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">ifrstm</span><span class="p">,</span><span class="n">H</span><span class="p">(</span><span class="n">ifrstm</span><span class="p">,</span><span class="n">jch</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                            </span><span class="n">H</span><span class="p">(</span><span class="n">ifrstm</span><span class="p">,</span><span class="n">jch</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">s</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="k">CALL </span><span class="n">ZROT</span><span class="p">(</span><span class="n">jch</span><span class="o">-</span><span class="n">ifrstm</span><span class="p">,</span><span class="n">T</span><span class="p">(</span><span class="n">ifrstm</span><span class="p">,</span><span class="n">jch</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                            </span><span class="n">T</span><span class="p">(</span><span class="n">ifrstm</span><span class="p">,</span><span class="n">jch</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">s</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ilz</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">CALL </span><span class="n">ZROT</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">jch</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">jch</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                       </span><span class="n">c</span><span class="p">,</span><span class="n">s</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="k">ENDDO</span>
<span class="k">                  ENDIF</span>
<span class="k">                  GOTO</span><span class="w"> </span><span class="mi">20</span><span class="w"></span>
<span class="w">               </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ilazro</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!              Only test 1 passed -- work on J:ILAST</span>
<span class="c">!</span>
<span class="w">                  </span><span class="n">ifirst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="w"></span>
<span class="w">                  </span><span class="k">GOTO</span><span class="w"> </span><span class="mi">60</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Neither test passed -- try next J</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">ENDDO</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!        (Drop-through is &quot;impossible&quot;)</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="k">GOTO</span><span class="w"> </span><span class="mi">200</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!        T(ILAST,ILAST)=0 -- clear H(ILAST,ILAST-1) to split off a</span>
<span class="c">!        1x1 block.</span>
<span class="c">!</span>
<span class="w"> </span><span class="mi">20</span><span class="w">         </span><span class="n">ctemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">H</span><span class="p">(</span><span class="n">ilast</span><span class="p">,</span><span class="n">ilast</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">ZLARTG</span><span class="p">(</span><span class="n">ctemp</span><span class="p">,</span><span class="n">H</span><span class="p">(</span><span class="n">ilast</span><span class="p">,</span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">c</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">H</span><span class="p">(</span><span class="n">ilast</span><span class="p">,</span><span class="n">ilast</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="n">H</span><span class="p">(</span><span class="n">ilast</span><span class="p">,</span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CZERO</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">ZROT</span><span class="p">(</span><span class="n">ilast</span><span class="o">-</span><span class="n">ifrstm</span><span class="p">,</span><span class="n">H</span><span class="p">(</span><span class="n">ifrstm</span><span class="p">,</span><span class="n">ilast</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">H</span><span class="p">(</span><span class="n">ifrstm</span><span class="p">,</span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                </span><span class="mi">1</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">s</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">ZROT</span><span class="p">(</span><span class="n">ilast</span><span class="o">-</span><span class="n">ifrstm</span><span class="p">,</span><span class="n">T</span><span class="p">(</span><span class="n">ifrstm</span><span class="p">,</span><span class="n">ilast</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">T</span><span class="p">(</span><span class="n">ifrstm</span><span class="p">,</span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                </span><span class="mi">1</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">s</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ilz</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">CALL </span><span class="n">ZROT</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ilast</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">s</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!        H(ILAST,ILAST-1)=0 -- Standardize B, set ALPHA and BETA</span>
<span class="c">!</span>
<span class="w"> </span><span class="mi">40</span><span class="w">         </span><span class="n">absb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">T</span><span class="p">(</span><span class="n">ilast</span><span class="p">,</span><span class="n">ilast</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">absb</span><span class="o">&gt;</span><span class="n">safmin</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">signbc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DCONJG</span><span class="p">(</span><span class="n">T</span><span class="p">(</span><span class="n">ilast</span><span class="p">,</span><span class="n">ilast</span><span class="p">)</span><span class="o">/</span><span class="n">absb</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">T</span><span class="p">(</span><span class="n">ilast</span><span class="p">,</span><span class="n">ilast</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">absb</span><span class="w"></span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ilschr</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                  CALL </span><span class="n">ZSCAL</span><span class="p">(</span><span class="n">ilast</span><span class="o">-</span><span class="n">ifrstm</span><span class="p">,</span><span class="n">signbc</span><span class="p">,</span><span class="n">T</span><span class="p">(</span><span class="n">ifrstm</span><span class="p">,</span><span class="n">ilast</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">CALL </span><span class="n">ZSCAL</span><span class="p">(</span><span class="n">ilast</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">ifrstm</span><span class="p">,</span><span class="n">signbc</span><span class="p">,</span><span class="n">H</span><span class="p">(</span><span class="n">ifrstm</span><span class="p">,</span><span class="n">ilast</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">ELSE</span>
<span class="k">                  CALL </span><span class="n">ZSCAL</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">signbc</span><span class="p">,</span><span class="n">H</span><span class="p">(</span><span class="n">ilast</span><span class="p">,</span><span class="n">ilast</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span>
<span class="k">               IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ilz</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">CALL </span><span class="n">ZSCAL</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">signbc</span><span class="p">,</span><span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ilast</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">ELSE</span>
<span class="k">               </span><span class="n">T</span><span class="p">(</span><span class="n">ilast</span><span class="p">,</span><span class="n">ilast</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CZERO</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span>
<span class="k">            </span><span class="n">Alpha</span><span class="p">(</span><span class="n">ilast</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">H</span><span class="p">(</span><span class="n">ilast</span><span class="p">,</span><span class="n">ilast</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">Beta</span><span class="p">(</span><span class="n">ilast</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">T</span><span class="p">(</span><span class="n">ilast</span><span class="p">,</span><span class="n">ilast</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!        Go to next block -- exit if finished.</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">ilast</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="o">&lt;</span><span class="n">Ilo</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">GOTO</span><span class="w"> </span><span class="mi">100</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!        Reset counters</span>
<span class="c">!</span>
<span class="w">            </span><span class="n">iiter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">            </span><span class="n">eshift</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CZERO</span><span class="w"></span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">ilschr</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               </span><span class="n">ilastm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ilast</span><span class="w"></span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ifrstm</span><span class="o">&gt;</span><span class="n">ilast</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">ifrstm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ilo</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span>
<span class="k">            CYCLE</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!        QZ step</span>
<span class="c">!</span>
<span class="c">!        This iteration only involves rows/columns IFIRST:ILAST.  We</span>
<span class="c">!        assume IFIRST &lt; ILAST, and that the diagonal of B is non-zero.</span>
<span class="c">!</span>
<span class="w"> </span><span class="mi">60</span><span class="w">         </span><span class="n">iiter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iiter</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">ilschr</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">ifrstm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ifirst</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!        Compute the Shift.</span>
<span class="c">!</span>
<span class="c">!        At this point, IFIRST &lt; ILAST, and the diagonal elements of</span>
<span class="c">!        T(IFIRST:ILAST,IFIRST,ILAST) are larger than BTOL (in</span>
<span class="c">!        magnitude)</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">iiter</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span><span class="o">/=</span><span class="n">iiter</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           The Wilkinson shift (AEP p.512), i.e., the eigenvalue of</span>
<span class="c">!           the bottom-right 2x2 block of A inv(B) which is nearest to</span>
<span class="c">!           the bottom-right element.</span>
<span class="c">!</span>
<span class="c">!           We factor B as U*D, where U has unit diagonals, and</span>
<span class="c">!           compute (A*inv(D))*inv(U).</span>
<span class="c">!</span>
<span class="w">               </span><span class="n">u12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">bscale</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ilast</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">bscale</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="n">ilast</span><span class="p">,</span><span class="n">ilast</span><span class="p">))</span><span class="w"></span>
<span class="w">               </span><span class="n">ad11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ascale</span><span class="o">*</span><span class="n">H</span><span class="p">(</span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="w">                       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                </span><span class="o">/</span><span class="p">(</span><span class="n">bscale</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="w">               </span><span class="n">ad21</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ascale</span><span class="o">*</span><span class="n">H</span><span class="p">(</span><span class="n">ilast</span><span class="p">,</span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                </span><span class="o">/</span><span class="p">(</span><span class="n">bscale</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="w">               </span><span class="n">ad12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ascale</span><span class="o">*</span><span class="n">H</span><span class="p">(</span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ilast</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">bscale</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="n">ilast</span><span class="p">,</span><span class="n">ilast</span><span class="p">))</span><span class="w"></span>
<span class="w">               </span><span class="n">ad22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ascale</span><span class="o">*</span><span class="n">H</span><span class="p">(</span><span class="n">ilast</span><span class="p">,</span><span class="n">ilast</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">bscale</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="n">ilast</span><span class="p">,</span><span class="n">ilast</span><span class="p">))</span><span class="w"></span>
<span class="w">               </span><span class="n">abi22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ad22</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">u12</span><span class="o">*</span><span class="n">ad21</span><span class="w"></span>
<span class="w">               </span><span class="n">abi12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ad12</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">u12</span><span class="o">*</span><span class="n">ad11</span><span class="w"></span>
<span class="c">!</span>
<span class="w">               </span><span class="n">shift</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abi22</span><span class="w"></span>
<span class="w">               </span><span class="n">ctemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">SQRT</span><span class="p">(</span><span class="n">abi12</span><span class="p">)</span><span class="o">*</span><span class="nb">SQRT</span><span class="p">(</span><span class="n">ad21</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ABS1</span><span class="p">(</span><span class="n">ctemp</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ctemp</span><span class="o">/=</span><span class="n">ZERO</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HALF</span><span class="o">*</span><span class="p">(</span><span class="n">ad11</span><span class="o">-</span><span class="n">shift</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">temp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ABS1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span><span class="n">ABS1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="w"></span>
<span class="w">                  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="o">*</span><span class="nb">SQRT</span><span class="p">((</span><span class="n">x</span><span class="o">/</span><span class="n">temp</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">ctemp</span><span class="o">/</span><span class="n">temp</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">temp2</span><span class="o">&gt;</span><span class="n">ZERO</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                     IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">DBLE</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">temp2</span><span class="p">)</span><span class="o">*</span><span class="nb">DBLE</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">+</span><span class="n">DIMAG</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">temp2</span><span class="p">)</span><span class="o">*</span><span class="n">DIMAG</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                    </span><span class="o">&lt;</span><span class="n">ZERO</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">y</span><span class="w"></span>
<span class="w">                  </span><span class="k">ENDIF</span>
<span class="k">                  </span><span class="n">shift</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">shift</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ctemp</span><span class="o">*</span><span class="n">ZLADIV</span><span class="p">(</span><span class="n">ctemp</span><span class="p">,(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">))</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span>
<span class="k">            ELSE</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!           Exceptional shift.  Chosen for no particularly good reason.</span>
<span class="c">!</span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">iiter</span><span class="o">/</span><span class="mi">20</span><span class="p">)</span><span class="o">*</span><span class="mi">20</span><span class="o">==</span><span class="n">iiter</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w">                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">              </span><span class="n">bscale</span><span class="o">*</span><span class="n">ABS1</span><span class="p">(</span><span class="n">T</span><span class="p">(</span><span class="n">ilast</span><span class="p">,</span><span class="n">ilast</span><span class="p">))</span><span class="o">&gt;</span><span class="n">safmin</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                  </span><span class="n">eshift</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eshift</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">ascale</span><span class="o">*</span><span class="n">H</span><span class="p">(</span><span class="n">ilast</span><span class="p">,</span><span class="n">ilast</span><span class="p">))</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="o">/</span><span class="p">(</span><span class="n">bscale</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="n">ilast</span><span class="p">,</span><span class="n">ilast</span><span class="p">))</span><span class="w"></span>
<span class="w">               </span><span class="k">ELSE</span>
<span class="k">                  </span><span class="n">eshift</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eshift</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">ascale</span><span class="o">*</span><span class="n">H</span><span class="p">(</span><span class="n">ilast</span><span class="p">,</span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">                     </span><span class="o">/</span><span class="p">(</span><span class="n">bscale</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span>
<span class="k">               </span><span class="n">shift</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eshift</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!        Now check for two consecutive small subdiagonals.</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">DO </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ifirst</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="n">istart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="w"></span>
<span class="w">               </span><span class="n">ctemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ascale</span><span class="o">*</span><span class="n">H</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">shift</span><span class="o">*</span><span class="p">(</span><span class="n">bscale</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">))</span><span class="w"></span>
<span class="w">               </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ABS1</span><span class="p">(</span><span class="n">ctemp</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">temp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ascale</span><span class="o">*</span><span class="n">ABS1</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">))</span><span class="w"></span>
<span class="w">               </span><span class="n">tempr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span><span class="n">temp2</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">tempr</span><span class="o">&lt;</span><span class="n">ONE</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">tempr</span><span class="o">/=</span><span class="n">ZERO</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                  </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="o">/</span><span class="n">tempr</span><span class="w"></span>
<span class="w">                  </span><span class="n">temp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp2</span><span class="o">/</span><span class="n">tempr</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span>
<span class="k">               IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ABS1</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">temp2</span><span class="o">&lt;=</span><span class="n">temp</span><span class="o">*</span><span class="n">atol</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">GOTO</span><span class="w"> </span><span class="mi">80</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDDO</span><span class="w"></span>
<span class="c">!</span>
<span class="w">            </span><span class="n">istart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ifirst</span><span class="w"></span>
<span class="w">            </span><span class="n">ctemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ascale</span><span class="o">*</span><span class="n">H</span><span class="p">(</span><span class="n">ifirst</span><span class="p">,</span><span class="n">ifirst</span><span class="p">)</span><span class="w">                             </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="p">&amp;</span><span class="w">              </span><span class="o">-</span><span class="w"> </span><span class="n">shift</span><span class="o">*</span><span class="p">(</span><span class="n">bscale</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="n">ifirst</span><span class="p">,</span><span class="n">ifirst</span><span class="p">))</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!        Do an implicit-shift QZ sweep.</span>
<span class="c">!</span>
<span class="c">!        Initial Q</span>
<span class="c">!</span>
<span class="w"> </span><span class="mi">80</span><span class="w">         </span><span class="n">ctemp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ascale</span><span class="o">*</span><span class="n">H</span><span class="p">(</span><span class="n">istart</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">istart</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">CALL </span><span class="n">ZLARTG</span><span class="p">(</span><span class="n">ctemp</span><span class="p">,</span><span class="n">ctemp2</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">ctemp3</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!        Sweep</span>
<span class="c">!</span>
<span class="w">            </span><span class="k">DO </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">istart</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">&gt;</span><span class="n">istart</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                  </span><span class="n">ctemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">H</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">CALL </span><span class="n">ZLARTG</span><span class="p">(</span><span class="n">ctemp</span><span class="p">,</span><span class="n">H</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">c</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">H</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="w">                  </span><span class="n">H</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CZERO</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="w">               </span><span class="k">DO </span><span class="n">jc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">ilastm</span><span class="w"></span>
<span class="w">                  </span><span class="n">ctemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">H</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">jc</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">H</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jc</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">H</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jc</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">DCONJG</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">*</span><span class="n">H</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">jc</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">H</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jc</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">H</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">jc</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctemp</span><span class="w"></span>
<span class="w">                  </span><span class="n">ctemp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">jc</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jc</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">T</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jc</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">DCONJG</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">jc</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jc</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">T</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">jc</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctemp2</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDDO</span>
<span class="k">               IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ilq</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                  DO </span><span class="n">jr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">                     </span><span class="n">ctemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">Q</span><span class="p">(</span><span class="n">jr</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">DCONJG</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">*</span><span class="n">Q</span><span class="p">(</span><span class="n">jr</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="n">Q</span><span class="p">(</span><span class="n">jr</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="o">*</span><span class="n">Q</span><span class="p">(</span><span class="n">jr</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">Q</span><span class="p">(</span><span class="n">jr</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="n">Q</span><span class="p">(</span><span class="n">jr</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctemp</span><span class="w"></span>
<span class="w">                  </span><span class="k">ENDDO</span>
<span class="k">               ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="w">               </span><span class="n">ctemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">T</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">ZLARTG</span><span class="p">(</span><span class="n">ctemp</span><span class="p">,</span><span class="n">T</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="n">c</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">T</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="w">               </span><span class="n">T</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CZERO</span><span class="w"></span>
<span class="c">!</span>
<span class="w">               </span><span class="k">DO </span><span class="n">jr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ifrstm</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">ilast</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">ctemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">H</span><span class="p">(</span><span class="n">jr</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">H</span><span class="p">(</span><span class="n">jr</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">H</span><span class="p">(</span><span class="n">jr</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">DCONJG</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">*</span><span class="n">H</span><span class="p">(</span><span class="n">jr</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">H</span><span class="p">(</span><span class="n">jr</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">H</span><span class="p">(</span><span class="n">jr</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctemp</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDDO</span>
<span class="k">               DO </span><span class="n">jr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ifrstm</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"></span>
<span class="w">                  </span><span class="n">ctemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="n">jr</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="n">jr</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">T</span><span class="p">(</span><span class="n">jr</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">DCONJG</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="n">jr</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="n">jr</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">T</span><span class="p">(</span><span class="n">jr</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctemp</span><span class="w"></span>
<span class="w">               </span><span class="k">ENDDO</span>
<span class="k">               IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ilz</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                  DO </span><span class="n">jr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="w">                     </span><span class="n">ctemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">Z</span><span class="p">(</span><span class="n">jr</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">Z</span><span class="p">(</span><span class="n">jr</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="n">Z</span><span class="p">(</span><span class="n">jr</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">DCONJG</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">*</span><span class="n">Z</span><span class="p">(</span><span class="n">jr</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">Z</span><span class="p">(</span><span class="n">jr</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">                     </span><span class="n">Z</span><span class="p">(</span><span class="n">jr</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctemp</span><span class="w"></span>
<span class="w">                  </span><span class="k">ENDDO</span>
<span class="k">               ENDIF</span>
<span class="k">            ENDDO</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!</span>
<span class="w">         </span><span class="k">ENDDO</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Drop-through = non-convergence</span>
<span class="c">!</span>
<span class="w">         </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ilast</span><span class="w"></span>
<span class="w">         </span><span class="k">GOTO</span><span class="w"> </span><span class="mi">200</span><span class="w"></span>
<span class="w">      </span><span class="k">ENDIF</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Successful completion of all QZ steps</span>
<span class="c">!</span>
<span class="c">!</span>
<span class="c">!     Set Eigenvalues 1:ILO-1</span>
<span class="c">!</span>
<span class="w"> </span><span class="mi">100</span><span class="w">  </span><span class="k">DO </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">Ilo</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="n">absb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ABS</span><span class="p">(</span><span class="n">T</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">absb</span><span class="o">&gt;</span><span class="n">safmin</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            </span><span class="n">signbc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DCONJG</span><span class="p">(</span><span class="n">T</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="n">absb</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">T</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">absb</span><span class="w"></span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ilschr</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">               CALL </span><span class="n">ZSCAL</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">signbc</span><span class="p">,</span><span class="n">T</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">CALL </span><span class="n">ZSCAL</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">signbc</span><span class="p">,</span><span class="n">H</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">ELSE</span>
<span class="k">               CALL </span><span class="n">ZSCAL</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">signbc</span><span class="p">,</span><span class="n">H</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">ENDIF</span>
<span class="k">            IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ilz</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">CALL </span><span class="n">ZSCAL</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">signbc</span><span class="p">,</span><span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">ELSE</span>
<span class="k">            </span><span class="n">T</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CZERO</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span>
<span class="k">         </span><span class="n">Alpha</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">H</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">Beta</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">T</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">ENDDO</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Normal Termination</span>
<span class="c">!</span>
<span class="w">      </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     Exit (other than argument error) -- return optimal workspace size</span>
<span class="c">!</span>
<span class="w"> </span><span class="mi">200</span><span class="w">  </span><span class="n">Work</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DCMPLX</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="w"></span>
<span class="c">!</span>
<span class="c">!     End of ZHGEQZ</span>
<span class="c">!</span>
<span class="w">      </span><span class="k">END SUBROUTINE </span><span class="n">ZHGEQZ</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              spag_lapack
 was developed by John S. Urban<br>              &copy; 2025 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2025-07-11 01:31 +0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>